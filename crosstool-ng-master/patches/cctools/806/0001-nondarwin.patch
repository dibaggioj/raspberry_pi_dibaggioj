diff -urN cctools-806-old/ar/archive.c cctools-806/ar/archive.c
--- cctools-806-old/ar/archive.c	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/ar/archive.c	2011-09-07 01:45:04.000000000 -0500
@@ -84,6 +84,10 @@
 #include "archive.h"
 #include "extern.h"
 
+#ifndef EBADRPC
+#define EBADRPC 72
+#endif
+
 typedef struct ar_hdr HDR;
 static char hb[sizeof(HDR) + 1];	/* real header */
 
@@ -321,7 +325,7 @@
 		 * things for exact binary equality.
 		 */
 		if (getenv("ZERO_AR_DATE") == NULL)
-			tv_sec = (long int)sb->st_mtimespec.tv_sec;
+			tv_sec = (long int)sb->st_mtime;
 		else
 			tv_sec = (long int)0;
 
@@ -340,21 +344,21 @@
 			(void)sprintf(hb, HDR3, name, (long int)tv_sec,
 			    (unsigned int)(u_short)sb->st_uid,
 			    (unsigned int)(u_short)sb->st_gid,
-			    sb->st_mode, sb->st_size, ARFMAG);
+			    sb->st_mode, (long long int)sb->st_size, ARFMAG);
 			lname = 0;
 		} else if (lname > sizeof(hdr->ar_name) || strchr(name, ' '))
 			(void)sprintf(hb, HDR1, AR_EFMT1, (lname + 3) & ~3,
 			    (long int)tv_sec,
 			    (unsigned int)(u_short)sb->st_uid,
 			    (unsigned int)(u_short)sb->st_gid,
-			    sb->st_mode, sb->st_size + ((lname + 3) & ~3),
+			    sb->st_mode, (long long int)(sb->st_size + ((lname + 3) & ~3)),
 			    ARFMAG);
 		else {
 			lname = 0;
 			(void)sprintf(hb, HDR2, name, (long int)tv_sec,
 			    (unsigned int)(u_short)sb->st_uid,
 			    (unsigned int)(u_short)sb->st_gid,
-			    sb->st_mode, sb->st_size, ARFMAG);
+			    sb->st_mode, (long long int)sb->st_size, ARFMAG);
 		}
 		size = sb->st_size;
 	} else {
diff -urN cctools-806-old/ar/archive.h cctools-806/ar/archive.h
--- cctools-806-old/ar/archive.h	2004-11-12 14:16:58.000000000 -0600
+++ cctools-806/ar/archive.h	2011-09-07 01:45:04.000000000 -0500
@@ -112,11 +112,11 @@
 } CHDR;
 
 /* Header format strings. */
-#define	HDR1	"%s%-13d%-12ld%-6u%-6u%-8o%-10qd%2s"
-#define	HDR2	"%-16.16s%-12ld%-6u%-6u%-8o%-10qd%2s"
+#define	HDR1	"%s%-13d%-12ld%-6u%-6u%-8o%-10lld%2s"
+#define	HDR2	"%-16.16s%-12ld%-6u%-6u%-8o%-10lld%2s"
 
 #define	OLDARMAXNAME	15
-#define	HDR3	"%-16.15s%-12ld%-6u%-6u%-8o%-10qd%2s"
+#define	HDR3	"%-16.15s%-12ld%-6u%-6u%-8o%-10lld%2s"
 
 
 #include <sys/cdefs.h>
diff -urN cctools-806-old/ar/Makefile cctools-806/ar/Makefile
--- cctools-806-old/ar/Makefile	2009-12-16 13:33:58.000000000 -0600
+++ cctools-806/ar/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,89 +0,0 @@
-ifneq "" "$(SDKROOT)"
-  SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
-endif
-OFLAG = -Os
-ifeq "mwccppc" "$(notdir $(CC))"
-  CFLAGS = -g $(OFLAG) -I$(SRCROOT)/../include $(SDK)
-else
-  CFLAGS = -g $(OFLAG) -Wall -I$(SRCROOT)/../include $(SDK)
-endif
-
-LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
-
-USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
-				  [ "$(RC_XBS)" != "YES" ]; then \
-	     echo YES ; else echo NO ; \
-	     fi; )
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-SRCROOT = .
-OBJROOT = .
-SYMROOT = .
-OFILE_DIR = $(OBJROOT)
-VPATH = $(OFILE_DIR)
-
-BINDIR = /usr/bin
-MANDIR = /usr/share/man
-DSTDIRS = $(DSTROOT)$(BINDIR) $(DSTROOT)$(MANDIR)/man1 $(DSTROOT)$(MANDIR)/man5
-
-HFILES = archive.h extern.h pathnames.h
-CFILES = append.c ar.c archive.c contents.c delete.c extract.c misc.c move.c \
-	 print.c replace.c 
-MAN1 = ar.1
-MAN5 = ar.5
-OBJS = $(CFILES:.c=.o) vers.o
-INSTALL_FILES = $(CFILES) $(HFILES) $(MAN1) $(MAN5) Makefile notes
-
-PRODUCT = ar
-
-all: $(OFILE_DIR) $(SYMROOT) $(PRODUCT).NEW
-
-$(PRODUCT).NEW:	$(OFILE_DIR) $(SYMROOT) $(OBJS)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/$@ $(OBJS) $(LIBSTUFF)
-
-vers.c:
-	vers_string -c $(VERS_STRING_FLAGS) $(PRODUCT) > $(OFILE_DIR)/$@
-
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c -o $(OFILE_DIR)/$*.o $<
-else
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file $(OFILE_DIR)/$*.d \
-		-o $(OFILE_DIR)/$*.o $<
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-clean: shlib_clean
-	-rm -f $(SYMROOT)/$(PRODUCT).NEW $(OFILE_DIR)/vers.c
-
-shlib_clean:
-	-cd $(OFILE_DIR); rm -f $(OBJS)
-	-rm -f $(OFILE_DIR)/Makedep make.out
-
-install: $(RC_OS)
-
-teflon macos: all $(DSTDIRS)
-	install -c -s -m 555 $(SYMROOT)/$(PRODUCT).NEW \
-		$(DSTROOT)$(BINDIR)/$(PRODUCT)
-	install -c -m 444 $(MAN1) $(DSTROOT)$(MANDIR)/man1
-	install -c -m 444 $(MAN5) $(DSTROOT)$(MANDIR)/man5
-
-nextstep:
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-$(OFILE_DIR) $(SYMROOT) $(DSTDIRS):
-	$(MKDIRS) $@
-
--include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/ar/Makefile.apple cctools-806/ar/Makefile.apple
--- cctools-806-old/ar/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/ar/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,89 @@
+ifneq "" "$(SDKROOT)"
+  SDK = -isysroot $(SDKROOT)
+  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
+endif
+OFLAG = -Os
+ifeq "mwccppc" "$(notdir $(CC))"
+  CFLAGS = -g $(OFLAG) -I$(SRCROOT)/../include $(SDK)
+else
+  CFLAGS = -g $(OFLAG) -Wall -I$(SRCROOT)/../include $(SDK)
+endif
+
+LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
+
+USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
+				  [ "$(RC_XBS)" != "YES" ]; then \
+	     echo YES ; else echo NO ; \
+	     fi; )
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+SRCROOT = .
+OBJROOT = .
+SYMROOT = .
+OFILE_DIR = $(OBJROOT)
+VPATH = $(OFILE_DIR)
+
+BINDIR = /usr/bin
+MANDIR = /usr/share/man
+DSTDIRS = $(DSTROOT)$(BINDIR) $(DSTROOT)$(MANDIR)/man1 $(DSTROOT)$(MANDIR)/man5
+
+HFILES = archive.h extern.h pathnames.h
+CFILES = append.c ar.c archive.c contents.c delete.c extract.c misc.c move.c \
+	 print.c replace.c 
+MAN1 = ar.1
+MAN5 = ar.5
+OBJS = $(CFILES:.c=.o) vers.o
+INSTALL_FILES = $(CFILES) $(HFILES) $(MAN1) $(MAN5) Makefile notes
+
+PRODUCT = ar
+
+all: $(OFILE_DIR) $(SYMROOT) $(PRODUCT).NEW
+
+$(PRODUCT).NEW:	$(OFILE_DIR) $(SYMROOT) $(OBJS)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/$@ $(OBJS) $(LIBSTUFF)
+
+vers.c:
+	vers_string -c $(VERS_STRING_FLAGS) $(PRODUCT) > $(OFILE_DIR)/$@
+
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c -o $(OFILE_DIR)/$*.o $<
+else
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file $(OFILE_DIR)/$*.d \
+		-o $(OFILE_DIR)/$*.o $<
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+clean: shlib_clean
+	-rm -f $(SYMROOT)/$(PRODUCT).NEW $(OFILE_DIR)/vers.c
+
+shlib_clean:
+	-cd $(OFILE_DIR); rm -f $(OBJS)
+	-rm -f $(OFILE_DIR)/Makedep make.out
+
+install: $(RC_OS)
+
+teflon macos: all $(DSTDIRS)
+	install -c -s -m 555 $(SYMROOT)/$(PRODUCT).NEW \
+		$(DSTROOT)$(BINDIR)/$(PRODUCT)
+	install -c -m 444 $(MAN1) $(DSTROOT)$(MANDIR)/man1
+	install -c -m 444 $(MAN5) $(DSTROOT)$(MANDIR)/man5
+
+nextstep:
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+$(OFILE_DIR) $(SYMROOT) $(DSTDIRS):
+	$(MKDIRS) $@
+
+-include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/ar/Makefile.arch.in cctools-806/ar/Makefile.arch.in
--- cctools-806-old/ar/Makefile.arch.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/ar/Makefile.arch.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,68 @@
+builddir = @builddir@
+top_builddir = @top_builddir@
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+
+prefix	= @prefix@
+exec_prefix	= @exec_prefix@
+libexecdir	= @libexecdir@
+
+VPATH = @srcdir@:@srcdir@/..
+
+CC              = @CC@
+WARNINGS	= @WARNINGS@
+CFLAGS          = @CFLAGS@
+MDYNAMICNOPIC   = @MDYNAMICNOPIC@
+CPPFLAGS        = @CPPFLAGS@
+DEFS            = @DEFS@ @ENDIAN_FLAG@
+LDFLAGS         = @LDFLAGS@
+HAVE_PRIVEXT    = @HAVE_PRIVEXT@
+HAVE_FOREIGN_HEADERS    = @HAVE_FOREIGN_HEADERS@
+
+ifeq ($(HAVE_PRIVEXT),NO)
+INCPRIVEXT      = -include $(top_srcdir)/include/extern.h
+endif
+
+ifeq ($(HAVE_FOREIGN_HEADERS),YES)
+FORHDRS         = -I$(top_srcdir)/include/foreign
+endif
+
+INSTALL		= @INSTALL@
+INSTALL_PROGRAM	= @INSTALL_PROGRAM@
+
+MYINCLUDES      = -I$(builddir) -I$(srcdir)/.. -I$(top_builddir)/include \
+			-I$(top_srcdir)/include $(INCPRIVEXT) $(FORHDRS)
+MYWARNINGS      =
+MYDEFS          = -DNeXT_MOD $(MYDEFS_$(ARCH))
+MYLDFLAGS	= -L$(top_builddir)/libstuff
+MYLIBS		= $(MYLIBS_$(ARCH))
+
+MYCOMPILEFLAGS  = $(WARNINGS) $(MYWARNINGS) $(DEFS) $(MYDEFS) \
+	$(CPPFLAGS) $(MYINCLUDES) $(CFLAGS) $(MDYNAMICNOPIC) 
+
+MYLINKFLAGS	= $(LDFLAGS) $(MYLDFLAGS) $(MYLIBS)
+
+CFILES = app.c as.c atof-generic.c atof-ieee.c expr.c fixes.c flonum-const.c \
+         flonum-copy.c flonum-mult.c frags.c hash.c hex-value.c input-file.c \
+         input-scrub.c layout.c messages.c obstack.c read.c sections.c \
+         symbols.c write_object.c xmalloc.c $(CFILES_$(ARCH))
+
+OBJS = $(CFILES:.c=.o) 
+
+%.o:	%.c
+	$(CC) $(MYCOMPILEFLAGS) -c -o $@ $<
+
+.PHONY: default clean distclean install
+
+default: as
+
+as: $(OBJS)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+
+install: as
+	mkdir -p $(DESTDIR)$(libexecdir)/gcc/darwin/$(ARCH)
+	$(INSTALL_PROGRAM) as $(DESTDIR)$(libexecdir)/gcc/darwin/$(ARCH)/as
+
+clean::
+	rm -r -f *.o
+	rm -f as
diff -urN cctools-806-old/ar/Makefile.in cctools-806/ar/Makefile.in
--- cctools-806-old/ar/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/ar/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,77 @@
+builddir = @builddir@
+top_builddir = @top_builddir@
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+
+prefix	= @prefix@
+datarootdir = @datarootdir@
+datadir = @datadir@
+exec_prefix	= @exec_prefix@
+bindir		= @bindir@
+mandir		= @mandir@
+
+VPATH = @srcdir@
+
+CC              = @CC@
+CFLAGS          = @CFLAGS@
+WARNINGS	= @WARNINGS@
+MDYNAMICNOPIC   = @MDYNAMICNOPIC@
+CPPFLAGS        = @CPPFLAGS@
+DEFS            = @DEFS@ @ENDIAN_FLAG@
+LDFLAGS         = @LDFLAGS@
+HAVE_PRIVEXT    = @HAVE_PRIVEXT@
+HAVE_FOREIGN_HEADERS    = @HAVE_FOREIGN_HEADERS@
+
+ifeq ($(HAVE_PRIVEXT),NO)
+INCPRIVEXT      = -include $(top_srcdir)/include/extern.h
+endif
+
+ifeq ($(HAVE_FOREIGN_HEADERS),YES)
+FORHDRS         = -I$(top_srcdir)/include/foreign
+endif
+
+INSTALL		= @INSTALL@
+INSTALL_PROGRAM = @INSTALL_PROGRAM@
+INSTALL_DATA	= @INSTALL_DATA@
+transform	= @program_transform_name@
+RANLIBPROG      = $(shell echo ranlib | sed '$(transform)')
+
+MYINCLUDES      = -I$(srcdir) -I$(top_builddir)/include \
+			-I$(top_srcdir)/include $(INCPRIVEXT) $(FORHDRS)
+MYWARNINGS      =
+MYDEFS          = -DBINDIR="\"$(bindir)\"" -DRANLIBPROG="\"$(RANLIBPROG)\""
+MYLDFLAGS	= -L$(top_builddir)/libstuff
+MYLIBS		= -lstuff
+
+MYCOMPILEFLAGS	= $(WARNINGS) $(MYWARNINGS) $(DEFS) $(MYDEFS) \
+	$(CPPFLAGS) $(MYINCLUDES) $(CFLAGS) $(MDYNAMICNOPIC) 
+	
+MYLINKFLAGS	= $(LDFLAGS) $(MYLDFLAGS) $(MYLIBS)
+
+CFILES = append.c ar.c archive.c contents.c delete.c extract.c misc.c \
+	move.c print.c replace.c 
+OBJS = $(CFILES:.c=.o)
+
+.c.o:
+	$(CC) $(MYCOMPILEFLAGS) -c -o $@ $<
+
+.PHONY: default install clean distclean
+
+default: ar
+
+ar: $(OBJS)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+
+install: ar
+	mkdir -p $(DESTDIR)$(bindir)
+	mkdir -p $(DESTDIR)$(mandir)/man1
+	mkdir -p $(DESTDIR)$(mandir)/man5
+	$(INSTALL_PROGRAM) ar \
+		$(DESTDIR)$(bindir)/`echo ar | sed '$(transform)'`
+	$(INSTALL_DATA) $(srcdir)/ar.1 $(DESTDIR)$(mandir)/man1/`echo ar.1 | sed '$(transform)'`
+	$(INSTALL_DATA) $(srcdir)/ar.5 $(DESTDIR)$(mandir)/man5/`echo ar.5 | sed '$(transform)'`
+
+
+clean:
+	rm -r -f *.o
+	rm -f ar
diff -urN cctools-806-old/ar/misc.c cctools-806/ar/misc.c
--- cctools-806-old/ar/misc.c	2003-08-12 19:02:39.000000000 -0500
+++ cctools-806/ar/misc.c	2011-09-07 01:45:04.000000000 -0500
@@ -81,6 +81,10 @@
 #include "extern.h"
 #include "pathnames.h"
 
+#ifndef EFTYPE
+#define EFTYPE 79
+#endif
+
 char *tname = "temporary file";		/* temporary file "name" */
 
 int
@@ -105,7 +109,7 @@
 	sigfillset(&set);
 	(void)sigprocmask(SIG_BLOCK, &set, &oset);
 	if ((fd = mkstemp(path)) == -1)
-		error(tname);
+		error2(tname);
         (void)unlink(path);
 	(void)sigprocmask(SIG_SETMASK, &oset, NULL);
 	return (fd);
@@ -169,7 +173,7 @@
 }
 
 void
-error(name)
+error2(name)
 	char *name;
 {
 
diff -urN cctools-806-old/as/arm/Makefile.in cctools-806/as/arm/Makefile.in
--- cctools-806-old/as/arm/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/arm/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,11 @@
+ARCH    =   arm
+
+CFILES_arm =	arm.c
+MYDEFS_arm =	-DARM
+MYLIBS_arm =	-lstuff
+
+VPATH=@srcdir@/arm
+
+all:	default
+
+.PHONY:	all
diff -urN cctools-806-old/as/i386/Makefile.in cctools-806/as/i386/Makefile.in
--- cctools-806-old/as/i386/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/i386/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,6 @@
+ARCH	=	i386
+
+CFILES_i386	=	i386.c
+MYDEFS_i386	=	-DI386 -Di486 -Di586 -Di686
+MYLIBS_i386	=	-lstuff
+
diff -urN cctools-806-old/as/Makefile cctools-806/as/Makefile
--- cctools-806-old/as/Makefile	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,496 +0,0 @@
-RC_OS = macos
-export USE_APPLE_PB_SUPPORT = all
-OFLAG = -Os
-X_CFLAGS =
-
-ifneq "clang" "$(notdir $(CC))"
-  GCC_FLAGS = -Wall $(X_CFLAGS)
-endif
-
-USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "clang" ] && \
-				  [ "$(RC_XBS)" != "YES" ]; then \
-	     echo YES ; else echo NO ; \
-	     fi; )
-
-ifneq "" "$(SDKROOT)"
-  SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
-endif
-CFLAGS = $(OFLAG) -g -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) \
-	$(GCC_FLAGS) -DNeXT_MOD $(SDK)
-
-LIBSTUFF_DIR = -L$(SYMROOT)/../../libstuff
-LIBSTUFF = -lstuff
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-SRCROOT = .
-SYMROOT = .
-OBJROOT = .
-SYM_DIRS = $(SYMROOT)/driver_dir \
-	   $(SYMROOT)/a68_dir \
-	   $(SYMROOT)/a88_dir \
-	   $(SYMROOT)/a386_dir \
- 	   $(SYMROOT)/ax86_64_dir \
-	   $(SYMROOT)/appc_dir \
-	   $(SYMROOT)/appc64_dir \
-	   $(SYMROOT)/a860_dir \
-	   $(SYMROOT)/ahppa_dir \
-	   $(SYMROOT)/asparc_dir \
-	   $(SYMROOT)/aarm_dir 
-
-OFILE_DIRS = $(OBJROOT)/driver_dir \
-	     $(OBJROOT)/a68_dir \
-	     $(OBJROOT)/a88_dir \
-	     $(OBJROOT)/a386_dir \
- 	     $(OBJROOT)/ax86_64_dir \
-	     $(OBJROOT)/appc_dir \
-	     $(OBJROOT)/appc64_dir \
-	     $(OBJROOT)/a860_dir \
-	     $(OBJROOT)/ahppa_dir \
-	     $(OBJROOT)/asparc_dir \
-	     $(OBJROOT)/aarm_dir
-
-BINDIR = /bin
-USRBINDIR = /usr/bin
-ifeq "macos" "$(RC_OS)"
-       LIBDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
-			    [ "$(RC_RELEASE)" = "Bunsen" ] ||    \
-			    [ "$(RC_RELEASE)" = "Gonzo"  ] ||    \
-			    [ "$(RC_RELEASE)" = "Kodiak" ]; then \
-	     echo /usr/libexec; else echo /usr/libexec/gcc/darwin; \
-	     fi; )
-       LOCLIBDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
-			       [ "$(RC_RELEASE)" = "Bunsen" ] ||    \
-			       [ "$(RC_RELEASE)" = "Gonzo"  ] ||    \
-			       [ "$(RC_RELEASE)" = "Kodiak" ]; then \
-	     echo /usr/local/libexec; else echo /usr/local/libexec/gcc/darwin; \
-	     fi; )
-else
-  LIBDIR = /usr/libexec
-  LOCLIBDIR = /usr/local/libexec
-endif
-
-DWARF = dwarf2dbg.c
-CFILES = app.c as.c atof-generic.c atof-ieee.c expr.c fixes.c flonum-const.c \
-	 flonum-copy.c flonum-mult.c frags.c hash.c hex-value.c input-file.c \
-	 input-scrub.c layout.c messages.c obstack.c read.c sections.c \
-	 symbols.c write_object.c xmalloc.c $(DWARF)
-
-CFILES_m68k = m68k.c
-CFILES_m88k = m88k.c
-CFILES_i860 = i860.c
-CFILES_i386 = i386.c
-CFILES_ppc = ppc.c
-CFILES_hppa = hppa.c hppa-aux.c
-CFILES_sparc = sparc.c
-CFILES_arm = arm.c
-
-HFILES = app.h as.h atof-ieee.h bignum.h expr.h fixes.h flonum.h frags.h \
-	 hash.h hex_value.h i386-opcode.h i386.h i860-opcode.h input-file.h \
-	 input-scrub.h layout.h m68k-opcode.h m88k-opcode.h ppc-opcode.h md.h \
-	 messages.h obstack.h read.h relax.h sections.h struc-symbol.h \
-	 symbols.h write_object.h xmalloc.h hppa-aux.h hppa-opcode.h \
-	 sparc-opcode.h arch64_32.h dwarf2dbg.h filenames.h arm_reloc.h
-
-CHECK_FILES = m68k-check.c m88k-check.c i860-check.c i386-check.c ppc-check.c \
-	      hppa-check.c sparc-check.c arm-check.c
-
-INSTALL_FILES = Makefile notes $(CFILES) $(CFILES_m68k) $(CFILES_m88k) \
-		$(CFILES_i860) $(CFILES_i386) $(CFILES_ppc) $(CFILES_hppa) \
-		$(CFILES_sparc) $(CFILES_arm) $(HFILES) $(CHECK_FILES) \
-		driver.c COPYING cctools.plist
-
-OBJS = $(CFILES:.c=.o) apple_version.o
-OBJS_m68k = $(CFILES_m68k:.c=.o)
-OBJS_m88k = $(CFILES_m88k:.c=.o)
-OBJS_i860 = $(CFILES_i860:.c=.o)
-OBJS_i386 = $(CFILES_i386:.c=.o)
-OBJS_ppc = $(CFILES_ppc:.c=.o)
-OBJS_hppa = $(CFILES_hppa:.c=.o)
-OBJS_sparc = $(CFILES_sparc:.c=.o)
-OBJS_arm = $(CFILES_arm:.c=.o)
-
-all:	$(OFILE_DIRS) $(SYM_DIRS) driver_build a68_build a88_build a386_build \
-	ax86_64_build a860_build appc_build appc64_build ahppa_build \
-	aarm_build asparc_build
-
-all_test:	a68_test a88_test a860_test a386_test appc_test ahppa_test
-
-driver_build:	$(OBJROOT)/driver_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd driver_dir;  $(MAKE) -f ../Makefile driver VPATH=..	\
-		CFLAGS="-g -Os -I../../include $(GCC_FLAGS) $(SDK)"	\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFILE_DIR=.	\
-		RC_FLAGS="$(RC_CFLAGS)" DEP_DIR=driver_dir;		\
-	else								\
-	    cd $(OBJROOT)/driver_dir; $(MAKE) -f $(SRCROOT)/Makefile	\
-		driver VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/driver_dir \
-		SYMROOT=$(SYMROOT)/driver_dir SRCROOT=$(SRCROOT)	\
-		CFLAGS="-g -Os -I$(SRCROOT)/../include $(GCC_FLAGS) $(SDK)" \
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_FLAGS="$(RC_CFLAGS)" DEP_DIR=driver_dir;		\
-	fi
-
-a68_build:	$(OBJROOT)/a68_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd a68_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.	\
-		SRCROOT=.. TARGET_OBJS="$(OBJS_m68k)" DEP_DIR=a68_dir	\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG) \
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		COPTS="-DM68K -DBUILTIN_MMUS";				\
-	else								\
-	    cd $(OBJROOT)/a68_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
-		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/a68_dir		\
-		SYMROOT=$(SYMROOT)/a68_dir SRCROOT=$(SRCROOT)		\
-		TARGET_OBJS="$(OBJS_m68k)"				\
-		COPTS="-DM68K -DBUILTIN_MMUS"				\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=a68_dir;		\
-	fi
-
-a68_test: a68_dir
-	cd a68_dir; $(MAKE) -f ../Makefile m68k-check VPATH=.. OFILE_DIR=. \
-		SRCROOT=.. COPTS="-DM68K -DBUILTIN_MMUS"
-	cd a68_dir; $(MAKE) -f ../Makefile test
-
-a88_build:	$(OBJROOT)/a88_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd a88_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.	\
-		SRCROOT=.. TARGET_OBJS="$(OBJS_m88k)" DEP_DIR=a88_dir	\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
-		COPTS="-DM88K -Dm88110" RCFLAGS=$(RCFLAGS);		\
-	else								\
-	    cd $(OBJROOT)/a88_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
-		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/a88_dir		\
-		SYMROOT=$(SYMROOT)/a88_dir SRCROOT=$(SRCROOT)		\
-		TARGET_OBJS="$(OBJS_m88k)" COPTS="-DM88K -Dm88110"	\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=a88_dir;		\
-	fi
-
-a88_test: a88_dir
-	cd a88_dir; $(MAKE) -f ../Makefile m88k-check VPATH=.. OFILE_DIR=. \
-		SRCROOT=.. COPTS="-DM88K -Dm88110"
-	cd a88_dir; $(MAKE) -f ../Makefile test
-
-a386_build:	$(OBJROOT)/a386_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd a386_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.	\
-		SRCROOT=.. TARGET_OBJS="$(OBJS_i386)" DEP_DIR=a386_dir	\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
-		COPTS="-DI386 -Di486 -Di586 -Di686"			\
-		RC_CFLAGS="$(RC_CFLAGS)";				\
-	else								\
-	    cd $(OBJROOT)/a386_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
-		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/a386_dir		\
-		SYMROOT=$(SYMROOT)/a386_dir SRCROOT=$(SRCROOT)		\
-		TARGET_OBJS="$(OBJS_i386)"				\
-		COPTS="-DI386 -Di486 -Di586 -Di686"			\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)"  DEP_DIR=a386_dir;		\
-	fi
-
-a386_test: a386_dir
-	cd a386_dir; $(MAKE) -f ../Makefile i386-check VPATH=.. OFILE_DIR=. \
-		SRCROOT=.. COPTS="-DI386 -Di486 -Di586 -Di686"
-	cd a386_dir; $(MAKE) -f ../Makefile test
-
-
-ax86_64_build:	$(OBJROOT)/ax86_64_dir
-	@if [ $(SRCROOT) = . ];						\
- 	then								\
- 	    cd ax86_64_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=. \
- 		SRCROOT=.. TARGET_OBJS="$(OBJS_i386)" DEP_DIR=ax86_64_dir \
- 		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
- 		COPTS="-DI386 -Di486 -Di586 -Di686 -DARCH64"		\
- 		RC_CFLAGS="$(RC_CFLAGS)" LIBSTUFF="-lstuff";		\
- 	else								\
- 	    cd $(OBJROOT)/ax86_64_dir; $(MAKE) -f $(SRCROOT)/Makefile as \
- 		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/ax86_64_dir	\
- 		SYMROOT=$(SYMROOT)/ax86_64_dir SRCROOT=$(SRCROOT)	\
- 		TARGET_OBJS="$(OBJS_i386)" LIBSTUFF="-lstuff"		\
- 		COPTS="-DI386 -Di486 -Di586 -Di686 -DARCH64"		\
- 		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
- 		RC_CFLAGS="$(RC_CFLAGS)"  DEP_DIR=ax86_64_dir;		\
- 	fi
- 
-ax86_64_test: ax86_64_dir
-	cd ax86_64_dir; $(MAKE) -f ../Makefile x86_64-check VPATH=.. \
-	    OFILE_DIR=. SRCROOT=.. COPTS="-DI386 -Di486 -Di586 -Di686 -DARCH64"
-	cd ax86_64_dir; $(MAKE) -f ../Makefile test
-
-a860_build:	$(OBJROOT)/a860_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd a860_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.	\
-		SRCROOT=.. TARGET_OBJS="$(OBJS_i860)" DEP_DIR=a860_dir	\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
-		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-DI860";		\
-	else								\
-	    cd $(OBJROOT)/a860_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
-		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/a860_dir		\
-		SYMROOT=$(SYMROOT)/a860_dir SRCROOT=$(SRCROOT)		\
-		TARGET_OBJS="$(OBJS_i860)" COPTS="-DI860"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)"  DEP_DIR=a860_dir;		\
-	fi
-
-a860_test: a860_dir
-	cd a860_dir; $(MAKE) -f ../Makefile i860-check VPATH=.. OFILE_DIR=. \
-		SRCROOT=.. COPTS="-DI860"
-	cd a860_dir; $(MAKE) -f ../Makefile test ASFLAGS=-W
-
-appc_build:	$(OBJROOT)/appc_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd appc_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.	\
-		SRCROOT=.. TARGET_OBJS="$(OBJS_ppc)" DEP_DIR=appc_dir	\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG) \
-		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-DPPC";			\
-	else								\
-	    cd $(OBJROOT)/appc_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
-		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/appc_dir		\
-		SYMROOT=$(SYMROOT)/appc_dir SRCROOT=$(SRCROOT)		\
-		TARGET_OBJS="$(OBJS_ppc)" COPTS="-DPPC"			\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=appc_dir;		\
-	fi
-
-appc64_build:	$(OBJROOT)/appc64_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd appc64_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=. \
-		SRCROOT=.. TARGET_OBJS="$(OBJS_ppc)" DEP_DIR=appc64_dir	\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" OFLAG=$(OFLAG)			\
-		COPTS="-DPPC -DARCH64" LIBSTUFF="-lstuff";		\
-	else								\
-	    cd $(OBJROOT)/appc64_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
-		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/appc64_dir	\
-		SYMROOT=$(SYMROOT)/appc64_dir SRCROOT=$(SRCROOT)	\
-		TARGET_OBJS="$(OBJS_ppc)" COPTS="-DPPC -DARCH64"	\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=appc64_dir		\
-		LIBSTUFF="-lstuff";					\
-	fi
-
-appc_test: appc_dir
-	cd appc_dir; $(MAKE) -f ../Makefile ppc-check VPATH=.. OFILE_DIR=. \
-		SRCROOT=.. COPTS="-DPPC"
-	cd appc_dir; $(MAKE) -f ../Makefile test
-
-ahppa_build:	$(OBJROOT)/ahppa_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd ahppa_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.\
-		SRCROOT=.. TARGET_OBJS="$(OBJS_hppa)" DEP_DIR=ahppa_dir	\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
-		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-DHPPA";		\
-	else								\
-	    cd $(OBJROOT)/ahppa_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
-		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/ahppa_dir		\
-		SYMROOT=$(SYMROOT)/ahppa_dir SRCROOT=$(SRCROOT)		\
-		TARGET_OBJS="$(OBJS_hppa)" COPTS="-DHPPA"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=ahppa_dir;		\
-	fi
-
-ahppa_test: ahppa_dir
-	cd ahppa_dir; $(MAKE) -f ../Makefile hppa-check VPATH=.. OFILE_DIR=. \
-		SRCROOT=.. COPTS="-DHPPA"
-	cd ahppa_dir; $(MAKE) -f ../Makefile test
-
-asparc_build:	$(OBJROOT)/asparc_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd asparc_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.\
-		SRCROOT=.. TARGET_OBJS="$(OBJS_sparc)" DEP_DIR=asparc_dir\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
-		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-DSPARC";		\
-	else								\
-	    cd $(OBJROOT)/asparc_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
-		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/asparc_dir	\
-		SYMROOT=$(SYMROOT)/asparc_dir SRCROOT=$(SRCROOT)	\
-		TARGET_OBJS="$(OBJS_sparc)" COPTS="-DSPARC"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=asparc_dir;		\
-	fi
-
-asparc_test: asparc_dir
-	cd asparc_dir; $(MAKE) -f ../Makefile sparc-check VPATH=.. \
-		OFILE_DIR=. SRCROOT=.. COPTS="-DSPARC"
-	cd asparc_dir; $(MAKE) -f ../Makefile test
-
-aarm_build:	$(OBJROOT)/aarm_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd aarm_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=. \
-		SRCROOT=.. TARGET_OBJS="$(OBJS_arm)" DEP_DIR=aarm_dir	\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
-		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-DARM";			\
-	else								\
-	    cd $(OBJROOT)/aarm_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
-		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/aarm_dir		\
-		SYMROOT=$(SYMROOT)/aarm_dir SRCROOT=$(SRCROOT)		\
-		TARGET_OBJS="$(OBJS_arm)" COPTS="-DARM"			\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=aarm_dir;		\
-	fi
-
-aarm_test: aarm_dir
-	cd aarm_dir; $(MAKE) -f ../Makefile arm-check VPATH=.. \
-		OFILE_DIR=. SRCROOT=.. COPTS="-DARM"
-	cd aarm_dir; $(MAKE) -f ../Makefile test
-
-driver:	driver.o apple_version.o
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/driver \
-		$(OFILE_DIR)/driver.o $(OFILE_DIR)/apple_version.o \
-		$(LIBSTUFF_DIR) $(LIBSTUFF)
-
-as:	$(OBJS) $(TARGET_OBJS)
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(SYMROOT)/as.private.o $(OBJS) $(TARGET_OBJS) \
-		$(LIBSTUFF_DIR) $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/as $(SYMROOT)/as.private.o
-
-m68k-check:
-	$(CC) $(COPTS) $(CFLAGS) -o check ../m68k-check.c
-
-m88k-check:
-	$(CC) $(COPTS) $(CFLAGS) -o check ../m88k-check.c
-
-i386-check:
-	$(CC) $(COPTS) $(CFLAGS) -o check ../i386-check.c
-
-x86_64-check:
-	$(CC) $(COPTS) $(CFLAGS) -DARCH64 -o check ../i386-check.c
-
-i860-check:
-	$(CC) $(COPTS) $(CFLAGS) -o check ../i860-check.c
-
-ppc-check:
-	$(CC) $(COPTS) $(CFLAGS) -o check ../ppc-check.c
-
-hppa-check:
-	$(CC) $(COPTS) $(CFLAGS) -o check ../hppa-check.c
-
-sparc-check:
-	$(CC) $(COPTS) $(CFLAGS) -o check ../sparc-check.c
-
-arm-check:
-	$(CC) $(COPTS) $(CFLAGS) -o check ../arm-check.c
-
-test:
-	./check $(LLVM_MC) > check.s
-	./as -W -force_cpusubtype_ALL $(ASFLAGS) -o check.o check.s
-	otool -X -tV $(LLVM_MC) check.o > check1.s
-	./as -force_cpusubtype_ALL $(ASFLAGS) -o check1.o check1.s
-	otool -X -tV $(LLVM_MC) check1.o > check2.s
-	diff check1.s check2.s > check.out
-	cmp check.o check1.o
-
-apple_version.c:
-	echo "const char apple_version[]= " \"`vers_string $(VERS_STRING_FLAGS) -f cctools`\" ";" > \
-		$(OFILE_DIR)/$@
-
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-.c.o:
-	$(CC) $(COPTS) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o $<
-else
-.c.o:
-	$(CC) $(COPTS) $(CFLAGS) $(RC_CFLAGS) -c -MD \
-		-dependency-file $(OFILE_DIR)/$*.d -o $(OFILE_DIR)/$*.o $<
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-clean shlib_clean:
-	-rm -r -f $(OFILE_DIRS) make.out
-
-installsrc installGASsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-install: all $(RC_OS)_install
-
-macos_install: common_install xcommon_install
-	$(MKDIRS) $(DSTROOT)$(LIBDIR)/i386
-	install -c -s -m 555 $(SYMROOT)/a386_dir/as \
-		$(DSTROOT)$(LIBDIR)/i386/as
-	$(MKDIRS) $(DSTROOT)$(LIBDIR)/x86_64
-	install -c -s -m 555 $(SYMROOT)/ax86_64_dir/as \
-		$(DSTROOT)$(LIBDIR)/x86_64/as
-
-teflon_install: common_install xcommon_install
-	$(MKDIRS) $(DSTROOT)$(LIBDIR)/i386
-	install -c -s -m 555 $(SYMROOT)/a386_dir/as \
-		$(DSTROOT)$(LIBDIR)/i386/as
-
-xcommon_install:
-	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
-	install -c -s -m 555 $(SYMROOT)/driver_dir/driver \
-		$(DSTROOT)$(USRBINDIR)/as	
-	$(MKDIRS) $(DSTROOT)/usr/local/OpenSourceVersions/
-	install -c -s -m 444 $(SRCROOT)/cctools.plist \
-		$(DSTROOT)/usr/local/OpenSourceVersions/cctools.plist
-	$(MKDIRS) $(DSTROOT)/usr/local/OpenSourceLicenses/
-	install -c -s -m 444 $(SRCROOT)/COPYING \
-		$(DSTROOT)/usr/local/OpenSourceLicenses/cctools.txt
-	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/ppc
-	install -c -s -m 555 $(SYMROOT)/appc_dir/as \
-		$(DSTROOT)$(LOCLIBDIR)/ppc/as
-	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/ppc64
-	install -c -s -m 555 $(SYMROOT)/appc64_dir/as \
-		$(DSTROOT)$(LOCLIBDIR)/ppc64/as
-	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/m68k
-	install -c -s -m 555 $(SYMROOT)/a68_dir/as \
-		$(DSTROOT)$(LOCLIBDIR)/m68k/as
-	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/sparc 
-	install -c -s -m 555 $(SYMROOT)/asparc_dir/as \
-		$(DSTROOT)$(LOCLIBDIR)/sparc/as
-	$(MKDIRS) $(DSTROOT)$(LIBDIR)/arm
-	install -c -s -m 555 $(SYMROOT)/aarm_dir/as \
-		$(DSTROOT)$(LIBDIR)/arm/as
-
-nextstep_install: common_install
-	$(MKDIRS) $(DSTROOT)$(BINDIR)
-	install -c -s -m 555 $(SYMROOT)/driver_dir/driver \
-		$(DSTROOT)$(BINDIR)/as	
-	$(MKDIRS) $(DSTROOT)$(LIBDIR)/m68k
-	install -c -s -m 555 $(SYMROOT)/a68_dir/as \
-		$(DSTROOT)$(LIBDIR)/m68k/as
-	$(MKDIRS) $(DSTROOT)$(LIBDIR)/i386
-	install -c -s -m 555 $(SYMROOT)/a386_dir/as \
-		$(DSTROOT)$(LIBDIR)/i386/as
-	$(MKDIRS) $(DSTROOT)$(LIBDIR)/sparc
-	install -c -s -m 555 $(SYMROOT)/asparc_dir/as \
-		$(DSTROOT)$(LIBDIR)/sparc/as
-	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/ppc
-	install -c -s -m 555 $(SYMROOT)/appc_dir/as \
-		$(DSTROOT)$(LOCLIBDIR)/ppc/as
-
-common_install:
-	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/m88k
-	install -c -s -m 555 $(SYMROOT)/a88_dir/as \
-		$(DSTROOT)$(LOCLIBDIR)/m88k/as
-	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/hppa
-	install -c -s -m 555 $(SYMROOT)/ahppa_dir/as \
-		$(DSTROOT)$(LOCLIBDIR)/hppa/as
-	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/i860
-	install -s -m 555 $(SYMROOT)/a860_dir/as \
-		$(DSTROOT)$(LOCLIBDIR)/i860/as
-
-$(OFILE_DIRS) $(SYM_DIRS):
-	$(MKDIRS) $@
-
--include $(DEP_DIR)/Makedep
diff -urN cctools-806-old/as/Makefile.apple cctools-806/as/Makefile.apple
--- cctools-806-old/as/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,496 @@
+RC_OS = macos
+export USE_APPLE_PB_SUPPORT = all
+OFLAG = -Os
+X_CFLAGS =
+
+ifneq "clang" "$(notdir $(CC))"
+  GCC_FLAGS = -Wall $(X_CFLAGS)
+endif
+
+USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "clang" ] && \
+				  [ "$(RC_XBS)" != "YES" ]; then \
+	     echo YES ; else echo NO ; \
+	     fi; )
+
+ifneq "" "$(SDKROOT)"
+  SDK = -isysroot $(SDKROOT)
+  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
+endif
+CFLAGS = $(OFLAG) -g -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) \
+	$(GCC_FLAGS) -DNeXT_MOD $(SDK)
+
+LIBSTUFF_DIR = -L$(SYMROOT)/../../libstuff
+LIBSTUFF = -lstuff
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+SRCROOT = .
+SYMROOT = .
+OBJROOT = .
+SYM_DIRS = $(SYMROOT)/driver_dir \
+	   $(SYMROOT)/a68_dir \
+	   $(SYMROOT)/a88_dir \
+	   $(SYMROOT)/a386_dir \
+ 	   $(SYMROOT)/ax86_64_dir \
+	   $(SYMROOT)/appc_dir \
+	   $(SYMROOT)/appc64_dir \
+	   $(SYMROOT)/a860_dir \
+	   $(SYMROOT)/ahppa_dir \
+	   $(SYMROOT)/asparc_dir \
+	   $(SYMROOT)/aarm_dir 
+
+OFILE_DIRS = $(OBJROOT)/driver_dir \
+	     $(OBJROOT)/a68_dir \
+	     $(OBJROOT)/a88_dir \
+	     $(OBJROOT)/a386_dir \
+ 	     $(OBJROOT)/ax86_64_dir \
+	     $(OBJROOT)/appc_dir \
+	     $(OBJROOT)/appc64_dir \
+	     $(OBJROOT)/a860_dir \
+	     $(OBJROOT)/ahppa_dir \
+	     $(OBJROOT)/asparc_dir \
+	     $(OBJROOT)/aarm_dir
+
+BINDIR = /bin
+USRBINDIR = /usr/bin
+ifeq "macos" "$(RC_OS)"
+       LIBDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
+			    [ "$(RC_RELEASE)" = "Bunsen" ] ||    \
+			    [ "$(RC_RELEASE)" = "Gonzo"  ] ||    \
+			    [ "$(RC_RELEASE)" = "Kodiak" ]; then \
+	     echo /usr/libexec; else echo /usr/libexec/gcc/darwin; \
+	     fi; )
+       LOCLIBDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
+			       [ "$(RC_RELEASE)" = "Bunsen" ] ||    \
+			       [ "$(RC_RELEASE)" = "Gonzo"  ] ||    \
+			       [ "$(RC_RELEASE)" = "Kodiak" ]; then \
+	     echo /usr/local/libexec; else echo /usr/local/libexec/gcc/darwin; \
+	     fi; )
+else
+  LIBDIR = /usr/libexec
+  LOCLIBDIR = /usr/local/libexec
+endif
+
+DWARF = dwarf2dbg.c
+CFILES = app.c as.c atof-generic.c atof-ieee.c expr.c fixes.c flonum-const.c \
+	 flonum-copy.c flonum-mult.c frags.c hash.c hex-value.c input-file.c \
+	 input-scrub.c layout.c messages.c obstack.c read.c sections.c \
+	 symbols.c write_object.c xmalloc.c $(DWARF)
+
+CFILES_m68k = m68k.c
+CFILES_m88k = m88k.c
+CFILES_i860 = i860.c
+CFILES_i386 = i386.c
+CFILES_ppc = ppc.c
+CFILES_hppa = hppa.c hppa-aux.c
+CFILES_sparc = sparc.c
+CFILES_arm = arm.c
+
+HFILES = app.h as.h atof-ieee.h bignum.h expr.h fixes.h flonum.h frags.h \
+	 hash.h hex_value.h i386-opcode.h i386.h i860-opcode.h input-file.h \
+	 input-scrub.h layout.h m68k-opcode.h m88k-opcode.h ppc-opcode.h md.h \
+	 messages.h obstack.h read.h relax.h sections.h struc-symbol.h \
+	 symbols.h write_object.h xmalloc.h hppa-aux.h hppa-opcode.h \
+	 sparc-opcode.h arch64_32.h dwarf2dbg.h filenames.h arm_reloc.h
+
+CHECK_FILES = m68k-check.c m88k-check.c i860-check.c i386-check.c ppc-check.c \
+	      hppa-check.c sparc-check.c arm-check.c
+
+INSTALL_FILES = Makefile notes $(CFILES) $(CFILES_m68k) $(CFILES_m88k) \
+		$(CFILES_i860) $(CFILES_i386) $(CFILES_ppc) $(CFILES_hppa) \
+		$(CFILES_sparc) $(CFILES_arm) $(HFILES) $(CHECK_FILES) \
+		driver.c COPYING cctools.plist
+
+OBJS = $(CFILES:.c=.o) apple_version.o
+OBJS_m68k = $(CFILES_m68k:.c=.o)
+OBJS_m88k = $(CFILES_m88k:.c=.o)
+OBJS_i860 = $(CFILES_i860:.c=.o)
+OBJS_i386 = $(CFILES_i386:.c=.o)
+OBJS_ppc = $(CFILES_ppc:.c=.o)
+OBJS_hppa = $(CFILES_hppa:.c=.o)
+OBJS_sparc = $(CFILES_sparc:.c=.o)
+OBJS_arm = $(CFILES_arm:.c=.o)
+
+all:	$(OFILE_DIRS) $(SYM_DIRS) driver_build a68_build a88_build a386_build \
+	ax86_64_build a860_build appc_build appc64_build ahppa_build \
+	aarm_build asparc_build
+
+all_test:	a68_test a88_test a860_test a386_test appc_test ahppa_test
+
+driver_build:	$(OBJROOT)/driver_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd driver_dir;  $(MAKE) -f ../Makefile driver VPATH=..	\
+		CFLAGS="-g -Os -I../../include $(GCC_FLAGS) $(SDK)"	\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFILE_DIR=.	\
+		RC_FLAGS="$(RC_CFLAGS)" DEP_DIR=driver_dir;		\
+	else								\
+	    cd $(OBJROOT)/driver_dir; $(MAKE) -f $(SRCROOT)/Makefile	\
+		driver VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/driver_dir \
+		SYMROOT=$(SYMROOT)/driver_dir SRCROOT=$(SRCROOT)	\
+		CFLAGS="-g -Os -I$(SRCROOT)/../include $(GCC_FLAGS) $(SDK)" \
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_FLAGS="$(RC_CFLAGS)" DEP_DIR=driver_dir;		\
+	fi
+
+a68_build:	$(OBJROOT)/a68_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd a68_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.	\
+		SRCROOT=.. TARGET_OBJS="$(OBJS_m68k)" DEP_DIR=a68_dir	\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG) \
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		COPTS="-DM68K -DBUILTIN_MMUS";				\
+	else								\
+	    cd $(OBJROOT)/a68_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
+		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/a68_dir		\
+		SYMROOT=$(SYMROOT)/a68_dir SRCROOT=$(SRCROOT)		\
+		TARGET_OBJS="$(OBJS_m68k)"				\
+		COPTS="-DM68K -DBUILTIN_MMUS"				\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=a68_dir;		\
+	fi
+
+a68_test: a68_dir
+	cd a68_dir; $(MAKE) -f ../Makefile m68k-check VPATH=.. OFILE_DIR=. \
+		SRCROOT=.. COPTS="-DM68K -DBUILTIN_MMUS"
+	cd a68_dir; $(MAKE) -f ../Makefile test
+
+a88_build:	$(OBJROOT)/a88_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd a88_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.	\
+		SRCROOT=.. TARGET_OBJS="$(OBJS_m88k)" DEP_DIR=a88_dir	\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
+		COPTS="-DM88K -Dm88110" RCFLAGS=$(RCFLAGS);		\
+	else								\
+	    cd $(OBJROOT)/a88_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
+		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/a88_dir		\
+		SYMROOT=$(SYMROOT)/a88_dir SRCROOT=$(SRCROOT)		\
+		TARGET_OBJS="$(OBJS_m88k)" COPTS="-DM88K -Dm88110"	\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=a88_dir;		\
+	fi
+
+a88_test: a88_dir
+	cd a88_dir; $(MAKE) -f ../Makefile m88k-check VPATH=.. OFILE_DIR=. \
+		SRCROOT=.. COPTS="-DM88K -Dm88110"
+	cd a88_dir; $(MAKE) -f ../Makefile test
+
+a386_build:	$(OBJROOT)/a386_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd a386_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.	\
+		SRCROOT=.. TARGET_OBJS="$(OBJS_i386)" DEP_DIR=a386_dir	\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
+		COPTS="-DI386 -Di486 -Di586 -Di686"			\
+		RC_CFLAGS="$(RC_CFLAGS)";				\
+	else								\
+	    cd $(OBJROOT)/a386_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
+		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/a386_dir		\
+		SYMROOT=$(SYMROOT)/a386_dir SRCROOT=$(SRCROOT)		\
+		TARGET_OBJS="$(OBJS_i386)"				\
+		COPTS="-DI386 -Di486 -Di586 -Di686"			\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)"  DEP_DIR=a386_dir;		\
+	fi
+
+a386_test: a386_dir
+	cd a386_dir; $(MAKE) -f ../Makefile i386-check VPATH=.. OFILE_DIR=. \
+		SRCROOT=.. COPTS="-DI386 -Di486 -Di586 -Di686"
+	cd a386_dir; $(MAKE) -f ../Makefile test
+
+
+ax86_64_build:	$(OBJROOT)/ax86_64_dir
+	@if [ $(SRCROOT) = . ];						\
+ 	then								\
+ 	    cd ax86_64_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=. \
+ 		SRCROOT=.. TARGET_OBJS="$(OBJS_i386)" DEP_DIR=ax86_64_dir \
+ 		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
+ 		COPTS="-DI386 -Di486 -Di586 -Di686 -DARCH64"		\
+ 		RC_CFLAGS="$(RC_CFLAGS)" LIBSTUFF="-lstuff";		\
+ 	else								\
+ 	    cd $(OBJROOT)/ax86_64_dir; $(MAKE) -f $(SRCROOT)/Makefile as \
+ 		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/ax86_64_dir	\
+ 		SYMROOT=$(SYMROOT)/ax86_64_dir SRCROOT=$(SRCROOT)	\
+ 		TARGET_OBJS="$(OBJS_i386)" LIBSTUFF="-lstuff"		\
+ 		COPTS="-DI386 -Di486 -Di586 -Di686 -DARCH64"		\
+ 		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+ 		RC_CFLAGS="$(RC_CFLAGS)"  DEP_DIR=ax86_64_dir;		\
+ 	fi
+ 
+ax86_64_test: ax86_64_dir
+	cd ax86_64_dir; $(MAKE) -f ../Makefile x86_64-check VPATH=.. \
+	    OFILE_DIR=. SRCROOT=.. COPTS="-DI386 -Di486 -Di586 -Di686 -DARCH64"
+	cd ax86_64_dir; $(MAKE) -f ../Makefile test
+
+a860_build:	$(OBJROOT)/a860_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd a860_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.	\
+		SRCROOT=.. TARGET_OBJS="$(OBJS_i860)" DEP_DIR=a860_dir	\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
+		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-DI860";		\
+	else								\
+	    cd $(OBJROOT)/a860_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
+		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/a860_dir		\
+		SYMROOT=$(SYMROOT)/a860_dir SRCROOT=$(SRCROOT)		\
+		TARGET_OBJS="$(OBJS_i860)" COPTS="-DI860"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)"  DEP_DIR=a860_dir;		\
+	fi
+
+a860_test: a860_dir
+	cd a860_dir; $(MAKE) -f ../Makefile i860-check VPATH=.. OFILE_DIR=. \
+		SRCROOT=.. COPTS="-DI860"
+	cd a860_dir; $(MAKE) -f ../Makefile test ASFLAGS=-W
+
+appc_build:	$(OBJROOT)/appc_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd appc_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.	\
+		SRCROOT=.. TARGET_OBJS="$(OBJS_ppc)" DEP_DIR=appc_dir	\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG) \
+		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-DPPC";			\
+	else								\
+	    cd $(OBJROOT)/appc_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
+		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/appc_dir		\
+		SYMROOT=$(SYMROOT)/appc_dir SRCROOT=$(SRCROOT)		\
+		TARGET_OBJS="$(OBJS_ppc)" COPTS="-DPPC"			\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=appc_dir;		\
+	fi
+
+appc64_build:	$(OBJROOT)/appc64_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd appc64_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=. \
+		SRCROOT=.. TARGET_OBJS="$(OBJS_ppc)" DEP_DIR=appc64_dir	\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" OFLAG=$(OFLAG)			\
+		COPTS="-DPPC -DARCH64" LIBSTUFF="-lstuff";		\
+	else								\
+	    cd $(OBJROOT)/appc64_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
+		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/appc64_dir	\
+		SYMROOT=$(SYMROOT)/appc64_dir SRCROOT=$(SRCROOT)	\
+		TARGET_OBJS="$(OBJS_ppc)" COPTS="-DPPC -DARCH64"	\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=appc64_dir		\
+		LIBSTUFF="-lstuff";					\
+	fi
+
+appc_test: appc_dir
+	cd appc_dir; $(MAKE) -f ../Makefile ppc-check VPATH=.. OFILE_DIR=. \
+		SRCROOT=.. COPTS="-DPPC"
+	cd appc_dir; $(MAKE) -f ../Makefile test
+
+ahppa_build:	$(OBJROOT)/ahppa_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd ahppa_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.\
+		SRCROOT=.. TARGET_OBJS="$(OBJS_hppa)" DEP_DIR=ahppa_dir	\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
+		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-DHPPA";		\
+	else								\
+	    cd $(OBJROOT)/ahppa_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
+		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/ahppa_dir		\
+		SYMROOT=$(SYMROOT)/ahppa_dir SRCROOT=$(SRCROOT)		\
+		TARGET_OBJS="$(OBJS_hppa)" COPTS="-DHPPA"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=ahppa_dir;		\
+	fi
+
+ahppa_test: ahppa_dir
+	cd ahppa_dir; $(MAKE) -f ../Makefile hppa-check VPATH=.. OFILE_DIR=. \
+		SRCROOT=.. COPTS="-DHPPA"
+	cd ahppa_dir; $(MAKE) -f ../Makefile test
+
+asparc_build:	$(OBJROOT)/asparc_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd asparc_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=.\
+		SRCROOT=.. TARGET_OBJS="$(OBJS_sparc)" DEP_DIR=asparc_dir\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
+		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-DSPARC";		\
+	else								\
+	    cd $(OBJROOT)/asparc_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
+		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/asparc_dir	\
+		SYMROOT=$(SYMROOT)/asparc_dir SRCROOT=$(SRCROOT)	\
+		TARGET_OBJS="$(OBJS_sparc)" COPTS="-DSPARC"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=asparc_dir;		\
+	fi
+
+asparc_test: asparc_dir
+	cd asparc_dir; $(MAKE) -f ../Makefile sparc-check VPATH=.. \
+		OFILE_DIR=. SRCROOT=.. COPTS="-DSPARC"
+	cd asparc_dir; $(MAKE) -f ../Makefile test
+
+aarm_build:	$(OBJROOT)/aarm_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd aarm_dir; $(MAKE) -f ../Makefile as VPATH=.. OFILE_DIR=. \
+		SRCROOT=.. TARGET_OBJS="$(OBJS_arm)" DEP_DIR=aarm_dir	\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" OFLAG=$(OFLAG)	\
+		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-DARM";			\
+	else								\
+	    cd $(OBJROOT)/aarm_dir; $(MAKE) -f $(SRCROOT)/Makefile as	\
+		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/aarm_dir		\
+		SYMROOT=$(SYMROOT)/aarm_dir SRCROOT=$(SRCROOT)		\
+		TARGET_OBJS="$(OBJS_arm)" COPTS="-DARM"			\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" DEP_DIR=aarm_dir;		\
+	fi
+
+aarm_test: aarm_dir
+	cd aarm_dir; $(MAKE) -f ../Makefile arm-check VPATH=.. \
+		OFILE_DIR=. SRCROOT=.. COPTS="-DARM"
+	cd aarm_dir; $(MAKE) -f ../Makefile test
+
+driver:	driver.o apple_version.o
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/driver \
+		$(OFILE_DIR)/driver.o $(OFILE_DIR)/apple_version.o \
+		$(LIBSTUFF_DIR) $(LIBSTUFF)
+
+as:	$(OBJS) $(TARGET_OBJS)
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(SYMROOT)/as.private.o $(OBJS) $(TARGET_OBJS) \
+		$(LIBSTUFF_DIR) $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/as $(SYMROOT)/as.private.o
+
+m68k-check:
+	$(CC) $(COPTS) $(CFLAGS) -o check ../m68k-check.c
+
+m88k-check:
+	$(CC) $(COPTS) $(CFLAGS) -o check ../m88k-check.c
+
+i386-check:
+	$(CC) $(COPTS) $(CFLAGS) -o check ../i386-check.c
+
+x86_64-check:
+	$(CC) $(COPTS) $(CFLAGS) -DARCH64 -o check ../i386-check.c
+
+i860-check:
+	$(CC) $(COPTS) $(CFLAGS) -o check ../i860-check.c
+
+ppc-check:
+	$(CC) $(COPTS) $(CFLAGS) -o check ../ppc-check.c
+
+hppa-check:
+	$(CC) $(COPTS) $(CFLAGS) -o check ../hppa-check.c
+
+sparc-check:
+	$(CC) $(COPTS) $(CFLAGS) -o check ../sparc-check.c
+
+arm-check:
+	$(CC) $(COPTS) $(CFLAGS) -o check ../arm-check.c
+
+test:
+	./check $(LLVM_MC) > check.s
+	./as -W -force_cpusubtype_ALL $(ASFLAGS) -o check.o check.s
+	otool -X -tV $(LLVM_MC) check.o > check1.s
+	./as -force_cpusubtype_ALL $(ASFLAGS) -o check1.o check1.s
+	otool -X -tV $(LLVM_MC) check1.o > check2.s
+	diff check1.s check2.s > check.out
+	cmp check.o check1.o
+
+apple_version.c:
+	echo "const char apple_version[]= " \"`vers_string $(VERS_STRING_FLAGS) -f cctools`\" ";" > \
+		$(OFILE_DIR)/$@
+
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+.c.o:
+	$(CC) $(COPTS) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o $<
+else
+.c.o:
+	$(CC) $(COPTS) $(CFLAGS) $(RC_CFLAGS) -c -MD \
+		-dependency-file $(OFILE_DIR)/$*.d -o $(OFILE_DIR)/$*.o $<
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+clean shlib_clean:
+	-rm -r -f $(OFILE_DIRS) make.out
+
+installsrc installGASsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+install: all $(RC_OS)_install
+
+macos_install: common_install xcommon_install
+	$(MKDIRS) $(DSTROOT)$(LIBDIR)/i386
+	install -c -s -m 555 $(SYMROOT)/a386_dir/as \
+		$(DSTROOT)$(LIBDIR)/i386/as
+	$(MKDIRS) $(DSTROOT)$(LIBDIR)/x86_64
+	install -c -s -m 555 $(SYMROOT)/ax86_64_dir/as \
+		$(DSTROOT)$(LIBDIR)/x86_64/as
+
+teflon_install: common_install xcommon_install
+	$(MKDIRS) $(DSTROOT)$(LIBDIR)/i386
+	install -c -s -m 555 $(SYMROOT)/a386_dir/as \
+		$(DSTROOT)$(LIBDIR)/i386/as
+
+xcommon_install:
+	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
+	install -c -s -m 555 $(SYMROOT)/driver_dir/driver \
+		$(DSTROOT)$(USRBINDIR)/as	
+	$(MKDIRS) $(DSTROOT)/usr/local/OpenSourceVersions/
+	install -c -s -m 444 $(SRCROOT)/cctools.plist \
+		$(DSTROOT)/usr/local/OpenSourceVersions/cctools.plist
+	$(MKDIRS) $(DSTROOT)/usr/local/OpenSourceLicenses/
+	install -c -s -m 444 $(SRCROOT)/COPYING \
+		$(DSTROOT)/usr/local/OpenSourceLicenses/cctools.txt
+	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/ppc
+	install -c -s -m 555 $(SYMROOT)/appc_dir/as \
+		$(DSTROOT)$(LOCLIBDIR)/ppc/as
+	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/ppc64
+	install -c -s -m 555 $(SYMROOT)/appc64_dir/as \
+		$(DSTROOT)$(LOCLIBDIR)/ppc64/as
+	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/m68k
+	install -c -s -m 555 $(SYMROOT)/a68_dir/as \
+		$(DSTROOT)$(LOCLIBDIR)/m68k/as
+	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/sparc 
+	install -c -s -m 555 $(SYMROOT)/asparc_dir/as \
+		$(DSTROOT)$(LOCLIBDIR)/sparc/as
+	$(MKDIRS) $(DSTROOT)$(LIBDIR)/arm
+	install -c -s -m 555 $(SYMROOT)/aarm_dir/as \
+		$(DSTROOT)$(LIBDIR)/arm/as
+
+nextstep_install: common_install
+	$(MKDIRS) $(DSTROOT)$(BINDIR)
+	install -c -s -m 555 $(SYMROOT)/driver_dir/driver \
+		$(DSTROOT)$(BINDIR)/as	
+	$(MKDIRS) $(DSTROOT)$(LIBDIR)/m68k
+	install -c -s -m 555 $(SYMROOT)/a68_dir/as \
+		$(DSTROOT)$(LIBDIR)/m68k/as
+	$(MKDIRS) $(DSTROOT)$(LIBDIR)/i386
+	install -c -s -m 555 $(SYMROOT)/a386_dir/as \
+		$(DSTROOT)$(LIBDIR)/i386/as
+	$(MKDIRS) $(DSTROOT)$(LIBDIR)/sparc
+	install -c -s -m 555 $(SYMROOT)/asparc_dir/as \
+		$(DSTROOT)$(LIBDIR)/sparc/as
+	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/ppc
+	install -c -s -m 555 $(SYMROOT)/appc_dir/as \
+		$(DSTROOT)$(LOCLIBDIR)/ppc/as
+
+common_install:
+	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/m88k
+	install -c -s -m 555 $(SYMROOT)/a88_dir/as \
+		$(DSTROOT)$(LOCLIBDIR)/m88k/as
+	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/hppa
+	install -c -s -m 555 $(SYMROOT)/ahppa_dir/as \
+		$(DSTROOT)$(LOCLIBDIR)/hppa/as
+	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)/i860
+	install -s -m 555 $(SYMROOT)/a860_dir/as \
+		$(DSTROOT)$(LOCLIBDIR)/i860/as
+
+$(OFILE_DIRS) $(SYM_DIRS):
+	$(MKDIRS) $@
+
+-include $(DEP_DIR)/Makedep
diff -urN cctools-806-old/as/Makefile.arch.in cctools-806/as/Makefile.arch.in
--- cctools-806-old/as/Makefile.arch.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/Makefile.arch.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,68 @@
+builddir = @builddir@
+top_builddir = @top_builddir@
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+
+prefix	= @prefix@
+exec_prefix	= @exec_prefix@
+libexecdir	= @libexecdir@
+
+VPATH = @srcdir@:@srcdir@/..
+
+CC              = @CC@
+WARNINGS	= @WARNINGS@
+CFLAGS          = @CFLAGS@
+MDYNAMICNOPIC   = @MDYNAMICNOPIC@
+CPPFLAGS        = @CPPFLAGS@
+DEFS            = @DEFS@ @ENDIAN_FLAG@
+LDFLAGS         = @LDFLAGS@
+HAVE_PRIVEXT    = @HAVE_PRIVEXT@
+HAVE_FOREIGN_HEADERS    = @HAVE_FOREIGN_HEADERS@
+
+ifeq ($(HAVE_PRIVEXT),NO)
+INCPRIVEXT      = -include $(top_srcdir)/include/extern.h
+endif
+
+ifeq ($(HAVE_FOREIGN_HEADERS),YES)
+FORHDRS         = -I$(top_srcdir)/include/foreign
+endif
+
+INSTALL		= @INSTALL@
+INSTALL_PROGRAM	= @INSTALL_PROGRAM@
+
+MYINCLUDES      = -I$(builddir) -I$(srcdir)/.. -I$(top_builddir)/include \
+			-I$(top_srcdir)/include $(INCPRIVEXT) $(FORHDRS)
+MYWARNINGS      =
+MYDEFS          = -DNeXT_MOD $(MYDEFS_$(ARCH))
+MYLDFLAGS	= -L$(top_builddir)/libstuff
+MYLIBS		= $(MYLIBS_$(ARCH))
+
+MYCOMPILEFLAGS  = $(WARNINGS) $(MYWARNINGS) $(DEFS) $(MYDEFS) \
+	$(CPPFLAGS) $(MYINCLUDES) $(CFLAGS) $(MDYNAMICNOPIC) 
+
+MYLINKFLAGS	= $(LDFLAGS) $(MYLDFLAGS) $(MYLIBS)
+
+CFILES = app.c as.c atof-generic.c atof-ieee.c expr.c fixes.c flonum-const.c \
+         flonum-copy.c flonum-mult.c frags.c hash.c hex-value.c input-file.c \
+         input-scrub.c layout.c messages.c obstack.c read.c sections.c \
+         symbols.c write_object.c xmalloc.c dwarf2dbg.c $(CFILES_$(ARCH))
+
+OBJS = $(CFILES:.c=.o) 
+
+%.o:	%.c
+	$(CC) $(MYCOMPILEFLAGS) -c -o $@ $<
+
+.PHONY: default clean distclean install
+
+default: as
+
+as: $(OBJS)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+
+install: as
+	mkdir -p $(DESTDIR)$(libexecdir)/gcc/darwin/$(ARCH)
+	$(INSTALL_PROGRAM) as $(DESTDIR)$(libexecdir)/gcc/darwin/$(ARCH)/as
+
+clean::
+	rm -r -f *.o
+	rm -f as
diff -urN cctools-806-old/as/Makefile.in cctools-806/as/Makefile.in
--- cctools-806-old/as/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,81 @@
+builddir = @builddir@
+top_builddir = @top_builddir@
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+
+prefix	= @prefix@
+exec_prefix	= @exec_prefix@
+libexecdir	= @libexecdir@
+bindir		= @bindir@
+
+VPATH = @srcdir@
+
+CC              = @CC@
+CFLAGS          = @CFLAGS@
+WARNINGS	= @WARNINGS@
+MDYNAMICNOPIC   = @MDYNAMICNOPIC@
+CPPFLAGS        = @CPPFLAGS@
+DEFS            = @DEFS@ @ENDIAN_FLAG@
+LDFLAGS         = @LDFLAGS@
+HAVE_PRIVEXT    = @HAVE_PRIVEXT@
+HAVE_FOREIGN_HEADERS    = @HAVE_FOREIGN_HEADERS@
+
+ifeq ($(HAVE_PRIVEXT),NO)
+INCPRIVEXT      = -include $(top_srcdir)/include/extern.h
+endif
+
+ifeq ($(HAVE_FOREIGN_HEADERS),YES)
+FORHDRS         = -I$(top_srcdir)/include/foreign
+endif
+
+INSTALL		= @INSTALL@
+INSTALL_PROGRAM = @INSTALL_PROGRAM@
+transform	= @program_transform_name@
+
+MYINCLUDES      = -I$(srcdir) -I$(top_builddir)/include \
+			-I$(top_srcdir)/include $(INCPRIVEXT) \
+			$(FORHDRS)
+MYWARNINGS      = 
+MYDEFS          = -DNeXT_MOD
+MYLDFLAGS	= -L$(top_builddir)/libstuff
+MYLIBS		= -lstuff
+
+MYCOMPILEFLAGS	= $(WARNINGS) $(MYWARNINGS) $(DEFS) $(MYDEFS) \
+	$(CPPFLAGS) $(MYINCLUDES) $(CFLAGS) $(MDYNAMICNOPIC) 
+
+MYLINKFLAGS	= $(LDFLAGS) $(MYLDFLAGS) $(MYLIBS)
+
+ASTARGETS = @ASTARGETS@
+
+CFILES = driver.c
+OBJS = $(CFILES:.c=.o)
+
+.c.o:
+	$(CC) $(MYCOMPILEFLAGS) -c -o $@ $<
+
+.PHONY: default install clean distclean $(ASTARGETS)
+
+default: driver $(ASTARGETS)
+
+$(ASTARGETS):
+	cd $@ && $(MAKE)
+
+driver: $(OBJS)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+
+install: driver install-arch
+	mkdir -p $(DESTDIR)$(bindir)
+	$(INSTALL_PROGRAM) driver \
+		$(DESTDIR)$(bindir)/`echo as | sed '$(transform)'`
+
+install-arch:
+	for ast in $(ASTARGETS); do				\
+		(cd $${ast} && $(MAKE) install) || exit 1;	\
+	done
+
+clean:
+	rm -r -f *.o
+	rm -f driver
+	for ast in $(ASTARGETS); do			\
+		(cd $${ast} && $(MAKE) $@) || exit 1;	\
+	done
diff -urN cctools-806-old/as/ppc/Makefile.in cctools-806/as/ppc/Makefile.in
--- cctools-806-old/as/ppc/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/ppc/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,5 @@
+ARCH	=	ppc
+
+CFILES_ppc	=	ppc.c
+MYDEFS_ppc	=	-DPPC
+MYLIBS_ppc	=	-lstuff
diff -urN cctools-806-old/as/ppc64/Makefile.in cctools-806/as/ppc64/Makefile.in
--- cctools-806-old/as/ppc64/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/ppc64/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,5 @@
+ARCH	=	ppc64
+
+CFILES_ppc64	=	ppc.c
+MYDEFS_ppc64	=	-DPPC -DARCH64
+MYLIBS_ppc64	=	-lstuff64
diff -urN cctools-806-old/as/torture/arch4t.s cctools-806/as/torture/arch4t.s
--- cctools-806-old/as/torture/arch4t.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/arch4t.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,38 @@
+	.text
+	.align 0
+l:
+	bx	r0
+	bxeq	r1
+
+foo:	
+	ldrh	r3, foo
+	ldrsh	r4, [r5]
+	ldrsb	r4, [r1, r3]
+	ldrsh	r1, [r4, r4]!
+	ldreqsb	r1, [r5, -r3]
+	ldrneh	r2, [r6], r7
+	ldrccsh r2, [r7], +r8
+	ldrsb	r2, [r3, #255]
+	ldrsh	r1, [r4, #-250]
+	ldrsb	r1, [r5, #+240]
+
+	strh	r2, bar
+	strneh	r3, [r3]
+
+	msr	CPSR_f, #2
+	msr	CPSR_c, r3
+	msr	CPSR_x, r4
+	msr	CPSR_s, r5
+	msr	CPSR_f, r6
+	msr	CPSR_all, r7
+	
+	msr	SPSR_f, #4
+	msr	SPSR_c, r8
+	msr	SPSR_x, r9
+	msr	SPSR_s, r10
+	msr	SPSR_f, r11
+	msr	SPSR_all, r12
+bar:
+	@ section padding for a.out's benefit
+	nop
+	nop
diff -urN cctools-806-old/as/torture/archv2.s cctools-806/as/torture/archv2.s
--- cctools-806-old/as/torture/archv2.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/archv2.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,9 @@
+    .text
+    ldc p4,cr12,[r6,#-12]
+    ldccsl p6,cr5,[r0,#32]!
+    stcgel p1,cr0,[r15],#+16
+    ldc   p11,cr0,[r0],{0x21}
+    fldmiax r0, {d0-d15}
+    stc   p11,cr0,[r0],{0x21}
+    fstmiax r0, {d0-d15}
+
diff -urN cctools-806-old/as/torture/archv5e.s cctools-806/as/torture/archv5e.s
--- cctools-806-old/as/torture/archv5e.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/archv5e.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,43 @@
+# el_segundo.s
+#
+# Tests that we generate the right code for v5e instructions.
+	.text
+	.globl main
+	.align	0
+main:
+	smlabbgt r0,r1,r2,r3
+	smlabb r0,r1,r2,r3
+	smlatb r0,r1,r2,r3
+	smlabt r0,r1,r2,r3
+	smlatt r0,r1,r2,r3
+
+	smlawbgt r0,r1,r2,r3
+	smlawb r0,r1,r2,r3
+	smlawt r0,r1,r2,r3
+
+	smlalbbgt r0,r1,r2,r3
+	smlalbb r0,r1,r2,r3
+	smlaltb r0,r1,r2,r3
+	smlalbt r0,r1,r2,r3
+	smlaltt r0,r1,r2,r3
+
+	smulbbgt r0,r1,r2
+	smulbb r0,r1,r2
+	smultb r0,r1,r2
+	smulbt r0,r1,r2
+	smultt r0,r1,r2
+
+	smulwbgt r0,r1,r2
+	smulwb r0,r1,r2
+	smulwt r0,r1,r2
+
+	qaddgt r0,r1,r2
+	qadd r0,r1,r2
+
+	qdadd r0,r1,r2
+	qsub r0,r1,r2
+	qdsub r0,r1,r2
+	qsub r0,r1,r2
+
+	@ padding for a.out's sake
+	nop
diff -urN cctools-806-old/as/torture/archv6.s cctools-806/as/torture/archv6.s
--- cctools-806-old/as/torture/archv6.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/archv6.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,216 @@
+.text
+.align 0
+
+label:
+	cps #15
+	cpsid if
+	cpsie if
+	ldrex r2, [r4]
+	ldrexne r4, [r8]
+	mcrr2 p0, 12, r7, r5, c3
+	mrrc2 p0, 12, r7, r5, c3
+	pkhbt	r2, r5, r8
+	pkhbt	r2, r5, r8, LSL #3
+	pkhbtal	r2, r5, r8, LSL #3
+	pkhbteq	r2, r5, r8, LSL #3	
+	pkhtb	r2, r5, r8	@ Equivalent to pkhbt r2, r8, r5.
+	pkhtb	r2, r5, r8, ASR #3
+	pkhtbal	r2, r5, r8, ASR #3
+	pkhtbeq	r2, r5, r8, ASR #3
+	qadd16	r2, r4, r7
+	qadd16ne r2, r4, r7	
+	qadd8	r2, r4, r7
+	qadd8ne r2, r4, r7
+	qaddsubx	r2, r4, r7
+	qaddsubxne	r2, r4, r7
+	qsub16	 r2, r4, r7
+	qsub16ne r2, r4, r7
+	qsub8	 r2, r4, r7
+	qsub8ne r2, r4, r7
+	qsubaddx	 r2, r4, r7
+	qsubaddx r2, r4, r7
+	rev	r2, r4
+	rev16	r2, r4
+	rev16ne   r3, r5
+	revne   r3, r5
+	revsh	r2, r4
+	revshne   r3, r5
+	rfeda	r2
+	rfedb	r2!
+	rfeea	r2
+	rfeed	r2!
+	rfefa	r2!
+	rfefd	r2
+	rfeia	r2
+	rfeib	r2!
+	sadd16	 r2, r4, r7
+	sadd16ne r2, r4, r7
+	sxtah r2, r4, r5
+	sxtah r2, r4, r5, ROR #8
+	sxtahne r2, r4, r5
+	sxtahne r2, r4, r5, ROR #8
+	sadd8	 r2, r4, r7
+	sadd8ne r2, r4, r7
+	sxtab16 r2, r4, r5
+	sxtab16 r2, r4, r5, ROR #8
+	sxtab16ne r2, r4, r5
+	sxtab16ne r2, r4, r5, ROR #8
+	sxtab r2, r4, r5
+	sxtab r2, r4, r5, ROR #8
+	sxtabne r2, r4, r5
+	sxtabne r2, r4, r5, ROR #8
+	saddsubx	 r2, r4, r7
+	saddsubxne r2, r4, r7
+	sel r1, r2, r3
+	selne r1, r2, r3
+	setend be
+	setend le
+	shadd16	 r2, r4, r7
+	shadd16ne r2, r4, r7
+	shadd8	 r2, r4, r7
+	shadd8ne r2, r4, r7
+	shaddsubx	 r2, r4, r7
+	shaddsubxne r2, r4, r7
+	shsub16	 r2, r4, r7
+	shsub16ne r2, r4, r7
+	shsub8	 r2, r4, r7
+	shsub8ne r2, r4, r7
+	shsubaddx	 r2, r4, r7
+	shsubaddxne r2, r4, r7
+	smlad r1,r2,r3,r4
+	smladle r1,r2,r3,r4
+	smladx r1,r2,r3,r4
+	smladxle r1,r2,r3,r4
+	smlald r1,r2,r3,r4
+	smlaldle r1,r2,r3,r4
+	smlaldx r1,r2,r3,r4
+	smlaldxle r1,r2,r3,r4
+	smlsd r1,r2,r3,r4
+	smlsdle r1,r2,r3,r4
+	smlsdx r1,r2,r3,r4
+	smlsdxle r1,r2,r3,r4	
+	smlsld r1,r2,r3,r4	
+	smlsldle r1,r2,r3,r4
+	smlsldx r1,r2,r3,r4
+	smlsldxle r1,r2,r3,r4	
+	smmla r1,r2,r3,r4	
+	smmlale r1,r2,r3,r4
+	smmlar r1,r2,r3,r4
+	smmlarle r1,r2,r3,r4	
+	smmls r1,r2,r3,r4	
+	smmlsle r1,r2,r3,r4
+	smmlsr r1,r2,r3,r4
+	smmlsrle r1,r2,r3,r4	
+	smmul r1,r2,r3
+	smmulle r1,r2,r3
+	smmulr r1,r2,r3
+	smmulrle r1,r2,r3
+	smuad r1,r2,r3
+	smuadle r1,r2,r3
+	smuadx r1,r2,r3
+	smuadxle r1,r2,r3
+	smusd r1,r2,r3
+	smusdle r1,r2,r3
+	smusdx r1,r2,r3
+	smusdxle r1,r2,r3
+	srsia #16
+	srsib #16!
+	ssat r1, #1, r2
+	ssat r1, #1, r2, ASR #2
+	ssat r1, #1, r2, LSL #2
+	ssat16 r1, #1, r1
+	ssat16le r1, #1, r1
+	ssub16	 r2, r4, r7
+	ssub16ne r2, r4, r7
+	ssub8	 r2, r4, r7
+	ssub8ne r2, r4, r7
+	ssubaddx	 r2, r4, r7
+	ssubaddxne r2, r4, r7
+	strex r1, r2, [r3]
+	strexne r1, r2, [r3]
+	sxth r2, r5
+	sxth r2, r5, ROR #8
+	sxthne r2, r5
+	sxthne r2, r5, ROR #8
+	sxtb16 r2, r5
+	sxtb16 r2, r5, ROR #8
+	sxtb16ne r2, r5
+	sxtb16ne r2, r5, ROR #8
+	sxtb r2, r5
+	sxtb r2, r5, ROR #8
+	sxtbne r2, r5
+	sxtbne r2, r5, ROR #8
+	uadd16	 r2, r4, r7
+	uadd16ne r2, r4, r7
+	uxtah r2, r3, r5
+	uxtah r2, r3, r5, ROR #8
+	uxtahne r2, r3, r5
+	uxtahne r2, r3, r5, ROR #8
+	uadd8	 r2, r4, r7
+	uadd8ne r2, r4, r7
+	uxtab16 r2, r3, r5
+	uxtab16 r2, r3, r5, ROR #8
+	uxtab16ne r2, r3, r5
+	uxtab16ne r2, r3, r5, ROR #8
+	uxtab r2, r3, r5
+	uxtab r2, r3, r5, ROR #8
+	uxtabne r2, r3, r5
+	uxtabne r2, r3, r5, ROR #8
+	uaddsubx	 r2, r4, r7
+	uaddsubxne r2, r4, r7
+	uhadd16	 r2, r4, r7
+	uhadd16ne r2, r4, r7
+	uhadd8	 r2, r4, r7
+	uhadd8ne r2, r4, r7
+	uhaddsubx	 r2, r4, r7
+	uhaddsubxne r2, r4, r7
+	uhsub16	 r2, r4, r7
+	uhsub16ne r2, r4, r7
+	uhsub8	 r2, r4, r7
+	uhsub8ne r2, r4, r7
+	uhsubaddx	 r2, r4, r7
+	uhsubaddxne r2, r4, r7
+	umaal	r1, r2, r3, r4
+	umaalle	r1, r2, r3, r4	
+	uqadd16	 r2, r4, r7
+	uqadd16ne r2, r4, r7
+	uqadd8	 r2, r4, r7
+	uqadd8ne r2, r4, r7
+	uqaddsubx	 r2, r4, r7
+	uqaddsubxne r2, r4, r7
+	uqsub16	 r2, r4, r7
+	uqsub16ne r2, r4, r7
+	uqsub8	 r2, r4, r7
+	uqsub8ne r2, r4, r7
+	uqsubaddx	 r2, r4, r7
+	uqsubaddxne r2, r4, r7
+	usad8 r1, r2, r3
+	usad8ne r1, r2, r3
+	usada8 r1, r2, r3, r4
+	usada8ne r1, r2, r3, r4
+	usat r1, #15, r2
+	usat r1, #15, r2, ASR #4
+	usat r1, #15, r2, LSL #4
+	usat16 r1, #15, r2
+	usat16le r1, #15, r2
+	usatle r1, #15, r2
+	usatle r1, #15, r2, ASR #4
+	usatle r1, #15, r2, LSL #4
+	usub16	 r2, r4, r7
+	usub16ne r2, r4, r7
+	usub8	 r2, r4, r7
+	usub8ne r2, r4, r7
+	usubaddx	 r2, r4, r7
+	usubaddxne r2, r4, r7
+	uxth r2, r5
+	uxth r2, r5, ROR #8
+	uxthne r2, r5
+	uxthne r2, r5, ROR #8
+	uxtb16 r2, r5
+	uxtb16 r2, r5, ROR #8
+	uxtb16ne r2, r5
+	uxtb16ne r2, r5, ROR #8
+	uxtb r2, r5
+	uxtb r2, r5, ROR #8
+	uxtbne r2, r5
+	uxtbne r2, r5, ROR #8
diff -urN cctools-806-old/as/torture/cruft.s cctools-806/as/torture/cruft.s
--- cctools-806-old/as/torture/cruft.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/cruft.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,3 @@
+    movlo   r0, #-1
+    mvnlo   r0, #0
+
diff -urN cctools-806-old/as/torture/expr-operands.s cctools-806/as/torture/expr-operands.s
--- cctools-806-old/as/torture/expr-operands.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/expr-operands.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,7 @@
+    .set PCRELV2, (LJTI30_0_0-(LPCRELL2+8))
+LPCRELL2:
+    add r2, pc, #PCRELV2
+    ldr pc, [r2, +r3, lsl #2]
+LJTI30_0_0:
+    .long    4
+
diff -urN cctools-806-old/as/torture/imm-rotate.s cctools-806/as/torture/imm-rotate.s
--- cctools-806-old/as/torture/imm-rotate.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/imm-rotate.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,2 @@
+    cmp r3, #1, 22 @ 1024
+
diff -urN cctools-806-old/as/torture/inst.s cctools-806/as/torture/inst.s
--- cctools-806-old/as/torture/inst.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/inst.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,225 @@
+@	Test file for ARM/GAS -- basic instructions
+@   From GNU binutils-2.17, copyright (c) 2007 Free Software Foundation.
+@   Distributed under the terms of the GNU General Public License v2.
+
+.text
+.align
+	mov	r0, #0
+	mov	r1, r2
+	mov	r3, r4, lsl #3
+	mov	r5, r6, lsr r7
+	mov	r8, r9, asr r10
+	mov	r11, r12, asl r13
+	mov	r14, r15, rrx
+	moval	a2, a3
+	moveq	a3, a4
+	movne	v1, v2
+	movlt	v3, v4
+	movge	v5, v6
+	movle	v7, v8
+	movgt	ip, sp
+	movcc	r1, r2
+	movcs	r1, r3
+	movmi	r3, r6
+	movpl	wr, sb
+	movvs	r1, r8
+	movvc	SB, r1, lsr #31
+	movhi	r8, pc
+	movls	PC, lr
+	movhs	r9, r8
+	movul	r1, r3
+	movs	r0, r8
+	movuls	r0, WR
+	
+	add	r0, r1, #10
+	add	r2, r3, r4
+	add	r5, r6, r7, asl #5
+	add	r1, r2, r3, lsl r1
+
+	and	r0, r1, #10
+	and	r2, r3, r4
+	and	r5, r6, r7, asl #5
+	and	r1, r2, r3, lsl r1
+
+	eor	r0, r1, #10
+	eor	r2, r3, r4
+	eor	r5, r6, r7, asl #5
+	eor	r1, r2, r3, lsl r1
+
+	sub	r0, r1, #10
+	sub	r2, r3, r4
+	sub	r5, r6, r7, asl #5
+	sub	r1, r2, r3, lsl r1
+
+	adc	r0, r1, #10
+	adc	r2, r3, r4
+	adc	r5, r6, r7, asl #5
+	adc	r1, r2, r3, lsl r1
+
+	sbc	r0, r1, #10
+	sbc	r2, r3, r4
+	sbc	r5, r6, r7, asl #5
+	sbc	r1, r2, r3, lsl r1
+
+	rsb	r0, r1, #10
+	rsb	r2, r3, r4
+	rsb	r5, r6, r7, asl #5
+	rsb	r1, r2, r3, lsl r1
+
+	rsc	r0, r1, #10
+	rsc	r2, r3, r4
+	rsc	r5, r6, r7, asl #5
+	rsc	r1, r2, r3, lsl r1
+
+	orr	r0, r1, #10
+	orr	r2, r3, r4
+	orr	r5, r6, r7, asl #5
+	orr	r1, r2, r3, lsl r1
+
+	bic	r0, r1, #10
+	bic	r2, r3, r4
+	bic	r5, r6, r7, asl #5
+	bic	r1, r2, r3, lsl r1
+
+	mvn	r0, #10
+	mvn	r2, r4
+	mvn	r5, r7, asl #5
+	mvn	r1, r3, lsl r1
+
+	tst	r0, #10
+	tst	r2, r4
+	tst	r5, r7, asl #5
+	tst	r1, r3, lsl r1
+
+	teq	r0, #10
+	teq	r2, r4
+	teq	r5, r7, asl #5
+	teq	r1, r3, lsl r1
+
+	cmp	r0, #10
+	cmp	r2, r4
+	cmp	r5, r7, asl #5
+	cmp	r1, r3, lsl r1
+
+	cmn	r0, #10
+	cmn	r2, r4
+	cmn	r5, r7, asl #5
+	cmn	r1, r3, lsl r1
+
+	teqp	r0, #10
+	teqp	r2, r4
+	teqp	r5, r7, asl #5
+	teqp	r1, r3, lsl r1
+
+	cmnp	r0, #10
+	cmnp	r2, r4
+	cmnp	r5, r7, asl #5
+	cmnp	r1, r3, lsl r1
+
+	cmpp	r0, #10
+	cmpp	r2, r4
+	cmpp	r5, r7, asl #5
+	cmpp	r1, r3, lsl r1
+
+	tstp	r0, #10
+	tstp	r2, r4
+	tstp	r5, r7, asl #5
+	tstp	r1, r3, lsl r1
+
+	mul	r0, r1, r2
+	muls	r1, r2, r3
+	mulne	r0, r1, r0
+	mullss	r9, r8, r7
+
+	mla	r1, r9, sl, fp
+	mlas	r3, r4, r9, IP
+	mlalt	r9, r8, r7, SP
+	mlages	r4, r1, r3, LR
+
+	ldr	r0, [r1]
+	ldr	r1, [r1, r2]
+	ldr	r2, [r3, r4]!
+	ldr	r2, [r2, #32]
+	ldr	r2, [r3, r4, lsr #8]
+	ldreq	r4, [r5, r4, asl #9]!
+	ldrne	r4, [r5], #6
+	ldrt	r1, [r2], r3
+	ldr	r2, [r4], r5, lsr #8
+foo:
+	ldr	r0, foo
+	ldrb	r3, [r4]
+	ldrnebt	r5, [r8]
+	
+	str	r0, [r1]
+	str	r1, [r1, r2]
+	str	r3, [r4, r3]!
+	str	r2, [r2, #32]
+	str	r2, [r3, r4, lsr #8]
+	streq	r4, [r5, r4, asl #9]!
+	strne	r4, [r5], #6
+	str	r1, [r2], r3
+	strt	r2, [r4], r5, lsr #8
+	str	r1, bar
+bar:
+	stralb	r1, [r7]
+	strbt	r2, [r0]
+
+	ldmia	r0, {r1}
+	ldmeqib	r2, {r3, r4, r5}
+	ldmalda	r3, {r0-r15}^
+	ldmdb	FP!, {r0-r8, SL}
+	ldmed	r1, {r0, r1, r2}|0xf0
+	ldmfd	r2, {r3, r4}+{r5, r6, r7, r8}
+	ldmea	r3, 3
+	ldmfa	r4, {r8, r9}^
+	
+	stmia	r0, {r1}
+	stmeqib	r2, {r3, r4, r5}
+	stmalda	r3, {r0-r15}^
+	stmdb	r11!, {r0-r8, r10}
+	stmed	r1, {r0, r1, r2}
+	stmfd	r2, {r3, r4}
+	stmea	r3, 3
+	stmfa	r4, {r8, r9}^
+
+	swi	0x123456
+	swihs	0x33
+
+	bl	_wombat
+	blpl	hohum
+	b	_wibble
+	ble	testerfunc
+
+	mov r1, r2, lsl #2
+	mov r1, r2, lsl #0 
+	mov r1, r2, lsl #31
+	mov r1, r2, lsl r3
+	mov r1, r2, lsr #2
+	mov r1, r2, lsr #31
+	mov r1, r2, lsr #32
+	mov r1, r2, lsr r3
+	mov r1, r2, asr #2
+	mov r1, r2, asr #31
+	mov r1, r2, asr #32
+	mov r1, r2, asr r3
+	mov r1, r2, ror #2
+	mov r1, r2, ror #31
+	mov r1, r2, ror r3
+	mov r1, r2, rrx
+	mov r1, r2, LSL #2
+	mov r1, r2, LSL #0 
+	mov r1, r2, LSL #31
+	mov r1, r2, LSL r3
+	mov r1, r2, LSR #2
+	mov r1, r2, LSR #31
+	mov r1, r2, LSR #32
+	mov r1, r2, LSR r3
+	mov r1, r2, ASR #2
+	mov r1, r2, ASR #31
+	mov r1, r2, ASR #32
+	mov r1, r2, ASR r3
+	mov r1, r2, ROR #2
+	mov r1, r2, ROR #31
+	mov r1, r2, ROR r3
+	mov r1, r2, RRX
+	
diff -urN cctools-806-old/as/torture/libunwind-additions.s cctools-806/as/torture/libunwind-additions.s
--- cctools-806-old/as/torture/libunwind-additions.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/libunwind-additions.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,5 @@
+.global foo
+    foo:    ldc p11,cr0,[r0],{0x21}
+.globl bar
+    bar:    stc p11,cr0,[r0],{0x21}
+
diff -urN cctools-806-old/as/torture/more-inst.s cctools-806/as/torture/more-inst.s
--- cctools-806-old/as/torture/more-inst.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/more-inst.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+clz r2,r11
+
+msr cpsr_cxsf,#10
+msr cpsr_c,r10
+msr spsr_xfs,#10
+mrs r10,cpsr
+mrs r10,spsr
+
+blx wibble
+wibble:    blxne r1
+
+sub sp, sp, #1, 22
+
+strh r1, [sp, #+118]
+ldrh r1, [sp, #+118]
+
+strh r0, [r1, #25]
+strh r0, [r1, #-25]
+strh r0, [r1, +r2]
+strh r0, [r1, -r2]
+strh r0, [r1, r2]
+strh r0, [r1, #25]!
+strh r0, [r1, +r2]!
+strh r0, [r1], #25
+strh r0, [r1], #-25
+strh r0, [r1], -ip
+strh r0, [r1]
+
+ldrh r0, [r1, #+25]
+ldrh r0, [r1, #-25]
+ldrh r0, [r1, +r2]
+ldrsb r0, [r1, -r2]
+ldrsb r0, [r1, r2]
+ldrsb r0, [r1, #25]!
+ldrsh r0, [r1, +r2]!
+ldrsh r0, [r1], #25
+ldrsh r0, [r1], #-25
+ldrh r0, [r1], -ip
+ldrsb r0, [sp]
+
diff -urN cctools-806-old/as/torture/more-vfp1.s cctools-806/as/torture/more-vfp1.s
--- cctools-806-old/as/torture/more-vfp1.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/more-vfp1.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,7 @@
+
+    @ these should be identical constructions
+    fldd d3, wibble
+wibble: nop
+    ldr r3, wobble
+wobble: nop
+
diff -urN cctools-806-old/as/torture/new-pseudo-ops.s cctools-806/as/torture/new-pseudo-ops.s
--- cctools-806-old/as/torture/new-pseudo-ops.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/new-pseudo-ops.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,81 @@
+    .section    __TEXT,__cstring,cstring_literals
+    .zerofill   __DATA__, __common, .objc_class_name_HelloApplication, 4, 2
+
+@ old-style macro
+.macro foo
+    add r0,r0,$0
+.endm
+
+@ new-style macro with 1 arg
+    .macro bar a
+    add r0,r0,\a
+.endm
+
+@ new-style macro with 5 args
+.macro baz a b c d, e
+    add \a,\c,\d
+.endm
+
+@ new-style macro with 1 arg and default
+.macro boo a=r0
+    add \a,r1,\a
+.endm
+
+@ new-style macro with 5 args and some defaults
+.macro wibble a=r0,b,c=r3 d=r5,e=r9
+    add \a, \d, \c, lsl \e
+    add \a, \d, \c, lsl\e
+.endmacro
+
+.macro wobble a=r0
+.rept 12
+    add \a,\a,#50
+.endr
+.endm
+
+.text
+nop
+nop
+nop
+nop
+
+.ifc "foo","bar"
+bkpt 0
+.else
+mov r12,r0
+.endif
+
+.ifc "foo","foo"
+mov r0,r12
+.else
+bkpt 0
+.endif
+
+.set shifter, 31
+.rept 32
+mov r1,r2,lsl #shifter
+.set shifter, shifter - 1
+.endr
+
+wobble
+
+.rept 5
+add r0,r0,#1
+.endr
+
+wibble r0 r1 r2 r3 r4
+foo r1
+bar r2
+baz e=r1,a=r3,b=r4,d=r5,c=r6
+baz r3,r4,r6, r5,r1
+boo
+boo r4 
+wibble e=r1,a=,b=r4,d=r5,c=r6
+wibble ,r1,,, 
+
+    b 14f
+14: mov r0,#42
+    mov r0,#19
+    mov r4,#30
+    b 14b
+
diff -urN cctools-806-old/as/torture/vfp1d.s cctools-806/as/torture/vfp1d.s
--- cctools-806-old/as/torture/vfp1d.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/vfp1d.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,284 @@
+@ VFP Instructions for D variants (Double precision)
+	.text
+	.globl F
+F:
+	@ First we test the basic syntax and bit patterns of the opcodes.
+	@ Most of these tests deliberatly use d0/r0 to avoid setting
+	@ any more bits than necessary.
+
+	@ Comparison operations
+
+	fcmped	d0, d0
+	fcmpezd	d0
+	fcmpd	d0, d0
+	fcmpzd	d0
+
+	@ Monadic data operations
+
+	fabsd	d0, d0
+	fcpyd	d0, d0
+	fnegd	d0, d0
+	fsqrtd	d0, d0
+
+	@ Dyadic data operations
+
+	faddd	d0, d0, d0
+	fdivd	d0, d0, d0
+	fmacd	d0, d0, d0
+	fmscd	d0, d0, d0
+	fmuld	d0, d0, d0
+	fnmacd	d0, d0, d0
+	fnmscd	d0, d0, d0
+	fnmuld	d0, d0, d0
+	fsubd	d0, d0, d0
+
+	@ Load/store operations
+
+	fldd	d0, [r0]
+	fstd	d0, [r0]
+
+	@ Load/store multiple operations
+
+	fldmiad	r0, {d0}
+	fldmfdd	r0, {d0}
+	fldmiad	r0!, {d0}
+	fldmfdd	r0!, {d0}
+	fldmdbd	r0!, {d0}
+	fldmead	r0!, {d0}
+
+	fstmiad	r0, {d0}
+	fstmead	r0, {d0}
+	fstmiad	r0!, {d0}
+	fstmead	r0!, {d0}
+	fstmdbd	r0!, {d0}
+	fstmfdd	r0!, {d0}
+
+	@ Conversion operations
+
+	fsitod	d0, s0
+	fuitod	d0, s0
+
+	ftosid	s0, d0
+	ftosizd	s0, d0
+	ftouid	s0, d0
+	ftouizd	s0, d0
+
+	fcvtds	d0, s0
+	fcvtsd	s0, d0
+	
+	@ ARM from VFP operations
+
+	fmrdh	r0, d0
+	fmrdl	r0, d0
+
+	@ VFP From ARM operations
+
+	fmdhr	d0, r0
+	fmdlr	d0, r0
+
+	@ Now we test that the register fields are updated correctly for
+	@ each class of instruction.
+
+	@ Single register operations (compare-zero):
+
+	fcmpzd	d1
+	fcmpzd	d2
+	fcmpzd	d15
+
+	@ Two register comparison operations:
+
+	fcmpd	d0, d1
+	fcmpd	d0, d2
+	fcmpd	d0, d15
+	fcmpd	d1, d0
+	fcmpd	d2, d0
+	fcmpd	d15, d0
+	fcmpd	d5, d12
+
+	@ Two register data operations (monadic)
+
+	fnegd	d0, d1
+	fnegd	d0, d2
+	fnegd	d0, d15
+	fnegd	d1, d0
+	fnegd	d2, d0
+	fnegd	d15, d0
+	fnegd	d12, d5
+	
+	@ Three register data operations (dyadic)
+
+	faddd	d0, d0, d1
+	faddd	d0, d0, d2
+	faddd	d0, d0, d15
+	faddd	d0, d1, d0
+	faddd	d0, d2, d0
+	faddd	d0, d15, d0
+	faddd	d1, d0, d0
+	faddd	d2, d0, d0
+	faddd	d15, d0, d0
+	faddd	d12, d9, d5
+
+	@ Conversion operations
+
+	fcvtds	d0, s1
+	fcvtds	d0, s2
+	fcvtds	d0, s31
+	fcvtds	d1, s0
+	fcvtds	d2, s0
+	fcvtds	d15, s0
+	fcvtsd	s1, d0
+	fcvtsd	s2, d0
+	fcvtsd	s31, d0
+	fcvtsd	s0, d1
+	fcvtsd	s0, d2
+	fcvtsd	s0, d15
+
+	@ Move to VFP from ARM
+
+	fmrdh	r1, d0
+	fmrdh	r14, d0
+	fmrdh	r0, d1
+	fmrdh	r0, d2
+	fmrdh	r0, d15
+	fmrdl	r1, d0
+	fmrdl	r14, d0
+	fmrdl	r0, d1
+	fmrdl	r0, d2
+	fmrdl	r0, d15
+
+	@ Move to ARM from VFP
+
+	fmdhr	d0, r1
+	fmdhr	d0, r14
+	fmdhr	d1, r0
+	fmdhr	d2, r0
+	fmdhr	d15, r0
+	fmdlr	d0, r1
+	fmdlr	d0, r14
+	fmdlr	d1, r0
+	fmdlr	d2, r0
+	fmdlr	d15, r0
+
+	@ Load/store operations
+
+	fldd	d0, [r1]
+	fldd	d0, [r14]
+	fldd	d0, [r0, #0]
+	fldd	d0, [r0, #1020]
+	fldd	d0, [r0, #-1020]
+	fldd	d1, [r0]
+	fldd	d2, [r0]
+	fldd	d15, [r0]
+	fstd	d12, [r12, #804]
+
+	@ Load/store multiple operations
+
+	fldmiad	r0, {d1}
+	fldmiad	r0, {d2}
+	fldmiad	r0, {d15}
+	fldmiad	r0, {d0-d1}
+	fldmiad	r0, {d0-d2}
+	fldmiad	r0, {d0-d15}
+	fldmiad	r0, {d1-d15}
+	fldmiad	r0, {d2-d15}
+	fldmiad	r0, {d14-d15}
+	fldmiad	r1, {d0}
+	fldmiad	r14, {d0}
+
+	@ Check that we assemble all the register names correctly
+
+	fcmpzd	d0
+	fcmpzd	d1
+	fcmpzd	d2
+	fcmpzd	d3
+	fcmpzd	d4
+	fcmpzd	d5
+	fcmpzd	d6
+	fcmpzd	d7
+	fcmpzd	d8
+	fcmpzd	d9
+	fcmpzd	d10
+	fcmpzd	d11
+	fcmpzd	d12
+	fcmpzd	d13
+	fcmpzd	d14
+	fcmpzd	d15
+
+	@ Now we check the placement of the conditional execution substring.
+	@ On VFP this is always at the end of the instruction.
+	
+	@ Comparison operations
+
+	fcmpedeq	d1, d15
+	fcmpezdeq	d2
+	fcmpdeq	d3, d14
+	fcmpzdeq	d4
+
+	@ Monadic data operations
+
+	fabsdeq	d5, d13
+	fcpydeq	d6, d12
+	fnegdeq	d7, d11
+	fsqrtdeq	d8, d10
+
+	@ Dyadic data operations
+
+	fadddeq	d9, d1, d15
+	fdivdeq	d2, d3, d14
+	fmacdeq	d4, d13, d12
+	fmscdeq	d5, d6, d11
+	fmuldeq	d7, d10, d9
+	fnmacdeq	d8, d9, d10
+	fnmscdeq	d7, d6, d11
+	fnmuldeq	d5, d4, d12
+	fsubdeq	d3, d13, d14
+
+	@ Load/store operations
+
+	flddeq	d2, [r5]
+	fstdeq	d1, [r12]
+
+	@ Load/store multiple operations
+
+	fldmiadeq	r1, {d1}
+	fldmfddeq	r2, {d2}
+	fldmiadeq	r3!, {d3}
+	fldmfddeq	r4!, {d4}
+	fldmdbdeq	r5!, {d5}
+	fldmeadeq	r6!, {d6}
+
+	fstmiadeq	r7, {d15}
+	fstmeadeq	r8, {d14}
+	fstmiadeq	r9!, {d13}
+	fstmeadeq	r10!, {d12}
+	fstmdbdeq	r11!, {d11}
+	fstmfddeq	r12!, {d10}
+
+	@ Conversion operations
+
+	fsitodeq	d15, s1
+	fuitodeq	d1, s31
+
+	ftosideq	s1, d15
+	ftosizdeq	s31, d2
+	ftouideq	s15, d2
+	ftouizdeq	s11, d3
+
+	fcvtdseq	d1, s10
+	fcvtsdeq	s11, d1
+	
+	@ ARM from VFP operations
+
+	fmrdheq	r8, d1
+	fmrdleq	r7, d15
+
+	@ VFP From ARM operations
+
+	fmdhreq	d1, r15
+	fmdlreq	d15, r1
+
+	# Add three nop instructions to ensure that the
+	# output is 32-byte aligned as required for arm-aout.
+	nop
+	nop
+	nop
diff -urN cctools-806-old/as/torture/vfp1s.s cctools-806/as/torture/vfp1s.s
--- cctools-806-old/as/torture/vfp1s.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/vfp1s.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,339 @@
+@ VFP Instructions for v1xD variants (Single precision only)
+	.text
+	.globl F
+F:
+	@ First we test the basic syntax and bit patterns of the opcodes.
+	@ Most of these tests deliberatly use s0/r0 to avoid setting
+	@ any more bits than necessary.
+
+	@ Comparison operations
+
+	fmstat
+
+	fcmpes	s0, s0
+	fcmpezs	s0
+	fcmps	s0, s0
+	fcmpzs	s0
+
+	@ Monadic data operations
+
+	fabss	s0, s0
+	fcpys	s0, s0
+	fnegs	s0, s0
+	fsqrts	s0, s0
+
+	@ Dyadic data operations
+
+	fadds	s0, s0, s0
+	fdivs	s0, s0, s0
+	fmacs	s0, s0, s0
+	fmscs	s0, s0, s0
+	fmuls	s0, s0, s0
+	fnmacs	s0, s0, s0
+	fnmscs	s0, s0, s0
+	fnmuls	s0, s0, s0
+	fsubs	s0, s0, s0
+
+	@ Load/store operations
+
+	flds	s0, [r0]
+	fsts	s0, [r0]
+
+	@ Load/store multiple operations
+
+	fldmias	r0, {s0}
+	fldmfds	r0, {s0}
+	fldmias	r0!, {s0}
+	fldmfds	r0!, {s0}
+	fldmdbs	r0!, {s0}
+	fldmeas	r0!, {s0}
+
+	fldmiax	r0, {d0}
+	fldmfdx	r0, {d0}
+	fldmiax	r0!, {d0}
+	fldmfdx	r0!, {d0}
+	fldmdbx	r0!, {d0}
+	fldmeax	r0!, {d0}
+
+	fstmias	r0, {s0}
+	fstmeas	r0, {s0}
+	fstmias	r0!, {s0}
+	fstmeas	r0!, {s0}
+	fstmdbs	r0!, {s0}
+	fstmfds	r0!, {s0}
+
+	fstmiax	r0, {d0}
+	fstmeax	r0, {d0}
+	fstmiax	r0!, {d0}
+	fstmeax	r0!, {d0}
+	fstmdbx	r0!, {d0}
+	fstmfdx	r0!, {d0}
+
+	@ Conversion operations
+
+	fsitos	s0, s0
+	fuitos	s0, s0
+
+	ftosis	s0, s0
+	ftosizs	s0, s0
+	ftouis	s0, s0
+	ftouizs	s0, s0
+
+	@ ARM from VFP operations
+
+	fmrs	r0, s0
+	fmrx	r0, fpsid
+	fmrx	r0, fpscr
+	fmrx	r0, fpexc
+
+	@ VFP From ARM operations
+
+	fmsr	s0, r0
+	fmxr	fpsid, r0
+	fmxr	fpscr, r0
+	fmxr	fpexc, r0
+
+	@ Now we test that the register fields are updated correctly for
+	@ each class of instruction.
+
+	@ Single register operations (compare-zero):
+
+	fcmpzs	s1
+	fcmpzs	s2
+	fcmpzs	s31
+
+	@ Two register comparison operations:
+
+	fcmps	s0, s1
+	fcmps	s0, s2
+	fcmps	s0, s31
+	fcmps	s1, s0
+	fcmps	s2, s0
+	fcmps	s31, s0
+	fcmps	s21, s12
+
+	@ Two register data operations (monadic)
+
+	fnegs	s0, s1
+	fnegs	s0, s2
+	fnegs	s0, s31
+	fnegs	s1, s0
+	fnegs	s2, s0
+	fnegs	s31, s0
+	fnegs	s12, s21
+	
+	@ Three register data operations (dyadic)
+
+	fadds	s0, s0, s1
+	fadds	s0, s0, s2
+	fadds	s0, s0, s31
+	fadds	s0, s1, s0
+	fadds	s0, s2, s0
+	fadds	s0, s31, s0
+	fadds	s1, s0, s0
+	fadds	s2, s0, s0
+	fadds	s31, s0, s0
+	fadds	s12, s21, s5
+
+	@ Conversion operations
+
+	fsitos	s0, s1
+	fsitos	s0, s2
+	fsitos	s0, s31
+	fsitos	s1, s0
+	fsitos	s2, s0
+	fsitos	s31, s0
+
+	ftosis	s0, s1
+	ftosis	s0, s2
+	ftosis	s0, s31
+	ftosis	s1, s0
+	ftosis	s2, s0
+	ftosis	s31, s0
+
+	@ Move to VFP from ARM
+
+	fmsr	s0, r1
+	fmsr	s0, r7
+	fmsr	s0, r14
+	fmsr	s1, r0
+	fmsr	s2, r0
+	fmsr	s31, r0
+	fmsr	s21, r7
+
+	fmxr	fpsid, r1
+	fmxr	fpsid, r14
+
+	@ Move to ARM from VFP
+
+	fmrs	r0, s1
+	fmrs	r0, s2
+	fmrs	r0, s31
+	fmrs	r1, s0
+	fmrs	r7, s0
+	fmrs	r14, s0
+	fmrs	r9, s11
+
+	fmrx	r1, fpsid
+	fmrx	r14, fpsid
+
+	@ Load/store operations
+
+	flds	s0, [r1]
+	flds	s0, [r14]
+	flds	s0, [r0, #0]
+	flds	s0, [r0, #1020]
+	flds	s0, [r0, #-1020]
+	flds	s1, [r0]
+	flds	s2, [r0]
+	flds	s31, [r0]
+	fsts	s21, [r12, #804]
+
+	@ Load/store multiple operations
+
+	fldmias	r0, {s1}
+	fldmias	r0, {s2}
+	fldmias	r0, {s31}
+	fldmias	r0, {s0-s1}
+	fldmias	r0, {s0-s2}
+	fldmias	r0, {s0-s31}
+	fldmias	r0, {s1-s31}
+	fldmias	r0, {s2-s31}
+	fldmias	r0, {s30-s31}
+	fldmias	r1, {s0}
+	fldmias	r14, {s0}
+
+	fstmiax	r0, {d1}
+	fstmiax	r0, {d2}
+	fstmiax	r0, {d15}
+	fstmiax	r0, {d0-d1}
+	fstmiax	r0, {d0-d2}
+	fstmiax	r0, {d0-d15}
+	fstmiax	r0, {d1-d15}
+	fstmiax	r0, {d2-d15}
+	fstmiax	r0, {d14-d15}
+	fstmiax	r1, {d0}
+	fstmiax	r14, {d0}
+
+	@ Check that we assemble all the register names correctly
+
+	fcmpzs	s0
+	fcmpzs	s1
+	fcmpzs	s2
+	fcmpzs	s3
+	fcmpzs	s4
+	fcmpzs	s5
+	fcmpzs	s6
+	fcmpzs	s7
+	fcmpzs	s8
+	fcmpzs	s9
+	fcmpzs	s10
+	fcmpzs	s11
+	fcmpzs	s12
+	fcmpzs	s13
+	fcmpzs	s14
+	fcmpzs	s15
+	fcmpzs	s16
+	fcmpzs	s17
+	fcmpzs	s18
+	fcmpzs	s19
+	fcmpzs	s20
+	fcmpzs	s21
+	fcmpzs	s22
+	fcmpzs	s23
+	fcmpzs	s24
+	fcmpzs	s25
+	fcmpzs	s26
+	fcmpzs	s27
+	fcmpzs	s28
+	fcmpzs	s29
+	fcmpzs	s30
+	fcmpzs	s31
+
+	@ Now we check the placement of the conditional execution substring.
+	@ On VFP this is always at the end of the instruction.
+	@ We use different register numbers here to check for correct
+	@ disassembly
+	
+	@ Comparison operations
+
+	fmstateq
+
+	fcmpeseq	s3, s7
+	fcmpezseq	s5
+	fcmpseq	s1, s2
+	fcmpzseq	s1
+
+	@ Monadic data operations
+
+	fabsseq	s1, s3
+	fcpyseq	s31, s19
+	fnegseq	s20, s8
+	fsqrtseq	s5, s7
+
+	@ Dyadic data operations
+
+	faddseq	s6, s5, s4
+	fdivseq	s3, s2, s1
+	fmacseq	s31, s30, s29
+	fmscseq	s28, s27, s26
+	fmulseq	s25, s24, s23
+	fnmacseq	s22, s21, s20
+	fnmscseq	s19, s18, s17
+	fnmulseq	s16, s15, s14
+	fsubseq	s13, s12, s11
+
+	@ Load/store operations
+
+	fldseq	s10, [r8]
+	fstseq	s9, [r7]
+
+	@ Load/store multiple operations
+
+	fldmiaseq	r1, {s8}
+	fldmfdseq	r2, {s7}
+	fldmiaseq	r3!, {s6}
+	fldmfdseq	r4!, {s5}
+	fldmdbseq	r5!, {s4}
+	fldmeaseq	r6!, {s3}
+
+	fldmiaxeq	r7, {d1}
+	fldmfdxeq	r8, {d2}
+	fldmiaxeq	r9!, {d3}
+	fldmfdxeq	r10!, {d4}
+	fldmdbxeq	r11!, {d5}
+	fldmeaxeq	r12!, {d6}
+
+	fstmiaseq	r13, {s2}
+	fstmeaseq	r14, {s1}
+	fstmiaseq	r1!, {s31}
+	fstmeaseq	r2!, {s30}
+	fstmdbseq	r3!, {s29}
+	fstmfdseq	r4!, {s28}
+
+	fstmiaxeq	r5, {d7}
+	fstmeaxeq	r6, {d8}
+	fstmiaxeq	r7!, {d9}
+	fstmeaxeq	r8!, {d10}
+	fstmdbxeq	r9!, {d11}
+	fstmfdxeq	r10!, {d12}
+
+	@ Conversion operations
+
+	fsitoseq	s27, s6
+	ftosiseq	s25, s5
+	ftosizseq	s23, s4
+	ftouiseq	s21, s3
+	ftouizseq	s19, s2
+	fuitoseq	s17, s1
+
+	@ ARM from VFP operations
+
+	fmrseq	r11, s3
+	fmrxeq	r9, fpsid
+
+	@ VFP From ARM operations
+
+	fmsreq	s3, r9
+	fmxreq	fpsid, r8
+
diff -urN cctools-806-old/as/torture/vfp2.s cctools-806/as/torture/vfp2.s
--- cctools-806-old/as/torture/vfp2.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/vfp2.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,18 @@
+@ VFP2 Additional instructions
+	.text
+	.globl F
+F:
+	@ First we test the basic syntax and bit patterns of the opcodes.
+	@ Use a combination of r5, r10, s15, s17, d0 and d15 to exercise
+	@ the full register bitpatterns
+
+	fmdrr d0, r5, r10
+	fmrrd r5, r10, d0
+	fmsrr {s15, s16}, r5, r10
+	fmrrs r5, r10, {s15, s16}
+
+	fmdrr d15, r10, r5
+	fmrrd r10, r5, d15
+	fmsrr {s17, s18}, r10, r5
+	fmrrs r10, r5, {s17, s18}
+
diff -urN cctools-806-old/as/torture/weakrefs.c cctools-806/as/torture/weakrefs.c
--- cctools-806-old/as/torture/weakrefs.c	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/weakrefs.c	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,10 @@
+#include <stdio.h>
+
+extern int wibble() __attribute__ ((weak_import));
+
+int main()
+{
+    wibble();
+    return 0;
+} 
+
diff -urN cctools-806-old/as/torture/weakrefs.s cctools-806/as/torture/weakrefs.s
--- cctools-806-old/as/torture/weakrefs.s	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/torture/weakrefs.s	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,15 @@
+	.text
+.globl _main
+_main:
+	pushl	%ebp
+	movl	%esp, %ebp
+	subl	$8, %esp
+	call	L_foo$stub
+	movl	$0, %eax
+	leave
+	ret
+	.section __IMPORT,__jump_table,symbol_stubs,self_modifying_code+pure_instructions,5
+L_foo$stub:
+	.indirect_symbol _foo
+	hlt ; hlt ; hlt ; hlt ; hlt
+	.subsections_via_symbols
diff -urN cctools-806-old/as/x86_64/Makefile.in cctools-806/as/x86_64/Makefile.in
--- cctools-806-old/as/x86_64/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/as/x86_64/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,6 @@
+ARCH	=	x86_64
+
+CFILES_x86_64	=	i386.c
+MYDEFS_x86_64	=	-DI386 -Di486 -Di586 -Di686 -DARCH64
+MYLIBS_x86_64	=	-lstuff64
+
diff -urN cctools-806-old/cbtlibs/Makefile cctools-806/cbtlibs/Makefile
--- cctools-806-old/cbtlibs/Makefile	2009-12-16 13:34:18.000000000 -0600
+++ cctools-806/cbtlibs/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,94 +0,0 @@
-RC_OS = macos
-OFLAG = -Os
-USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
-				  [ "$(RC_XBS)" != "YES" ]; then \
-	     echo YES ; else echo NO ; \
-	     fi; )
-ifneq "" "$(SDKROOT)"
-  SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
-endif
-	
-ifeq "mwccppc" "$(notdir $(CC))"
-  CFLAGS = $(OFLAG) -g -gccinc -I$(SRCROOT)/../include $(SDK)
-else
-  CFLAGS = $(OFLAG) -g -I$(SRCROOT)/../include -Wall $(X_CFLAGS) $(SDK)
-endif
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-SRCROOT = .
-SYMROOT = .
-OBJROOT = .
-OFILE_DIR = $(OBJROOT)
-VPATH = $(OFILE_DIR)
-
-CFILES = libsyminfo.c
-OBJS = $(CFILES:.c=.o)
-INSTALL_FILES = $(CFILES) Makefile notes
-LOCLIBDIR = /usr/local/lib
-LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
-
-all: $(OFILE_DIR) $(SYMROOT) lib_ofiles
-
-lib_ofiles: $(OFILE_DIR) $(SYMROOT) libsyminfo.a 
-
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c -o $(OFILE_DIR)/$*.o $<
-else
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
-		-MD -dependency-file $(OFILE_DIR)/$*.d \
-		-o $(OFILE_DIR)/$*.o $<
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-clean shlib_clean:
-	-rm -r -f $(OFILE_DIRS)
-	-rm -f libsyminfo.a
-
-install: all
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-$(SYMROOT):
-	$(MKDIRS) $@
-
-libsyminfo.o: libsyminfo.c
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c \
-		-o $(OFILE_DIR)/$*.o $(SRCROOT)/libsyminfo.c -DLIBRARY_API
-else
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c \
-		-MD -dependency-file $(OFILE_DIR)/$*.d -o $(OFILE_DIR)/$*.o \
-		$(SRCROOT)/libsyminfo.c -DLIBRARY_API
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-libsyminfo.a: libsyminfo.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/libsyminfo.o.tmp \
-		libsyminfo.o $(LIBSTUFF)
-	libtool -static -o $(SYMROOT)/libsyminfo.a \
-		$(OBJROOT)/libsyminfo.o.tmp
-
-
-lib_ofiles_install: lib_ofiles
-	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)
-	install -p -c -m 444 $(SYMROOT)/libsyminfo.a \
-		$(DSTROOT)$(LOCLIBDIR)/libsyminfo.a
-	ranlib $(DSTROOT)$(LOCLIBDIR)/libsyminfo.a
-
--include $(OFILE_DIR)/Makedep
-
-$(OFILE_DIR) $(SYMROOT):
-	$(MKDIRS) $@
diff -urN cctools-806-old/cbtlibs/Makefile.apple cctools-806/cbtlibs/Makefile.apple
--- cctools-806-old/cbtlibs/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/cbtlibs/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,94 @@
+RC_OS = macos
+OFLAG = -Os
+USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
+				  [ "$(RC_XBS)" != "YES" ]; then \
+	     echo YES ; else echo NO ; \
+	     fi; )
+ifneq "" "$(SDKROOT)"
+  SDK = -isysroot $(SDKROOT)
+  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
+endif
+	
+ifeq "mwccppc" "$(notdir $(CC))"
+  CFLAGS = $(OFLAG) -g -gccinc -I$(SRCROOT)/../include $(SDK)
+else
+  CFLAGS = $(OFLAG) -g -I$(SRCROOT)/../include -Wall $(X_CFLAGS) $(SDK)
+endif
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+SRCROOT = .
+SYMROOT = .
+OBJROOT = .
+OFILE_DIR = $(OBJROOT)
+VPATH = $(OFILE_DIR)
+
+CFILES = libsyminfo.c
+OBJS = $(CFILES:.c=.o)
+INSTALL_FILES = $(CFILES) Makefile notes
+LOCLIBDIR = /usr/local/lib
+LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
+
+all: $(OFILE_DIR) $(SYMROOT) lib_ofiles
+
+lib_ofiles: $(OFILE_DIR) $(SYMROOT) libsyminfo.a 
+
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c -o $(OFILE_DIR)/$*.o $<
+else
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
+		-MD -dependency-file $(OFILE_DIR)/$*.d \
+		-o $(OFILE_DIR)/$*.o $<
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+clean shlib_clean:
+	-rm -r -f $(OFILE_DIRS)
+	-rm -f libsyminfo.a
+
+install: all
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+$(SYMROOT):
+	$(MKDIRS) $@
+
+libsyminfo.o: libsyminfo.c
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c \
+		-o $(OFILE_DIR)/$*.o $(SRCROOT)/libsyminfo.c -DLIBRARY_API
+else
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c \
+		-MD -dependency-file $(OFILE_DIR)/$*.d -o $(OFILE_DIR)/$*.o \
+		$(SRCROOT)/libsyminfo.c -DLIBRARY_API
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+libsyminfo.a: libsyminfo.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/libsyminfo.o.tmp \
+		libsyminfo.o $(LIBSTUFF)
+	libtool -static -o $(SYMROOT)/libsyminfo.a \
+		$(OBJROOT)/libsyminfo.o.tmp
+
+
+lib_ofiles_install: lib_ofiles
+	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)
+	install -p -c -m 444 $(SYMROOT)/libsyminfo.a \
+		$(DSTROOT)$(LOCLIBDIR)/libsyminfo.a
+	ranlib $(DSTROOT)$(LOCLIBDIR)/libsyminfo.a
+
+-include $(OFILE_DIR)/Makedep
+
+$(OFILE_DIR) $(SYMROOT):
+	$(MKDIRS) $@
diff -urN cctools-806-old/config.guess cctools-806/config.guess
--- cctools-806-old/config.guess	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/config.guess	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1388 @@
+#! /bin/sh
+# Attempt to guess a canonical system name.
+#   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
+#   2000, 2001, 2002, 2003 Free Software Foundation, Inc.
+
+timestamp='2003-02-22'
+
+# This file is free software; you can redistribute it and/or modify it
+# under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful, but
+# WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
+# General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111-1307, USA.
+#
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
+
+# Originally written by Per Bothner <per@bothner.com>.
+# Please send patches to <config-patches@gnu.org>.  Submit a context
+# diff and a properly formatted ChangeLog entry.
+#
+# This script attempts to guess a canonical system name similar to
+# config.sub.  If it succeeds, it prints the system name on stdout, and
+# exits with 0.  Otherwise, it exits with 1.
+#
+# The plan is that this can be called by configure scripts if you
+# don't specify an explicit build system type.
+
+me=`echo "$0" | sed -e 's,.*/,,'`
+
+usage="\
+Usage: $0 [OPTION]
+
+Output the configuration name of the system \`$me' is run on.
+
+Operation modes:
+  -h, --help         print this help, then exit
+  -t, --time-stamp   print date of last modification, then exit
+  -v, --version      print version number, then exit
+
+Report bugs and patches to <config-patches@gnu.org>."
+
+version="\
+GNU config.guess ($timestamp)
+
+Originally written by Per Bothner.
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001
+Free Software Foundation, Inc.
+
+This is free software; see the source for copying conditions.  There is NO
+warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
+
+help="
+Try \`$me --help' for more information."
+
+# Parse command line
+while test $# -gt 0 ; do
+  case $1 in
+    --time-stamp | --time* | -t )
+       echo "$timestamp" ; exit 0 ;;
+    --version | -v )
+       echo "$version" ; exit 0 ;;
+    --help | --h* | -h )
+       echo "$usage"; exit 0 ;;
+    -- )     # Stop option processing
+       shift; break ;;
+    - )	# Use stdin as input.
+       break ;;
+    -* )
+       echo "$me: invalid option $1$help" >&2
+       exit 1 ;;
+    * )
+       break ;;
+  esac
+done
+
+if test $# != 0; then
+  echo "$me: too many arguments$help" >&2
+  exit 1
+fi
+
+trap 'exit 1' 1 2 15
+
+# CC_FOR_BUILD -- compiler used by this script. Note that the use of a
+# compiler to aid in system detection is discouraged as it requires
+# temporary files to be created and, as you can see below, it is a
+# headache to deal with in a portable fashion.
+
+# Historically, `CC_FOR_BUILD' used to be named `HOST_CC'. We still
+# use `HOST_CC' if defined, but it is deprecated.
+
+# Portable tmp directory creation inspired by the Autoconf team.
+
+set_cc_for_build='
+trap "exitcode=\$?; (rm -f \$tmpfiles 2>/dev/null; rmdir \$tmp 2>/dev/null) && exit \$exitcode" 0 ;
+trap "rm -f \$tmpfiles 2>/dev/null; rmdir \$tmp 2>/dev/null; exit 1" 1 2 13 15 ;
+: ${TMPDIR=/tmp} ;
+ { tmp=`(umask 077 && mktemp -d -q "$TMPDIR/cgXXXXXX") 2>/dev/null` && test -n "$tmp" && test -d "$tmp" ; } ||
+ { test -n "$RANDOM" && tmp=$TMPDIR/cg$$-$RANDOM && (umask 077 && mkdir $tmp) ; } ||
+ { echo "$me: cannot create a temporary directory in $TMPDIR" >&2 ; exit 1 ; } ;
+dummy=$tmp/dummy ;
+tmpfiles="$dummy.c $dummy.o $dummy.rel $dummy" ;
+case $CC_FOR_BUILD,$HOST_CC,$CC in
+ ,,)    echo "int x;" > $dummy.c ;
+	for c in cc gcc c89 c99 ; do
+	  if ($c -c -o $dummy.o $dummy.c) >/dev/null 2>&1 ; then
+	     CC_FOR_BUILD="$c"; break ;
+	  fi ;
+	done ;
+	if test x"$CC_FOR_BUILD" = x ; then
+	  CC_FOR_BUILD=no_compiler_found ;
+	fi
+	;;
+ ,,*)   CC_FOR_BUILD=$CC ;;
+ ,*,*)  CC_FOR_BUILD=$HOST_CC ;;
+esac ;'
+
+# This is needed to find uname on a Pyramid OSx when run in the BSD universe.
+# (ghazi@noc.rutgers.edu 1994-08-24)
+if (test -f /.attbin/uname) >/dev/null 2>&1 ; then
+	PATH=$PATH:/.attbin ; export PATH
+fi
+
+UNAME_MACHINE=`(uname -m) 2>/dev/null` || UNAME_MACHINE=unknown
+UNAME_RELEASE=`(uname -r) 2>/dev/null` || UNAME_RELEASE=unknown
+UNAME_SYSTEM=`(uname -s) 2>/dev/null`  || UNAME_SYSTEM=unknown
+UNAME_VERSION=`(uname -v) 2>/dev/null` || UNAME_VERSION=unknown
+
+# Note: order is significant - the case branches are not exclusive.
+
+case "${UNAME_MACHINE}:${UNAME_SYSTEM}:${UNAME_RELEASE}:${UNAME_VERSION}" in
+    *:NetBSD:*:*)
+	# NetBSD (nbsd) targets should (where applicable) match one or
+	# more of the tupples: *-*-netbsdelf*, *-*-netbsdaout*,
+	# *-*-netbsdecoff* and *-*-netbsd*.  For targets that recently
+	# switched to ELF, *-*-netbsd* would select the old
+	# object file format.  This provides both forward
+	# compatibility and a consistent mechanism for selecting the
+	# object file format.
+	#
+	# Note: NetBSD doesn't particularly care about the vendor
+	# portion of the name.  We always set it to "unknown".
+	sysctl="sysctl -n hw.machine_arch"
+	UNAME_MACHINE_ARCH=`(/sbin/$sysctl 2>/dev/null || \
+	    /usr/sbin/$sysctl 2>/dev/null || echo unknown)`
+	case "${UNAME_MACHINE_ARCH}" in
+	    armeb) machine=armeb-unknown ;;
+	    arm*) machine=arm-unknown ;;
+	    sh3el) machine=shl-unknown ;;
+	    sh3eb) machine=sh-unknown ;;
+	    *) machine=${UNAME_MACHINE_ARCH}-unknown ;;
+	esac
+	# The Operating System including object format, if it has switched
+	# to ELF recently, or will in the future.
+	case "${UNAME_MACHINE_ARCH}" in
+	    arm*|i386|m68k|ns32k|sh3*|sparc|vax)
+		eval $set_cc_for_build
+		if echo __ELF__ | $CC_FOR_BUILD -E - 2>/dev/null \
+			| grep __ELF__ >/dev/null
+		then
+		    # Once all utilities can be ECOFF (netbsdecoff) or a.out (netbsdaout).
+		    # Return netbsd for either.  FIX?
+		    os=netbsd
+		else
+		    os=netbsdelf
+		fi
+		;;
+	    *)
+	        os=netbsd
+		;;
+	esac
+	# The OS release
+	# Debian GNU/NetBSD machines have a different userland, and
+	# thus, need a distinct triplet. However, they do not need
+	# kernel version information, so it can be replaced with a
+	# suitable tag, in the style of linux-gnu.
+	case "${UNAME_VERSION}" in
+	    Debian*)
+		release='-gnu'
+		;;
+	    *)
+		release=`echo ${UNAME_RELEASE}|sed -e 's/[-_].*/\./'`
+		;;
+	esac
+	# Since CPU_TYPE-MANUFACTURER-KERNEL-OPERATING_SYSTEM:
+	# contains redundant information, the shorter form:
+	# CPU_TYPE-MANUFACTURER-OPERATING_SYSTEM is used.
+	echo "${machine}-${os}${release}"
+	exit 0 ;;
+    amiga:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    arc:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    hp300:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mac68k:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    macppc:OpenBSD:*:*)
+	echo powerpc-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mvme68k:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mvme88k:OpenBSD:*:*)
+	echo m88k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    mvmeppc:OpenBSD:*:*)
+	echo powerpc-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    pmax:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    sgi:OpenBSD:*:*)
+	echo mipseb-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    sun3:OpenBSD:*:*)
+	echo m68k-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    wgrisc:OpenBSD:*:*)
+	echo mipsel-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    *:OpenBSD:*:*)
+	echo ${UNAME_MACHINE}-unknown-openbsd${UNAME_RELEASE}
+	exit 0 ;;
+    alpha:OSF1:*:*)
+	if test $UNAME_RELEASE = "V4.0"; then
+		UNAME_RELEASE=`/usr/sbin/sizer -v | awk '{print $3}'`
+	fi
+	# According to Compaq, /usr/sbin/psrinfo has been available on
+	# OSF/1 and Tru64 systems produced since 1995.  I hope that
+	# covers most systems running today.  This code pipes the CPU
+	# types through head -n 1, so we only detect the type of CPU 0.
+	ALPHA_CPU_TYPE=`/usr/sbin/psrinfo -v | sed -n -e 's/^  The alpha \(.*\) processor.*$/\1/p' | head -n 1`
+	case "$ALPHA_CPU_TYPE" in
+	    "EV4 (21064)")
+		UNAME_MACHINE="alpha" ;;
+	    "EV4.5 (21064)")
+		UNAME_MACHINE="alpha" ;;
+	    "LCA4 (21066/21068)")
+		UNAME_MACHINE="alpha" ;;
+	    "EV5 (21164)")
+		UNAME_MACHINE="alphaev5" ;;
+	    "EV5.6 (21164A)")
+		UNAME_MACHINE="alphaev56" ;;
+	    "EV5.6 (21164PC)")
+		UNAME_MACHINE="alphapca56" ;;
+	    "EV5.7 (21164PC)")
+		UNAME_MACHINE="alphapca57" ;;
+	    "EV6 (21264)")
+		UNAME_MACHINE="alphaev6" ;;
+	    "EV6.7 (21264A)")
+		UNAME_MACHINE="alphaev67" ;;
+	    "EV6.8CB (21264C)")
+		UNAME_MACHINE="alphaev68" ;;
+	    "EV6.8AL (21264B)")
+		UNAME_MACHINE="alphaev68" ;;
+	    "EV6.8CX (21264D)")
+		UNAME_MACHINE="alphaev68" ;;
+	    "EV6.9A (21264/EV69A)")
+		UNAME_MACHINE="alphaev69" ;;
+	    "EV7 (21364)")
+		UNAME_MACHINE="alphaev7" ;;
+	    "EV7.9 (21364A)")
+		UNAME_MACHINE="alphaev79" ;;
+	esac
+	# A Vn.n version is a released version.
+	# A Tn.n version is a released field test version.
+	# A Xn.n version is an unreleased experimental baselevel.
+	# 1.2 uses "1.2" for uname -r.
+	echo ${UNAME_MACHINE}-dec-osf`echo ${UNAME_RELEASE} | sed -e 's/^[VTX]//' | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
+	exit 0 ;;
+    Alpha\ *:Windows_NT*:*)
+	# How do we know it's Interix rather than the generic POSIX subsystem?
+	# Should we change UNAME_MACHINE based on the output of uname instead
+	# of the specific Alpha model?
+	echo alpha-pc-interix
+	exit 0 ;;
+    21064:Windows_NT:50:3)
+	echo alpha-dec-winnt3.5
+	exit 0 ;;
+    Amiga*:UNIX_System_V:4.0:*)
+	echo m68k-unknown-sysv4
+	exit 0;;
+    *:[Aa]miga[Oo][Ss]:*:*)
+	echo ${UNAME_MACHINE}-unknown-amigaos
+	exit 0 ;;
+    *:[Mm]orph[Oo][Ss]:*:*)
+	echo ${UNAME_MACHINE}-unknown-morphos
+	exit 0 ;;
+    *:OS/390:*:*)
+	echo i370-ibm-openedition
+	exit 0 ;;
+    arm:RISC*:1.[012]*:*|arm:riscix:1.[012]*:*)
+	echo arm-acorn-riscix${UNAME_RELEASE}
+	exit 0;;
+    SR2?01:HI-UX/MPP:*:* | SR8000:HI-UX/MPP:*:*)
+	echo hppa1.1-hitachi-hiuxmpp
+	exit 0;;
+    Pyramid*:OSx*:*:* | MIS*:OSx*:*:* | MIS*:SMP_DC-OSx*:*:*)
+	# akee@wpdis03.wpafb.af.mil (Earle F. Ake) contributed MIS and NILE.
+	if test "`(/bin/universe) 2>/dev/null`" = att ; then
+		echo pyramid-pyramid-sysv3
+	else
+		echo pyramid-pyramid-bsd
+	fi
+	exit 0 ;;
+    NILE*:*:*:dcosx)
+	echo pyramid-pyramid-svr4
+	exit 0 ;;
+    DRS?6000:UNIX_SV:4.2*:7*)
+	case `/usr/bin/uname -p` in
+	    sparc) echo sparc-icl-nx7 && exit 0 ;;
+	esac ;;
+    sun4H:SunOS:5.*:*)
+	echo sparc-hal-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    sun4*:SunOS:5.*:* | tadpole*:SunOS:5.*:*)
+	echo sparc-sun-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    i86pc:SunOS:5.*:*)
+	echo i386-pc-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    sun4*:SunOS:6*:*)
+	# According to config.sub, this is the proper way to canonicalize
+	# SunOS6.  Hard to guess exactly what SunOS6 will be like, but
+	# it's likely to be more like Solaris than SunOS4.
+	echo sparc-sun-solaris3`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    sun4*:SunOS:*:*)
+	case "`/usr/bin/arch -k`" in
+	    Series*|S4*)
+		UNAME_RELEASE=`uname -v`
+		;;
+	esac
+	# Japanese Language versions have a version number like `4.1.3-JL'.
+	echo sparc-sun-sunos`echo ${UNAME_RELEASE}|sed -e 's/-/_/'`
+	exit 0 ;;
+    sun3*:SunOS:*:*)
+	echo m68k-sun-sunos${UNAME_RELEASE}
+	exit 0 ;;
+    sun*:*:4.2BSD:*)
+	UNAME_RELEASE=`(sed 1q /etc/motd | awk '{print substr($5,1,3)}') 2>/dev/null`
+	test "x${UNAME_RELEASE}" = "x" && UNAME_RELEASE=3
+	case "`/bin/arch`" in
+	    sun3)
+		echo m68k-sun-sunos${UNAME_RELEASE}
+		;;
+	    sun4)
+		echo sparc-sun-sunos${UNAME_RELEASE}
+		;;
+	esac
+	exit 0 ;;
+    aushp:SunOS:*:*)
+	echo sparc-auspex-sunos${UNAME_RELEASE}
+	exit 0 ;;
+    # The situation for MiNT is a little confusing.  The machine name
+    # can be virtually everything (everything which is not
+    # "atarist" or "atariste" at least should have a processor
+    # > m68000).  The system name ranges from "MiNT" over "FreeMiNT"
+    # to the lowercase version "mint" (or "freemint").  Finally
+    # the system name "TOS" denotes a system which is actually not
+    # MiNT.  But MiNT is downward compatible to TOS, so this should
+    # be no problem.
+    atarist[e]:*MiNT:*:* | atarist[e]:*mint:*:* | atarist[e]:*TOS:*:*)
+        echo m68k-atari-mint${UNAME_RELEASE}
+	exit 0 ;;
+    atari*:*MiNT:*:* | atari*:*mint:*:* | atarist[e]:*TOS:*:*)
+	echo m68k-atari-mint${UNAME_RELEASE}
+        exit 0 ;;
+    *falcon*:*MiNT:*:* | *falcon*:*mint:*:* | *falcon*:*TOS:*:*)
+        echo m68k-atari-mint${UNAME_RELEASE}
+	exit 0 ;;
+    milan*:*MiNT:*:* | milan*:*mint:*:* | *milan*:*TOS:*:*)
+        echo m68k-milan-mint${UNAME_RELEASE}
+        exit 0 ;;
+    hades*:*MiNT:*:* | hades*:*mint:*:* | *hades*:*TOS:*:*)
+        echo m68k-hades-mint${UNAME_RELEASE}
+        exit 0 ;;
+    *:*MiNT:*:* | *:*mint:*:* | *:*TOS:*:*)
+        echo m68k-unknown-mint${UNAME_RELEASE}
+        exit 0 ;;
+    powerpc:machten:*:*)
+	echo powerpc-apple-machten${UNAME_RELEASE}
+	exit 0 ;;
+    RISC*:Mach:*:*)
+	echo mips-dec-mach_bsd4.3
+	exit 0 ;;
+    RISC*:ULTRIX:*:*)
+	echo mips-dec-ultrix${UNAME_RELEASE}
+	exit 0 ;;
+    VAX*:ULTRIX*:*:*)
+	echo vax-dec-ultrix${UNAME_RELEASE}
+	exit 0 ;;
+    2020:CLIX:*:* | 2430:CLIX:*:*)
+	echo clipper-intergraph-clix${UNAME_RELEASE}
+	exit 0 ;;
+    mips:*:*:UMIPS | mips:*:*:RISCos)
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+#ifdef __cplusplus
+#include <stdio.h>  /* for printf() prototype */
+	int main (int argc, char *argv[]) {
+#else
+	int main (argc, argv) int argc; char *argv[]; {
+#endif
+	#if defined (host_mips) && defined (MIPSEB)
+	#if defined (SYSTYPE_SYSV)
+	  printf ("mips-mips-riscos%ssysv\n", argv[1]); exit (0);
+	#endif
+	#if defined (SYSTYPE_SVR4)
+	  printf ("mips-mips-riscos%ssvr4\n", argv[1]); exit (0);
+	#endif
+	#if defined (SYSTYPE_BSD43) || defined(SYSTYPE_BSD)
+	  printf ("mips-mips-riscos%sbsd\n", argv[1]); exit (0);
+	#endif
+	#endif
+	  exit (-1);
+	}
+EOF
+	$CC_FOR_BUILD -o $dummy $dummy.c \
+	  && $dummy `echo "${UNAME_RELEASE}" | sed -n 's/\([0-9]*\).*/\1/p'` \
+	  && exit 0
+	echo mips-mips-riscos${UNAME_RELEASE}
+	exit 0 ;;
+    Motorola:PowerMAX_OS:*:*)
+	echo powerpc-motorola-powermax
+	exit 0 ;;
+    Motorola:*:4.3:PL8-*)
+	echo powerpc-harris-powermax
+	exit 0 ;;
+    Night_Hawk:*:*:PowerMAX_OS | Synergy:PowerMAX_OS:*:*)
+	echo powerpc-harris-powermax
+	exit 0 ;;
+    Night_Hawk:Power_UNIX:*:*)
+	echo powerpc-harris-powerunix
+	exit 0 ;;
+    m88k:CX/UX:7*:*)
+	echo m88k-harris-cxux7
+	exit 0 ;;
+    m88k:*:4*:R4*)
+	echo m88k-motorola-sysv4
+	exit 0 ;;
+    m88k:*:3*:R3*)
+	echo m88k-motorola-sysv3
+	exit 0 ;;
+    AViiON:dgux:*:*)
+        # DG/UX returns AViiON for all architectures
+        UNAME_PROCESSOR=`/usr/bin/uname -p`
+	if [ $UNAME_PROCESSOR = mc88100 ] || [ $UNAME_PROCESSOR = mc88110 ]
+	then
+	    if [ ${TARGET_BINARY_INTERFACE}x = m88kdguxelfx ] || \
+	       [ ${TARGET_BINARY_INTERFACE}x = x ]
+	    then
+		echo m88k-dg-dgux${UNAME_RELEASE}
+	    else
+		echo m88k-dg-dguxbcs${UNAME_RELEASE}
+	    fi
+	else
+	    echo i586-dg-dgux${UNAME_RELEASE}
+	fi
+ 	exit 0 ;;
+    M88*:DolphinOS:*:*)	# DolphinOS (SVR3)
+	echo m88k-dolphin-sysv3
+	exit 0 ;;
+    M88*:*:R3*:*)
+	# Delta 88k system running SVR3
+	echo m88k-motorola-sysv3
+	exit 0 ;;
+    XD88*:*:*:*) # Tektronix XD88 system running UTekV (SVR3)
+	echo m88k-tektronix-sysv3
+	exit 0 ;;
+    Tek43[0-9][0-9]:UTek:*:*) # Tektronix 4300 system running UTek (BSD)
+	echo m68k-tektronix-bsd
+	exit 0 ;;
+    *:IRIX*:*:*)
+	echo mips-sgi-irix`echo ${UNAME_RELEASE}|sed -e 's/-/_/g'`
+	exit 0 ;;
+    ????????:AIX?:[12].1:2)   # AIX 2.2.1 or AIX 2.1.1 is RT/PC AIX.
+	echo romp-ibm-aix      # uname -m gives an 8 hex-code CPU id
+	exit 0 ;;              # Note that: echo "'`uname -s`'" gives 'AIX '
+    i*86:AIX:*:*)
+	echo i386-ibm-aix
+	exit 0 ;;
+    ia64:AIX:*:*)
+	if [ -x /usr/bin/oslevel ] ; then
+		IBM_REV=`/usr/bin/oslevel`
+	else
+		IBM_REV=${UNAME_VERSION}.${UNAME_RELEASE}
+	fi
+	echo ${UNAME_MACHINE}-ibm-aix${IBM_REV}
+	exit 0 ;;
+    *:AIX:2:3)
+	if grep bos325 /usr/include/stdio.h >/dev/null 2>&1; then
+		eval $set_cc_for_build
+		sed 's/^		//' << EOF >$dummy.c
+		#include <sys/systemcfg.h>
+
+		main()
+			{
+			if (!__power_pc())
+				exit(1);
+			puts("powerpc-ibm-aix3.2.5");
+			exit(0);
+			}
+EOF
+		$CC_FOR_BUILD -o $dummy $dummy.c && $dummy && exit 0
+		echo rs6000-ibm-aix3.2.5
+	elif grep bos324 /usr/include/stdio.h >/dev/null 2>&1; then
+		echo rs6000-ibm-aix3.2.4
+	else
+		echo rs6000-ibm-aix3.2
+	fi
+	exit 0 ;;
+    *:AIX:*:[45])
+	IBM_CPU_ID=`/usr/sbin/lsdev -C -c processor -S available | sed 1q | awk '{ print $1 }'`
+	if /usr/sbin/lsattr -El ${IBM_CPU_ID} | grep ' POWER' >/dev/null 2>&1; then
+		IBM_ARCH=rs6000
+	else
+		IBM_ARCH=powerpc
+	fi
+	if [ -x /usr/bin/oslevel ] ; then
+		IBM_REV=`/usr/bin/oslevel`
+	else
+		IBM_REV=${UNAME_VERSION}.${UNAME_RELEASE}
+	fi
+	echo ${IBM_ARCH}-ibm-aix${IBM_REV}
+	exit 0 ;;
+    *:AIX:*:*)
+	echo rs6000-ibm-aix
+	exit 0 ;;
+    ibmrt:4.4BSD:*|romp-ibm:BSD:*)
+	echo romp-ibm-bsd4.4
+	exit 0 ;;
+    ibmrt:*BSD:*|romp-ibm:BSD:*)            # covers RT/PC BSD and
+	echo romp-ibm-bsd${UNAME_RELEASE}   # 4.3 with uname added to
+	exit 0 ;;                           # report: romp-ibm BSD 4.3
+    *:BOSX:*:*)
+	echo rs6000-bull-bosx
+	exit 0 ;;
+    DPX/2?00:B.O.S.:*:*)
+	echo m68k-bull-sysv3
+	exit 0 ;;
+    9000/[34]??:4.3bsd:1.*:*)
+	echo m68k-hp-bsd
+	exit 0 ;;
+    hp300:4.4BSD:*:* | 9000/[34]??:4.3bsd:2.*:*)
+	echo m68k-hp-bsd4.4
+	exit 0 ;;
+    9000/[34678]??:HP-UX:*:*)
+	HPUX_REV=`echo ${UNAME_RELEASE}|sed -e 's/[^.]*.[0B]*//'`
+	case "${UNAME_MACHINE}" in
+	    9000/31? )            HP_ARCH=m68000 ;;
+	    9000/[34]?? )         HP_ARCH=m68k ;;
+	    9000/[678][0-9][0-9])
+		if [ -x /usr/bin/getconf ]; then
+		    sc_cpu_version=`/usr/bin/getconf SC_CPU_VERSION 2>/dev/null`
+                    sc_kernel_bits=`/usr/bin/getconf SC_KERNEL_BITS 2>/dev/null`
+                    case "${sc_cpu_version}" in
+                      523) HP_ARCH="hppa1.0" ;; # CPU_PA_RISC1_0
+                      528) HP_ARCH="hppa1.1" ;; # CPU_PA_RISC1_1
+                      532)                      # CPU_PA_RISC2_0
+                        case "${sc_kernel_bits}" in
+                          32) HP_ARCH="hppa2.0n" ;;
+                          64) HP_ARCH="hppa2.0w" ;;
+			  '') HP_ARCH="hppa2.0" ;;   # HP-UX 10.20
+                        esac ;;
+                    esac
+		fi
+		if [ "${HP_ARCH}" = "" ]; then
+		    eval $set_cc_for_build
+		    sed 's/^              //' << EOF >$dummy.c
+
+              #define _HPUX_SOURCE
+              #include <stdlib.h>
+              #include <unistd.h>
+
+              int main ()
+              {
+              #if defined(_SC_KERNEL_BITS)
+                  long bits = sysconf(_SC_KERNEL_BITS);
+              #endif
+                  long cpu  = sysconf (_SC_CPU_VERSION);
+
+                  switch (cpu)
+              	{
+              	case CPU_PA_RISC1_0: puts ("hppa1.0"); break;
+              	case CPU_PA_RISC1_1: puts ("hppa1.1"); break;
+              	case CPU_PA_RISC2_0:
+              #if defined(_SC_KERNEL_BITS)
+              	    switch (bits)
+              		{
+              		case 64: puts ("hppa2.0w"); break;
+              		case 32: puts ("hppa2.0n"); break;
+              		default: puts ("hppa2.0"); break;
+              		} break;
+              #else  /* !defined(_SC_KERNEL_BITS) */
+              	    puts ("hppa2.0"); break;
+              #endif
+              	default: puts ("hppa1.0"); break;
+              	}
+                  exit (0);
+              }
+EOF
+		    (CCOPTS= $CC_FOR_BUILD -o $dummy $dummy.c 2>/dev/null) && HP_ARCH=`$dummy`
+		    test -z "$HP_ARCH" && HP_ARCH=hppa
+		fi ;;
+	esac
+	if [ ${HP_ARCH} = "hppa2.0w" ]
+	then
+	    # avoid double evaluation of $set_cc_for_build
+	    test -n "$CC_FOR_BUILD" || eval $set_cc_for_build
+	    if echo __LP64__ | (CCOPTS= $CC_FOR_BUILD -E -) | grep __LP64__ >/dev/null
+	    then
+		HP_ARCH="hppa2.0w"
+	    else
+		HP_ARCH="hppa64"
+	    fi
+	fi
+	echo ${HP_ARCH}-hp-hpux${HPUX_REV}
+	exit 0 ;;
+    ia64:HP-UX:*:*)
+	HPUX_REV=`echo ${UNAME_RELEASE}|sed -e 's/[^.]*.[0B]*//'`
+	echo ia64-hp-hpux${HPUX_REV}
+	exit 0 ;;
+    3050*:HI-UX:*:*)
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#include <unistd.h>
+	int
+	main ()
+	{
+	  long cpu = sysconf (_SC_CPU_VERSION);
+	  /* The order matters, because CPU_IS_HP_MC68K erroneously returns
+	     true for CPU_PA_RISC1_0.  CPU_IS_PA_RISC returns correct
+	     results, however.  */
+	  if (CPU_IS_PA_RISC (cpu))
+	    {
+	      switch (cpu)
+		{
+		  case CPU_PA_RISC1_0: puts ("hppa1.0-hitachi-hiuxwe2"); break;
+		  case CPU_PA_RISC1_1: puts ("hppa1.1-hitachi-hiuxwe2"); break;
+		  case CPU_PA_RISC2_0: puts ("hppa2.0-hitachi-hiuxwe2"); break;
+		  default: puts ("hppa-hitachi-hiuxwe2"); break;
+		}
+	    }
+	  else if (CPU_IS_HP_MC68K (cpu))
+	    puts ("m68k-hitachi-hiuxwe2");
+	  else puts ("unknown-hitachi-hiuxwe2");
+	  exit (0);
+	}
+EOF
+	$CC_FOR_BUILD -o $dummy $dummy.c && $dummy && exit 0
+	echo unknown-hitachi-hiuxwe2
+	exit 0 ;;
+    9000/7??:4.3bsd:*:* | 9000/8?[79]:4.3bsd:*:* )
+	echo hppa1.1-hp-bsd
+	exit 0 ;;
+    9000/8??:4.3bsd:*:*)
+	echo hppa1.0-hp-bsd
+	exit 0 ;;
+    *9??*:MPE/iX:*:* | *3000*:MPE/iX:*:*)
+	echo hppa1.0-hp-mpeix
+	exit 0 ;;
+    hp7??:OSF1:*:* | hp8?[79]:OSF1:*:* )
+	echo hppa1.1-hp-osf
+	exit 0 ;;
+    hp8??:OSF1:*:*)
+	echo hppa1.0-hp-osf
+	exit 0 ;;
+    i*86:OSF1:*:*)
+	if [ -x /usr/sbin/sysversion ] ; then
+	    echo ${UNAME_MACHINE}-unknown-osf1mk
+	else
+	    echo ${UNAME_MACHINE}-unknown-osf1
+	fi
+	exit 0 ;;
+    parisc*:Lites*:*:*)
+	echo hppa1.1-hp-lites
+	exit 0 ;;
+    C1*:ConvexOS:*:* | convex:ConvexOS:C1*:*)
+	echo c1-convex-bsd
+        exit 0 ;;
+    C2*:ConvexOS:*:* | convex:ConvexOS:C2*:*)
+	if getsysinfo -f scalar_acc
+	then echo c32-convex-bsd
+	else echo c2-convex-bsd
+	fi
+        exit 0 ;;
+    C34*:ConvexOS:*:* | convex:ConvexOS:C34*:*)
+	echo c34-convex-bsd
+        exit 0 ;;
+    C38*:ConvexOS:*:* | convex:ConvexOS:C38*:*)
+	echo c38-convex-bsd
+        exit 0 ;;
+    C4*:ConvexOS:*:* | convex:ConvexOS:C4*:*)
+	echo c4-convex-bsd
+        exit 0 ;;
+    CRAY*Y-MP:*:*:*)
+	echo ymp-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    CRAY*[A-Z]90:*:*:*)
+	echo ${UNAME_MACHINE}-cray-unicos${UNAME_RELEASE} \
+	| sed -e 's/CRAY.*\([A-Z]90\)/\1/' \
+	      -e y/ABCDEFGHIJKLMNOPQRSTUVWXYZ/abcdefghijklmnopqrstuvwxyz/ \
+	      -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    CRAY*TS:*:*:*)
+	echo t90-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    CRAY*T3E:*:*:*)
+	echo alphaev5-cray-unicosmk${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    CRAY*SV1:*:*:*)
+	echo sv1-cray-unicos${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/'
+	exit 0 ;;
+    *:UNICOS/mp:*:*)
+	echo nv1-cray-unicosmp${UNAME_RELEASE} | sed -e 's/\.[^.]*$/.X/' 
+	exit 0 ;;
+    F30[01]:UNIX_System_V:*:* | F700:UNIX_System_V:*:*)
+	FUJITSU_PROC=`uname -m | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz'`
+        FUJITSU_SYS=`uname -p | tr 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' 'abcdefghijklmnopqrstuvwxyz' | sed -e 's/\///'`
+        FUJITSU_REL=`echo ${UNAME_RELEASE} | sed -e 's/ /_/'`
+        echo "${FUJITSU_PROC}-fujitsu-${FUJITSU_SYS}${FUJITSU_REL}"
+        exit 0 ;;
+    i*86:BSD/386:*:* | i*86:BSD/OS:*:* | *:Ascend\ Embedded/OS:*:*)
+	echo ${UNAME_MACHINE}-pc-bsdi${UNAME_RELEASE}
+	exit 0 ;;
+    sparc*:BSD/OS:*:*)
+	echo sparc-unknown-bsdi${UNAME_RELEASE}
+	exit 0 ;;
+    *:BSD/OS:*:*)
+	echo ${UNAME_MACHINE}-unknown-bsdi${UNAME_RELEASE}
+	exit 0 ;;
+    *:FreeBSD:*:*)
+	# Determine whether the default compiler uses glibc.
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#include <features.h>
+	#if __GLIBC__ >= 2
+	LIBC=gnu
+	#else
+	LIBC=
+	#endif
+EOF
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^LIBC=`
+	echo ${UNAME_MACHINE}-unknown-freebsd`echo ${UNAME_RELEASE}|sed -e 's/[-(].*//'`${LIBC:+-$LIBC}
+	exit 0 ;;
+    i*:CYGWIN*:*)
+	echo ${UNAME_MACHINE}-pc-cygwin
+	exit 0 ;;
+    i*:MINGW*:*)
+	echo ${UNAME_MACHINE}-pc-mingw32
+	exit 0 ;;
+    i*:PW*:*)
+	echo ${UNAME_MACHINE}-pc-pw32
+	exit 0 ;;
+    x86:Interix*:3*)
+	echo i586-pc-interix3
+	exit 0 ;;
+    [345]86:Windows_95:* | [345]86:Windows_98:* | [345]86:Windows_NT:*)
+	echo i${UNAME_MACHINE}-pc-mks
+	exit 0 ;;
+    i*:Windows_NT*:* | Pentium*:Windows_NT*:*)
+	# How do we know it's Interix rather than the generic POSIX subsystem?
+	# It also conflicts with pre-2.0 versions of AT&T UWIN. Should we
+	# UNAME_MACHINE based on the output of uname instead of i386?
+	echo i586-pc-interix
+	exit 0 ;;
+    i*:UWIN*:*)
+	echo ${UNAME_MACHINE}-pc-uwin
+	exit 0 ;;
+    p*:CYGWIN*:*)
+	echo powerpcle-unknown-cygwin
+	exit 0 ;;
+    prep*:SunOS:5.*:*)
+	echo powerpcle-unknown-solaris2`echo ${UNAME_RELEASE}|sed -e 's/[^.]*//'`
+	exit 0 ;;
+    *:GNU:*:*)
+	echo `echo ${UNAME_MACHINE}|sed -e 's,[-/].*$,,'`-unknown-gnu`echo ${UNAME_RELEASE}|sed -e 's,/.*$,,'`
+	exit 0 ;;
+    i*86:Minix:*:*)
+	echo ${UNAME_MACHINE}-pc-minix
+	exit 0 ;;
+    arm*:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    ia64:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    m68*:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    mips:Linux:*:*)
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#undef CPU
+	#undef mips
+	#undef mipsel
+	#if defined(__MIPSEL__) || defined(__MIPSEL) || defined(_MIPSEL) || defined(MIPSEL)
+	CPU=mipsel
+	#else
+	#if defined(__MIPSEB__) || defined(__MIPSEB) || defined(_MIPSEB) || defined(MIPSEB)
+	CPU=mips
+	#else
+	CPU=
+	#endif
+	#endif
+EOF
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^CPU=`
+	test x"${CPU}" != x && echo "${CPU}-unknown-linux-gnu" && exit 0
+	;;
+    mips64:Linux:*:*)
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#undef CPU
+	#undef mips64
+	#undef mips64el
+	#if defined(__MIPSEL__) || defined(__MIPSEL) || defined(_MIPSEL) || defined(MIPSEL)
+	CPU=mips64el
+	#else
+	#if defined(__MIPSEB__) || defined(__MIPSEB) || defined(_MIPSEB) || defined(MIPSEB)
+	CPU=mips64
+	#else
+	CPU=
+	#endif
+	#endif
+EOF
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^CPU=`
+	test x"${CPU}" != x && echo "${CPU}-unknown-linux-gnu" && exit 0
+	;;
+    ppc:Linux:*:*)
+	echo powerpc-unknown-linux-gnu
+	exit 0 ;;
+    ppc64:Linux:*:*)
+	echo powerpc64-unknown-linux-gnu
+	exit 0 ;;
+    alpha:Linux:*:*)
+	case `sed -n '/^cpu model/s/^.*: \(.*\)/\1/p' < /proc/cpuinfo` in
+	  EV5)   UNAME_MACHINE=alphaev5 ;;
+	  EV56)  UNAME_MACHINE=alphaev56 ;;
+	  PCA56) UNAME_MACHINE=alphapca56 ;;
+	  PCA57) UNAME_MACHINE=alphapca56 ;;
+	  EV6)   UNAME_MACHINE=alphaev6 ;;
+	  EV67)  UNAME_MACHINE=alphaev67 ;;
+	  EV68*) UNAME_MACHINE=alphaev68 ;;
+        esac
+	objdump --private-headers /bin/sh | grep ld.so.1 >/dev/null
+	if test "$?" = 0 ; then LIBC="libc1" ; else LIBC="" ; fi
+	echo ${UNAME_MACHINE}-unknown-linux-gnu${LIBC}
+	exit 0 ;;
+    parisc:Linux:*:* | hppa:Linux:*:*)
+	# Look for CPU level
+	case `grep '^cpu[^a-z]*:' /proc/cpuinfo 2>/dev/null | cut -d' ' -f2` in
+	  PA7*) echo hppa1.1-unknown-linux-gnu ;;
+	  PA8*) echo hppa2.0-unknown-linux-gnu ;;
+	  *)    echo hppa-unknown-linux-gnu ;;
+	esac
+	exit 0 ;;
+    parisc64:Linux:*:* | hppa64:Linux:*:*)
+	echo hppa64-unknown-linux-gnu
+	exit 0 ;;
+    s390:Linux:*:* | s390x:Linux:*:*)
+	echo ${UNAME_MACHINE}-ibm-linux
+	exit 0 ;;
+    sh*:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    sparc:Linux:*:* | sparc64:Linux:*:*)
+	echo ${UNAME_MACHINE}-unknown-linux-gnu
+	exit 0 ;;
+    x86_64:Linux:*:*)
+	echo x86_64-unknown-linux-gnu
+	exit 0 ;;
+    i*86:Linux:*:*)
+	# The BFD linker knows what the default object file format is, so
+	# first see if it will tell us. cd to the root directory to prevent
+	# problems with other programs or directories called `ld' in the path.
+	# Set LC_ALL=C to ensure ld outputs messages in English.
+	ld_supported_targets=`cd /; LC_ALL=C ld --help 2>&1 \
+			 | sed -ne '/supported targets:/!d
+				    s/[ 	][ 	]*/ /g
+				    s/.*supported targets: *//
+				    s/ .*//
+				    p'`
+        case "$ld_supported_targets" in
+	  elf32-i386)
+		TENTATIVE="${UNAME_MACHINE}-pc-linux-gnu"
+		;;
+	  a.out-i386-linux)
+		echo "${UNAME_MACHINE}-pc-linux-gnuaout"
+		exit 0 ;;
+	  coff-i386)
+		echo "${UNAME_MACHINE}-pc-linux-gnucoff"
+		exit 0 ;;
+	  "")
+		# Either a pre-BFD a.out linker (linux-gnuoldld) or
+		# one that does not give us useful --help.
+		echo "${UNAME_MACHINE}-pc-linux-gnuoldld"
+		exit 0 ;;
+	esac
+	# Determine whether the default compiler is a.out or elf
+	eval $set_cc_for_build
+	sed 's/^	//' << EOF >$dummy.c
+	#include <features.h>
+	#ifdef __ELF__
+	# ifdef __GLIBC__
+	#  if __GLIBC__ >= 2
+	LIBC=gnu
+	#  else
+	LIBC=gnulibc1
+	#  endif
+	# else
+	LIBC=gnulibc1
+	# endif
+	#else
+	#ifdef __INTEL_COMPILER
+	LIBC=gnu
+	#else
+	LIBC=gnuaout
+	#endif
+	#endif
+EOF
+	eval `$CC_FOR_BUILD -E $dummy.c 2>/dev/null | grep ^LIBC=`
+	test x"${LIBC}" != x && echo "${UNAME_MACHINE}-pc-linux-${LIBC}" && exit 0
+	test x"${TENTATIVE}" != x && echo "${TENTATIVE}" && exit 0
+	;;
+    i*86:DYNIX/ptx:4*:*)
+	# ptx 4.0 does uname -s correctly, with DYNIX/ptx in there.
+	# earlier versions are messed up and put the nodename in both
+	# sysname and nodename.
+	echo i386-sequent-sysv4
+	exit 0 ;;
+    i*86:UNIX_SV:4.2MP:2.*)
+        # Unixware is an offshoot of SVR4, but it has its own version
+        # number series starting with 2...
+        # I am not positive that other SVR4 systems won't match this,
+	# I just have to hope.  -- rms.
+        # Use sysv4.2uw... so that sysv4* matches it.
+	echo ${UNAME_MACHINE}-pc-sysv4.2uw${UNAME_VERSION}
+	exit 0 ;;
+    i*86:OS/2:*:*)
+	# If we were able to find `uname', then EMX Unix compatibility
+	# is probably installed.
+	echo ${UNAME_MACHINE}-pc-os2-emx
+	exit 0 ;;
+    i*86:XTS-300:*:STOP)
+	echo ${UNAME_MACHINE}-unknown-stop
+	exit 0 ;;
+    i*86:atheos:*:*)
+	echo ${UNAME_MACHINE}-unknown-atheos
+	exit 0 ;;
+    i*86:LynxOS:2.*:* | i*86:LynxOS:3.[01]*:* | i*86:LynxOS:4.0*:*)
+	echo i386-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    i*86:*DOS:*:*)
+	echo ${UNAME_MACHINE}-pc-msdosdjgpp
+	exit 0 ;;
+    i*86:*:4.*:* | i*86:SYSTEM_V:4.*:*)
+	UNAME_REL=`echo ${UNAME_RELEASE} | sed 's/\/MP$//'`
+	if grep Novell /usr/include/link.h >/dev/null 2>/dev/null; then
+		echo ${UNAME_MACHINE}-univel-sysv${UNAME_REL}
+	else
+		echo ${UNAME_MACHINE}-pc-sysv${UNAME_REL}
+	fi
+	exit 0 ;;
+    i*86:*:5:[78]*)
+	case `/bin/uname -X | grep "^Machine"` in
+	    *486*)	     UNAME_MACHINE=i486 ;;
+	    *Pentium)	     UNAME_MACHINE=i586 ;;
+	    *Pent*|*Celeron) UNAME_MACHINE=i686 ;;
+	esac
+	echo ${UNAME_MACHINE}-unknown-sysv${UNAME_RELEASE}${UNAME_SYSTEM}${UNAME_VERSION}
+	exit 0 ;;
+    i*86:*:3.2:*)
+	if test -f /usr/options/cb.name; then
+		UNAME_REL=`sed -n 's/.*Version //p' </usr/options/cb.name`
+		echo ${UNAME_MACHINE}-pc-isc$UNAME_REL
+	elif /bin/uname -X 2>/dev/null >/dev/null ; then
+		UNAME_REL=`(/bin/uname -X|grep Release|sed -e 's/.*= //')`
+		(/bin/uname -X|grep i80486 >/dev/null) && UNAME_MACHINE=i486
+		(/bin/uname -X|grep '^Machine.*Pentium' >/dev/null) \
+			&& UNAME_MACHINE=i586
+		(/bin/uname -X|grep '^Machine.*Pent *II' >/dev/null) \
+			&& UNAME_MACHINE=i686
+		(/bin/uname -X|grep '^Machine.*Pentium Pro' >/dev/null) \
+			&& UNAME_MACHINE=i686
+		echo ${UNAME_MACHINE}-pc-sco$UNAME_REL
+	else
+		echo ${UNAME_MACHINE}-pc-sysv32
+	fi
+	exit 0 ;;
+    pc:*:*:*)
+	# Left here for compatibility:
+        # uname -m prints for DJGPP always 'pc', but it prints nothing about
+        # the processor, so we play safe by assuming i386.
+	echo i386-pc-msdosdjgpp
+        exit 0 ;;
+    Intel:Mach:3*:*)
+	echo i386-pc-mach3
+	exit 0 ;;
+    paragon:*:*:*)
+	echo i860-intel-osf1
+	exit 0 ;;
+    i860:*:4.*:*) # i860-SVR4
+	if grep Stardent /usr/include/sys/uadmin.h >/dev/null 2>&1 ; then
+	  echo i860-stardent-sysv${UNAME_RELEASE} # Stardent Vistra i860-SVR4
+	else # Add other i860-SVR4 vendors below as they are discovered.
+	  echo i860-unknown-sysv${UNAME_RELEASE}  # Unknown i860-SVR4
+	fi
+	exit 0 ;;
+    mini*:CTIX:SYS*5:*)
+	# "miniframe"
+	echo m68010-convergent-sysv
+	exit 0 ;;
+    mc68k:UNIX:SYSTEM5:3.51m)
+	echo m68k-convergent-sysv
+	exit 0 ;;
+    M680?0:D-NIX:5.3:*)
+	echo m68k-diab-dnix
+	exit 0 ;;
+    M68*:*:R3V[567]*:*)
+	test -r /sysV68 && echo 'm68k-motorola-sysv' && exit 0 ;;
+    3[34]??:*:4.0:3.0 | 3[34]??A:*:4.0:3.0 | 3[34]??,*:*:4.0:3.0 | 3[34]??/*:*:4.0:3.0 | 4400:*:4.0:3.0 | 4850:*:4.0:3.0 | SKA40:*:4.0:3.0 | SDS2:*:4.0:3.0)
+	OS_REL=''
+	test -r /etc/.relid \
+	&& OS_REL=.`sed -n 's/[^ ]* [^ ]* \([0-9][0-9]\).*/\1/p' < /etc/.relid`
+	/bin/uname -p 2>/dev/null | grep 86 >/dev/null \
+	  && echo i486-ncr-sysv4.3${OS_REL} && exit 0
+	/bin/uname -p 2>/dev/null | /bin/grep entium >/dev/null \
+	  && echo i586-ncr-sysv4.3${OS_REL} && exit 0 ;;
+    3[34]??:*:4.0:* | 3[34]??,*:*:4.0:*)
+        /bin/uname -p 2>/dev/null | grep 86 >/dev/null \
+          && echo i486-ncr-sysv4 && exit 0 ;;
+    m68*:LynxOS:2.*:* | m68*:LynxOS:3.0*:*)
+	echo m68k-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    mc68030:UNIX_System_V:4.*:*)
+	echo m68k-atari-sysv4
+	exit 0 ;;
+    TSUNAMI:LynxOS:2.*:*)
+	echo sparc-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    rs6000:LynxOS:2.*:*)
+	echo rs6000-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    PowerPC:LynxOS:2.*:* | PowerPC:LynxOS:3.[01]*:* | PowerPC:LynxOS:4.0*:*)
+	echo powerpc-unknown-lynxos${UNAME_RELEASE}
+	exit 0 ;;
+    SM[BE]S:UNIX_SV:*:*)
+	echo mips-dde-sysv${UNAME_RELEASE}
+	exit 0 ;;
+    RM*:ReliantUNIX-*:*:*)
+	echo mips-sni-sysv4
+	exit 0 ;;
+    RM*:SINIX-*:*:*)
+	echo mips-sni-sysv4
+	exit 0 ;;
+    *:SINIX-*:*:*)
+	if uname -p 2>/dev/null >/dev/null ; then
+		UNAME_MACHINE=`(uname -p) 2>/dev/null`
+		echo ${UNAME_MACHINE}-sni-sysv4
+	else
+		echo ns32k-sni-sysv
+	fi
+	exit 0 ;;
+    PENTIUM:*:4.0*:*) # Unisys `ClearPath HMP IX 4000' SVR4/MP effort
+                      # says <Richard.M.Bartel@ccMail.Census.GOV>
+        echo i586-unisys-sysv4
+        exit 0 ;;
+    *:UNIX_System_V:4*:FTX*)
+	# From Gerald Hewes <hewes@openmarket.com>.
+	# How about differentiating between stratus architectures? -djm
+	echo hppa1.1-stratus-sysv4
+	exit 0 ;;
+    *:*:*:FTX*)
+	# From seanf@swdc.stratus.com.
+	echo i860-stratus-sysv4
+	exit 0 ;;
+    *:VOS:*:*)
+	# From Paul.Green@stratus.com.
+	echo hppa1.1-stratus-vos
+	exit 0 ;;
+    mc68*:A/UX:*:*)
+	echo m68k-apple-aux${UNAME_RELEASE}
+	exit 0 ;;
+    news*:NEWS-OS:6*:*)
+	echo mips-sony-newsos6
+	exit 0 ;;
+    R[34]000:*System_V*:*:* | R4000:UNIX_SYSV:*:* | R*000:UNIX_SV:*:*)
+	if [ -d /usr/nec ]; then
+	        echo mips-nec-sysv${UNAME_RELEASE}
+	else
+	        echo mips-unknown-sysv${UNAME_RELEASE}
+	fi
+        exit 0 ;;
+    BeBox:BeOS:*:*)	# BeOS running on hardware made by Be, PPC only.
+	echo powerpc-be-beos
+	exit 0 ;;
+    BeMac:BeOS:*:*)	# BeOS running on Mac or Mac clone, PPC only.
+	echo powerpc-apple-beos
+	exit 0 ;;
+    BePC:BeOS:*:*)	# BeOS running on Intel PC compatible.
+	echo i586-pc-beos
+	exit 0 ;;
+    SX-4:SUPER-UX:*:*)
+	echo sx4-nec-superux${UNAME_RELEASE}
+	exit 0 ;;
+    SX-5:SUPER-UX:*:*)
+	echo sx5-nec-superux${UNAME_RELEASE}
+	exit 0 ;;
+    SX-6:SUPER-UX:*:*)
+	echo sx6-nec-superux${UNAME_RELEASE}
+	exit 0 ;;
+    Power*:Rhapsody:*:*)
+	echo powerpc-apple-rhapsody${UNAME_RELEASE}
+	exit 0 ;;
+    *:Rhapsody:*:*)
+	echo ${UNAME_MACHINE}-apple-rhapsody${UNAME_RELEASE}
+	exit 0 ;;
+    *:Darwin:*:*)
+	case `uname -p` in
+	    *86) UNAME_PROCESSOR=i686 ;;
+	    powerpc) UNAME_PROCESSOR=powerpc ;;
+	esac
+	echo ${UNAME_PROCESSOR}-apple-darwin${UNAME_RELEASE}
+	exit 0 ;;
+    *:procnto*:*:* | *:QNX:[0123456789]*:*)
+	UNAME_PROCESSOR=`uname -p`
+	if test "$UNAME_PROCESSOR" = "x86"; then
+		UNAME_PROCESSOR=i386
+		UNAME_MACHINE=pc
+	fi
+	echo ${UNAME_PROCESSOR}-${UNAME_MACHINE}-nto-qnx${UNAME_RELEASE}
+	exit 0 ;;
+    *:QNX:*:4*)
+	echo i386-pc-qnx
+	exit 0 ;;
+    NSR-[DGKLNPTVW]:NONSTOP_KERNEL:*:*)
+	echo nsr-tandem-nsk${UNAME_RELEASE}
+	exit 0 ;;
+    *:NonStop-UX:*:*)
+	echo mips-compaq-nonstopux
+	exit 0 ;;
+    BS2000:POSIX*:*:*)
+	echo bs2000-siemens-sysv
+	exit 0 ;;
+    DS/*:UNIX_System_V:*:*)
+	echo ${UNAME_MACHINE}-${UNAME_SYSTEM}-${UNAME_RELEASE}
+	exit 0 ;;
+    *:Plan9:*:*)
+	# "uname -m" is not consistent, so use $cputype instead. 386
+	# is converted to i386 for consistency with other x86
+	# operating systems.
+	if test "$cputype" = "386"; then
+	    UNAME_MACHINE=i386
+	else
+	    UNAME_MACHINE="$cputype"
+	fi
+	echo ${UNAME_MACHINE}-unknown-plan9
+	exit 0 ;;
+    *:TOPS-10:*:*)
+	echo pdp10-unknown-tops10
+	exit 0 ;;
+    *:TENEX:*:*)
+	echo pdp10-unknown-tenex
+	exit 0 ;;
+    KS10:TOPS-20:*:* | KL10:TOPS-20:*:* | TYPE4:TOPS-20:*:*)
+	echo pdp10-dec-tops20
+	exit 0 ;;
+    XKL-1:TOPS-20:*:* | TYPE5:TOPS-20:*:*)
+	echo pdp10-xkl-tops20
+	exit 0 ;;
+    *:TOPS-20:*:*)
+	echo pdp10-unknown-tops20
+	exit 0 ;;
+    *:ITS:*:*)
+	echo pdp10-unknown-its
+	exit 0 ;;
+esac
+
+#echo '(No uname command or uname output not recognized.)' 1>&2
+#echo "${UNAME_MACHINE}:${UNAME_SYSTEM}:${UNAME_RELEASE}:${UNAME_VERSION}" 1>&2
+
+eval $set_cc_for_build
+cat >$dummy.c <<EOF
+#ifdef _SEQUENT_
+# include <sys/types.h>
+# include <sys/utsname.h>
+#endif
+main ()
+{
+#if defined (sony)
+#if defined (MIPSEB)
+  /* BFD wants "bsd" instead of "newsos".  Perhaps BFD should be changed,
+     I don't know....  */
+  printf ("mips-sony-bsd\n"); exit (0);
+#else
+#include <sys/param.h>
+  printf ("m68k-sony-newsos%s\n",
+#ifdef NEWSOS4
+          "4"
+#else
+	  ""
+#endif
+         ); exit (0);
+#endif
+#endif
+
+#if defined (__arm) && defined (__acorn) && defined (__unix)
+  printf ("arm-acorn-riscix"); exit (0);
+#endif
+
+#if defined (hp300) && !defined (hpux)
+  printf ("m68k-hp-bsd\n"); exit (0);
+#endif
+
+#if defined (NeXT)
+#if !defined (__ARCHITECTURE__)
+#define __ARCHITECTURE__ "m68k"
+#endif
+  int version;
+  version=`(hostinfo | sed -n 's/.*NeXT Mach \([0-9]*\).*/\1/p') 2>/dev/null`;
+  if (version < 4)
+    printf ("%s-next-nextstep%d\n", __ARCHITECTURE__, version);
+  else
+    printf ("%s-next-openstep%d\n", __ARCHITECTURE__, version);
+  exit (0);
+#endif
+
+#if defined (MULTIMAX) || defined (n16)
+#if defined (UMAXV)
+  printf ("ns32k-encore-sysv\n"); exit (0);
+#else
+#if defined (CMU)
+  printf ("ns32k-encore-mach\n"); exit (0);
+#else
+  printf ("ns32k-encore-bsd\n"); exit (0);
+#endif
+#endif
+#endif
+
+#if defined (__386BSD__)
+  printf ("i386-pc-bsd\n"); exit (0);
+#endif
+
+#if defined (sequent)
+#if defined (i386)
+  printf ("i386-sequent-dynix\n"); exit (0);
+#endif
+#if defined (ns32000)
+  printf ("ns32k-sequent-dynix\n"); exit (0);
+#endif
+#endif
+
+#if defined (_SEQUENT_)
+    struct utsname un;
+
+    uname(&un);
+
+    if (strncmp(un.version, "V2", 2) == 0) {
+	printf ("i386-sequent-ptx2\n"); exit (0);
+    }
+    if (strncmp(un.version, "V1", 2) == 0) { /* XXX is V1 correct? */
+	printf ("i386-sequent-ptx1\n"); exit (0);
+    }
+    printf ("i386-sequent-ptx\n"); exit (0);
+
+#endif
+
+#if defined (vax)
+# if !defined (ultrix)
+#  include <sys/param.h>
+#  if defined (BSD)
+#   if BSD == 43
+      printf ("vax-dec-bsd4.3\n"); exit (0);
+#   else
+#    if BSD == 199006
+      printf ("vax-dec-bsd4.3reno\n"); exit (0);
+#    else
+      printf ("vax-dec-bsd\n"); exit (0);
+#    endif
+#   endif
+#  else
+    printf ("vax-dec-bsd\n"); exit (0);
+#  endif
+# else
+    printf ("vax-dec-ultrix\n"); exit (0);
+# endif
+#endif
+
+#if defined (alliant) && defined (i860)
+  printf ("i860-alliant-bsd\n"); exit (0);
+#endif
+
+  exit (1);
+}
+EOF
+
+$CC_FOR_BUILD -o $dummy $dummy.c 2>/dev/null && $dummy && exit 0
+
+# Apollos put the system type in the environment.
+
+test -d /usr/apollo && { echo ${ISP}-apollo-${SYSTYPE}; exit 0; }
+
+# Convex versions that predate uname can use getsysinfo(1)
+
+if [ -x /usr/convex/getsysinfo ]
+then
+    case `getsysinfo -f cpu_type` in
+    c1*)
+	echo c1-convex-bsd
+	exit 0 ;;
+    c2*)
+	if getsysinfo -f scalar_acc
+	then echo c32-convex-bsd
+	else echo c2-convex-bsd
+	fi
+	exit 0 ;;
+    c34*)
+	echo c34-convex-bsd
+	exit 0 ;;
+    c38*)
+	echo c38-convex-bsd
+	exit 0 ;;
+    c4*)
+	echo c4-convex-bsd
+	exit 0 ;;
+    esac
+fi
+
+cat >&2 <<EOF
+$0: unable to guess system type
+
+This script, last modified $timestamp, has failed to recognize
+the operating system you are using. It is advised that you
+download the most up to date version of the config scripts from
+
+    ftp://ftp.gnu.org/pub/gnu/config/
+
+If the version you run ($0) is already up to date, please
+send the following data and any information you think might be
+pertinent to <config-patches@gnu.org> in order to provide the needed
+information to handle your system.
+
+config.guess timestamp = $timestamp
+
+uname -m = `(uname -m) 2>/dev/null || echo unknown`
+uname -r = `(uname -r) 2>/dev/null || echo unknown`
+uname -s = `(uname -s) 2>/dev/null || echo unknown`
+uname -v = `(uname -v) 2>/dev/null || echo unknown`
+
+/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null`
+/bin/uname -X     = `(/bin/uname -X) 2>/dev/null`
+
+hostinfo               = `(hostinfo) 2>/dev/null`
+/bin/universe          = `(/bin/universe) 2>/dev/null`
+/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null`
+/bin/arch              = `(/bin/arch) 2>/dev/null`
+/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null`
+/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null`
+
+UNAME_MACHINE = ${UNAME_MACHINE}
+UNAME_RELEASE = ${UNAME_RELEASE}
+UNAME_SYSTEM  = ${UNAME_SYSTEM}
+UNAME_VERSION = ${UNAME_VERSION}
+EOF
+
+exit 1
+
+# Local variables:
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "timestamp='"
+# time-stamp-format: "%:y-%02m-%02d"
+# time-stamp-end: "'"
+# End:
diff -urN cctools-806-old/config.sub cctools-806/config.sub
--- cctools-806-old/config.sub	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/config.sub	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1489 @@
+#! /bin/sh
+# Configuration validation subroutine script.
+#   Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999,
+#   2000, 2001, 2002, 2003 Free Software Foundation, Inc.
+
+timestamp='2003-02-22'
+
+# This file is (in principle) common to ALL GNU software.
+# The presence of a machine in this file suggests that SOME GNU software
+# can handle that machine.  It does not imply ALL GNU software can.
+#
+# This file is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2 of the License, or
+# (at your option) any later version.
+#
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+#
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330,
+# Boston, MA 02111-1307, USA.
+
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
+
+# Please send patches to <config-patches@gnu.org>.  Submit a context
+# diff and a properly formatted ChangeLog entry.
+#
+# Configuration subroutine to validate and canonicalize a configuration type.
+# Supply the specified configuration type as an argument.
+# If it is invalid, we print an error message on stderr and exit with code 1.
+# Otherwise, we print the canonical config type on stdout and succeed.
+
+# This file is supposed to be the same for all GNU packages
+# and recognize all the CPU types, system types and aliases
+# that are meaningful with *any* GNU software.
+# Each package is responsible for reporting which valid configurations
+# it does not support.  The user should be able to distinguish
+# a failure to support a valid configuration from a meaningless
+# configuration.
+
+# The goal of this file is to map all the various variations of a given
+# machine specification into a single specification in the form:
+#	CPU_TYPE-MANUFACTURER-OPERATING_SYSTEM
+# or in some cases, the newer four-part form:
+#	CPU_TYPE-MANUFACTURER-KERNEL-OPERATING_SYSTEM
+# It is wrong to echo any other type of specification.
+
+me=`echo "$0" | sed -e 's,.*/,,'`
+
+usage="\
+Usage: $0 [OPTION] CPU-MFR-OPSYS
+       $0 [OPTION] ALIAS
+
+Canonicalize a configuration name.
+
+Operation modes:
+  -h, --help         print this help, then exit
+  -t, --time-stamp   print date of last modification, then exit
+  -v, --version      print version number, then exit
+
+Report bugs and patches to <config-patches@gnu.org>."
+
+version="\
+GNU config.sub ($timestamp)
+
+Copyright (C) 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001
+Free Software Foundation, Inc.
+
+This is free software; see the source for copying conditions.  There is NO
+warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE."
+
+help="
+Try \`$me --help' for more information."
+
+# Parse command line
+while test $# -gt 0 ; do
+  case $1 in
+    --time-stamp | --time* | -t )
+       echo "$timestamp" ; exit 0 ;;
+    --version | -v )
+       echo "$version" ; exit 0 ;;
+    --help | --h* | -h )
+       echo "$usage"; exit 0 ;;
+    -- )     # Stop option processing
+       shift; break ;;
+    - )	# Use stdin as input.
+       break ;;
+    -* )
+       echo "$me: invalid option $1$help"
+       exit 1 ;;
+
+    *local*)
+       # First pass through any local machine types.
+       echo $1
+       exit 0;;
+
+    * )
+       break ;;
+  esac
+done
+
+case $# in
+ 0) echo "$me: missing argument$help" >&2
+    exit 1;;
+ 1) ;;
+ *) echo "$me: too many arguments$help" >&2
+    exit 1;;
+esac
+
+# Separate what the user gave into CPU-COMPANY and OS or KERNEL-OS (if any).
+# Here we must recognize all the valid KERNEL-OS combinations.
+maybe_os=`echo $1 | sed 's/^\(.*\)-\([^-]*-[^-]*\)$/\2/'`
+case $maybe_os in
+  nto-qnx* | linux-gnu* | freebsd*-gnu* | netbsd*-gnu* | storm-chaos* | os2-emx* | rtmk-nova*)
+    os=-$maybe_os
+    basic_machine=`echo $1 | sed 's/^\(.*\)-\([^-]*-[^-]*\)$/\1/'`
+    ;;
+  *)
+    basic_machine=`echo $1 | sed 's/-[^-]*$//'`
+    if [ $basic_machine != $1 ]
+    then os=`echo $1 | sed 's/.*-/-/'`
+    else os=; fi
+    ;;
+esac
+
+### Let's recognize common machines as not being operating systems so
+### that things like config.sub decstation-3100 work.  We also
+### recognize some manufacturers as not being operating systems, so we
+### can provide default operating systems below.
+case $os in
+	-sun*os*)
+		# Prevent following clause from handling this invalid input.
+		;;
+	-dec* | -mips* | -sequent* | -encore* | -pc532* | -sgi* | -sony* | \
+	-att* | -7300* | -3300* | -delta* | -motorola* | -sun[234]* | \
+	-unicom* | -ibm* | -next | -hp | -isi* | -apollo | -altos* | \
+	-convergent* | -ncr* | -news | -32* | -3600* | -3100* | -hitachi* |\
+	-c[123]* | -convex* | -sun | -crds | -omron* | -dg | -ultra | -tti* | \
+	-harris | -dolphin | -highlevel | -gould | -cbm | -ns | -masscomp | \
+	-apple | -axis)
+		os=
+		basic_machine=$1
+		;;
+	-sim | -cisco | -oki | -wec | -winbond)
+		os=
+		basic_machine=$1
+		;;
+	-scout)
+		;;
+	-wrs)
+		os=-vxworks
+		basic_machine=$1
+		;;
+	-chorusos*)
+		os=-chorusos
+		basic_machine=$1
+		;;
+ 	-chorusrdb)
+ 		os=-chorusrdb
+		basic_machine=$1
+ 		;;
+	-hiux*)
+		os=-hiuxwe2
+		;;
+	-sco5)
+		os=-sco3.2v5
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-sco4)
+		os=-sco3.2v4
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-sco3.2.[4-9]*)
+		os=`echo $os | sed -e 's/sco3.2./sco3.2v/'`
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-sco3.2v[4-9]*)
+		# Don't forget version if it is 3.2v4 or newer.
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-sco*)
+		os=-sco3.2v2
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-udk*)
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-isc)
+		os=-isc2.2
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-clix*)
+		basic_machine=clipper-intergraph
+		;;
+	-isc*)
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-pc/'`
+		;;
+	-lynx*)
+		os=-lynxos
+		;;
+	-ptx*)
+		basic_machine=`echo $1 | sed -e 's/86-.*/86-sequent/'`
+		;;
+	-windowsnt*)
+		os=`echo $os | sed -e 's/windowsnt/winnt/'`
+		;;
+	-psos*)
+		os=-psos
+		;;
+	-mint | -mint[0-9]*)
+		basic_machine=m68k-atari
+		os=-mint
+		;;
+esac
+
+# Decode aliases for certain CPU-COMPANY combinations.
+case $basic_machine in
+	# Recognize the basic CPU types without company name.
+	# Some are omitted here because they have special meanings below.
+	1750a | 580 \
+	| a29k \
+	| alpha | alphaev[4-8] | alphaev56 | alphaev6[78] | alphapca5[67] \
+	| alpha64 | alpha64ev[4-8] | alpha64ev56 | alpha64ev6[78] | alpha64pca5[67] \
+	| arc | arm | arm[bl]e | arme[lb] | armv[2345] | armv[345][lb] | avr \
+	| clipper \
+	| d10v | d30v | dlx | dsp16xx \
+	| fr30 | frv \
+	| h8300 | h8500 | hppa | hppa1.[01] | hppa2.0 | hppa2.0[nw] | hppa64 \
+	| i370 | i860 | i960 | ia64 \
+	| ip2k \
+	| m32r | m68000 | m68k | m88k | mcore \
+	| mips | mipsbe | mipseb | mipsel | mipsle \
+	| mips16 \
+	| mips64 | mips64el \
+	| mips64vr | mips64vrel \
+	| mips64orion | mips64orionel \
+	| mips64vr4100 | mips64vr4100el \
+	| mips64vr4300 | mips64vr4300el \
+	| mips64vr5000 | mips64vr5000el \
+	| mipsisa32 | mipsisa32el \
+	| mipsisa32r2 | mipsisa32r2el \
+	| mipsisa64 | mipsisa64el \
+	| mipsisa64sb1 | mipsisa64sb1el \
+	| mipsisa64sr71k | mipsisa64sr71kel \
+	| mipstx39 | mipstx39el \
+	| mn10200 | mn10300 \
+	| msp430 \
+	| ns16k | ns32k \
+	| openrisc | or32 \
+	| pdp10 | pdp11 | pj | pjl \
+	| powerpc | powerpc64 | powerpc64le | powerpcle | ppcbe \
+	| pyramid \
+	| sh | sh[1234] | sh[23]e | sh[34]eb | shbe | shle | sh[1234]le | sh3ele \
+	| sh64 | sh64le \
+	| sparc | sparc64 | sparc86x | sparclet | sparclite | sparcv9 | sparcv9b \
+	| strongarm \
+	| tahoe | thumb | tic80 | tron \
+	| v850 | v850e \
+	| we32k \
+	| x86 | xscale | xstormy16 | xtensa \
+	| z8k)
+		basic_machine=$basic_machine-unknown
+		;;
+	m6811 | m68hc11 | m6812 | m68hc12)
+		# Motorola 68HC11/12.
+		basic_machine=$basic_machine-unknown
+		os=-none
+		;;
+	m88110 | m680[12346]0 | m683?2 | m68360 | m5200 | v70 | w65 | z8k)
+		;;
+
+	# We use `pc' rather than `unknown'
+	# because (1) that's what they normally are, and
+	# (2) the word "unknown" tends to confuse beginning users.
+	i*86 | x86_64)
+	  basic_machine=$basic_machine-pc
+	  ;;
+	# Object if more than one company name word.
+	*-*-*)
+		echo Invalid configuration \`$1\': machine \`$basic_machine\' not recognized 1>&2
+		exit 1
+		;;
+	# Recognize the basic CPU types with company name.
+	580-* \
+	| a29k-* \
+	| alpha-* | alphaev[4-8]-* | alphaev56-* | alphaev6[78]-* \
+	| alpha64-* | alpha64ev[4-8]-* | alpha64ev56-* | alpha64ev6[78]-* \
+	| alphapca5[67]-* | alpha64pca5[67]-* | arc-* \
+	| arm-*  | armbe-* | armle-* | armeb-* | armv*-* \
+	| avr-* \
+	| bs2000-* \
+	| c[123]* | c30-* | [cjt]90-* | c4x-* | c54x-* | c55x-* | c6x-* \
+	| clipper-* | cydra-* \
+	| d10v-* | d30v-* | dlx-* \
+	| elxsi-* \
+	| f30[01]-* | f700-* | fr30-* | frv-* | fx80-* \
+	| h8300-* | h8500-* \
+	| hppa-* | hppa1.[01]-* | hppa2.0-* | hppa2.0[nw]-* | hppa64-* \
+	| i*86-* | i860-* | i960-* | ia64-* \
+	| ip2k-* \
+	| m32r-* \
+	| m68000-* | m680[012346]0-* | m68360-* | m683?2-* | m68k-* \
+	| m88110-* | m88k-* | mcore-* \
+	| mips-* | mipsbe-* | mipseb-* | mipsel-* | mipsle-* \
+	| mips16-* \
+	| mips64-* | mips64el-* \
+	| mips64vr-* | mips64vrel-* \
+	| mips64orion-* | mips64orionel-* \
+	| mips64vr4100-* | mips64vr4100el-* \
+	| mips64vr4300-* | mips64vr4300el-* \
+	| mips64vr5000-* | mips64vr5000el-* \
+	| mipsisa32-* | mipsisa32el-* \
+	| mipsisa32r2-* | mipsisa32r2el-* \
+	| mipsisa64-* | mipsisa64el-* \
+	| mipsisa64sb1-* | mipsisa64sb1el-* \
+	| mipsisa64sr71k-* | mipsisa64sr71kel-* \
+	| mipstx39-* | mipstx39el-* \
+	| msp430-* \
+	| none-* | np1-* | nv1-* | ns16k-* | ns32k-* \
+	| orion-* \
+	| pdp10-* | pdp11-* | pj-* | pjl-* | pn-* | power-* \
+	| powerpc-* | powerpc64-* | powerpc64le-* | powerpcle-* | ppcbe-* \
+	| pyramid-* \
+	| romp-* | rs6000-* \
+	| sh-* | sh[1234]-* | sh[23]e-* | sh[34]eb-* | shbe-* \
+	| shle-* | sh[1234]le-* | sh3ele-* | sh64-* | sh64le-* \
+	| sparc-* | sparc64-* | sparc86x-* | sparclet-* | sparclite-* \
+	| sparcv9-* | sparcv9b-* | strongarm-* | sv1-* | sx?-* \
+	| tahoe-* | thumb-* \
+	| tic30-* | tic4x-* | tic54x-* | tic55x-* | tic6x-* | tic80-* \
+	| tron-* \
+	| v850-* | v850e-* | vax-* \
+	| we32k-* \
+	| x86-* | x86_64-* | xps100-* | xscale-* | xstormy16-* \
+	| xtensa-* \
+	| ymp-* \
+	| z8k-*)
+		;;
+	# Recognize the various machine names and aliases which stand
+	# for a CPU type and a company and sometimes even an OS.
+	386bsd)
+		basic_machine=i386-unknown
+		os=-bsd
+		;;
+	3b1 | 7300 | 7300-att | att-7300 | pc7300 | safari | unixpc)
+		basic_machine=m68000-att
+		;;
+	3b*)
+		basic_machine=we32k-att
+		;;
+	a29khif)
+		basic_machine=a29k-amd
+		os=-udi
+		;;
+	adobe68k)
+		basic_machine=m68010-adobe
+		os=-scout
+		;;
+	alliant | fx80)
+		basic_machine=fx80-alliant
+		;;
+	altos | altos3068)
+		basic_machine=m68k-altos
+		;;
+	am29k)
+		basic_machine=a29k-none
+		os=-bsd
+		;;
+	amdahl)
+		basic_machine=580-amdahl
+		os=-sysv
+		;;
+	amiga | amiga-*)
+		basic_machine=m68k-unknown
+		;;
+	amigaos | amigados)
+		basic_machine=m68k-unknown
+		os=-amigaos
+		;;
+	amigaunix | amix)
+		basic_machine=m68k-unknown
+		os=-sysv4
+		;;
+	apollo68)
+		basic_machine=m68k-apollo
+		os=-sysv
+		;;
+	apollo68bsd)
+		basic_machine=m68k-apollo
+		os=-bsd
+		;;
+	aux)
+		basic_machine=m68k-apple
+		os=-aux
+		;;
+	balance)
+		basic_machine=ns32k-sequent
+		os=-dynix
+		;;
+	c90)
+		basic_machine=c90-cray
+		os=-unicos
+		;;
+	convex-c1)
+		basic_machine=c1-convex
+		os=-bsd
+		;;
+	convex-c2)
+		basic_machine=c2-convex
+		os=-bsd
+		;;
+	convex-c32)
+		basic_machine=c32-convex
+		os=-bsd
+		;;
+	convex-c34)
+		basic_machine=c34-convex
+		os=-bsd
+		;;
+	convex-c38)
+		basic_machine=c38-convex
+		os=-bsd
+		;;
+	cray | j90)
+		basic_machine=j90-cray
+		os=-unicos
+		;;
+	crds | unos)
+		basic_machine=m68k-crds
+		;;
+	cris | cris-* | etrax*)
+		basic_machine=cris-axis
+		;;
+	da30 | da30-*)
+		basic_machine=m68k-da30
+		;;
+	decstation | decstation-3100 | pmax | pmax-* | pmin | dec3100 | decstatn)
+		basic_machine=mips-dec
+		;;
+	decsystem10* | dec10*)
+		basic_machine=pdp10-dec
+		os=-tops10
+		;;
+	decsystem20* | dec20*)
+		basic_machine=pdp10-dec
+		os=-tops20
+		;;
+	delta | 3300 | motorola-3300 | motorola-delta \
+	      | 3300-motorola | delta-motorola)
+		basic_machine=m68k-motorola
+		;;
+	delta88)
+		basic_machine=m88k-motorola
+		os=-sysv3
+		;;
+	dpx20 | dpx20-*)
+		basic_machine=rs6000-bull
+		os=-bosx
+		;;
+	dpx2* | dpx2*-bull)
+		basic_machine=m68k-bull
+		os=-sysv3
+		;;
+	ebmon29k)
+		basic_machine=a29k-amd
+		os=-ebmon
+		;;
+	elxsi)
+		basic_machine=elxsi-elxsi
+		os=-bsd
+		;;
+	encore | umax | mmax)
+		basic_machine=ns32k-encore
+		;;
+	es1800 | OSE68k | ose68k | ose | OSE)
+		basic_machine=m68k-ericsson
+		os=-ose
+		;;
+	fx2800)
+		basic_machine=i860-alliant
+		;;
+	genix)
+		basic_machine=ns32k-ns
+		;;
+	gmicro)
+		basic_machine=tron-gmicro
+		os=-sysv
+		;;
+	go32)
+		basic_machine=i386-pc
+		os=-go32
+		;;
+	h3050r* | hiux*)
+		basic_machine=hppa1.1-hitachi
+		os=-hiuxwe2
+		;;
+	h8300hms)
+		basic_machine=h8300-hitachi
+		os=-hms
+		;;
+	h8300xray)
+		basic_machine=h8300-hitachi
+		os=-xray
+		;;
+	h8500hms)
+		basic_machine=h8500-hitachi
+		os=-hms
+		;;
+	harris)
+		basic_machine=m88k-harris
+		os=-sysv3
+		;;
+	hp300-*)
+		basic_machine=m68k-hp
+		;;
+	hp300bsd)
+		basic_machine=m68k-hp
+		os=-bsd
+		;;
+	hp300hpux)
+		basic_machine=m68k-hp
+		os=-hpux
+		;;
+	hp3k9[0-9][0-9] | hp9[0-9][0-9])
+		basic_machine=hppa1.0-hp
+		;;
+	hp9k2[0-9][0-9] | hp9k31[0-9])
+		basic_machine=m68000-hp
+		;;
+	hp9k3[2-9][0-9])
+		basic_machine=m68k-hp
+		;;
+	hp9k6[0-9][0-9] | hp6[0-9][0-9])
+		basic_machine=hppa1.0-hp
+		;;
+	hp9k7[0-79][0-9] | hp7[0-79][0-9])
+		basic_machine=hppa1.1-hp
+		;;
+	hp9k78[0-9] | hp78[0-9])
+		# FIXME: really hppa2.0-hp
+		basic_machine=hppa1.1-hp
+		;;
+	hp9k8[67]1 | hp8[67]1 | hp9k80[24] | hp80[24] | hp9k8[78]9 | hp8[78]9 | hp9k893 | hp893)
+		# FIXME: really hppa2.0-hp
+		basic_machine=hppa1.1-hp
+		;;
+	hp9k8[0-9][13679] | hp8[0-9][13679])
+		basic_machine=hppa1.1-hp
+		;;
+	hp9k8[0-9][0-9] | hp8[0-9][0-9])
+		basic_machine=hppa1.0-hp
+		;;
+	hppa-next)
+		os=-nextstep3
+		;;
+	hppaosf)
+		basic_machine=hppa1.1-hp
+		os=-osf
+		;;
+	hppro)
+		basic_machine=hppa1.1-hp
+		os=-proelf
+		;;
+	i370-ibm* | ibm*)
+		basic_machine=i370-ibm
+		;;
+# I'm not sure what "Sysv32" means.  Should this be sysv3.2?
+	i*86v32)
+		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
+		os=-sysv32
+		;;
+	i*86v4*)
+		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
+		os=-sysv4
+		;;
+	i*86v)
+		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
+		os=-sysv
+		;;
+	i*86sol2)
+		basic_machine=`echo $1 | sed -e 's/86.*/86-pc/'`
+		os=-solaris2
+		;;
+	i386mach)
+		basic_machine=i386-mach
+		os=-mach
+		;;
+	i386-vsta | vsta)
+		basic_machine=i386-unknown
+		os=-vsta
+		;;
+	iris | iris4d)
+		basic_machine=mips-sgi
+		case $os in
+		    -irix*)
+			;;
+		    *)
+			os=-irix4
+			;;
+		esac
+		;;
+	isi68 | isi)
+		basic_machine=m68k-isi
+		os=-sysv
+		;;
+	m88k-omron*)
+		basic_machine=m88k-omron
+		;;
+	magnum | m3230)
+		basic_machine=mips-mips
+		os=-sysv
+		;;
+	merlin)
+		basic_machine=ns32k-utek
+		os=-sysv
+		;;
+	mingw32)
+		basic_machine=i386-pc
+		os=-mingw32
+		;;
+	miniframe)
+		basic_machine=m68000-convergent
+		;;
+	*mint | -mint[0-9]* | *MiNT | *MiNT[0-9]*)
+		basic_machine=m68k-atari
+		os=-mint
+		;;
+	mips3*-*)
+		basic_machine=`echo $basic_machine | sed -e 's/mips3/mips64/'`
+		;;
+	mips3*)
+		basic_machine=`echo $basic_machine | sed -e 's/mips3/mips64/'`-unknown
+		;;
+	mmix*)
+		basic_machine=mmix-knuth
+		os=-mmixware
+		;;
+	monitor)
+		basic_machine=m68k-rom68k
+		os=-coff
+		;;
+	morphos)
+		basic_machine=powerpc-unknown
+		os=-morphos
+		;;
+	msdos)
+		basic_machine=i386-pc
+		os=-msdos
+		;;
+	mvs)
+		basic_machine=i370-ibm
+		os=-mvs
+		;;
+	ncr3000)
+		basic_machine=i486-ncr
+		os=-sysv4
+		;;
+	netbsd386)
+		basic_machine=i386-unknown
+		os=-netbsd
+		;;
+	netwinder)
+		basic_machine=armv4l-rebel
+		os=-linux
+		;;
+	news | news700 | news800 | news900)
+		basic_machine=m68k-sony
+		os=-newsos
+		;;
+	news1000)
+		basic_machine=m68030-sony
+		os=-newsos
+		;;
+	news-3600 | risc-news)
+		basic_machine=mips-sony
+		os=-newsos
+		;;
+	necv70)
+		basic_machine=v70-nec
+		os=-sysv
+		;;
+	next | m*-next )
+		basic_machine=m68k-next
+		case $os in
+		    -nextstep* )
+			;;
+		    -ns2*)
+		      os=-nextstep2
+			;;
+		    *)
+		      os=-nextstep3
+			;;
+		esac
+		;;
+	nh3000)
+		basic_machine=m68k-harris
+		os=-cxux
+		;;
+	nh[45]000)
+		basic_machine=m88k-harris
+		os=-cxux
+		;;
+	nindy960)
+		basic_machine=i960-intel
+		os=-nindy
+		;;
+	mon960)
+		basic_machine=i960-intel
+		os=-mon960
+		;;
+	nonstopux)
+		basic_machine=mips-compaq
+		os=-nonstopux
+		;;
+	np1)
+		basic_machine=np1-gould
+		;;
+	nv1)
+		basic_machine=nv1-cray
+		os=-unicosmp
+		;;
+	nsr-tandem)
+		basic_machine=nsr-tandem
+		;;
+	op50n-* | op60c-*)
+		basic_machine=hppa1.1-oki
+		os=-proelf
+		;;
+	or32 | or32-*)
+		basic_machine=or32-unknown
+		os=-coff
+		;;
+	OSE68000 | ose68000)
+		basic_machine=m68000-ericsson
+		os=-ose
+		;;
+	os68k)
+		basic_machine=m68k-none
+		os=-os68k
+		;;
+	pa-hitachi)
+		basic_machine=hppa1.1-hitachi
+		os=-hiuxwe2
+		;;
+	paragon)
+		basic_machine=i860-intel
+		os=-osf
+		;;
+	pbd)
+		basic_machine=sparc-tti
+		;;
+	pbb)
+		basic_machine=m68k-tti
+		;;
+	pc532 | pc532-*)
+		basic_machine=ns32k-pc532
+		;;
+	pentium | p5 | k5 | k6 | nexgen | viac3)
+		basic_machine=i586-pc
+		;;
+	pentiumpro | p6 | 6x86 | athlon | athlon_*)
+		basic_machine=i686-pc
+		;;
+	pentiumii | pentium2)
+		basic_machine=i686-pc
+		;;
+	pentium-* | p5-* | k5-* | k6-* | nexgen-* | viac3-*)
+		basic_machine=i586-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	pentiumpro-* | p6-* | 6x86-* | athlon-*)
+		basic_machine=i686-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	pentiumii-* | pentium2-*)
+		basic_machine=i686-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	pn)
+		basic_machine=pn-gould
+		;;
+	power)	basic_machine=power-ibm
+		;;
+	ppc)	basic_machine=powerpc-unknown
+		;;
+	ppc-*)	basic_machine=powerpc-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	ppcle | powerpclittle | ppc-le | powerpc-little)
+		basic_machine=powerpcle-unknown
+		;;
+	ppcle-* | powerpclittle-*)
+		basic_machine=powerpcle-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	ppc64)	basic_machine=powerpc64-unknown
+		;;
+	ppc64-*) basic_machine=powerpc64-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	ppc64le | powerpc64little | ppc64-le | powerpc64-little)
+		basic_machine=powerpc64le-unknown
+		;;
+	ppc64le-* | powerpc64little-*)
+		basic_machine=powerpc64le-`echo $basic_machine | sed 's/^[^-]*-//'`
+		;;
+	ps2)
+		basic_machine=i386-ibm
+		;;
+	pw32)
+		basic_machine=i586-unknown
+		os=-pw32
+		;;
+	rom68k)
+		basic_machine=m68k-rom68k
+		os=-coff
+		;;
+	rm[46]00)
+		basic_machine=mips-siemens
+		;;
+	rtpc | rtpc-*)
+		basic_machine=romp-ibm
+		;;
+	s390 | s390-*)
+		basic_machine=s390-ibm
+		;;
+	s390x | s390x-*)
+		basic_machine=s390x-ibm
+		;;
+	sa29200)
+		basic_machine=a29k-amd
+		os=-udi
+		;;
+	sb1)
+		basic_machine=mipsisa64sb1-unknown
+		;;
+	sb1el)
+		basic_machine=mipsisa64sb1el-unknown
+		;;
+	sequent)
+		basic_machine=i386-sequent
+		;;
+	sh)
+		basic_machine=sh-hitachi
+		os=-hms
+		;;
+	sparclite-wrs | simso-wrs)
+		basic_machine=sparclite-wrs
+		os=-vxworks
+		;;
+	sps7)
+		basic_machine=m68k-bull
+		os=-sysv2
+		;;
+	spur)
+		basic_machine=spur-unknown
+		;;
+	st2000)
+		basic_machine=m68k-tandem
+		;;
+	stratus)
+		basic_machine=i860-stratus
+		os=-sysv4
+		;;
+	sun2)
+		basic_machine=m68000-sun
+		;;
+	sun2os3)
+		basic_machine=m68000-sun
+		os=-sunos3
+		;;
+	sun2os4)
+		basic_machine=m68000-sun
+		os=-sunos4
+		;;
+	sun3os3)
+		basic_machine=m68k-sun
+		os=-sunos3
+		;;
+	sun3os4)
+		basic_machine=m68k-sun
+		os=-sunos4
+		;;
+	sun4os3)
+		basic_machine=sparc-sun
+		os=-sunos3
+		;;
+	sun4os4)
+		basic_machine=sparc-sun
+		os=-sunos4
+		;;
+	sun4sol2)
+		basic_machine=sparc-sun
+		os=-solaris2
+		;;
+	sun3 | sun3-*)
+		basic_machine=m68k-sun
+		;;
+	sun4)
+		basic_machine=sparc-sun
+		;;
+	sun386 | sun386i | roadrunner)
+		basic_machine=i386-sun
+		;;
+	sv1)
+		basic_machine=sv1-cray
+		os=-unicos
+		;;
+	symmetry)
+		basic_machine=i386-sequent
+		os=-dynix
+		;;
+	t3e)
+		basic_machine=alphaev5-cray
+		os=-unicos
+		;;
+	t90)
+		basic_machine=t90-cray
+		os=-unicos
+		;;
+        tic4x | c4x*)
+		basic_machine=tic4x-unknown
+		os=-coff
+		;;
+	tic54x | c54x*)
+		basic_machine=tic54x-unknown
+		os=-coff
+		;;
+	tic55x | c55x*)
+		basic_machine=tic55x-unknown
+		os=-coff
+		;;
+	tic6x | c6x*)
+		basic_machine=tic6x-unknown
+		os=-coff
+		;;
+	tx39)
+		basic_machine=mipstx39-unknown
+		;;
+	tx39el)
+		basic_machine=mipstx39el-unknown
+		;;
+	toad1)
+		basic_machine=pdp10-xkl
+		os=-tops20
+		;;
+	tower | tower-32)
+		basic_machine=m68k-ncr
+		;;
+	udi29k)
+		basic_machine=a29k-amd
+		os=-udi
+		;;
+	ultra3)
+		basic_machine=a29k-nyu
+		os=-sym1
+		;;
+	v810 | necv810)
+		basic_machine=v810-nec
+		os=-none
+		;;
+	vaxv)
+		basic_machine=vax-dec
+		os=-sysv
+		;;
+	vms)
+		basic_machine=vax-dec
+		os=-vms
+		;;
+	vpp*|vx|vx-*)
+		basic_machine=f301-fujitsu
+		;;
+	vxworks960)
+		basic_machine=i960-wrs
+		os=-vxworks
+		;;
+	vxworks68)
+		basic_machine=m68k-wrs
+		os=-vxworks
+		;;
+	vxworks29k)
+		basic_machine=a29k-wrs
+		os=-vxworks
+		;;
+	w65*)
+		basic_machine=w65-wdc
+		os=-none
+		;;
+	w89k-*)
+		basic_machine=hppa1.1-winbond
+		os=-proelf
+		;;
+	xps | xps100)
+		basic_machine=xps100-honeywell
+		;;
+	ymp)
+		basic_machine=ymp-cray
+		os=-unicos
+		;;
+	z8k-*-coff)
+		basic_machine=z8k-unknown
+		os=-sim
+		;;
+	none)
+		basic_machine=none-none
+		os=-none
+		;;
+
+# Here we handle the default manufacturer of certain CPU types.  It is in
+# some cases the only manufacturer, in others, it is the most popular.
+	w89k)
+		basic_machine=hppa1.1-winbond
+		;;
+	op50n)
+		basic_machine=hppa1.1-oki
+		;;
+	op60c)
+		basic_machine=hppa1.1-oki
+		;;
+	romp)
+		basic_machine=romp-ibm
+		;;
+	rs6000)
+		basic_machine=rs6000-ibm
+		;;
+	vax)
+		basic_machine=vax-dec
+		;;
+	pdp10)
+		# there are many clones, so DEC is not a safe bet
+		basic_machine=pdp10-unknown
+		;;
+	pdp11)
+		basic_machine=pdp11-dec
+		;;
+	we32k)
+		basic_machine=we32k-att
+		;;
+	sh3 | sh4 | sh[34]eb | sh[1234]le | sh[23]ele)
+		basic_machine=sh-unknown
+		;;
+	sh64)
+		basic_machine=sh64-unknown
+		;;
+	sparc | sparcv9 | sparcv9b)
+		basic_machine=sparc-sun
+		;;
+	cydra)
+		basic_machine=cydra-cydrome
+		;;
+	orion)
+		basic_machine=orion-highlevel
+		;;
+	orion105)
+		basic_machine=clipper-highlevel
+		;;
+	mac | mpw | mac-mpw)
+		basic_machine=m68k-apple
+		;;
+	pmac | pmac-mpw)
+		basic_machine=powerpc-apple
+		;;
+	*-unknown)
+		# Make sure to match an already-canonicalized machine name.
+		;;
+	*)
+		echo Invalid configuration \`$1\': machine \`$basic_machine\' not recognized 1>&2
+		exit 1
+		;;
+esac
+
+# Here we canonicalize certain aliases for manufacturers.
+case $basic_machine in
+	*-digital*)
+		basic_machine=`echo $basic_machine | sed 's/digital.*/dec/'`
+		;;
+	*-commodore*)
+		basic_machine=`echo $basic_machine | sed 's/commodore.*/cbm/'`
+		;;
+	*)
+		;;
+esac
+
+# Decode manufacturer-specific aliases for certain operating systems.
+
+if [ x"$os" != x"" ]
+then
+case $os in
+        # First match some system type aliases
+        # that might get confused with valid system types.
+	# -solaris* is a basic system type, with this one exception.
+	-solaris1 | -solaris1.*)
+		os=`echo $os | sed -e 's|solaris1|sunos4|'`
+		;;
+	-solaris)
+		os=-solaris2
+		;;
+	-svr4*)
+		os=-sysv4
+		;;
+	-unixware*)
+		os=-sysv4.2uw
+		;;
+	-gnu/linux*)
+		os=`echo $os | sed -e 's|gnu/linux|linux-gnu|'`
+		;;
+	# First accept the basic system types.
+	# The portable systems comes first.
+	# Each alternative MUST END IN A *, to match a version number.
+	# -sysv* is not here because it comes later, after sysvr4.
+	-gnu* | -bsd* | -mach* | -minix* | -genix* | -ultrix* | -irix* \
+	      | -*vms* | -sco* | -esix* | -isc* | -aix* | -sunos | -sunos[34]*\
+	      | -hpux* | -unos* | -osf* | -luna* | -dgux* | -solaris* | -sym* \
+	      | -amigaos* | -amigados* | -msdos* | -newsos* | -unicos* | -aof* \
+	      | -aos* \
+	      | -nindy* | -vxsim* | -vxworks* | -ebmon* | -hms* | -mvs* \
+	      | -clix* | -riscos* | -uniplus* | -iris* | -rtu* | -xenix* \
+	      | -hiux* | -386bsd* | -netbsd* | -openbsd* | -freebsd* | -riscix* \
+	      | -lynxos* | -bosx* | -nextstep* | -cxux* | -aout* | -elf* | -oabi* \
+	      | -ptx* | -coff* | -ecoff* | -winnt* | -domain* | -vsta* \
+	      | -udi* | -eabi* | -lites* | -ieee* | -go32* | -aux* \
+	      | -chorusos* | -chorusrdb* \
+	      | -cygwin* | -pe* | -psos* | -moss* | -proelf* | -rtems* \
+	      | -mingw32* | -linux-gnu* | -uxpv* | -beos* | -mpeix* | -udk* \
+	      | -interix* | -uwin* | -mks* | -rhapsody* | -darwin* | -opened* \
+	      | -openstep* | -oskit* | -conix* | -pw32* | -nonstopux* \
+	      | -storm-chaos* | -tops10* | -tenex* | -tops20* | -its* \
+	      | -os2* | -vos* | -palmos* | -uclinux* | -nucleus* \
+	      | -morphos* | -superux* | -rtmk* | -rtmk-nova* | -windiss* \
+	      | -powermax* | -dnix*)
+	# Remember, each alternative MUST END IN *, to match a version number.
+		;;
+	-qnx*)
+		case $basic_machine in
+		    x86-* | i*86-*)
+			;;
+		    *)
+			os=-nto$os
+			;;
+		esac
+		;;
+	-nto-qnx*)
+		;;
+	-nto*)
+		os=`echo $os | sed -e 's|nto|nto-qnx|'`
+		;;
+	-sim | -es1800* | -hms* | -xray | -os68k* | -none* | -v88r* \
+	      | -windows* | -osx | -abug | -netware* | -os9* | -beos* \
+	      | -macos* | -mpw* | -magic* | -mmixware* | -mon960* | -lnews*)
+		;;
+	-mac*)
+		os=`echo $os | sed -e 's|mac|macos|'`
+		;;
+	-linux*)
+		os=`echo $os | sed -e 's|linux|linux-gnu|'`
+		;;
+	-sunos5*)
+		os=`echo $os | sed -e 's|sunos5|solaris2|'`
+		;;
+	-sunos6*)
+		os=`echo $os | sed -e 's|sunos6|solaris3|'`
+		;;
+	-opened*)
+		os=-openedition
+		;;
+	-wince*)
+		os=-wince
+		;;
+	-osfrose*)
+		os=-osfrose
+		;;
+	-osf*)
+		os=-osf
+		;;
+	-utek*)
+		os=-bsd
+		;;
+	-dynix*)
+		os=-bsd
+		;;
+	-acis*)
+		os=-aos
+		;;
+	-atheos*)
+		os=-atheos
+		;;
+	-386bsd)
+		os=-bsd
+		;;
+	-ctix* | -uts*)
+		os=-sysv
+		;;
+	-nova*)
+		os=-rtmk-nova
+		;;
+	-ns2 )
+		os=-nextstep2
+		;;
+	-nsk*)
+		os=-nsk
+		;;
+	# Preserve the version number of sinix5.
+	-sinix5.*)
+		os=`echo $os | sed -e 's|sinix|sysv|'`
+		;;
+	-sinix*)
+		os=-sysv4
+		;;
+	-triton*)
+		os=-sysv3
+		;;
+	-oss*)
+		os=-sysv3
+		;;
+	-svr4)
+		os=-sysv4
+		;;
+	-svr3)
+		os=-sysv3
+		;;
+	-sysvr4)
+		os=-sysv4
+		;;
+	# This must come after -sysvr4.
+	-sysv*)
+		;;
+	-ose*)
+		os=-ose
+		;;
+	-es1800*)
+		os=-ose
+		;;
+	-xenix)
+		os=-xenix
+		;;
+	-*mint | -mint[0-9]* | -*MiNT | -MiNT[0-9]*)
+		os=-mint
+		;;
+	-aros*)
+		os=-aros
+		;;
+	-kaos*)
+		os=-kaos
+		;;
+	-none)
+		;;
+	*)
+		# Get rid of the `-' at the beginning of $os.
+		os=`echo $os | sed 's/[^-]*-//'`
+		echo Invalid configuration \`$1\': system \`$os\' not recognized 1>&2
+		exit 1
+		;;
+esac
+else
+
+# Here we handle the default operating systems that come with various machines.
+# The value should be what the vendor currently ships out the door with their
+# machine or put another way, the most popular os provided with the machine.
+
+# Note that if you're going to try to match "-MANUFACTURER" here (say,
+# "-sun"), then you have to tell the case statement up towards the top
+# that MANUFACTURER isn't an operating system.  Otherwise, code above
+# will signal an error saying that MANUFACTURER isn't an operating
+# system, and we'll never get to this point.
+
+case $basic_machine in
+	*-acorn)
+		os=-riscix1.2
+		;;
+	arm*-rebel)
+		os=-linux
+		;;
+	arm*-semi)
+		os=-aout
+		;;
+	# This must come before the *-dec entry.
+	pdp10-*)
+		os=-tops20
+		;;
+	pdp11-*)
+		os=-none
+		;;
+	*-dec | vax-*)
+		os=-ultrix4.2
+		;;
+	m68*-apollo)
+		os=-domain
+		;;
+	i386-sun)
+		os=-sunos4.0.2
+		;;
+	m68000-sun)
+		os=-sunos3
+		# This also exists in the configure program, but was not the
+		# default.
+		# os=-sunos4
+		;;
+	m68*-cisco)
+		os=-aout
+		;;
+	mips*-cisco)
+		os=-elf
+		;;
+	mips*-*)
+		os=-elf
+		;;
+	or32-*)
+		os=-coff
+		;;
+	*-tti)	# must be before sparc entry or we get the wrong os.
+		os=-sysv3
+		;;
+	sparc-* | *-sun)
+		os=-sunos4.1.1
+		;;
+	*-be)
+		os=-beos
+		;;
+	*-ibm)
+		os=-aix
+		;;
+	*-wec)
+		os=-proelf
+		;;
+	*-winbond)
+		os=-proelf
+		;;
+	*-oki)
+		os=-proelf
+		;;
+	*-hp)
+		os=-hpux
+		;;
+	*-hitachi)
+		os=-hiux
+		;;
+	i860-* | *-att | *-ncr | *-altos | *-motorola | *-convergent)
+		os=-sysv
+		;;
+	*-cbm)
+		os=-amigaos
+		;;
+	*-dg)
+		os=-dgux
+		;;
+	*-dolphin)
+		os=-sysv3
+		;;
+	m68k-ccur)
+		os=-rtu
+		;;
+	m88k-omron*)
+		os=-luna
+		;;
+	*-next )
+		os=-nextstep
+		;;
+	*-sequent)
+		os=-ptx
+		;;
+	*-crds)
+		os=-unos
+		;;
+	*-ns)
+		os=-genix
+		;;
+	i370-*)
+		os=-mvs
+		;;
+	*-next)
+		os=-nextstep3
+		;;
+	*-gould)
+		os=-sysv
+		;;
+	*-highlevel)
+		os=-bsd
+		;;
+	*-encore)
+		os=-bsd
+		;;
+	*-sgi)
+		os=-irix
+		;;
+	*-siemens)
+		os=-sysv4
+		;;
+	*-masscomp)
+		os=-rtu
+		;;
+	f30[01]-fujitsu | f700-fujitsu)
+		os=-uxpv
+		;;
+	*-rom68k)
+		os=-coff
+		;;
+	*-*bug)
+		os=-coff
+		;;
+	*-apple)
+		os=-macos
+		;;
+	*-atari*)
+		os=-mint
+		;;
+	*)
+		os=-none
+		;;
+esac
+fi
+
+# Here we handle the case where we know the os, and the CPU type, but not the
+# manufacturer.  We pick the logical manufacturer.
+vendor=unknown
+case $basic_machine in
+	*-unknown)
+		case $os in
+			-riscix*)
+				vendor=acorn
+				;;
+			-sunos*)
+				vendor=sun
+				;;
+			-aix*)
+				vendor=ibm
+				;;
+			-beos*)
+				vendor=be
+				;;
+			-hpux*)
+				vendor=hp
+				;;
+			-mpeix*)
+				vendor=hp
+				;;
+			-hiux*)
+				vendor=hitachi
+				;;
+			-unos*)
+				vendor=crds
+				;;
+			-dgux*)
+				vendor=dg
+				;;
+			-luna*)
+				vendor=omron
+				;;
+			-genix*)
+				vendor=ns
+				;;
+			-mvs* | -opened*)
+				vendor=ibm
+				;;
+			-ptx*)
+				vendor=sequent
+				;;
+			-vxsim* | -vxworks* | -windiss*)
+				vendor=wrs
+				;;
+			-aux*)
+				vendor=apple
+				;;
+			-hms*)
+				vendor=hitachi
+				;;
+			-mpw* | -macos*)
+				vendor=apple
+				;;
+			-*mint | -mint[0-9]* | -*MiNT | -MiNT[0-9]*)
+				vendor=atari
+				;;
+			-vos*)
+				vendor=stratus
+				;;
+		esac
+		basic_machine=`echo $basic_machine | sed "s/unknown/$vendor/"`
+		;;
+esac
+
+echo $basic_machine$os
+exit 0
+
+# Local variables:
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "timestamp='"
+# time-stamp-format: "%:y-%02m-%02d"
+# time-stamp-end: "'"
+# End:
diff -urN cctools-806-old/configure cctools-806/configure
--- cctools-806-old/configure	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/configure	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,8293 @@
+#! /bin/sh
+# Guess values for system-dependent variables and create Makefiles.
+# Generated by GNU Autoconf 2.68 for cctools 806.
+#
+# Report bugs to <ddrtist@gmail.com>.
+#
+#
+# Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
+# 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010 Free Software
+# Foundation, Inc.
+#
+#
+# This configure script is free software; the Free Software Foundation
+# gives unlimited permission to copy, distribute and modify it.
+## -------------------- ##
+## M4sh Initialization. ##
+## -------------------- ##
+
+# Be more Bourne compatible
+DUALCASE=1; export DUALCASE # for MKS sh
+if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then :
+  emulate sh
+  NULLCMD=:
+  # Pre-4.2 versions of Zsh do word splitting on ${1+"$@"}, which
+  # is contrary to our usage.  Disable this feature.
+  alias -g '${1+"$@"}'='"$@"'
+  setopt NO_GLOB_SUBST
+else
+  case `(set -o) 2>/dev/null` in #(
+  *posix*) :
+    set -o posix ;; #(
+  *) :
+     ;;
+esac
+fi
+
+
+as_nl='
+'
+export as_nl
+# Printing a long string crashes Solaris 7 /usr/bin/printf.
+as_echo='\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\'
+as_echo=$as_echo$as_echo$as_echo$as_echo$as_echo
+as_echo=$as_echo$as_echo$as_echo$as_echo$as_echo$as_echo
+# Prefer a ksh shell builtin over an external printf program on Solaris,
+# but without wasting forks for bash or zsh.
+if test -z "$BASH_VERSION$ZSH_VERSION" \
+    && (test "X`print -r -- $as_echo`" = "X$as_echo") 2>/dev/null; then
+  as_echo='print -r --'
+  as_echo_n='print -rn --'
+elif (test "X`printf %s $as_echo`" = "X$as_echo") 2>/dev/null; then
+  as_echo='printf %s\n'
+  as_echo_n='printf %s'
+else
+  if test "X`(/usr/ucb/echo -n -n $as_echo) 2>/dev/null`" = "X-n $as_echo"; then
+    as_echo_body='eval /usr/ucb/echo -n "$1$as_nl"'
+    as_echo_n='/usr/ucb/echo -n'
+  else
+    as_echo_body='eval expr "X$1" : "X\\(.*\\)"'
+    as_echo_n_body='eval
+      arg=$1;
+      case $arg in #(
+      *"$as_nl"*)
+	expr "X$arg" : "X\\(.*\\)$as_nl";
+	arg=`expr "X$arg" : ".*$as_nl\\(.*\\)"`;;
+      esac;
+      expr "X$arg" : "X\\(.*\\)" | tr -d "$as_nl"
+    '
+    export as_echo_n_body
+    as_echo_n='sh -c $as_echo_n_body as_echo'
+  fi
+  export as_echo_body
+  as_echo='sh -c $as_echo_body as_echo'
+fi
+
+# The user is always right.
+if test "${PATH_SEPARATOR+set}" != set; then
+  PATH_SEPARATOR=:
+  (PATH='/bin;/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 && {
+    (PATH='/bin:/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 ||
+      PATH_SEPARATOR=';'
+  }
+fi
+
+
+# IFS
+# We need space, tab and new line, in precisely that order.  Quoting is
+# there to prevent editors from complaining about space-tab.
+# (If _AS_PATH_WALK were called with IFS unset, it would disable word
+# splitting by setting IFS to empty value.)
+IFS=" ""	$as_nl"
+
+# Find who we are.  Look in the path if we contain no directory separator.
+as_myself=
+case $0 in #((
+  *[\\/]* ) as_myself=$0 ;;
+  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
+  done
+IFS=$as_save_IFS
+
+     ;;
+esac
+# We did not find ourselves, most probably we were run as `sh COMMAND'
+# in which case we are not to be found in the path.
+if test "x$as_myself" = x; then
+  as_myself=$0
+fi
+if test ! -f "$as_myself"; then
+  $as_echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
+  exit 1
+fi
+
+# Unset variables that we do not need and which cause bugs (e.g. in
+# pre-3.0 UWIN ksh).  But do not cause bugs in bash 2.01; the "|| exit 1"
+# suppresses any "Segmentation fault" message there.  '((' could
+# trigger a bug in pdksh 5.2.14.
+for as_var in BASH_ENV ENV MAIL MAILPATH
+do eval test x\${$as_var+set} = xset \
+  && ( (unset $as_var) || exit 1) >/dev/null 2>&1 && unset $as_var || :
+done
+PS1='$ '
+PS2='> '
+PS4='+ '
+
+# NLS nuisances.
+LC_ALL=C
+export LC_ALL
+LANGUAGE=C
+export LANGUAGE
+
+# CDPATH.
+(unset CDPATH) >/dev/null 2>&1 && unset CDPATH
+
+if test "x$CONFIG_SHELL" = x; then
+  as_bourne_compatible="if test -n \"\${ZSH_VERSION+set}\" && (emulate sh) >/dev/null 2>&1; then :
+  emulate sh
+  NULLCMD=:
+  # Pre-4.2 versions of Zsh do word splitting on \${1+\"\$@\"}, which
+  # is contrary to our usage.  Disable this feature.
+  alias -g '\${1+\"\$@\"}'='\"\$@\"'
+  setopt NO_GLOB_SUBST
+else
+  case \`(set -o) 2>/dev/null\` in #(
+  *posix*) :
+    set -o posix ;; #(
+  *) :
+     ;;
+esac
+fi
+"
+  as_required="as_fn_return () { (exit \$1); }
+as_fn_success () { as_fn_return 0; }
+as_fn_failure () { as_fn_return 1; }
+as_fn_ret_success () { return 0; }
+as_fn_ret_failure () { return 1; }
+
+exitcode=0
+as_fn_success || { exitcode=1; echo as_fn_success failed.; }
+as_fn_failure && { exitcode=1; echo as_fn_failure succeeded.; }
+as_fn_ret_success || { exitcode=1; echo as_fn_ret_success failed.; }
+as_fn_ret_failure && { exitcode=1; echo as_fn_ret_failure succeeded.; }
+if ( set x; as_fn_ret_success y && test x = \"\$1\" ); then :
+
+else
+  exitcode=1; echo positional parameters were not saved.
+fi
+test x\$exitcode = x0 || exit 1"
+  as_suggested="  as_lineno_1=";as_suggested=$as_suggested$LINENO;as_suggested=$as_suggested" as_lineno_1a=\$LINENO
+  as_lineno_2=";as_suggested=$as_suggested$LINENO;as_suggested=$as_suggested" as_lineno_2a=\$LINENO
+  eval 'test \"x\$as_lineno_1'\$as_run'\" != \"x\$as_lineno_2'\$as_run'\" &&
+  test \"x\`expr \$as_lineno_1'\$as_run' + 1\`\" = \"x\$as_lineno_2'\$as_run'\"' || exit 1
+test \$(( 1 + 1 )) = 2 || exit 1"
+  if (eval "$as_required") 2>/dev/null; then :
+  as_have_required=yes
+else
+  as_have_required=no
+fi
+  if test x$as_have_required = xyes && (eval "$as_suggested") 2>/dev/null; then :
+
+else
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+as_found=false
+for as_dir in /bin$PATH_SEPARATOR/usr/bin$PATH_SEPARATOR$PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+  as_found=:
+  case $as_dir in #(
+	 /*)
+	   for as_base in sh bash ksh sh5; do
+	     # Try only shells that exist, to save several forks.
+	     as_shell=$as_dir/$as_base
+	     if { test -f "$as_shell" || test -f "$as_shell.exe"; } &&
+		    { $as_echo "$as_bourne_compatible""$as_required" | as_run=a "$as_shell"; } 2>/dev/null; then :
+  CONFIG_SHELL=$as_shell as_have_required=yes
+		   if { $as_echo "$as_bourne_compatible""$as_suggested" | as_run=a "$as_shell"; } 2>/dev/null; then :
+  break 2
+fi
+fi
+	   done;;
+       esac
+  as_found=false
+done
+$as_found || { if { test -f "$SHELL" || test -f "$SHELL.exe"; } &&
+	      { $as_echo "$as_bourne_compatible""$as_required" | as_run=a "$SHELL"; } 2>/dev/null; then :
+  CONFIG_SHELL=$SHELL as_have_required=yes
+fi; }
+IFS=$as_save_IFS
+
+
+      if test "x$CONFIG_SHELL" != x; then :
+  # We cannot yet assume a decent shell, so we have to provide a
+	# neutralization value for shells without unset; and this also
+	# works around shells that cannot unset nonexistent variables.
+	# Preserve -v and -x to the replacement shell.
+	BASH_ENV=/dev/null
+	ENV=/dev/null
+	(unset BASH_ENV) >/dev/null 2>&1 && unset BASH_ENV ENV
+	export CONFIG_SHELL
+	case $- in # ((((
+	  *v*x* | *x*v* ) as_opts=-vx ;;
+	  *v* ) as_opts=-v ;;
+	  *x* ) as_opts=-x ;;
+	  * ) as_opts= ;;
+	esac
+	exec "$CONFIG_SHELL" $as_opts "$as_myself" ${1+"$@"}
+fi
+
+    if test x$as_have_required = xno; then :
+  $as_echo "$0: This script requires a shell more modern than all"
+  $as_echo "$0: the shells that I found on your system."
+  if test x${ZSH_VERSION+set} = xset ; then
+    $as_echo "$0: In particular, zsh $ZSH_VERSION has bugs and should"
+    $as_echo "$0: be upgraded to zsh 4.3.4 or later."
+  else
+    $as_echo "$0: Please tell bug-autoconf@gnu.org and ddrtist@gmail.com
+$0: about your system, including any error possibly output
+$0: before this message. Then install a modern shell, or
+$0: manually run the script under such a shell if you do
+$0: have one."
+  fi
+  exit 1
+fi
+fi
+fi
+SHELL=${CONFIG_SHELL-/bin/sh}
+export SHELL
+# Unset more variables known to interfere with behavior of common tools.
+CLICOLOR_FORCE= GREP_OPTIONS=
+unset CLICOLOR_FORCE GREP_OPTIONS
+
+## --------------------- ##
+## M4sh Shell Functions. ##
+## --------------------- ##
+# as_fn_unset VAR
+# ---------------
+# Portably unset VAR.
+as_fn_unset ()
+{
+  { eval $1=; unset $1;}
+}
+as_unset=as_fn_unset
+
+# as_fn_set_status STATUS
+# -----------------------
+# Set $? to STATUS, without forking.
+as_fn_set_status ()
+{
+  return $1
+} # as_fn_set_status
+
+# as_fn_exit STATUS
+# -----------------
+# Exit the shell with STATUS, even in a "trap 0" or "set -e" context.
+as_fn_exit ()
+{
+  set +e
+  as_fn_set_status $1
+  exit $1
+} # as_fn_exit
+
+# as_fn_mkdir_p
+# -------------
+# Create "$as_dir" as a directory, including parents if necessary.
+as_fn_mkdir_p ()
+{
+
+  case $as_dir in #(
+  -*) as_dir=./$as_dir;;
+  esac
+  test -d "$as_dir" || eval $as_mkdir_p || {
+    as_dirs=
+    while :; do
+      case $as_dir in #(
+      *\'*) as_qdir=`$as_echo "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #'(
+      *) as_qdir=$as_dir;;
+      esac
+      as_dirs="'$as_qdir' $as_dirs"
+      as_dir=`$as_dirname -- "$as_dir" ||
+$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$as_dir" : 'X\(//\)[^/]' \| \
+	 X"$as_dir" : 'X\(//\)$' \| \
+	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
+$as_echo X"$as_dir" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+      test -d "$as_dir" && break
+    done
+    test -z "$as_dirs" || eval "mkdir $as_dirs"
+  } || test -d "$as_dir" || as_fn_error $? "cannot create directory $as_dir"
+
+
+} # as_fn_mkdir_p
+# as_fn_append VAR VALUE
+# ----------------------
+# Append the text in VALUE to the end of the definition contained in VAR. Take
+# advantage of any shell optimizations that allow amortized linear growth over
+# repeated appends, instead of the typical quadratic growth present in naive
+# implementations.
+if (eval "as_var=1; as_var+=2; test x\$as_var = x12") 2>/dev/null; then :
+  eval 'as_fn_append ()
+  {
+    eval $1+=\$2
+  }'
+else
+  as_fn_append ()
+  {
+    eval $1=\$$1\$2
+  }
+fi # as_fn_append
+
+# as_fn_arith ARG...
+# ------------------
+# Perform arithmetic evaluation on the ARGs, and store the result in the
+# global $as_val. Take advantage of shells that can avoid forks. The arguments
+# must be portable across $(()) and expr.
+if (eval "test \$(( 1 + 1 )) = 2") 2>/dev/null; then :
+  eval 'as_fn_arith ()
+  {
+    as_val=$(( $* ))
+  }'
+else
+  as_fn_arith ()
+  {
+    as_val=`expr "$@" || test $? -eq 1`
+  }
+fi # as_fn_arith
+
+
+# as_fn_error STATUS ERROR [LINENO LOG_FD]
+# ----------------------------------------
+# Output "`basename $0`: error: ERROR" to stderr. If LINENO and LOG_FD are
+# provided, also output the error to LOG_FD, referencing LINENO. Then exit the
+# script with STATUS, using 1 if that was 0.
+as_fn_error ()
+{
+  as_status=$1; test $as_status -eq 0 && as_status=1
+  if test "$4"; then
+    as_lineno=${as_lineno-"$3"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+    $as_echo "$as_me:${as_lineno-$LINENO}: error: $2" >&$4
+  fi
+  $as_echo "$as_me: error: $2" >&2
+  as_fn_exit $as_status
+} # as_fn_error
+
+if expr a : '\(a\)' >/dev/null 2>&1 &&
+   test "X`expr 00001 : '.*\(...\)'`" = X001; then
+  as_expr=expr
+else
+  as_expr=false
+fi
+
+if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
+  as_basename=basename
+else
+  as_basename=false
+fi
+
+if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
+  as_dirname=dirname
+else
+  as_dirname=false
+fi
+
+as_me=`$as_basename -- "$0" ||
+$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
+	 X"$0" : 'X\(//\)$' \| \
+	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
+$as_echo X/"$0" |
+    sed '/^.*\/\([^/][^/]*\)\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\/\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\/\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+
+# Avoid depending upon Character Ranges.
+as_cr_letters='abcdefghijklmnopqrstuvwxyz'
+as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
+as_cr_Letters=$as_cr_letters$as_cr_LETTERS
+as_cr_digits='0123456789'
+as_cr_alnum=$as_cr_Letters$as_cr_digits
+
+
+  as_lineno_1=$LINENO as_lineno_1a=$LINENO
+  as_lineno_2=$LINENO as_lineno_2a=$LINENO
+  eval 'test "x$as_lineno_1'$as_run'" != "x$as_lineno_2'$as_run'" &&
+  test "x`expr $as_lineno_1'$as_run' + 1`" = "x$as_lineno_2'$as_run'"' || {
+  # Blame Lee E. McMahon (1931-1989) for sed's syntax.  :-)
+  sed -n '
+    p
+    /[$]LINENO/=
+  ' <$as_myself |
+    sed '
+      s/[$]LINENO.*/&-/
+      t lineno
+      b
+      :lineno
+      N
+      :loop
+      s/[$]LINENO\([^'$as_cr_alnum'_].*\n\)\(.*\)/\2\1\2/
+      t loop
+      s/-\n.*//
+    ' >$as_me.lineno &&
+  chmod +x "$as_me.lineno" ||
+    { $as_echo "$as_me: error: cannot create $as_me.lineno; rerun with a POSIX shell" >&2; as_fn_exit 1; }
+
+  # Don't try to exec as it changes $[0], causing all sort of problems
+  # (the dirname of $[0] is not the place where we might find the
+  # original and so on.  Autoconf is especially sensitive to this).
+  . "./$as_me.lineno"
+  # Exit status is that of the last command.
+  exit
+}
+
+ECHO_C= ECHO_N= ECHO_T=
+case `echo -n x` in #(((((
+-n*)
+  case `echo 'xy\c'` in
+  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
+  xy)  ECHO_C='\c';;
+  *)   echo `echo ksh88 bug on AIX 6.1` > /dev/null
+       ECHO_T='	';;
+  esac;;
+*)
+  ECHO_N='-n';;
+esac
+
+rm -f conf$$ conf$$.exe conf$$.file
+if test -d conf$$.dir; then
+  rm -f conf$$.dir/conf$$.file
+else
+  rm -f conf$$.dir
+  mkdir conf$$.dir 2>/dev/null
+fi
+if (echo >conf$$.file) 2>/dev/null; then
+  if ln -s conf$$.file conf$$ 2>/dev/null; then
+    as_ln_s='ln -s'
+    # ... but there are two gotchas:
+    # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
+    # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
+    # In both cases, we have to default to `cp -p'.
+    ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
+      as_ln_s='cp -p'
+  elif ln conf$$.file conf$$ 2>/dev/null; then
+    as_ln_s=ln
+  else
+    as_ln_s='cp -p'
+  fi
+else
+  as_ln_s='cp -p'
+fi
+rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
+rmdir conf$$.dir 2>/dev/null
+
+if mkdir -p . 2>/dev/null; then
+  as_mkdir_p='mkdir -p "$as_dir"'
+else
+  test -d ./-p && rmdir ./-p
+  as_mkdir_p=false
+fi
+
+if test -x / >/dev/null 2>&1; then
+  as_test_x='test -x'
+else
+  if ls -dL / >/dev/null 2>&1; then
+    as_ls_L_option=L
+  else
+    as_ls_L_option=
+  fi
+  as_test_x='
+    eval sh -c '\''
+      if test -d "$1"; then
+	test -d "$1/.";
+      else
+	case $1 in #(
+	-*)set "./$1";;
+	esac;
+	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in #((
+	???[sx]*):;;*)false;;esac;fi
+    '\'' sh
+  '
+fi
+as_executable_p=$as_test_x
+
+# Sed expression to map a string onto a valid CPP name.
+as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
+
+# Sed expression to map a string onto a valid variable name.
+as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
+
+
+test -n "$DJDIR" || exec 7<&0 </dev/null
+exec 6>&1
+
+# Name of the host.
+# hostname on some systems (SVR3.2, old GNU/Linux) returns a bogus exit status,
+# so uname gets run too.
+ac_hostname=`(hostname || uname -n) 2>/dev/null | sed 1q`
+
+#
+# Initializations.
+#
+ac_default_prefix=/usr/local
+ac_clean_files=
+ac_config_libobj_dir=.
+LIBOBJS=
+cross_compiling=no
+subdirs=
+MFLAGS=
+MAKEFLAGS=
+
+# Identity of this package.
+PACKAGE_NAME='cctools'
+PACKAGE_TARNAME='cctools'
+PACKAGE_VERSION='806'
+PACKAGE_STRING='cctools 806'
+PACKAGE_BUGREPORT='ddrtist@gmail.com'
+PACKAGE_URL=''
+
+ac_unique_file="APPLE_LICENSE"
+# Factoring default headers for most tests.
+ac_includes_default="\
+#include <stdio.h>
+#ifdef HAVE_SYS_TYPES_H
+# include <sys/types.h>
+#endif
+#ifdef HAVE_SYS_STAT_H
+# include <sys/stat.h>
+#endif
+#ifdef STDC_HEADERS
+# include <stdlib.h>
+# include <stddef.h>
+#else
+# ifdef HAVE_STDLIB_H
+#  include <stdlib.h>
+# endif
+#endif
+#ifdef HAVE_STRING_H
+# if !defined STDC_HEADERS && defined HAVE_MEMORY_H
+#  include <memory.h>
+# endif
+# include <string.h>
+#endif
+#ifdef HAVE_STRINGS_H
+# include <strings.h>
+#endif
+#ifdef HAVE_INTTYPES_H
+# include <inttypes.h>
+#endif
+#ifdef HAVE_STDINT_H
+# include <stdint.h>
+#endif
+#ifdef HAVE_UNISTD_H
+# include <unistd.h>
+#endif"
+
+ac_header_list=
+ac_subst_vars='LTLIBOBJS
+COMPONENTS
+ALLOCA
+LIBOBJS
+ENDIAN_FLAG
+EMULATED_OBJ
+HAVE_FOREIGN_HEADERS
+EGREP
+GREP
+CPP
+HAVE_PRIVEXT
+OBJC
+WARNINGS
+MDYNAMICNOPIC
+ASTARGETS
+HOST_AR
+HOST_RANLIB
+ac_ct_CXX
+CXXFLAGS
+CXX
+LN_S
+INSTALL_DATA
+INSTALL_SCRIPT
+INSTALL_PROGRAM
+YFLAGS
+YACC
+LEXLIB
+OBJEXT
+EXEEXT
+ac_ct_CC
+CPPFLAGS
+LDFLAGS
+CFLAGS
+CC
+LEX_OUTPUT_ROOT
+LEX
+target_os
+target_vendor
+target_cpu
+target
+host_os
+host_vendor
+host_cpu
+host
+build_os
+build_vendor
+build_cpu
+build
+target_alias
+host_alias
+build_alias
+LIBS
+ECHO_T
+ECHO_N
+ECHO_C
+DEFS
+mandir
+localedir
+libdir
+psdir
+pdfdir
+dvidir
+htmldir
+infodir
+docdir
+oldincludedir
+includedir
+localstatedir
+sharedstatedir
+sysconfdir
+datadir
+datarootdir
+libexecdir
+sbindir
+bindir
+program_transform_name
+prefix
+exec_prefix
+PACKAGE_URL
+PACKAGE_BUGREPORT
+PACKAGE_STRING
+PACKAGE_VERSION
+PACKAGE_TARNAME
+PACKAGE_NAME
+PATH_SEPARATOR
+SHELL'
+ac_subst_files=''
+ac_user_opts='
+enable_option_checking
+enable_as_targets
+with_sysroot
+'
+      ac_precious_vars='build_alias
+host_alias
+target_alias
+CC
+CFLAGS
+LDFLAGS
+LIBS
+CPPFLAGS
+YACC
+YFLAGS
+CXX
+CXXFLAGS
+CCC
+CPP'
+
+
+# Initialize some variables set by options.
+ac_init_help=
+ac_init_version=false
+ac_unrecognized_opts=
+ac_unrecognized_sep=
+# The variables have the same names as the options, with
+# dashes changed to underlines.
+cache_file=/dev/null
+exec_prefix=NONE
+no_create=
+no_recursion=
+prefix=NONE
+program_prefix=NONE
+program_suffix=NONE
+program_transform_name=s,x,x,
+silent=
+site=
+srcdir=
+verbose=
+x_includes=NONE
+x_libraries=NONE
+
+# Installation directory options.
+# These are left unexpanded so users can "make install exec_prefix=/foo"
+# and all the variables that are supposed to be based on exec_prefix
+# by default will actually change.
+# Use braces instead of parens because sh, perl, etc. also accept them.
+# (The list follows the same order as the GNU Coding Standards.)
+bindir='${exec_prefix}/bin'
+sbindir='${exec_prefix}/sbin'
+libexecdir='${exec_prefix}/libexec'
+datarootdir='${prefix}/share'
+datadir='${datarootdir}'
+sysconfdir='${prefix}/etc'
+sharedstatedir='${prefix}/com'
+localstatedir='${prefix}/var'
+includedir='${prefix}/include'
+oldincludedir='/usr/include'
+docdir='${datarootdir}/doc/${PACKAGE_TARNAME}'
+infodir='${datarootdir}/info'
+htmldir='${docdir}'
+dvidir='${docdir}'
+pdfdir='${docdir}'
+psdir='${docdir}'
+libdir='${exec_prefix}/lib'
+localedir='${datarootdir}/locale'
+mandir='${datarootdir}/man'
+
+ac_prev=
+ac_dashdash=
+for ac_option
+do
+  # If the previous option needs an argument, assign it.
+  if test -n "$ac_prev"; then
+    eval $ac_prev=\$ac_option
+    ac_prev=
+    continue
+  fi
+
+  case $ac_option in
+  *=?*) ac_optarg=`expr "X$ac_option" : '[^=]*=\(.*\)'` ;;
+  *=)   ac_optarg= ;;
+  *)    ac_optarg=yes ;;
+  esac
+
+  # Accept the important Cygnus configure options, so we can diagnose typos.
+
+  case $ac_dashdash$ac_option in
+  --)
+    ac_dashdash=yes ;;
+
+  -bindir | --bindir | --bindi | --bind | --bin | --bi)
+    ac_prev=bindir ;;
+  -bindir=* | --bindir=* | --bindi=* | --bind=* | --bin=* | --bi=*)
+    bindir=$ac_optarg ;;
+
+  -build | --build | --buil | --bui | --bu)
+    ac_prev=build_alias ;;
+  -build=* | --build=* | --buil=* | --bui=* | --bu=*)
+    build_alias=$ac_optarg ;;
+
+  -cache-file | --cache-file | --cache-fil | --cache-fi \
+  | --cache-f | --cache- | --cache | --cach | --cac | --ca | --c)
+    ac_prev=cache_file ;;
+  -cache-file=* | --cache-file=* | --cache-fil=* | --cache-fi=* \
+  | --cache-f=* | --cache-=* | --cache=* | --cach=* | --cac=* | --ca=* | --c=*)
+    cache_file=$ac_optarg ;;
+
+  --config-cache | -C)
+    cache_file=config.cache ;;
+
+  -datadir | --datadir | --datadi | --datad)
+    ac_prev=datadir ;;
+  -datadir=* | --datadir=* | --datadi=* | --datad=*)
+    datadir=$ac_optarg ;;
+
+  -datarootdir | --datarootdir | --datarootdi | --datarootd | --dataroot \
+  | --dataroo | --dataro | --datar)
+    ac_prev=datarootdir ;;
+  -datarootdir=* | --datarootdir=* | --datarootdi=* | --datarootd=* \
+  | --dataroot=* | --dataroo=* | --dataro=* | --datar=*)
+    datarootdir=$ac_optarg ;;
+
+  -disable-* | --disable-*)
+    ac_useropt=`expr "x$ac_option" : 'x-*disable-\(.*\)'`
+    # Reject names that are not valid shell variable names.
+    expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
+      as_fn_error $? "invalid feature name: $ac_useropt"
+    ac_useropt_orig=$ac_useropt
+    ac_useropt=`$as_echo "$ac_useropt" | sed 's/[-+.]/_/g'`
+    case $ac_user_opts in
+      *"
+"enable_$ac_useropt"
+"*) ;;
+      *) ac_unrecognized_opts="$ac_unrecognized_opts$ac_unrecognized_sep--disable-$ac_useropt_orig"
+	 ac_unrecognized_sep=', ';;
+    esac
+    eval enable_$ac_useropt=no ;;
+
+  -docdir | --docdir | --docdi | --doc | --do)
+    ac_prev=docdir ;;
+  -docdir=* | --docdir=* | --docdi=* | --doc=* | --do=*)
+    docdir=$ac_optarg ;;
+
+  -dvidir | --dvidir | --dvidi | --dvid | --dvi | --dv)
+    ac_prev=dvidir ;;
+  -dvidir=* | --dvidir=* | --dvidi=* | --dvid=* | --dvi=* | --dv=*)
+    dvidir=$ac_optarg ;;
+
+  -enable-* | --enable-*)
+    ac_useropt=`expr "x$ac_option" : 'x-*enable-\([^=]*\)'`
+    # Reject names that are not valid shell variable names.
+    expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
+      as_fn_error $? "invalid feature name: $ac_useropt"
+    ac_useropt_orig=$ac_useropt
+    ac_useropt=`$as_echo "$ac_useropt" | sed 's/[-+.]/_/g'`
+    case $ac_user_opts in
+      *"
+"enable_$ac_useropt"
+"*) ;;
+      *) ac_unrecognized_opts="$ac_unrecognized_opts$ac_unrecognized_sep--enable-$ac_useropt_orig"
+	 ac_unrecognized_sep=', ';;
+    esac
+    eval enable_$ac_useropt=\$ac_optarg ;;
+
+  -exec-prefix | --exec_prefix | --exec-prefix | --exec-prefi \
+  | --exec-pref | --exec-pre | --exec-pr | --exec-p | --exec- \
+  | --exec | --exe | --ex)
+    ac_prev=exec_prefix ;;
+  -exec-prefix=* | --exec_prefix=* | --exec-prefix=* | --exec-prefi=* \
+  | --exec-pref=* | --exec-pre=* | --exec-pr=* | --exec-p=* | --exec-=* \
+  | --exec=* | --exe=* | --ex=*)
+    exec_prefix=$ac_optarg ;;
+
+  -gas | --gas | --ga | --g)
+    # Obsolete; use --with-gas.
+    with_gas=yes ;;
+
+  -help | --help | --hel | --he | -h)
+    ac_init_help=long ;;
+  -help=r* | --help=r* | --hel=r* | --he=r* | -hr*)
+    ac_init_help=recursive ;;
+  -help=s* | --help=s* | --hel=s* | --he=s* | -hs*)
+    ac_init_help=short ;;
+
+  -host | --host | --hos | --ho)
+    ac_prev=host_alias ;;
+  -host=* | --host=* | --hos=* | --ho=*)
+    host_alias=$ac_optarg ;;
+
+  -htmldir | --htmldir | --htmldi | --htmld | --html | --htm | --ht)
+    ac_prev=htmldir ;;
+  -htmldir=* | --htmldir=* | --htmldi=* | --htmld=* | --html=* | --htm=* \
+  | --ht=*)
+    htmldir=$ac_optarg ;;
+
+  -includedir | --includedir | --includedi | --included | --include \
+  | --includ | --inclu | --incl | --inc)
+    ac_prev=includedir ;;
+  -includedir=* | --includedir=* | --includedi=* | --included=* | --include=* \
+  | --includ=* | --inclu=* | --incl=* | --inc=*)
+    includedir=$ac_optarg ;;
+
+  -infodir | --infodir | --infodi | --infod | --info | --inf)
+    ac_prev=infodir ;;
+  -infodir=* | --infodir=* | --infodi=* | --infod=* | --info=* | --inf=*)
+    infodir=$ac_optarg ;;
+
+  -libdir | --libdir | --libdi | --libd)
+    ac_prev=libdir ;;
+  -libdir=* | --libdir=* | --libdi=* | --libd=*)
+    libdir=$ac_optarg ;;
+
+  -libexecdir | --libexecdir | --libexecdi | --libexecd | --libexec \
+  | --libexe | --libex | --libe)
+    ac_prev=libexecdir ;;
+  -libexecdir=* | --libexecdir=* | --libexecdi=* | --libexecd=* | --libexec=* \
+  | --libexe=* | --libex=* | --libe=*)
+    libexecdir=$ac_optarg ;;
+
+  -localedir | --localedir | --localedi | --localed | --locale)
+    ac_prev=localedir ;;
+  -localedir=* | --localedir=* | --localedi=* | --localed=* | --locale=*)
+    localedir=$ac_optarg ;;
+
+  -localstatedir | --localstatedir | --localstatedi | --localstated \
+  | --localstate | --localstat | --localsta | --localst | --locals)
+    ac_prev=localstatedir ;;
+  -localstatedir=* | --localstatedir=* | --localstatedi=* | --localstated=* \
+  | --localstate=* | --localstat=* | --localsta=* | --localst=* | --locals=*)
+    localstatedir=$ac_optarg ;;
+
+  -mandir | --mandir | --mandi | --mand | --man | --ma | --m)
+    ac_prev=mandir ;;
+  -mandir=* | --mandir=* | --mandi=* | --mand=* | --man=* | --ma=* | --m=*)
+    mandir=$ac_optarg ;;
+
+  -nfp | --nfp | --nf)
+    # Obsolete; use --without-fp.
+    with_fp=no ;;
+
+  -no-create | --no-create | --no-creat | --no-crea | --no-cre \
+  | --no-cr | --no-c | -n)
+    no_create=yes ;;
+
+  -no-recursion | --no-recursion | --no-recursio | --no-recursi \
+  | --no-recurs | --no-recur | --no-recu | --no-rec | --no-re | --no-r)
+    no_recursion=yes ;;
+
+  -oldincludedir | --oldincludedir | --oldincludedi | --oldincluded \
+  | --oldinclude | --oldinclud | --oldinclu | --oldincl | --oldinc \
+  | --oldin | --oldi | --old | --ol | --o)
+    ac_prev=oldincludedir ;;
+  -oldincludedir=* | --oldincludedir=* | --oldincludedi=* | --oldincluded=* \
+  | --oldinclude=* | --oldinclud=* | --oldinclu=* | --oldincl=* | --oldinc=* \
+  | --oldin=* | --oldi=* | --old=* | --ol=* | --o=*)
+    oldincludedir=$ac_optarg ;;
+
+  -prefix | --prefix | --prefi | --pref | --pre | --pr | --p)
+    ac_prev=prefix ;;
+  -prefix=* | --prefix=* | --prefi=* | --pref=* | --pre=* | --pr=* | --p=*)
+    prefix=$ac_optarg ;;
+
+  -program-prefix | --program-prefix | --program-prefi | --program-pref \
+  | --program-pre | --program-pr | --program-p)
+    ac_prev=program_prefix ;;
+  -program-prefix=* | --program-prefix=* | --program-prefi=* \
+  | --program-pref=* | --program-pre=* | --program-pr=* | --program-p=*)
+    program_prefix=$ac_optarg ;;
+
+  -program-suffix | --program-suffix | --program-suffi | --program-suff \
+  | --program-suf | --program-su | --program-s)
+    ac_prev=program_suffix ;;
+  -program-suffix=* | --program-suffix=* | --program-suffi=* \
+  | --program-suff=* | --program-suf=* | --program-su=* | --program-s=*)
+    program_suffix=$ac_optarg ;;
+
+  -program-transform-name | --program-transform-name \
+  | --program-transform-nam | --program-transform-na \
+  | --program-transform-n | --program-transform- \
+  | --program-transform | --program-transfor \
+  | --program-transfo | --program-transf \
+  | --program-trans | --program-tran \
+  | --progr-tra | --program-tr | --program-t)
+    ac_prev=program_transform_name ;;
+  -program-transform-name=* | --program-transform-name=* \
+  | --program-transform-nam=* | --program-transform-na=* \
+  | --program-transform-n=* | --program-transform-=* \
+  | --program-transform=* | --program-transfor=* \
+  | --program-transfo=* | --program-transf=* \
+  | --program-trans=* | --program-tran=* \
+  | --progr-tra=* | --program-tr=* | --program-t=*)
+    program_transform_name=$ac_optarg ;;
+
+  -pdfdir | --pdfdir | --pdfdi | --pdfd | --pdf | --pd)
+    ac_prev=pdfdir ;;
+  -pdfdir=* | --pdfdir=* | --pdfdi=* | --pdfd=* | --pdf=* | --pd=*)
+    pdfdir=$ac_optarg ;;
+
+  -psdir | --psdir | --psdi | --psd | --ps)
+    ac_prev=psdir ;;
+  -psdir=* | --psdir=* | --psdi=* | --psd=* | --ps=*)
+    psdir=$ac_optarg ;;
+
+  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
+  | -silent | --silent | --silen | --sile | --sil)
+    silent=yes ;;
+
+  -sbindir | --sbindir | --sbindi | --sbind | --sbin | --sbi | --sb)
+    ac_prev=sbindir ;;
+  -sbindir=* | --sbindir=* | --sbindi=* | --sbind=* | --sbin=* \
+  | --sbi=* | --sb=*)
+    sbindir=$ac_optarg ;;
+
+  -sharedstatedir | --sharedstatedir | --sharedstatedi \
+  | --sharedstated | --sharedstate | --sharedstat | --sharedsta \
+  | --sharedst | --shareds | --shared | --share | --shar \
+  | --sha | --sh)
+    ac_prev=sharedstatedir ;;
+  -sharedstatedir=* | --sharedstatedir=* | --sharedstatedi=* \
+  | --sharedstated=* | --sharedstate=* | --sharedstat=* | --sharedsta=* \
+  | --sharedst=* | --shareds=* | --shared=* | --share=* | --shar=* \
+  | --sha=* | --sh=*)
+    sharedstatedir=$ac_optarg ;;
+
+  -site | --site | --sit)
+    ac_prev=site ;;
+  -site=* | --site=* | --sit=*)
+    site=$ac_optarg ;;
+
+  -srcdir | --srcdir | --srcdi | --srcd | --src | --sr)
+    ac_prev=srcdir ;;
+  -srcdir=* | --srcdir=* | --srcdi=* | --srcd=* | --src=* | --sr=*)
+    srcdir=$ac_optarg ;;
+
+  -sysconfdir | --sysconfdir | --sysconfdi | --sysconfd | --sysconf \
+  | --syscon | --sysco | --sysc | --sys | --sy)
+    ac_prev=sysconfdir ;;
+  -sysconfdir=* | --sysconfdir=* | --sysconfdi=* | --sysconfd=* | --sysconf=* \
+  | --syscon=* | --sysco=* | --sysc=* | --sys=* | --sy=*)
+    sysconfdir=$ac_optarg ;;
+
+  -target | --target | --targe | --targ | --tar | --ta | --t)
+    ac_prev=target_alias ;;
+  -target=* | --target=* | --targe=* | --targ=* | --tar=* | --ta=* | --t=*)
+    target_alias=$ac_optarg ;;
+
+  -v | -verbose | --verbose | --verbos | --verbo | --verb)
+    verbose=yes ;;
+
+  -version | --version | --versio | --versi | --vers | -V)
+    ac_init_version=: ;;
+
+  -with-* | --with-*)
+    ac_useropt=`expr "x$ac_option" : 'x-*with-\([^=]*\)'`
+    # Reject names that are not valid shell variable names.
+    expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
+      as_fn_error $? "invalid package name: $ac_useropt"
+    ac_useropt_orig=$ac_useropt
+    ac_useropt=`$as_echo "$ac_useropt" | sed 's/[-+.]/_/g'`
+    case $ac_user_opts in
+      *"
+"with_$ac_useropt"
+"*) ;;
+      *) ac_unrecognized_opts="$ac_unrecognized_opts$ac_unrecognized_sep--with-$ac_useropt_orig"
+	 ac_unrecognized_sep=', ';;
+    esac
+    eval with_$ac_useropt=\$ac_optarg ;;
+
+  -without-* | --without-*)
+    ac_useropt=`expr "x$ac_option" : 'x-*without-\(.*\)'`
+    # Reject names that are not valid shell variable names.
+    expr "x$ac_useropt" : ".*[^-+._$as_cr_alnum]" >/dev/null &&
+      as_fn_error $? "invalid package name: $ac_useropt"
+    ac_useropt_orig=$ac_useropt
+    ac_useropt=`$as_echo "$ac_useropt" | sed 's/[-+.]/_/g'`
+    case $ac_user_opts in
+      *"
+"with_$ac_useropt"
+"*) ;;
+      *) ac_unrecognized_opts="$ac_unrecognized_opts$ac_unrecognized_sep--without-$ac_useropt_orig"
+	 ac_unrecognized_sep=', ';;
+    esac
+    eval with_$ac_useropt=no ;;
+
+  --x)
+    # Obsolete; use --with-x.
+    with_x=yes ;;
+
+  -x-includes | --x-includes | --x-include | --x-includ | --x-inclu \
+  | --x-incl | --x-inc | --x-in | --x-i)
+    ac_prev=x_includes ;;
+  -x-includes=* | --x-includes=* | --x-include=* | --x-includ=* | --x-inclu=* \
+  | --x-incl=* | --x-inc=* | --x-in=* | --x-i=*)
+    x_includes=$ac_optarg ;;
+
+  -x-libraries | --x-libraries | --x-librarie | --x-librari \
+  | --x-librar | --x-libra | --x-libr | --x-lib | --x-li | --x-l)
+    ac_prev=x_libraries ;;
+  -x-libraries=* | --x-libraries=* | --x-librarie=* | --x-librari=* \
+  | --x-librar=* | --x-libra=* | --x-libr=* | --x-lib=* | --x-li=* | --x-l=*)
+    x_libraries=$ac_optarg ;;
+
+  -*) as_fn_error $? "unrecognized option: \`$ac_option'
+Try \`$0 --help' for more information"
+    ;;
+
+  *=*)
+    ac_envvar=`expr "x$ac_option" : 'x\([^=]*\)='`
+    # Reject names that are not valid shell variable names.
+    case $ac_envvar in #(
+      '' | [0-9]* | *[!_$as_cr_alnum]* )
+      as_fn_error $? "invalid variable name: \`$ac_envvar'" ;;
+    esac
+    eval $ac_envvar=\$ac_optarg
+    export $ac_envvar ;;
+
+  *)
+    # FIXME: should be removed in autoconf 3.0.
+    $as_echo "$as_me: WARNING: you should use --build, --host, --target" >&2
+    expr "x$ac_option" : ".*[^-._$as_cr_alnum]" >/dev/null &&
+      $as_echo "$as_me: WARNING: invalid host type: $ac_option" >&2
+    : "${build_alias=$ac_option} ${host_alias=$ac_option} ${target_alias=$ac_option}"
+    ;;
+
+  esac
+done
+
+if test -n "$ac_prev"; then
+  ac_option=--`echo $ac_prev | sed 's/_/-/g'`
+  as_fn_error $? "missing argument to $ac_option"
+fi
+
+if test -n "$ac_unrecognized_opts"; then
+  case $enable_option_checking in
+    no) ;;
+    fatal) as_fn_error $? "unrecognized options: $ac_unrecognized_opts" ;;
+    *)     $as_echo "$as_me: WARNING: unrecognized options: $ac_unrecognized_opts" >&2 ;;
+  esac
+fi
+
+# Check all directory arguments for consistency.
+for ac_var in	exec_prefix prefix bindir sbindir libexecdir datarootdir \
+		datadir sysconfdir sharedstatedir localstatedir includedir \
+		oldincludedir docdir infodir htmldir dvidir pdfdir psdir \
+		libdir localedir mandir
+do
+  eval ac_val=\$$ac_var
+  # Remove trailing slashes.
+  case $ac_val in
+    */ )
+      ac_val=`expr "X$ac_val" : 'X\(.*[^/]\)' \| "X$ac_val" : 'X\(.*\)'`
+      eval $ac_var=\$ac_val;;
+  esac
+  # Be sure to have absolute directory names.
+  case $ac_val in
+    [\\/$]* | ?:[\\/]* )  continue;;
+    NONE | '' ) case $ac_var in *prefix ) continue;; esac;;
+  esac
+  as_fn_error $? "expected an absolute directory name for --$ac_var: $ac_val"
+done
+
+# There might be people who depend on the old broken behavior: `$host'
+# used to hold the argument of --host etc.
+# FIXME: To remove some day.
+build=$build_alias
+host=$host_alias
+target=$target_alias
+
+# FIXME: To remove some day.
+if test "x$host_alias" != x; then
+  if test "x$build_alias" = x; then
+    cross_compiling=maybe
+    $as_echo "$as_me: WARNING: if you wanted to set the --build type, don't use --host.
+    If a cross compiler is detected then cross compile mode will be used" >&2
+  elif test "x$build_alias" != "x$host_alias"; then
+    cross_compiling=yes
+  fi
+fi
+
+ac_tool_prefix=
+test -n "$host_alias" && ac_tool_prefix=$host_alias-
+
+test "$silent" = yes && exec 6>/dev/null
+
+
+ac_pwd=`pwd` && test -n "$ac_pwd" &&
+ac_ls_di=`ls -di .` &&
+ac_pwd_ls_di=`cd "$ac_pwd" && ls -di .` ||
+  as_fn_error $? "working directory cannot be determined"
+test "X$ac_ls_di" = "X$ac_pwd_ls_di" ||
+  as_fn_error $? "pwd does not report name of working directory"
+
+
+# Find the source files, if location was not specified.
+if test -z "$srcdir"; then
+  ac_srcdir_defaulted=yes
+  # Try the directory containing this script, then the parent directory.
+  ac_confdir=`$as_dirname -- "$as_myself" ||
+$as_expr X"$as_myself" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$as_myself" : 'X\(//\)[^/]' \| \
+	 X"$as_myself" : 'X\(//\)$' \| \
+	 X"$as_myself" : 'X\(/\)' \| . 2>/dev/null ||
+$as_echo X"$as_myself" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+  srcdir=$ac_confdir
+  if test ! -r "$srcdir/$ac_unique_file"; then
+    srcdir=..
+  fi
+else
+  ac_srcdir_defaulted=no
+fi
+if test ! -r "$srcdir/$ac_unique_file"; then
+  test "$ac_srcdir_defaulted" = yes && srcdir="$ac_confdir or .."
+  as_fn_error $? "cannot find sources ($ac_unique_file) in $srcdir"
+fi
+ac_msg="sources are in $srcdir, but \`cd $srcdir' does not work"
+ac_abs_confdir=`(
+	cd "$srcdir" && test -r "./$ac_unique_file" || as_fn_error $? "$ac_msg"
+	pwd)`
+# When building in place, set srcdir=.
+if test "$ac_abs_confdir" = "$ac_pwd"; then
+  srcdir=.
+fi
+# Remove unnecessary trailing slashes from srcdir.
+# Double slashes in file names in object file debugging info
+# mess up M-x gdb in Emacs.
+case $srcdir in
+*/) srcdir=`expr "X$srcdir" : 'X\(.*[^/]\)' \| "X$srcdir" : 'X\(.*\)'`;;
+esac
+for ac_var in $ac_precious_vars; do
+  eval ac_env_${ac_var}_set=\${${ac_var}+set}
+  eval ac_env_${ac_var}_value=\$${ac_var}
+  eval ac_cv_env_${ac_var}_set=\${${ac_var}+set}
+  eval ac_cv_env_${ac_var}_value=\$${ac_var}
+done
+
+#
+# Report the --help message.
+#
+if test "$ac_init_help" = "long"; then
+  # Omit some internal or obsolete options to make the list less imposing.
+  # This message is too long to be a string in the A/UX 3.1 sh.
+  cat <<_ACEOF
+\`configure' configures cctools 806 to adapt to many kinds of systems.
+
+Usage: $0 [OPTION]... [VAR=VALUE]...
+
+To assign environment variables (e.g., CC, CFLAGS...), specify them as
+VAR=VALUE.  See below for descriptions of some of the useful variables.
+
+Defaults for the options are specified in brackets.
+
+Configuration:
+  -h, --help              display this help and exit
+      --help=short        display options specific to this package
+      --help=recursive    display the short help of all the included packages
+  -V, --version           display version information and exit
+  -q, --quiet, --silent   do not print \`checking ...' messages
+      --cache-file=FILE   cache test results in FILE [disabled]
+  -C, --config-cache      alias for \`--cache-file=config.cache'
+  -n, --no-create         do not create output files
+      --srcdir=DIR        find the sources in DIR [configure dir or \`..']
+
+Installation directories:
+  --prefix=PREFIX         install architecture-independent files in PREFIX
+                          [$ac_default_prefix]
+  --exec-prefix=EPREFIX   install architecture-dependent files in EPREFIX
+                          [PREFIX]
+
+By default, \`make install' will install all the files in
+\`$ac_default_prefix/bin', \`$ac_default_prefix/lib' etc.  You can specify
+an installation prefix other than \`$ac_default_prefix' using \`--prefix',
+for instance \`--prefix=\$HOME'.
+
+For better control, use the options below.
+
+Fine tuning of the installation directories:
+  --bindir=DIR            user executables [EPREFIX/bin]
+  --sbindir=DIR           system admin executables [EPREFIX/sbin]
+  --libexecdir=DIR        program executables [EPREFIX/libexec]
+  --sysconfdir=DIR        read-only single-machine data [PREFIX/etc]
+  --sharedstatedir=DIR    modifiable architecture-independent data [PREFIX/com]
+  --localstatedir=DIR     modifiable single-machine data [PREFIX/var]
+  --libdir=DIR            object code libraries [EPREFIX/lib]
+  --includedir=DIR        C header files [PREFIX/include]
+  --oldincludedir=DIR     C header files for non-gcc [/usr/include]
+  --datarootdir=DIR       read-only arch.-independent data root [PREFIX/share]
+  --datadir=DIR           read-only architecture-independent data [DATAROOTDIR]
+  --infodir=DIR           info documentation [DATAROOTDIR/info]
+  --localedir=DIR         locale-dependent data [DATAROOTDIR/locale]
+  --mandir=DIR            man documentation [DATAROOTDIR/man]
+  --docdir=DIR            documentation root [DATAROOTDIR/doc/cctools]
+  --htmldir=DIR           html documentation [DOCDIR]
+  --dvidir=DIR            dvi documentation [DOCDIR]
+  --pdfdir=DIR            pdf documentation [DOCDIR]
+  --psdir=DIR             ps documentation [DOCDIR]
+_ACEOF
+
+  cat <<\_ACEOF
+
+Program names:
+  --program-prefix=PREFIX            prepend PREFIX to installed program names
+  --program-suffix=SUFFIX            append SUFFIX to installed program names
+  --program-transform-name=PROGRAM   run sed PROGRAM on installed program names
+
+System types:
+  --build=BUILD     configure for building on BUILD [guessed]
+  --host=HOST       cross-compile to build programs to run on HOST [BUILD]
+  --target=TARGET   configure for building compilers for TARGET [HOST]
+_ACEOF
+fi
+
+if test -n "$ac_init_help"; then
+  case $ac_init_help in
+     short | recursive ) echo "Configuration of cctools 806:";;
+   esac
+  cat <<\_ACEOF
+
+Optional Features:
+  --disable-option-checking  ignore unrecognized --enable/--with options
+  --disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)
+  --enable-FEATURE[=ARG]  include FEATURE [ARG=yes]
+  --enable-as-targets     space-separated list ("arm", "ppc", "ppc64", "i386",
+                          "x86_64", "all")
+
+Optional Packages:
+  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
+  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
+  --with-sysroot          filesystem root of cross build environment
+
+Some influential environment variables:
+  CC          C compiler command
+  CFLAGS      C compiler flags
+  LDFLAGS     linker flags, e.g. -L<lib dir> if you have libraries in a
+              nonstandard directory <lib dir>
+  LIBS        libraries to pass to the linker, e.g. -l<library>
+  CPPFLAGS    (Objective) C/C++ preprocessor flags, e.g. -I<include dir> if
+              you have headers in a nonstandard directory <include dir>
+  YACC        The `Yet Another Compiler Compiler' implementation to use.
+              Defaults to the first program found out of: `bison -y', `byacc',
+              `yacc'.
+  YFLAGS      The list of arguments that will be passed by default to $YACC.
+              This script will default YFLAGS to the empty string to avoid a
+              default value of `-d' given by some make applications.
+  CXX         C++ compiler command
+  CXXFLAGS    C++ compiler flags
+  CPP         C preprocessor
+
+Use these variables to override the choices made by `configure' or to help
+it to find libraries and programs with nonstandard names/locations.
+
+Report bugs to <ddrtist@gmail.com>.
+_ACEOF
+ac_status=$?
+fi
+
+if test "$ac_init_help" = "recursive"; then
+  # If there are subdirs, report their specific --help.
+  for ac_dir in : $ac_subdirs_all; do test "x$ac_dir" = x: && continue
+    test -d "$ac_dir" ||
+      { cd "$srcdir" && ac_pwd=`pwd` && srcdir=. && test -d "$ac_dir"; } ||
+      continue
+    ac_builddir=.
+
+case "$ac_dir" in
+.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
+*)
+  ac_dir_suffix=/`$as_echo "$ac_dir" | sed 's|^\.[\\/]||'`
+  # A ".." for each directory in $ac_dir_suffix.
+  ac_top_builddir_sub=`$as_echo "$ac_dir_suffix" | sed 's|/[^\\/]*|/..|g;s|/||'`
+  case $ac_top_builddir_sub in
+  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
+  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
+  esac ;;
+esac
+ac_abs_top_builddir=$ac_pwd
+ac_abs_builddir=$ac_pwd$ac_dir_suffix
+# for backward compatibility:
+ac_top_builddir=$ac_top_build_prefix
+
+case $srcdir in
+  .)  # We are building in place.
+    ac_srcdir=.
+    ac_top_srcdir=$ac_top_builddir_sub
+    ac_abs_top_srcdir=$ac_pwd ;;
+  [\\/]* | ?:[\\/]* )  # Absolute name.
+    ac_srcdir=$srcdir$ac_dir_suffix;
+    ac_top_srcdir=$srcdir
+    ac_abs_top_srcdir=$srcdir ;;
+  *) # Relative name.
+    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
+    ac_top_srcdir=$ac_top_build_prefix$srcdir
+    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
+esac
+ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
+
+    cd "$ac_dir" || { ac_status=$?; continue; }
+    # Check for guested configure.
+    if test -f "$ac_srcdir/configure.gnu"; then
+      echo &&
+      $SHELL "$ac_srcdir/configure.gnu" --help=recursive
+    elif test -f "$ac_srcdir/configure"; then
+      echo &&
+      $SHELL "$ac_srcdir/configure" --help=recursive
+    else
+      $as_echo "$as_me: WARNING: no configuration information is in $ac_dir" >&2
+    fi || ac_status=$?
+    cd "$ac_pwd" || { ac_status=$?; break; }
+  done
+fi
+
+test -n "$ac_init_help" && exit $ac_status
+if $ac_init_version; then
+  cat <<\_ACEOF
+cctools configure 806
+generated by GNU Autoconf 2.68
+
+Copyright (C) 2010 Free Software Foundation, Inc.
+This configure script is free software; the Free Software Foundation
+gives unlimited permission to copy, distribute and modify it.
+_ACEOF
+  exit
+fi
+
+## ------------------------ ##
+## Autoconf initialization. ##
+## ------------------------ ##
+
+# ac_fn_c_try_compile LINENO
+# --------------------------
+# Try to compile conftest.$ac_ext, and return whether this succeeded.
+ac_fn_c_try_compile ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  rm -f conftest.$ac_objext
+  if { { ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_compile") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    grep -v '^ *+' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+    mv -f conftest.er1 conftest.err
+  fi
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then :
+  ac_retval=0
+else
+  $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_retval=1
+fi
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+  as_fn_set_status $ac_retval
+
+} # ac_fn_c_try_compile
+
+# ac_fn_c_try_link LINENO
+# -----------------------
+# Try to link conftest.$ac_ext, and return whether this succeeded.
+ac_fn_c_try_link ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  rm -f conftest.$ac_objext conftest$ac_exeext
+  if { { ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_link") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    grep -v '^ *+' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+    mv -f conftest.er1 conftest.err
+  fi
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; } && {
+	 test -z "$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest$ac_exeext && {
+	 test "$cross_compiling" = yes ||
+	 $as_test_x conftest$ac_exeext
+       }; then :
+  ac_retval=0
+else
+  $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_retval=1
+fi
+  # Delete the IPA/IPO (Inter Procedural Analysis/Optimization) information
+  # created by the PGI compiler (conftest_ipa8_conftest.oo), as it would
+  # interfere with the next link command; also delete a directory that is
+  # left behind by Apple's compiler.  We do this before executing the actions.
+  rm -rf conftest.dSYM conftest_ipa8_conftest.oo
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+  as_fn_set_status $ac_retval
+
+} # ac_fn_c_try_link
+
+# ac_fn_cxx_try_compile LINENO
+# ----------------------------
+# Try to compile conftest.$ac_ext, and return whether this succeeded.
+ac_fn_cxx_try_compile ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  rm -f conftest.$ac_objext
+  if { { ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_compile") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    grep -v '^ *+' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+    mv -f conftest.er1 conftest.err
+  fi
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; } && {
+	 test -z "$ac_cxx_werror_flag" ||
+	 test ! -s conftest.err
+       } && test -s conftest.$ac_objext; then :
+  ac_retval=0
+else
+  $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+	ac_retval=1
+fi
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+  as_fn_set_status $ac_retval
+
+} # ac_fn_cxx_try_compile
+
+# ac_fn_c_try_cpp LINENO
+# ----------------------
+# Try to preprocess conftest.$ac_ext, and return whether this succeeded.
+ac_fn_c_try_cpp ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  if { { ac_try="$ac_cpp conftest.$ac_ext"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_cpp conftest.$ac_ext") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    grep -v '^ *+' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+    mv -f conftest.er1 conftest.err
+  fi
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; } > conftest.i && {
+	 test -z "$ac_c_preproc_warn_flag$ac_c_werror_flag" ||
+	 test ! -s conftest.err
+       }; then :
+  ac_retval=0
+else
+  $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+    ac_retval=1
+fi
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+  as_fn_set_status $ac_retval
+
+} # ac_fn_c_try_cpp
+
+# ac_fn_c_try_run LINENO
+# ----------------------
+# Try to link conftest.$ac_ext, and return whether this succeeded. Assumes
+# that executables *can* be run.
+ac_fn_c_try_run ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  if { { ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_link") 2>&5
+  ac_status=$?
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; } && { ac_try='./conftest$ac_exeext'
+  { { case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_try") 2>&5
+  ac_status=$?
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }; }; then :
+  ac_retval=0
+else
+  $as_echo "$as_me: program exited with status $ac_status" >&5
+       $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+       ac_retval=$ac_status
+fi
+  rm -rf conftest.dSYM conftest_ipa8_conftest.oo
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+  as_fn_set_status $ac_retval
+
+} # ac_fn_c_try_run
+
+# ac_fn_c_check_header_mongrel LINENO HEADER VAR INCLUDES
+# -------------------------------------------------------
+# Tests whether HEADER exists, giving a warning if it cannot be compiled using
+# the include files in INCLUDES and setting the cache variable VAR
+# accordingly.
+ac_fn_c_check_header_mongrel ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  if eval \${$3+:} false; then :
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
+$as_echo_n "checking for $2... " >&6; }
+if eval \${$3+:} false; then :
+  $as_echo_n "(cached) " >&6
+fi
+eval ac_res=\$$3
+	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+$as_echo "$ac_res" >&6; }
+else
+  # Is the header compilable?
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking $2 usability" >&5
+$as_echo_n "checking $2 usability... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$4
+#include <$2>
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  ac_header_compiler=yes
+else
+  ac_header_compiler=no
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_header_compiler" >&5
+$as_echo "$ac_header_compiler" >&6; }
+
+# Is the header present?
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking $2 presence" >&5
+$as_echo_n "checking $2 presence... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <$2>
+_ACEOF
+if ac_fn_c_try_cpp "$LINENO"; then :
+  ac_header_preproc=yes
+else
+  ac_header_preproc=no
+fi
+rm -f conftest.err conftest.i conftest.$ac_ext
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_header_preproc" >&5
+$as_echo "$ac_header_preproc" >&6; }
+
+# So?  What about this header?
+case $ac_header_compiler:$ac_header_preproc:$ac_c_preproc_warn_flag in #((
+  yes:no: )
+    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2: accepted by the compiler, rejected by the preprocessor!" >&5
+$as_echo "$as_me: WARNING: $2: accepted by the compiler, rejected by the preprocessor!" >&2;}
+    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2: proceeding with the compiler's result" >&5
+$as_echo "$as_me: WARNING: $2: proceeding with the compiler's result" >&2;}
+    ;;
+  no:yes:* )
+    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2: present but cannot be compiled" >&5
+$as_echo "$as_me: WARNING: $2: present but cannot be compiled" >&2;}
+    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2:     check for missing prerequisite headers?" >&5
+$as_echo "$as_me: WARNING: $2:     check for missing prerequisite headers?" >&2;}
+    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2: see the Autoconf documentation" >&5
+$as_echo "$as_me: WARNING: $2: see the Autoconf documentation" >&2;}
+    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2:     section \"Present But Cannot Be Compiled\"" >&5
+$as_echo "$as_me: WARNING: $2:     section \"Present But Cannot Be Compiled\"" >&2;}
+    { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $2: proceeding with the compiler's result" >&5
+$as_echo "$as_me: WARNING: $2: proceeding with the compiler's result" >&2;}
+( $as_echo "## -------------------------------- ##
+## Report this to ddrtist@gmail.com ##
+## -------------------------------- ##"
+     ) | sed "s/^/$as_me: WARNING:     /" >&2
+    ;;
+esac
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
+$as_echo_n "checking for $2... " >&6; }
+if eval \${$3+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  eval "$3=\$ac_header_compiler"
+fi
+eval ac_res=\$$3
+	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+$as_echo "$ac_res" >&6; }
+fi
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+
+} # ac_fn_c_check_header_mongrel
+
+# ac_fn_c_check_header_compile LINENO HEADER VAR INCLUDES
+# -------------------------------------------------------
+# Tests whether HEADER exists and can be compiled using the include files in
+# INCLUDES, setting the cache variable VAR accordingly.
+ac_fn_c_check_header_compile ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
+$as_echo_n "checking for $2... " >&6; }
+if eval \${$3+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$4
+#include <$2>
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  eval "$3=yes"
+else
+  eval "$3=no"
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+eval ac_res=\$$3
+	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+$as_echo "$ac_res" >&6; }
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+
+} # ac_fn_c_check_header_compile
+
+# ac_fn_c_check_func LINENO FUNC VAR
+# ----------------------------------
+# Tests whether FUNC exists, setting the cache variable VAR accordingly
+ac_fn_c_check_func ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
+$as_echo_n "checking for $2... " >&6; }
+if eval \${$3+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+/* Define $2 to an innocuous variant, in case <limits.h> declares $2.
+   For example, HP-UX 11i <limits.h> declares gettimeofday.  */
+#define $2 innocuous_$2
+
+/* System header to define __stub macros and hopefully few prototypes,
+    which can conflict with char $2 (); below.
+    Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
+    <limits.h> exists even on freestanding compilers.  */
+
+#ifdef __STDC__
+# include <limits.h>
+#else
+# include <assert.h>
+#endif
+
+#undef $2
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+char $2 ();
+/* The GNU C library defines this for functions which it implements
+    to always fail with ENOSYS.  Some functions are actually named
+    something starting with __ and the normal name is an alias.  */
+#if defined __stub_$2 || defined __stub___$2
+choke me
+#endif
+
+int
+main ()
+{
+return $2 ();
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"; then :
+  eval "$3=yes"
+else
+  eval "$3=no"
+fi
+rm -f core conftest.err conftest.$ac_objext \
+    conftest$ac_exeext conftest.$ac_ext
+fi
+eval ac_res=\$$3
+	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+$as_echo "$ac_res" >&6; }
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+
+} # ac_fn_c_check_func
+
+# ac_fn_c_check_decl LINENO SYMBOL VAR INCLUDES
+# ---------------------------------------------
+# Tests whether SYMBOL is declared in INCLUDES, setting cache variable VAR
+# accordingly.
+ac_fn_c_check_decl ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  as_decl_name=`echo $2|sed 's/ *(.*//'`
+  as_decl_use=`echo $2|sed -e 's/(/((/' -e 's/)/) 0&/' -e 's/,/) 0& (/g'`
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether $as_decl_name is declared" >&5
+$as_echo_n "checking whether $as_decl_name is declared... " >&6; }
+if eval \${$3+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$4
+int
+main ()
+{
+#ifndef $as_decl_name
+#ifdef __cplusplus
+  (void) $as_decl_use;
+#else
+  (void) $as_decl_name;
+#endif
+#endif
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  eval "$3=yes"
+else
+  eval "$3=no"
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+eval ac_res=\$$3
+	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+$as_echo "$ac_res" >&6; }
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+
+} # ac_fn_c_check_decl
+
+# ac_fn_c_check_type LINENO TYPE VAR INCLUDES
+# -------------------------------------------
+# Tests whether TYPE exists after having included INCLUDES, setting cache
+# variable VAR accordingly.
+ac_fn_c_check_type ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for $2" >&5
+$as_echo_n "checking for $2... " >&6; }
+if eval \${$3+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  eval "$3=no"
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$4
+int
+main ()
+{
+if (sizeof ($2))
+	 return 0;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$4
+int
+main ()
+{
+if (sizeof (($2)))
+	    return 0;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+
+else
+  eval "$3=yes"
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+eval ac_res=\$$3
+	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+$as_echo "$ac_res" >&6; }
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+
+} # ac_fn_c_check_type
+
+# ac_fn_c_find_intX_t LINENO BITS VAR
+# -----------------------------------
+# Finds a signed integer type with width BITS, setting cache variable VAR
+# accordingly.
+ac_fn_c_find_intX_t ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for int$2_t" >&5
+$as_echo_n "checking for int$2_t... " >&6; }
+if eval \${$3+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  eval "$3=no"
+     # Order is important - never check a type that is potentially smaller
+     # than half of the expected target width.
+     for ac_type in int$2_t 'int' 'long int' \
+	 'long long int' 'short int' 'signed char'; do
+       cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$ac_includes_default
+	     enum { N = $2 / 2 - 1 };
+int
+main ()
+{
+static int test_array [1 - 2 * !(0 < ($ac_type) ((((($ac_type) 1 << N) << N) - 1) * 2 + 1))];
+test_array [0] = 0
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$ac_includes_default
+	        enum { N = $2 / 2 - 1 };
+int
+main ()
+{
+static int test_array [1 - 2 * !(($ac_type) ((((($ac_type) 1 << N) << N) - 1) * 2 + 1)
+		 < ($ac_type) ((((($ac_type) 1 << N) << N) - 1) * 2 + 2))];
+test_array [0] = 0
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+
+else
+  case $ac_type in #(
+  int$2_t) :
+    eval "$3=yes" ;; #(
+  *) :
+    eval "$3=\$ac_type" ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+       if eval test \"x\$"$3"\" = x"no"; then :
+
+else
+  break
+fi
+     done
+fi
+eval ac_res=\$$3
+	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+$as_echo "$ac_res" >&6; }
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+
+} # ac_fn_c_find_intX_t
+
+# ac_fn_c_find_uintX_t LINENO BITS VAR
+# ------------------------------------
+# Finds an unsigned integer type with width BITS, setting cache variable VAR
+# accordingly.
+ac_fn_c_find_uintX_t ()
+{
+  as_lineno=${as_lineno-"$1"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for uint$2_t" >&5
+$as_echo_n "checking for uint$2_t... " >&6; }
+if eval \${$3+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  eval "$3=no"
+     # Order is important - never check a type that is potentially smaller
+     # than half of the expected target width.
+     for ac_type in uint$2_t 'unsigned int' 'unsigned long int' \
+	 'unsigned long long int' 'unsigned short int' 'unsigned char'; do
+       cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$ac_includes_default
+int
+main ()
+{
+static int test_array [1 - 2 * !((($ac_type) -1 >> ($2 / 2 - 1)) >> ($2 / 2 - 1) == 3)];
+test_array [0] = 0
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  case $ac_type in #(
+  uint$2_t) :
+    eval "$3=yes" ;; #(
+  *) :
+    eval "$3=\$ac_type" ;;
+esac
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+       if eval test \"x\$"$3"\" = x"no"; then :
+
+else
+  break
+fi
+     done
+fi
+eval ac_res=\$$3
+	       { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_res" >&5
+$as_echo "$ac_res" >&6; }
+  eval $as_lineno_stack; ${as_lineno_stack:+:} unset as_lineno
+
+} # ac_fn_c_find_uintX_t
+cat >config.log <<_ACEOF
+This file contains any messages produced by compilers while
+running configure, to aid debugging if configure makes a mistake.
+
+It was created by cctools $as_me 806, which was
+generated by GNU Autoconf 2.68.  Invocation command line was
+
+  $ $0 $@
+
+_ACEOF
+exec 5>>config.log
+{
+cat <<_ASUNAME
+## --------- ##
+## Platform. ##
+## --------- ##
+
+hostname = `(hostname || uname -n) 2>/dev/null | sed 1q`
+uname -m = `(uname -m) 2>/dev/null || echo unknown`
+uname -r = `(uname -r) 2>/dev/null || echo unknown`
+uname -s = `(uname -s) 2>/dev/null || echo unknown`
+uname -v = `(uname -v) 2>/dev/null || echo unknown`
+
+/usr/bin/uname -p = `(/usr/bin/uname -p) 2>/dev/null || echo unknown`
+/bin/uname -X     = `(/bin/uname -X) 2>/dev/null     || echo unknown`
+
+/bin/arch              = `(/bin/arch) 2>/dev/null              || echo unknown`
+/usr/bin/arch -k       = `(/usr/bin/arch -k) 2>/dev/null       || echo unknown`
+/usr/convex/getsysinfo = `(/usr/convex/getsysinfo) 2>/dev/null || echo unknown`
+/usr/bin/hostinfo      = `(/usr/bin/hostinfo) 2>/dev/null      || echo unknown`
+/bin/machine           = `(/bin/machine) 2>/dev/null           || echo unknown`
+/usr/bin/oslevel       = `(/usr/bin/oslevel) 2>/dev/null       || echo unknown`
+/bin/universe          = `(/bin/universe) 2>/dev/null          || echo unknown`
+
+_ASUNAME
+
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    $as_echo "PATH: $as_dir"
+  done
+IFS=$as_save_IFS
+
+} >&5
+
+cat >&5 <<_ACEOF
+
+
+## ----------- ##
+## Core tests. ##
+## ----------- ##
+
+_ACEOF
+
+
+# Keep a trace of the command line.
+# Strip out --no-create and --no-recursion so they do not pile up.
+# Strip out --silent because we don't want to record it for future runs.
+# Also quote any args containing shell meta-characters.
+# Make two passes to allow for proper duplicate-argument suppression.
+ac_configure_args=
+ac_configure_args0=
+ac_configure_args1=
+ac_must_keep_next=false
+for ac_pass in 1 2
+do
+  for ac_arg
+  do
+    case $ac_arg in
+    -no-create | --no-c* | -n | -no-recursion | --no-r*) continue ;;
+    -q | -quiet | --quiet | --quie | --qui | --qu | --q \
+    | -silent | --silent | --silen | --sile | --sil)
+      continue ;;
+    *\'*)
+      ac_arg=`$as_echo "$ac_arg" | sed "s/'/'\\\\\\\\''/g"` ;;
+    esac
+    case $ac_pass in
+    1) as_fn_append ac_configure_args0 " '$ac_arg'" ;;
+    2)
+      as_fn_append ac_configure_args1 " '$ac_arg'"
+      if test $ac_must_keep_next = true; then
+	ac_must_keep_next=false # Got value, back to normal.
+      else
+	case $ac_arg in
+	  *=* | --config-cache | -C | -disable-* | --disable-* \
+	  | -enable-* | --enable-* | -gas | --g* | -nfp | --nf* \
+	  | -q | -quiet | --q* | -silent | --sil* | -v | -verb* \
+	  | -with-* | --with-* | -without-* | --without-* | --x)
+	    case "$ac_configure_args0 " in
+	      "$ac_configure_args1"*" '$ac_arg' "* ) continue ;;
+	    esac
+	    ;;
+	  -* ) ac_must_keep_next=true ;;
+	esac
+      fi
+      as_fn_append ac_configure_args " '$ac_arg'"
+      ;;
+    esac
+  done
+done
+{ ac_configure_args0=; unset ac_configure_args0;}
+{ ac_configure_args1=; unset ac_configure_args1;}
+
+# When interrupted or exit'd, cleanup temporary files, and complete
+# config.log.  We remove comments because anyway the quotes in there
+# would cause problems or look ugly.
+# WARNING: Use '\'' to represent an apostrophe within the trap.
+# WARNING: Do not start the trap code with a newline, due to a FreeBSD 4.0 bug.
+trap 'exit_status=$?
+  # Save into config.log some information that might help in debugging.
+  {
+    echo
+
+    $as_echo "## ---------------- ##
+## Cache variables. ##
+## ---------------- ##"
+    echo
+    # The following way of writing the cache mishandles newlines in values,
+(
+  for ac_var in `(set) 2>&1 | sed -n '\''s/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'\''`; do
+    eval ac_val=\$$ac_var
+    case $ac_val in #(
+    *${as_nl}*)
+      case $ac_var in #(
+      *_cv_*) { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: cache variable $ac_var contains a newline" >&5
+$as_echo "$as_me: WARNING: cache variable $ac_var contains a newline" >&2;} ;;
+      esac
+      case $ac_var in #(
+      _ | IFS | as_nl) ;; #(
+      BASH_ARGV | BASH_SOURCE) eval $ac_var= ;; #(
+      *) { eval $ac_var=; unset $ac_var;} ;;
+      esac ;;
+    esac
+  done
+  (set) 2>&1 |
+    case $as_nl`(ac_space='\'' '\''; set) 2>&1` in #(
+    *${as_nl}ac_space=\ *)
+      sed -n \
+	"s/'\''/'\''\\\\'\'''\''/g;
+	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\''\\2'\''/p"
+      ;; #(
+    *)
+      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
+      ;;
+    esac |
+    sort
+)
+    echo
+
+    $as_echo "## ----------------- ##
+## Output variables. ##
+## ----------------- ##"
+    echo
+    for ac_var in $ac_subst_vars
+    do
+      eval ac_val=\$$ac_var
+      case $ac_val in
+      *\'\''*) ac_val=`$as_echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
+      esac
+      $as_echo "$ac_var='\''$ac_val'\''"
+    done | sort
+    echo
+
+    if test -n "$ac_subst_files"; then
+      $as_echo "## ------------------- ##
+## File substitutions. ##
+## ------------------- ##"
+      echo
+      for ac_var in $ac_subst_files
+      do
+	eval ac_val=\$$ac_var
+	case $ac_val in
+	*\'\''*) ac_val=`$as_echo "$ac_val" | sed "s/'\''/'\''\\\\\\\\'\'''\''/g"`;;
+	esac
+	$as_echo "$ac_var='\''$ac_val'\''"
+      done | sort
+      echo
+    fi
+
+    if test -s confdefs.h; then
+      $as_echo "## ----------- ##
+## confdefs.h. ##
+## ----------- ##"
+      echo
+      cat confdefs.h
+      echo
+    fi
+    test "$ac_signal" != 0 &&
+      $as_echo "$as_me: caught signal $ac_signal"
+    $as_echo "$as_me: exit $exit_status"
+  } >&5
+  rm -f core *.core core.conftest.* &&
+    rm -f -r conftest* confdefs* conf$$* $ac_clean_files &&
+    exit $exit_status
+' 0
+for ac_signal in 1 2 13 15; do
+  trap 'ac_signal='$ac_signal'; as_fn_exit 1' $ac_signal
+done
+ac_signal=0
+
+# confdefs.h avoids OS command line length limits that DEFS can exceed.
+rm -f -r conftest* confdefs.h
+
+$as_echo "/* confdefs.h */" > confdefs.h
+
+# Predefined preprocessor variables.
+
+cat >>confdefs.h <<_ACEOF
+#define PACKAGE_NAME "$PACKAGE_NAME"
+_ACEOF
+
+cat >>confdefs.h <<_ACEOF
+#define PACKAGE_TARNAME "$PACKAGE_TARNAME"
+_ACEOF
+
+cat >>confdefs.h <<_ACEOF
+#define PACKAGE_VERSION "$PACKAGE_VERSION"
+_ACEOF
+
+cat >>confdefs.h <<_ACEOF
+#define PACKAGE_STRING "$PACKAGE_STRING"
+_ACEOF
+
+cat >>confdefs.h <<_ACEOF
+#define PACKAGE_BUGREPORT "$PACKAGE_BUGREPORT"
+_ACEOF
+
+cat >>confdefs.h <<_ACEOF
+#define PACKAGE_URL "$PACKAGE_URL"
+_ACEOF
+
+
+# Let the site file select an alternate cache file if it wants to.
+# Prefer an explicitly selected file to automatically selected ones.
+ac_site_file1=NONE
+ac_site_file2=NONE
+if test -n "$CONFIG_SITE"; then
+  # We do not want a PATH search for config.site.
+  case $CONFIG_SITE in #((
+    -*)  ac_site_file1=./$CONFIG_SITE;;
+    */*) ac_site_file1=$CONFIG_SITE;;
+    *)   ac_site_file1=./$CONFIG_SITE;;
+  esac
+elif test "x$prefix" != xNONE; then
+  ac_site_file1=$prefix/share/config.site
+  ac_site_file2=$prefix/etc/config.site
+else
+  ac_site_file1=$ac_default_prefix/share/config.site
+  ac_site_file2=$ac_default_prefix/etc/config.site
+fi
+for ac_site_file in "$ac_site_file1" "$ac_site_file2"
+do
+  test "x$ac_site_file" = xNONE && continue
+  if test /dev/null != "$ac_site_file" && test -r "$ac_site_file"; then
+    { $as_echo "$as_me:${as_lineno-$LINENO}: loading site script $ac_site_file" >&5
+$as_echo "$as_me: loading site script $ac_site_file" >&6;}
+    sed 's/^/| /' "$ac_site_file" >&5
+    . "$ac_site_file" \
+      || { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "failed to load site script $ac_site_file
+See \`config.log' for more details" "$LINENO" 5; }
+  fi
+done
+
+if test -r "$cache_file"; then
+  # Some versions of bash will fail to source /dev/null (special files
+  # actually), so we avoid doing that.  DJGPP emulates it as a regular file.
+  if test /dev/null != "$cache_file" && test -f "$cache_file"; then
+    { $as_echo "$as_me:${as_lineno-$LINENO}: loading cache $cache_file" >&5
+$as_echo "$as_me: loading cache $cache_file" >&6;}
+    case $cache_file in
+      [\\/]* | ?:[\\/]* ) . "$cache_file";;
+      *)                      . "./$cache_file";;
+    esac
+  fi
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: creating cache $cache_file" >&5
+$as_echo "$as_me: creating cache $cache_file" >&6;}
+  >$cache_file
+fi
+
+as_fn_append ac_header_list " stdlib.h"
+as_fn_append ac_header_list " unistd.h"
+as_fn_append ac_header_list " sys/param.h"
+# Check that the precious variables saved in the cache have kept the same
+# value.
+ac_cache_corrupted=false
+for ac_var in $ac_precious_vars; do
+  eval ac_old_set=\$ac_cv_env_${ac_var}_set
+  eval ac_new_set=\$ac_env_${ac_var}_set
+  eval ac_old_val=\$ac_cv_env_${ac_var}_value
+  eval ac_new_val=\$ac_env_${ac_var}_value
+  case $ac_old_set,$ac_new_set in
+    set,)
+      { $as_echo "$as_me:${as_lineno-$LINENO}: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&5
+$as_echo "$as_me: error: \`$ac_var' was set to \`$ac_old_val' in the previous run" >&2;}
+      ac_cache_corrupted=: ;;
+    ,set)
+      { $as_echo "$as_me:${as_lineno-$LINENO}: error: \`$ac_var' was not set in the previous run" >&5
+$as_echo "$as_me: error: \`$ac_var' was not set in the previous run" >&2;}
+      ac_cache_corrupted=: ;;
+    ,);;
+    *)
+      if test "x$ac_old_val" != "x$ac_new_val"; then
+	# differences in whitespace do not lead to failure.
+	ac_old_val_w=`echo x $ac_old_val`
+	ac_new_val_w=`echo x $ac_new_val`
+	if test "$ac_old_val_w" != "$ac_new_val_w"; then
+	  { $as_echo "$as_me:${as_lineno-$LINENO}: error: \`$ac_var' has changed since the previous run:" >&5
+$as_echo "$as_me: error: \`$ac_var' has changed since the previous run:" >&2;}
+	  ac_cache_corrupted=:
+	else
+	  { $as_echo "$as_me:${as_lineno-$LINENO}: warning: ignoring whitespace changes in \`$ac_var' since the previous run:" >&5
+$as_echo "$as_me: warning: ignoring whitespace changes in \`$ac_var' since the previous run:" >&2;}
+	  eval $ac_var=\$ac_old_val
+	fi
+	{ $as_echo "$as_me:${as_lineno-$LINENO}:   former value:  \`$ac_old_val'" >&5
+$as_echo "$as_me:   former value:  \`$ac_old_val'" >&2;}
+	{ $as_echo "$as_me:${as_lineno-$LINENO}:   current value: \`$ac_new_val'" >&5
+$as_echo "$as_me:   current value: \`$ac_new_val'" >&2;}
+      fi;;
+  esac
+  # Pass precious variables to config.status.
+  if test "$ac_new_set" = set; then
+    case $ac_new_val in
+    *\'*) ac_arg=$ac_var=`$as_echo "$ac_new_val" | sed "s/'/'\\\\\\\\''/g"` ;;
+    *) ac_arg=$ac_var=$ac_new_val ;;
+    esac
+    case " $ac_configure_args " in
+      *" '$ac_arg' "*) ;; # Avoid dups.  Use of quotes ensures accuracy.
+      *) as_fn_append ac_configure_args " '$ac_arg'" ;;
+    esac
+  fi
+done
+if $ac_cache_corrupted; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+  { $as_echo "$as_me:${as_lineno-$LINENO}: error: changes in the environment can compromise the build" >&5
+$as_echo "$as_me: error: changes in the environment can compromise the build" >&2;}
+  as_fn_error $? "run \`make distclean' and/or \`rm $cache_file' and start over" "$LINENO" 5
+fi
+## -------------------- ##
+## Main body of script. ##
+## -------------------- ##
+
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+
+
+ac_config_headers="$ac_config_headers include/config.h"
+
+
+ac_aux_dir=
+for ac_dir in "$srcdir" "$srcdir/.." "$srcdir/../.."; do
+  if test -f "$ac_dir/install-sh"; then
+    ac_aux_dir=$ac_dir
+    ac_install_sh="$ac_aux_dir/install-sh -c"
+    break
+  elif test -f "$ac_dir/install.sh"; then
+    ac_aux_dir=$ac_dir
+    ac_install_sh="$ac_aux_dir/install.sh -c"
+    break
+  elif test -f "$ac_dir/shtool"; then
+    ac_aux_dir=$ac_dir
+    ac_install_sh="$ac_aux_dir/shtool install -c"
+    break
+  fi
+done
+if test -z "$ac_aux_dir"; then
+  as_fn_error $? "cannot find install-sh, install.sh, or shtool in \"$srcdir\" \"$srcdir/..\" \"$srcdir/../..\"" "$LINENO" 5
+fi
+
+# These three variables are undocumented and unsupported,
+# and are intended to be withdrawn in a future Autoconf release.
+# They can cause serious problems if a builder's source tree is in a directory
+# whose full name contains unusual characters.
+ac_config_guess="$SHELL $ac_aux_dir/config.guess"  # Please don't use this var.
+ac_config_sub="$SHELL $ac_aux_dir/config.sub"  # Please don't use this var.
+ac_configure="$SHELL $ac_aux_dir/configure"  # Please don't use this var.
+
+
+# Make sure we can run config.sub.
+$SHELL "$ac_aux_dir/config.sub" sun4 >/dev/null 2>&1 ||
+  as_fn_error $? "cannot run $SHELL $ac_aux_dir/config.sub" "$LINENO" 5
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking build system type" >&5
+$as_echo_n "checking build system type... " >&6; }
+if ${ac_cv_build+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  ac_build_alias=$build_alias
+test "x$ac_build_alias" = x &&
+  ac_build_alias=`$SHELL "$ac_aux_dir/config.guess"`
+test "x$ac_build_alias" = x &&
+  as_fn_error $? "cannot guess build type; you must specify one" "$LINENO" 5
+ac_cv_build=`$SHELL "$ac_aux_dir/config.sub" $ac_build_alias` ||
+  as_fn_error $? "$SHELL $ac_aux_dir/config.sub $ac_build_alias failed" "$LINENO" 5
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_build" >&5
+$as_echo "$ac_cv_build" >&6; }
+case $ac_cv_build in
+*-*-*) ;;
+*) as_fn_error $? "invalid value of canonical build" "$LINENO" 5;;
+esac
+build=$ac_cv_build
+ac_save_IFS=$IFS; IFS='-'
+set x $ac_cv_build
+shift
+build_cpu=$1
+build_vendor=$2
+shift; shift
+# Remember, the first character of IFS is used to create $*,
+# except with old shells:
+build_os=$*
+IFS=$ac_save_IFS
+case $build_os in *\ *) build_os=`echo "$build_os" | sed 's/ /-/g'`;; esac
+
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking host system type" >&5
+$as_echo_n "checking host system type... " >&6; }
+if ${ac_cv_host+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test "x$host_alias" = x; then
+  ac_cv_host=$ac_cv_build
+else
+  ac_cv_host=`$SHELL "$ac_aux_dir/config.sub" $host_alias` ||
+    as_fn_error $? "$SHELL $ac_aux_dir/config.sub $host_alias failed" "$LINENO" 5
+fi
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_host" >&5
+$as_echo "$ac_cv_host" >&6; }
+case $ac_cv_host in
+*-*-*) ;;
+*) as_fn_error $? "invalid value of canonical host" "$LINENO" 5;;
+esac
+host=$ac_cv_host
+ac_save_IFS=$IFS; IFS='-'
+set x $ac_cv_host
+shift
+host_cpu=$1
+host_vendor=$2
+shift; shift
+# Remember, the first character of IFS is used to create $*,
+# except with old shells:
+host_os=$*
+IFS=$ac_save_IFS
+case $host_os in *\ *) host_os=`echo "$host_os" | sed 's/ /-/g'`;; esac
+
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking target system type" >&5
+$as_echo_n "checking target system type... " >&6; }
+if ${ac_cv_target+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test "x$target_alias" = x; then
+  ac_cv_target=$ac_cv_host
+else
+  ac_cv_target=`$SHELL "$ac_aux_dir/config.sub" $target_alias` ||
+    as_fn_error $? "$SHELL $ac_aux_dir/config.sub $target_alias failed" "$LINENO" 5
+fi
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_target" >&5
+$as_echo "$ac_cv_target" >&6; }
+case $ac_cv_target in
+*-*-*) ;;
+*) as_fn_error $? "invalid value of canonical target" "$LINENO" 5;;
+esac
+target=$ac_cv_target
+ac_save_IFS=$IFS; IFS='-'
+set x $ac_cv_target
+shift
+target_cpu=$1
+target_vendor=$2
+shift; shift
+# Remember, the first character of IFS is used to create $*,
+# except with old shells:
+target_os=$*
+IFS=$ac_save_IFS
+case $target_os in *\ *) target_os=`echo "$target_os" | sed 's/ /-/g'`;; esac
+
+
+# The aliases save the names the user supplied, while $host etc.
+# will get canonicalized.
+test -n "$target_alias" &&
+  test "$program_prefix$program_suffix$program_transform_name" = \
+    NONENONEs,x,x, &&
+  program_prefix=${target_alias}-
+
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+if test -n "$ac_tool_prefix"; then
+  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
+set dummy ${ac_tool_prefix}gcc; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_CC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_CC="${ac_tool_prefix}gcc"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+$as_echo "$CC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+fi
+if test -z "$ac_cv_prog_CC"; then
+  ac_ct_CC=$CC
+  # Extract the first word of "gcc", so it can be a program name with args.
+set dummy gcc; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_ac_ct_CC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$ac_ct_CC"; then
+  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_ac_ct_CC="gcc"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+ac_ct_CC=$ac_cv_prog_ac_ct_CC
+if test -n "$ac_ct_CC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CC" >&5
+$as_echo "$ac_ct_CC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+  if test "x$ac_ct_CC" = x; then
+    CC=""
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
+$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
+ac_tool_warned=yes ;;
+esac
+    CC=$ac_ct_CC
+  fi
+else
+  CC="$ac_cv_prog_CC"
+fi
+
+if test -z "$CC"; then
+          if test -n "$ac_tool_prefix"; then
+    # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
+set dummy ${ac_tool_prefix}cc; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_CC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_CC="${ac_tool_prefix}cc"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+$as_echo "$CC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+  fi
+fi
+if test -z "$CC"; then
+  # Extract the first word of "cc", so it can be a program name with args.
+set dummy cc; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_CC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+  ac_prog_rejected=no
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
+       ac_prog_rejected=yes
+       continue
+     fi
+    ac_cv_prog_CC="cc"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+if test $ac_prog_rejected = yes; then
+  # We found a bogon in the path, so make sure we never use it.
+  set dummy $ac_cv_prog_CC
+  shift
+  if test $# != 0; then
+    # We chose a different compiler from the bogus one.
+    # However, it has the same basename, so the bogon will be chosen
+    # first if we set CC to just the basename; use the full file name.
+    shift
+    ac_cv_prog_CC="$as_dir/$ac_word${1+' '}$@"
+  fi
+fi
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+$as_echo "$CC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+fi
+if test -z "$CC"; then
+  if test -n "$ac_tool_prefix"; then
+  for ac_prog in cl.exe
+  do
+    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
+set dummy $ac_tool_prefix$ac_prog; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_CC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+$as_echo "$CC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+    test -n "$CC" && break
+  done
+fi
+if test -z "$CC"; then
+  ac_ct_CC=$CC
+  for ac_prog in cl.exe
+do
+  # Extract the first word of "$ac_prog", so it can be a program name with args.
+set dummy $ac_prog; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_ac_ct_CC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$ac_ct_CC"; then
+  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_ac_ct_CC="$ac_prog"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+ac_ct_CC=$ac_cv_prog_ac_ct_CC
+if test -n "$ac_ct_CC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CC" >&5
+$as_echo "$ac_ct_CC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+  test -n "$ac_ct_CC" && break
+done
+
+  if test "x$ac_ct_CC" = x; then
+    CC=""
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
+$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
+ac_tool_warned=yes ;;
+esac
+    CC=$ac_ct_CC
+  fi
+fi
+
+fi
+
+
+test -z "$CC" && { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "no acceptable C compiler found in \$PATH
+See \`config.log' for more details" "$LINENO" 5; }
+
+# Provide some information about the compiler.
+$as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler version" >&5
+set X $ac_compile
+ac_compiler=$2
+for ac_option in --version -v -V -qversion; do
+  { { ac_try="$ac_compiler $ac_option >&5"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    sed '10a\
+... rest of stderr output deleted ...
+         10q' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+  fi
+  rm -f conftest.er1 conftest.err
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }
+done
+
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+ac_clean_files_save=$ac_clean_files
+ac_clean_files="$ac_clean_files a.out a.out.dSYM a.exe b.out"
+# Try to create an executable without -o first, disregard a.out.
+# It will help us diagnose broken compilers, and finding out an intuition
+# of exeext.
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether the C compiler works" >&5
+$as_echo_n "checking whether the C compiler works... " >&6; }
+ac_link_default=`$as_echo "$ac_link" | sed 's/ -o *conftest[^ ]*//'`
+
+# The possible output files:
+ac_files="a.out conftest.exe conftest a.exe a_out.exe b.out conftest.*"
+
+ac_rmfiles=
+for ac_file in $ac_files
+do
+  case $ac_file in
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.dSYM | *.o | *.obj ) ;;
+    * ) ac_rmfiles="$ac_rmfiles $ac_file";;
+  esac
+done
+rm -f $ac_rmfiles
+
+if { { ac_try="$ac_link_default"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_link_default") 2>&5
+  ac_status=$?
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }; then :
+  # Autoconf-2.13 could set the ac_cv_exeext variable to `no'.
+# So ignore a value of `no', otherwise this would lead to `EXEEXT = no'
+# in a Makefile.  We should not override ac_cv_exeext if it was cached,
+# so that the user can short-circuit this test for compilers unknown to
+# Autoconf.
+for ac_file in $ac_files ''
+do
+  test -f "$ac_file" || continue
+  case $ac_file in
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.dSYM | *.o | *.obj )
+	;;
+    [ab].out )
+	# We found the default executable, but exeext='' is most
+	# certainly right.
+	break;;
+    *.* )
+	if test "${ac_cv_exeext+set}" = set && test "$ac_cv_exeext" != no;
+	then :; else
+	   ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
+	fi
+	# We set ac_cv_exeext here because the later test for it is not
+	# safe: cross compilers may not add the suffix if given an `-o'
+	# argument, so we may need to know it at that point already.
+	# Even if this section looks crufty: it has the advantage of
+	# actually working.
+	break;;
+    * )
+	break;;
+  esac
+done
+test "$ac_cv_exeext" = no && ac_cv_exeext=
+
+else
+  ac_file=''
+fi
+if test -z "$ac_file"; then :
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+$as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error 77 "C compiler cannot create executables
+See \`config.log' for more details" "$LINENO" 5; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler default output file name" >&5
+$as_echo_n "checking for C compiler default output file name... " >&6; }
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_file" >&5
+$as_echo "$ac_file" >&6; }
+ac_exeext=$ac_cv_exeext
+
+rm -f -r a.out a.out.dSYM a.exe conftest$ac_cv_exeext b.out
+ac_clean_files=$ac_clean_files_save
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for suffix of executables" >&5
+$as_echo_n "checking for suffix of executables... " >&6; }
+if { { ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_link") 2>&5
+  ac_status=$?
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }; then :
+  # If both `conftest.exe' and `conftest' are `present' (well, observable)
+# catch `conftest.exe'.  For instance with Cygwin, `ls conftest' will
+# work properly (i.e., refer to `conftest.exe'), while it won't with
+# `rm'.
+for ac_file in conftest.exe conftest conftest.*; do
+  test -f "$ac_file" || continue
+  case $ac_file in
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.dSYM | *.o | *.obj ) ;;
+    *.* ) ac_cv_exeext=`expr "$ac_file" : '[^.]*\(\..*\)'`
+	  break;;
+    * ) break;;
+  esac
+done
+else
+  { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "cannot compute suffix of executables: cannot compile and link
+See \`config.log' for more details" "$LINENO" 5; }
+fi
+rm -f conftest conftest$ac_cv_exeext
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_exeext" >&5
+$as_echo "$ac_cv_exeext" >&6; }
+
+rm -f conftest.$ac_ext
+EXEEXT=$ac_cv_exeext
+ac_exeext=$EXEEXT
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <stdio.h>
+int
+main ()
+{
+FILE *f = fopen ("conftest.out", "w");
+ return ferror (f) || fclose (f) != 0;
+
+  ;
+  return 0;
+}
+_ACEOF
+ac_clean_files="$ac_clean_files conftest.out"
+# Check that the compiler produces executables we can run.  If not, either
+# the compiler is broken, or we cross compile.
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether we are cross compiling" >&5
+$as_echo_n "checking whether we are cross compiling... " >&6; }
+if test "$cross_compiling" != yes; then
+  { { ac_try="$ac_link"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_link") 2>&5
+  ac_status=$?
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }
+  if { ac_try='./conftest$ac_cv_exeext'
+  { { case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_try") 2>&5
+  ac_status=$?
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }; }; then
+    cross_compiling=no
+  else
+    if test "$cross_compiling" = maybe; then
+	cross_compiling=yes
+    else
+	{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "cannot run C compiled programs.
+If you meant to cross compile, use \`--host'.
+See \`config.log' for more details" "$LINENO" 5; }
+    fi
+  fi
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $cross_compiling" >&5
+$as_echo "$cross_compiling" >&6; }
+
+rm -f conftest.$ac_ext conftest$ac_cv_exeext conftest.out
+ac_clean_files=$ac_clean_files_save
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for suffix of object files" >&5
+$as_echo_n "checking for suffix of object files... " >&6; }
+if ${ac_cv_objext+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.o conftest.obj
+if { { ac_try="$ac_compile"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_compile") 2>&5
+  ac_status=$?
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }; then :
+  for ac_file in conftest.o conftest.obj conftest.*; do
+  test -f "$ac_file" || continue;
+  case $ac_file in
+    *.$ac_ext | *.xcoff | *.tds | *.d | *.pdb | *.xSYM | *.bb | *.bbg | *.map | *.inf | *.dSYM ) ;;
+    *) ac_cv_objext=`expr "$ac_file" : '.*\.\(.*\)'`
+       break;;
+  esac
+done
+else
+  $as_echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+{ { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "cannot compute suffix of object files: cannot compile
+See \`config.log' for more details" "$LINENO" 5; }
+fi
+rm -f conftest.$ac_cv_objext conftest.$ac_ext
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_objext" >&5
+$as_echo "$ac_cv_objext" >&6; }
+OBJEXT=$ac_cv_objext
+ac_objext=$OBJEXT
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether we are using the GNU C compiler" >&5
+$as_echo_n "checking whether we are using the GNU C compiler... " >&6; }
+if ${ac_cv_c_compiler_gnu+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+#ifndef __GNUC__
+       choke me
+#endif
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  ac_compiler_gnu=yes
+else
+  ac_compiler_gnu=no
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+ac_cv_c_compiler_gnu=$ac_compiler_gnu
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_compiler_gnu" >&5
+$as_echo "$ac_cv_c_compiler_gnu" >&6; }
+if test $ac_compiler_gnu = yes; then
+  GCC=yes
+else
+  GCC=
+fi
+ac_test_CFLAGS=${CFLAGS+set}
+ac_save_CFLAGS=$CFLAGS
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether $CC accepts -g" >&5
+$as_echo_n "checking whether $CC accepts -g... " >&6; }
+if ${ac_cv_prog_cc_g+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  ac_save_c_werror_flag=$ac_c_werror_flag
+   ac_c_werror_flag=yes
+   ac_cv_prog_cc_g=no
+   CFLAGS="-g"
+   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  ac_cv_prog_cc_g=yes
+else
+  CFLAGS=""
+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+
+else
+  ac_c_werror_flag=$ac_save_c_werror_flag
+	 CFLAGS="-g"
+	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  ac_cv_prog_cc_g=yes
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+   ac_c_werror_flag=$ac_save_c_werror_flag
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_g" >&5
+$as_echo "$ac_cv_prog_cc_g" >&6; }
+if test "$ac_test_CFLAGS" = set; then
+  CFLAGS=$ac_save_CFLAGS
+elif test $ac_cv_prog_cc_g = yes; then
+  if test "$GCC" = yes; then
+    CFLAGS="-g -O2"
+  else
+    CFLAGS="-g"
+  fi
+else
+  if test "$GCC" = yes; then
+    CFLAGS="-O2"
+  else
+    CFLAGS=
+  fi
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $CC option to accept ISO C89" >&5
+$as_echo_n "checking for $CC option to accept ISO C89... " >&6; }
+if ${ac_cv_prog_cc_c89+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  ac_cv_prog_cc_c89=no
+ac_save_CC=$CC
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <stdarg.h>
+#include <stdio.h>
+#include <sys/types.h>
+#include <sys/stat.h>
+/* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
+struct buf { int x; };
+FILE * (*rcsopen) (struct buf *, struct stat *, int);
+static char *e (p, i)
+     char **p;
+     int i;
+{
+  return p[i];
+}
+static char *f (char * (*g) (char **, int), char **p, ...)
+{
+  char *s;
+  va_list v;
+  va_start (v,p);
+  s = g (p, va_arg (v,int));
+  va_end (v);
+  return s;
+}
+
+/* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
+   function prototypes and stuff, but not '\xHH' hex character constants.
+   These don't provoke an error unfortunately, instead are silently treated
+   as 'x'.  The following induces an error, until -std is added to get
+   proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
+   array size at least.  It's necessary to write '\x00'==0 to get something
+   that's true only with -std.  */
+int osf4_cc_array ['\x00' == 0 ? 1 : -1];
+
+/* IBM C 6 for AIX is almost-ANSI by default, but it replaces macro parameters
+   inside strings and character constants.  */
+#define FOO(x) 'x'
+int xlc6_cc_array[FOO(a) == 'x' ? 1 : -1];
+
+int test (int i, double x);
+struct s1 {int (*f) (int a);};
+struct s2 {int (*f) (double a);};
+int pairnames (int, char **, FILE *(*)(struct buf *, struct stat *, int), int, int);
+int argc;
+char **argv;
+int
+main ()
+{
+return f (e, argv, 0) != argv[0]  ||  f (e, argv, 1) != argv[1];
+  ;
+  return 0;
+}
+_ACEOF
+for ac_arg in '' -qlanglvl=extc89 -qlanglvl=ansi -std \
+	-Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
+do
+  CC="$ac_save_CC $ac_arg"
+  if ac_fn_c_try_compile "$LINENO"; then :
+  ac_cv_prog_cc_c89=$ac_arg
+fi
+rm -f core conftest.err conftest.$ac_objext
+  test "x$ac_cv_prog_cc_c89" != "xno" && break
+done
+rm -f conftest.$ac_ext
+CC=$ac_save_CC
+
+fi
+# AC_CACHE_VAL
+case "x$ac_cv_prog_cc_c89" in
+  x)
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
+$as_echo "none needed" >&6; } ;;
+  xno)
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
+$as_echo "unsupported" >&6; } ;;
+  *)
+    CC="$CC $ac_cv_prog_cc_c89"
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c89" >&5
+$as_echo "$ac_cv_prog_cc_c89" >&6; } ;;
+esac
+if test "x$ac_cv_prog_cc_c89" != xno; then :
+
+fi
+
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+
+for ac_prog in flex lex
+do
+  # Extract the first word of "$ac_prog", so it can be a program name with args.
+set dummy $ac_prog; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_LEX+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$LEX"; then
+  ac_cv_prog_LEX="$LEX" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_LEX="$ac_prog"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+LEX=$ac_cv_prog_LEX
+if test -n "$LEX"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $LEX" >&5
+$as_echo "$LEX" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+  test -n "$LEX" && break
+done
+test -n "$LEX" || LEX=":"
+
+if test "x$LEX" != "x:"; then
+  cat >conftest.l <<_ACEOF
+%%
+a { ECHO; }
+b { REJECT; }
+c { yymore (); }
+d { yyless (1); }
+e { yyless (input () != 0); }
+f { unput (yytext[0]); }
+. { BEGIN INITIAL; }
+%%
+#ifdef YYTEXT_POINTER
+extern char *yytext;
+#endif
+int
+main (void)
+{
+  return ! yylex () + ! yywrap ();
+}
+_ACEOF
+{ { ac_try="$LEX conftest.l"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$LEX conftest.l") 2>&5
+  ac_status=$?
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking lex output file root" >&5
+$as_echo_n "checking lex output file root... " >&6; }
+if ${ac_cv_prog_lex_root+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+
+if test -f lex.yy.c; then
+  ac_cv_prog_lex_root=lex.yy
+elif test -f lexyy.c; then
+  ac_cv_prog_lex_root=lexyy
+else
+  as_fn_error $? "cannot find output from $LEX; giving up" "$LINENO" 5
+fi
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_lex_root" >&5
+$as_echo "$ac_cv_prog_lex_root" >&6; }
+LEX_OUTPUT_ROOT=$ac_cv_prog_lex_root
+
+if test -z "${LEXLIB+set}"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking lex library" >&5
+$as_echo_n "checking lex library... " >&6; }
+if ${ac_cv_lib_lex+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+
+    ac_save_LIBS=$LIBS
+    ac_cv_lib_lex='none needed'
+    for ac_lib in '' -lfl -ll; do
+      LIBS="$ac_lib $ac_save_LIBS"
+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+`cat $LEX_OUTPUT_ROOT.c`
+_ACEOF
+if ac_fn_c_try_link "$LINENO"; then :
+  ac_cv_lib_lex=$ac_lib
+fi
+rm -f core conftest.err conftest.$ac_objext \
+    conftest$ac_exeext conftest.$ac_ext
+      test "$ac_cv_lib_lex" != 'none needed' && break
+    done
+    LIBS=$ac_save_LIBS
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_lex" >&5
+$as_echo "$ac_cv_lib_lex" >&6; }
+  test "$ac_cv_lib_lex" != 'none needed' && LEXLIB=$ac_cv_lib_lex
+fi
+
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether yytext is a pointer" >&5
+$as_echo_n "checking whether yytext is a pointer... " >&6; }
+if ${ac_cv_prog_lex_yytext_pointer+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  # POSIX says lex can declare yytext either as a pointer or an array; the
+# default is implementation-dependent.  Figure out which it is, since
+# not all implementations provide the %pointer and %array declarations.
+ac_cv_prog_lex_yytext_pointer=no
+ac_save_LIBS=$LIBS
+LIBS="$LEXLIB $ac_save_LIBS"
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+  #define YYTEXT_POINTER 1
+`cat $LEX_OUTPUT_ROOT.c`
+_ACEOF
+if ac_fn_c_try_link "$LINENO"; then :
+  ac_cv_prog_lex_yytext_pointer=yes
+fi
+rm -f core conftest.err conftest.$ac_objext \
+    conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_save_LIBS
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_lex_yytext_pointer" >&5
+$as_echo "$ac_cv_prog_lex_yytext_pointer" >&6; }
+if test $ac_cv_prog_lex_yytext_pointer = yes; then
+
+$as_echo "#define YYTEXT_POINTER 1" >>confdefs.h
+
+fi
+rm -f conftest.l $LEX_OUTPUT_ROOT.c
+
+fi
+for ac_prog in 'bison -y' byacc
+do
+  # Extract the first word of "$ac_prog", so it can be a program name with args.
+set dummy $ac_prog; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_YACC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$YACC"; then
+  ac_cv_prog_YACC="$YACC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_YACC="$ac_prog"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+YACC=$ac_cv_prog_YACC
+if test -n "$YACC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $YACC" >&5
+$as_echo "$YACC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+  test -n "$YACC" && break
+done
+test -n "$YACC" || YACC="yacc"
+
+
+test "$program_prefix" != NONE &&
+  program_transform_name="s&^&$program_prefix&;$program_transform_name"
+# Use a double $ so make ignores it.
+test "$program_suffix" != NONE &&
+  program_transform_name="s&\$&$program_suffix&;$program_transform_name"
+# Double any \ or $.
+# By default was `s,x,x', remove it if useless.
+ac_script='s/[\\$]/&&/g;s/;s,x,x,$//'
+program_transform_name=`$as_echo "$program_transform_name" | sed "$ac_script"`
+
+
+case $target_os in
+darwin*)
+	:
+	;;
+*)
+	as_fn_error $? "$PACKAGE_NAME only supports targeting Darwin" "$LINENO" 5
+	;;
+esac
+
+case $target_cpu in
+     arm)
+
+$as_echo "#define EMULATED_HOST_CPU_TYPE 12" >>confdefs.h
+
+
+$as_echo "#define EMULATED_HOST_CPU_SUBTYPE 6" >>confdefs.h
+
+
+$as_echo "#define DEFAULT_MACH_ARCH \"arm\"" >>confdefs.h
+
+	;;
+     powerpc)
+
+$as_echo "#define EMULATED_HOST_CPU_TYPE 18" >>confdefs.h
+
+
+$as_echo "#define EMULATED_HOST_CPU_SUBTYPE 100" >>confdefs.h
+
+
+$as_echo "#define DEFAULT_MACH_ARCH \"ppc\"" >>confdefs.h
+
+	;;
+     powerpc64)
+
+$as_echo "#define EMULATED_HOST_CPU_TYPE 16777234" >>confdefs.h
+
+
+$as_echo "#define EMULATED_HOST_CPU_SUBTYPE 0" >>confdefs.h
+
+
+$as_echo "#define DEFAULT_MACH_ARCH \"ppc64\"" >>confdefs.h
+
+	;;
+     i?86)
+
+$as_echo "#define EMULATED_HOST_CPU_TYPE 7" >>confdefs.h
+
+
+$as_echo "#define EMULATED_HOST_CPU_SUBTYPE 3" >>confdefs.h
+
+
+$as_echo "#define DEFAULT_MACH_ARCH \"i386\"" >>confdefs.h
+
+	;;
+     x86_64)
+
+$as_echo "#define EMULATED_HOST_CPU_TYPE 16777223" >>confdefs.h
+
+
+$as_echo "#define EMULATED_HOST_CPU_SUBTYPE 3" >>confdefs.h
+
+
+$as_echo "#define DEFAULT_MACH_ARCH \"x86_64\"" >>confdefs.h
+
+	;;
+     *)
+	as_fn_error $? "Unsupported target $target_cpu" "$LINENO" 5
+	;;
+esac
+
+case $host_os in
+		linux*)
+				cat >>confdefs.h <<_ACEOF
+#define CROSS_BIN_PREFIX "$target"
+_ACEOF
+
+		;;
+esac
+
+# Checks for programs.
+# Find a good install program.  We prefer a C program (faster),
+# so one script is as good as another.  But avoid the broken or
+# incompatible versions:
+# SysV /etc/install, /usr/sbin/install
+# SunOS /usr/etc/install
+# IRIX /sbin/install
+# AIX /bin/install
+# AmigaOS /C/install, which installs bootblocks on floppy discs
+# AIX 4 /usr/bin/installbsd, which doesn't work without a -g flag
+# AFS /usr/afsws/bin/install, which mishandles nonexistent args
+# SVR4 /usr/ucb/install, which tries to use the nonexistent group "staff"
+# OS/2's system install, which has a completely different semantic
+# ./install, which can be erroneously created by make from ./install.sh.
+# Reject install programs that cannot install multiple files.
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for a BSD-compatible install" >&5
+$as_echo_n "checking for a BSD-compatible install... " >&6; }
+if test -z "$INSTALL"; then
+if ${ac_cv_path_install+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    # Account for people who put trailing slashes in PATH elements.
+case $as_dir/ in #((
+  ./ | .// | /[cC]/* | \
+  /etc/* | /usr/sbin/* | /usr/etc/* | /sbin/* | /usr/afsws/bin/* | \
+  ?:[\\/]os2[\\/]install[\\/]* | ?:[\\/]OS2[\\/]INSTALL[\\/]* | \
+  /usr/ucb/* ) ;;
+  *)
+    # OSF1 and SCO ODT 3.0 have their own names for install.
+    # Don't use installbsd from OSF since it installs stuff as root
+    # by default.
+    for ac_prog in ginstall scoinst install; do
+      for ac_exec_ext in '' $ac_executable_extensions; do
+	if { test -f "$as_dir/$ac_prog$ac_exec_ext" && $as_test_x "$as_dir/$ac_prog$ac_exec_ext"; }; then
+	  if test $ac_prog = install &&
+	    grep dspmsg "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
+	    # AIX install.  It has an incompatible calling convention.
+	    :
+	  elif test $ac_prog = install &&
+	    grep pwplus "$as_dir/$ac_prog$ac_exec_ext" >/dev/null 2>&1; then
+	    # program-specific install script used by HP pwplus--don't use.
+	    :
+	  else
+	    rm -rf conftest.one conftest.two conftest.dir
+	    echo one > conftest.one
+	    echo two > conftest.two
+	    mkdir conftest.dir
+	    if "$as_dir/$ac_prog$ac_exec_ext" -c conftest.one conftest.two "`pwd`/conftest.dir" &&
+	      test -s conftest.one && test -s conftest.two &&
+	      test -s conftest.dir/conftest.one &&
+	      test -s conftest.dir/conftest.two
+	    then
+	      ac_cv_path_install="$as_dir/$ac_prog$ac_exec_ext -c"
+	      break 3
+	    fi
+	  fi
+	fi
+      done
+    done
+    ;;
+esac
+
+  done
+IFS=$as_save_IFS
+
+rm -rf conftest.one conftest.two conftest.dir
+
+fi
+  if test "${ac_cv_path_install+set}" = set; then
+    INSTALL=$ac_cv_path_install
+  else
+    # As a last resort, use the slow shell script.  Don't cache a
+    # value for INSTALL within a source directory, because that will
+    # break other packages using the cache if that directory is
+    # removed, or if the value is a relative name.
+    INSTALL=$ac_install_sh
+  fi
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $INSTALL" >&5
+$as_echo "$INSTALL" >&6; }
+
+# Use test -z because SunOS4 sh mishandles braces in ${var-val}.
+# It thinks the first close brace ends the variable substitution.
+test -z "$INSTALL_PROGRAM" && INSTALL_PROGRAM='${INSTALL}'
+
+test -z "$INSTALL_SCRIPT" && INSTALL_SCRIPT='${INSTALL}'
+
+test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether ln -s works" >&5
+$as_echo_n "checking whether ln -s works... " >&6; }
+LN_S=$as_ln_s
+if test "$LN_S" = "ln -s"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no, using $LN_S" >&5
+$as_echo "no, using $LN_S" >&6; }
+fi
+
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+if test -n "$ac_tool_prefix"; then
+  # Extract the first word of "${ac_tool_prefix}gcc", so it can be a program name with args.
+set dummy ${ac_tool_prefix}gcc; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_CC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_CC="${ac_tool_prefix}gcc"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+$as_echo "$CC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+fi
+if test -z "$ac_cv_prog_CC"; then
+  ac_ct_CC=$CC
+  # Extract the first word of "gcc", so it can be a program name with args.
+set dummy gcc; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_ac_ct_CC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$ac_ct_CC"; then
+  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_ac_ct_CC="gcc"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+ac_ct_CC=$ac_cv_prog_ac_ct_CC
+if test -n "$ac_ct_CC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CC" >&5
+$as_echo "$ac_ct_CC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+  if test "x$ac_ct_CC" = x; then
+    CC=""
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
+$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
+ac_tool_warned=yes ;;
+esac
+    CC=$ac_ct_CC
+  fi
+else
+  CC="$ac_cv_prog_CC"
+fi
+
+if test -z "$CC"; then
+          if test -n "$ac_tool_prefix"; then
+    # Extract the first word of "${ac_tool_prefix}cc", so it can be a program name with args.
+set dummy ${ac_tool_prefix}cc; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_CC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_CC="${ac_tool_prefix}cc"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+$as_echo "$CC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+  fi
+fi
+if test -z "$CC"; then
+  # Extract the first word of "cc", so it can be a program name with args.
+set dummy cc; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_CC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+  ac_prog_rejected=no
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    if test "$as_dir/$ac_word$ac_exec_ext" = "/usr/ucb/cc"; then
+       ac_prog_rejected=yes
+       continue
+     fi
+    ac_cv_prog_CC="cc"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+if test $ac_prog_rejected = yes; then
+  # We found a bogon in the path, so make sure we never use it.
+  set dummy $ac_cv_prog_CC
+  shift
+  if test $# != 0; then
+    # We chose a different compiler from the bogus one.
+    # However, it has the same basename, so the bogon will be chosen
+    # first if we set CC to just the basename; use the full file name.
+    shift
+    ac_cv_prog_CC="$as_dir/$ac_word${1+' '}$@"
+  fi
+fi
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+$as_echo "$CC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+fi
+if test -z "$CC"; then
+  if test -n "$ac_tool_prefix"; then
+  for ac_prog in cl.exe
+  do
+    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
+set dummy $ac_tool_prefix$ac_prog; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_CC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$CC"; then
+  ac_cv_prog_CC="$CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_CC="$ac_tool_prefix$ac_prog"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+CC=$ac_cv_prog_CC
+if test -n "$CC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CC" >&5
+$as_echo "$CC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+    test -n "$CC" && break
+  done
+fi
+if test -z "$CC"; then
+  ac_ct_CC=$CC
+  for ac_prog in cl.exe
+do
+  # Extract the first word of "$ac_prog", so it can be a program name with args.
+set dummy $ac_prog; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_ac_ct_CC+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$ac_ct_CC"; then
+  ac_cv_prog_ac_ct_CC="$ac_ct_CC" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_ac_ct_CC="$ac_prog"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+ac_ct_CC=$ac_cv_prog_ac_ct_CC
+if test -n "$ac_ct_CC"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CC" >&5
+$as_echo "$ac_ct_CC" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+  test -n "$ac_ct_CC" && break
+done
+
+  if test "x$ac_ct_CC" = x; then
+    CC=""
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
+$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
+ac_tool_warned=yes ;;
+esac
+    CC=$ac_ct_CC
+  fi
+fi
+
+fi
+
+
+test -z "$CC" && { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "no acceptable C compiler found in \$PATH
+See \`config.log' for more details" "$LINENO" 5; }
+
+# Provide some information about the compiler.
+$as_echo "$as_me:${as_lineno-$LINENO}: checking for C compiler version" >&5
+set X $ac_compile
+ac_compiler=$2
+for ac_option in --version -v -V -qversion; do
+  { { ac_try="$ac_compiler $ac_option >&5"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    sed '10a\
+... rest of stderr output deleted ...
+         10q' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+  fi
+  rm -f conftest.er1 conftest.err
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }
+done
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether we are using the GNU C compiler" >&5
+$as_echo_n "checking whether we are using the GNU C compiler... " >&6; }
+if ${ac_cv_c_compiler_gnu+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+#ifndef __GNUC__
+       choke me
+#endif
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  ac_compiler_gnu=yes
+else
+  ac_compiler_gnu=no
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+ac_cv_c_compiler_gnu=$ac_compiler_gnu
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_compiler_gnu" >&5
+$as_echo "$ac_cv_c_compiler_gnu" >&6; }
+if test $ac_compiler_gnu = yes; then
+  GCC=yes
+else
+  GCC=
+fi
+ac_test_CFLAGS=${CFLAGS+set}
+ac_save_CFLAGS=$CFLAGS
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether $CC accepts -g" >&5
+$as_echo_n "checking whether $CC accepts -g... " >&6; }
+if ${ac_cv_prog_cc_g+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  ac_save_c_werror_flag=$ac_c_werror_flag
+   ac_c_werror_flag=yes
+   ac_cv_prog_cc_g=no
+   CFLAGS="-g"
+   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  ac_cv_prog_cc_g=yes
+else
+  CFLAGS=""
+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+
+else
+  ac_c_werror_flag=$ac_save_c_werror_flag
+	 CFLAGS="-g"
+	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  ac_cv_prog_cc_g=yes
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+   ac_c_werror_flag=$ac_save_c_werror_flag
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_g" >&5
+$as_echo "$ac_cv_prog_cc_g" >&6; }
+if test "$ac_test_CFLAGS" = set; then
+  CFLAGS=$ac_save_CFLAGS
+elif test $ac_cv_prog_cc_g = yes; then
+  if test "$GCC" = yes; then
+    CFLAGS="-g -O2"
+  else
+    CFLAGS="-g"
+  fi
+else
+  if test "$GCC" = yes; then
+    CFLAGS="-O2"
+  else
+    CFLAGS=
+  fi
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $CC option to accept ISO C89" >&5
+$as_echo_n "checking for $CC option to accept ISO C89... " >&6; }
+if ${ac_cv_prog_cc_c89+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  ac_cv_prog_cc_c89=no
+ac_save_CC=$CC
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <stdarg.h>
+#include <stdio.h>
+#include <sys/types.h>
+#include <sys/stat.h>
+/* Most of the following tests are stolen from RCS 5.7's src/conf.sh.  */
+struct buf { int x; };
+FILE * (*rcsopen) (struct buf *, struct stat *, int);
+static char *e (p, i)
+     char **p;
+     int i;
+{
+  return p[i];
+}
+static char *f (char * (*g) (char **, int), char **p, ...)
+{
+  char *s;
+  va_list v;
+  va_start (v,p);
+  s = g (p, va_arg (v,int));
+  va_end (v);
+  return s;
+}
+
+/* OSF 4.0 Compaq cc is some sort of almost-ANSI by default.  It has
+   function prototypes and stuff, but not '\xHH' hex character constants.
+   These don't provoke an error unfortunately, instead are silently treated
+   as 'x'.  The following induces an error, until -std is added to get
+   proper ANSI mode.  Curiously '\x00'!='x' always comes out true, for an
+   array size at least.  It's necessary to write '\x00'==0 to get something
+   that's true only with -std.  */
+int osf4_cc_array ['\x00' == 0 ? 1 : -1];
+
+/* IBM C 6 for AIX is almost-ANSI by default, but it replaces macro parameters
+   inside strings and character constants.  */
+#define FOO(x) 'x'
+int xlc6_cc_array[FOO(a) == 'x' ? 1 : -1];
+
+int test (int i, double x);
+struct s1 {int (*f) (int a);};
+struct s2 {int (*f) (double a);};
+int pairnames (int, char **, FILE *(*)(struct buf *, struct stat *, int), int, int);
+int argc;
+char **argv;
+int
+main ()
+{
+return f (e, argv, 0) != argv[0]  ||  f (e, argv, 1) != argv[1];
+  ;
+  return 0;
+}
+_ACEOF
+for ac_arg in '' -qlanglvl=extc89 -qlanglvl=ansi -std \
+	-Ae "-Aa -D_HPUX_SOURCE" "-Xc -D__EXTENSIONS__"
+do
+  CC="$ac_save_CC $ac_arg"
+  if ac_fn_c_try_compile "$LINENO"; then :
+  ac_cv_prog_cc_c89=$ac_arg
+fi
+rm -f core conftest.err conftest.$ac_objext
+  test "x$ac_cv_prog_cc_c89" != "xno" && break
+done
+rm -f conftest.$ac_ext
+CC=$ac_save_CC
+
+fi
+# AC_CACHE_VAL
+case "x$ac_cv_prog_cc_c89" in
+  x)
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: none needed" >&5
+$as_echo "none needed" >&6; } ;;
+  xno)
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: unsupported" >&5
+$as_echo "unsupported" >&6; } ;;
+  *)
+    CC="$CC $ac_cv_prog_cc_c89"
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cc_c89" >&5
+$as_echo "$ac_cv_prog_cc_c89" >&6; } ;;
+esac
+if test "x$ac_cv_prog_cc_c89" != xno; then :
+
+fi
+
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+ac_ext=cpp
+ac_cpp='$CXXCPP $CPPFLAGS'
+ac_compile='$CXX -c $CXXFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CXX -o conftest$ac_exeext $CXXFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_cxx_compiler_gnu
+if test -z "$CXX"; then
+  if test -n "$CCC"; then
+    CXX=$CCC
+  else
+    if test -n "$ac_tool_prefix"; then
+  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
+  do
+    # Extract the first word of "$ac_tool_prefix$ac_prog", so it can be a program name with args.
+set dummy $ac_tool_prefix$ac_prog; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_CXX+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$CXX"; then
+  ac_cv_prog_CXX="$CXX" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_CXX="$ac_tool_prefix$ac_prog"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+CXX=$ac_cv_prog_CXX
+if test -n "$CXX"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $CXX" >&5
+$as_echo "$CXX" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+    test -n "$CXX" && break
+  done
+fi
+if test -z "$CXX"; then
+  ac_ct_CXX=$CXX
+  for ac_prog in g++ c++ gpp aCC CC cxx cc++ cl.exe FCC KCC RCC xlC_r xlC
+do
+  # Extract the first word of "$ac_prog", so it can be a program name with args.
+set dummy $ac_prog; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_ac_ct_CXX+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$ac_ct_CXX"; then
+  ac_cv_prog_ac_ct_CXX="$ac_ct_CXX" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_ac_ct_CXX="$ac_prog"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+ac_ct_CXX=$ac_cv_prog_ac_ct_CXX
+if test -n "$ac_ct_CXX"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_CXX" >&5
+$as_echo "$ac_ct_CXX" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+  test -n "$ac_ct_CXX" && break
+done
+
+  if test "x$ac_ct_CXX" = x; then
+    CXX="g++"
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
+$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
+ac_tool_warned=yes ;;
+esac
+    CXX=$ac_ct_CXX
+  fi
+fi
+
+  fi
+fi
+# Provide some information about the compiler.
+$as_echo "$as_me:${as_lineno-$LINENO}: checking for C++ compiler version" >&5
+set X $ac_compile
+ac_compiler=$2
+for ac_option in --version -v -V -qversion; do
+  { { ac_try="$ac_compiler $ac_option >&5"
+case "(($ac_try" in
+  *\"* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo="\"\$as_me:${as_lineno-$LINENO}: $ac_try_echo\""
+$as_echo "$ac_try_echo"; } >&5
+  (eval "$ac_compiler $ac_option >&5") 2>conftest.err
+  ac_status=$?
+  if test -s conftest.err; then
+    sed '10a\
+... rest of stderr output deleted ...
+         10q' conftest.err >conftest.er1
+    cat conftest.er1 >&5
+  fi
+  rm -f conftest.er1 conftest.err
+  $as_echo "$as_me:${as_lineno-$LINENO}: \$? = $ac_status" >&5
+  test $ac_status = 0; }
+done
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether we are using the GNU C++ compiler" >&5
+$as_echo_n "checking whether we are using the GNU C++ compiler... " >&6; }
+if ${ac_cv_cxx_compiler_gnu+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+#ifndef __GNUC__
+       choke me
+#endif
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_cxx_try_compile "$LINENO"; then :
+  ac_compiler_gnu=yes
+else
+  ac_compiler_gnu=no
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+ac_cv_cxx_compiler_gnu=$ac_compiler_gnu
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_cxx_compiler_gnu" >&5
+$as_echo "$ac_cv_cxx_compiler_gnu" >&6; }
+if test $ac_compiler_gnu = yes; then
+  GXX=yes
+else
+  GXX=
+fi
+ac_test_CXXFLAGS=${CXXFLAGS+set}
+ac_save_CXXFLAGS=$CXXFLAGS
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether $CXX accepts -g" >&5
+$as_echo_n "checking whether $CXX accepts -g... " >&6; }
+if ${ac_cv_prog_cxx_g+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  ac_save_cxx_werror_flag=$ac_cxx_werror_flag
+   ac_cxx_werror_flag=yes
+   ac_cv_prog_cxx_g=no
+   CXXFLAGS="-g"
+   cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_cxx_try_compile "$LINENO"; then :
+  ac_cv_prog_cxx_g=yes
+else
+  CXXFLAGS=""
+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_cxx_try_compile "$LINENO"; then :
+
+else
+  ac_cxx_werror_flag=$ac_save_cxx_werror_flag
+	 CXXFLAGS="-g"
+	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_cxx_try_compile "$LINENO"; then :
+  ac_cv_prog_cxx_g=yes
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+   ac_cxx_werror_flag=$ac_save_cxx_werror_flag
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_prog_cxx_g" >&5
+$as_echo "$ac_cv_prog_cxx_g" >&6; }
+if test "$ac_test_CXXFLAGS" = set; then
+  CXXFLAGS=$ac_save_CXXFLAGS
+elif test $ac_cv_prog_cxx_g = yes; then
+  if test "$GXX" = yes; then
+    CXXFLAGS="-g -O2"
+  else
+    CXXFLAGS="-g"
+  fi
+else
+  if test "$GXX" = yes; then
+    CXXFLAGS="-O2"
+  else
+    CXXFLAGS=
+  fi
+fi
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+
+if test -n "$ac_tool_prefix"; then
+  # Extract the first word of "${ac_tool_prefix}ranlib", so it can be a program name with args.
+set dummy ${ac_tool_prefix}ranlib; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_HOST_RANLIB+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$HOST_RANLIB"; then
+  ac_cv_prog_HOST_RANLIB="$HOST_RANLIB" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_HOST_RANLIB="${ac_tool_prefix}ranlib"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+HOST_RANLIB=$ac_cv_prog_HOST_RANLIB
+if test -n "$HOST_RANLIB"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $HOST_RANLIB" >&5
+$as_echo "$HOST_RANLIB" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+fi
+if test -z "$ac_cv_prog_HOST_RANLIB"; then
+  ac_ct_HOST_RANLIB=$HOST_RANLIB
+  # Extract the first word of "ranlib", so it can be a program name with args.
+set dummy ranlib; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_ac_ct_HOST_RANLIB+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$ac_ct_HOST_RANLIB"; then
+  ac_cv_prog_ac_ct_HOST_RANLIB="$ac_ct_HOST_RANLIB" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_ac_ct_HOST_RANLIB="ranlib"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+ac_ct_HOST_RANLIB=$ac_cv_prog_ac_ct_HOST_RANLIB
+if test -n "$ac_ct_HOST_RANLIB"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_HOST_RANLIB" >&5
+$as_echo "$ac_ct_HOST_RANLIB" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+  if test "x$ac_ct_HOST_RANLIB" = x; then
+    HOST_RANLIB=":"
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
+$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
+ac_tool_warned=yes ;;
+esac
+    HOST_RANLIB=$ac_ct_HOST_RANLIB
+  fi
+else
+  HOST_RANLIB="$ac_cv_prog_HOST_RANLIB"
+fi
+
+if test -n "$ac_tool_prefix"; then
+  # Extract the first word of "${ac_tool_prefix}ar", so it can be a program name with args.
+set dummy ${ac_tool_prefix}ar; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_HOST_AR+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$HOST_AR"; then
+  ac_cv_prog_HOST_AR="$HOST_AR" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_HOST_AR="${ac_tool_prefix}ar"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+HOST_AR=$ac_cv_prog_HOST_AR
+if test -n "$HOST_AR"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $HOST_AR" >&5
+$as_echo "$HOST_AR" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+
+fi
+if test -z "$ac_cv_prog_HOST_AR"; then
+  ac_ct_HOST_AR=$HOST_AR
+  # Extract the first word of "ar", so it can be a program name with args.
+set dummy ar; ac_word=$2
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for $ac_word" >&5
+$as_echo_n "checking for $ac_word... " >&6; }
+if ${ac_cv_prog_ac_ct_HOST_AR+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -n "$ac_ct_HOST_AR"; then
+  ac_cv_prog_ac_ct_HOST_AR="$ac_ct_HOST_AR" # Let the user override the test.
+else
+as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_exec_ext in '' $ac_executable_extensions; do
+  if { test -f "$as_dir/$ac_word$ac_exec_ext" && $as_test_x "$as_dir/$ac_word$ac_exec_ext"; }; then
+    ac_cv_prog_ac_ct_HOST_AR="ar"
+    $as_echo "$as_me:${as_lineno-$LINENO}: found $as_dir/$ac_word$ac_exec_ext" >&5
+    break 2
+  fi
+done
+  done
+IFS=$as_save_IFS
+
+fi
+fi
+ac_ct_HOST_AR=$ac_cv_prog_ac_ct_HOST_AR
+if test -n "$ac_ct_HOST_AR"; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_ct_HOST_AR" >&5
+$as_echo "$ac_ct_HOST_AR" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+
+  if test "x$ac_ct_HOST_AR" = x; then
+    HOST_AR=":"
+  else
+    case $cross_compiling:$ac_tool_warned in
+yes:)
+{ $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: using cross tools not prefixed with host triplet" >&5
+$as_echo "$as_me: WARNING: using cross tools not prefixed with host triplet" >&2;}
+ac_tool_warned=yes ;;
+esac
+    HOST_AR=$ac_ct_HOST_AR
+  fi
+else
+  HOST_AR="$ac_cv_prog_HOST_AR"
+fi
+
+
+ASTARGETS=""
+conftargets=""
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for configured assembler targets" >&5
+$as_echo_n "checking for configured assembler targets... " >&6; }
+# Check whether --enable-as-targets was given.
+if test "${enable_as_targets+set}" = set; then :
+  enableval=$enable_as_targets; conftargets="$enableval"
+else
+  conftargets="default"
+fi
+
+
+case "$conftargets" in
+     all)
+        ASTARGETS="ppc ppc64 i386 x86_64 arm"
+	;;
+     default)
+	ASTARGETS="ppc ppc64 i386 x86_64 arm"
+	;;
+     yes)
+	as_fn_error $? "no assembler targets configured" "$LINENO" 5
+	;;
+     no)
+	as_fn_error $? "no assembler targets configured" "$LINENO" 5
+	;;
+     *)
+	if [ -z "$conftargets" ]; then
+	   as_fn_error $? "no assembler targets configured" "$LINENO" 5
+	fi
+	ASTARGETS="$conftargets"
+	;;
+esac
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ASTARGETS" >&5
+$as_echo "$ASTARGETS" >&6; }
+ASTARGETS=$ASTARGETS
+
+
+
+# Check whether --with-sysroot was given.
+if test "${with_sysroot+set}" = set; then :
+  withval=$with_sysroot;
+cat >>confdefs.h <<_ACEOF
+#define CROSS_SYSROOT "$withval"
+_ACEOF
+
+fi
+
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -mdynamic-no-pic"
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if -mdynamic-no-pic is supported" >&5
+$as_echo_n "checking if -mdynamic-no-pic is supported... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+const char hw[] = "Hello, World\n";
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  MDYNAMICNOPIC=-mdynamic-no-pic
+
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+else
+
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+CFLAGS=$ORIGCFLAGS
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -fno-builtin-round"
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if -fno-builtin-round is supported" >&5
+$as_echo_n "checking if -fno-builtin-round is supported... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+const char hw[] = "Hello, World\n";
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+else
+  CFLAGS=$ORIGCFLAGS
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -fno-builtin-trunc"
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if -fno-builtin-trunc is supported" >&5
+$as_echo_n "checking if -fno-builtin-trunc is supported... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+const char hw[] = "Hello, World\n";
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+else
+  CFLAGS=$ORIGCFLAGS
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -no-cpp-precomp"
+supported=0
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if -no-cpp-precomp is supported" >&5
+$as_echo_n "checking if -no-cpp-precomp is supported... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+const char hw[] = "Hello, World\n";
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+out=`$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext 2>&1`
+if [ $? -ne 0 ]; then
+   supported=0;
+else
+   unrecog=`echo $out | grep unrecog | wc -l`
+   if [ $unrecog -gt 0 ]; then
+      supported=0;
+   else
+      supported=1;
+   fi
+fi
+
+if [ $supported -eq 1 ]; then
+   { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+else
+   CFLAGS="$ORIGCFLAGS"
+   { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+fi
+rm -f conftest.$ac_objext conftest$ac_exeext conftest.$ac_ext
+
+WARNINGS=""
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -Wall"
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if -Wall is supported" >&5
+$as_echo_n "checking if -Wall is supported... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+const char hw[] = "Hello, World\n";
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  WARNINGS="$WARNINGS -Wall"
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+CFLAGS=$ORIGCFLAGS
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -Wno-long-double"
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if -Wno-long-double is supported" >&5
+$as_echo_n "checking if -Wno-long-double is supported... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+const char hw[] = "Hello, World\n";
+		   void* should_warn = 5;
+
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  WARNINGS="$WARNINGS -Wno-long-double"
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+CFLAGS=$ORIGCFLAGS
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -Wno-import"
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if -Wno-import is supported" >&5
+$as_echo_n "checking if -Wno-import is supported... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+const char hw[] = "Hello, World\n";
+		   void* should_warn = 5;
+
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  WARNINGS="$WARNINGS -Wno-import"
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+CFLAGS=$ORIGCFLAGS
+
+WARNINGS=$WARNINGS
+
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -x objective-c"
+OBJC="-x objective-c"
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if -x objective-c is supported" >&5
+$as_echo_n "checking if -x objective-c is supported... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+@class foo;
+void bar(void) {
+     [foo alloc];
+}
+
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+
+$as_echo "#define HAVE_OBJC 1" >>confdefs.h
+
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+else
+  OBJC=""
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+OBJC=$OBJC
+
+CFLAGS=$ORIGCFLAGS
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if __private_extern__ is supported" >&5
+$as_echo_n "checking if __private_extern__ is supported... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+__private_extern__ int foo;
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  HAVE_PRIVEXT=YES
+
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+else
+  HAVE_PRIVEXT=NO
+
+    { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+ORIGLDFLAGS=$LDFLAGS
+LDFLAGS="-multiply_defined suppress"
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking if -multiply_defined suppress is supported" >&5
+$as_echo_n "checking if -multiply_defined suppress is supported... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"; then :
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: yes" >&5
+$as_echo "yes" >&6; }
+else
+  LDFLAGS="$ORIGLDFLAGS"
+	 { $as_echo "$as_me:${as_lineno-$LINENO}: result: no" >&5
+$as_echo "no" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext \
+    conftest$ac_exeext conftest.$ac_ext
+
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking how to run the C preprocessor" >&5
+$as_echo_n "checking how to run the C preprocessor... " >&6; }
+# On Suns, sometimes $CPP names a directory.
+if test -n "$CPP" && test -d "$CPP"; then
+  CPP=
+fi
+if test -z "$CPP"; then
+  if ${ac_cv_prog_CPP+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+      # Double quotes because CPP needs to be expanded
+    for CPP in "$CC -E" "$CC -E -traditional-cpp" "/lib/cpp"
+    do
+      ac_preproc_ok=false
+for ac_c_preproc_warn_flag in '' yes
+do
+  # Use a header file that comes with gcc, so configuring glibc
+  # with a fresh cross-compiler works.
+  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
+  # <limits.h> exists even on freestanding compilers.
+  # On the NeXT, cc -E runs the code through the compiler's parser,
+  # not just through cpp. "Syntax error" is here to catch this case.
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#ifdef __STDC__
+# include <limits.h>
+#else
+# include <assert.h>
+#endif
+		     Syntax error
+_ACEOF
+if ac_fn_c_try_cpp "$LINENO"; then :
+
+else
+  # Broken: fails on valid input.
+continue
+fi
+rm -f conftest.err conftest.i conftest.$ac_ext
+
+  # OK, works on sane cases.  Now check whether nonexistent headers
+  # can be detected and how.
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <ac_nonexistent.h>
+_ACEOF
+if ac_fn_c_try_cpp "$LINENO"; then :
+  # Broken: success on invalid input.
+continue
+else
+  # Passes both tests.
+ac_preproc_ok=:
+break
+fi
+rm -f conftest.err conftest.i conftest.$ac_ext
+
+done
+# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
+rm -f conftest.i conftest.err conftest.$ac_ext
+if $ac_preproc_ok; then :
+  break
+fi
+
+    done
+    ac_cv_prog_CPP=$CPP
+
+fi
+  CPP=$ac_cv_prog_CPP
+else
+  ac_cv_prog_CPP=$CPP
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $CPP" >&5
+$as_echo "$CPP" >&6; }
+ac_preproc_ok=false
+for ac_c_preproc_warn_flag in '' yes
+do
+  # Use a header file that comes with gcc, so configuring glibc
+  # with a fresh cross-compiler works.
+  # Prefer <limits.h> to <assert.h> if __STDC__ is defined, since
+  # <limits.h> exists even on freestanding compilers.
+  # On the NeXT, cc -E runs the code through the compiler's parser,
+  # not just through cpp. "Syntax error" is here to catch this case.
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#ifdef __STDC__
+# include <limits.h>
+#else
+# include <assert.h>
+#endif
+		     Syntax error
+_ACEOF
+if ac_fn_c_try_cpp "$LINENO"; then :
+
+else
+  # Broken: fails on valid input.
+continue
+fi
+rm -f conftest.err conftest.i conftest.$ac_ext
+
+  # OK, works on sane cases.  Now check whether nonexistent headers
+  # can be detected and how.
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <ac_nonexistent.h>
+_ACEOF
+if ac_fn_c_try_cpp "$LINENO"; then :
+  # Broken: success on invalid input.
+continue
+else
+  # Passes both tests.
+ac_preproc_ok=:
+break
+fi
+rm -f conftest.err conftest.i conftest.$ac_ext
+
+done
+# Because of `break', _AC_PREPROC_IFELSE's cleaning code was skipped.
+rm -f conftest.i conftest.err conftest.$ac_ext
+if $ac_preproc_ok; then :
+
+else
+  { { $as_echo "$as_me:${as_lineno-$LINENO}: error: in \`$ac_pwd':" >&5
+$as_echo "$as_me: error: in \`$ac_pwd':" >&2;}
+as_fn_error $? "C preprocessor \"$CPP\" fails sanity check
+See \`config.log' for more details" "$LINENO" 5; }
+fi
+
+ac_ext=c
+ac_cpp='$CPP $CPPFLAGS'
+ac_compile='$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext >&5'
+ac_link='$CC -o conftest$ac_exeext $CFLAGS $CPPFLAGS $LDFLAGS conftest.$ac_ext $LIBS >&5'
+ac_compiler_gnu=$ac_cv_c_compiler_gnu
+
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for grep that handles long lines and -e" >&5
+$as_echo_n "checking for grep that handles long lines and -e... " >&6; }
+if ${ac_cv_path_GREP+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test -z "$GREP"; then
+  ac_path_GREP_found=false
+  # Loop through the user's path and test for each of PROGNAME-LIST
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_prog in grep ggrep; do
+    for ac_exec_ext in '' $ac_executable_extensions; do
+      ac_path_GREP="$as_dir/$ac_prog$ac_exec_ext"
+      { test -f "$ac_path_GREP" && $as_test_x "$ac_path_GREP"; } || continue
+# Check for GNU ac_path_GREP and select it if it is found.
+  # Check for GNU $ac_path_GREP
+case `"$ac_path_GREP" --version 2>&1` in
+*GNU*)
+  ac_cv_path_GREP="$ac_path_GREP" ac_path_GREP_found=:;;
+*)
+  ac_count=0
+  $as_echo_n 0123456789 >"conftest.in"
+  while :
+  do
+    cat "conftest.in" "conftest.in" >"conftest.tmp"
+    mv "conftest.tmp" "conftest.in"
+    cp "conftest.in" "conftest.nl"
+    $as_echo 'GREP' >> "conftest.nl"
+    "$ac_path_GREP" -e 'GREP$' -e '-(cannot match)-' < "conftest.nl" >"conftest.out" 2>/dev/null || break
+    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
+    as_fn_arith $ac_count + 1 && ac_count=$as_val
+    if test $ac_count -gt ${ac_path_GREP_max-0}; then
+      # Best one so far, save it but keep looking for a better one
+      ac_cv_path_GREP="$ac_path_GREP"
+      ac_path_GREP_max=$ac_count
+    fi
+    # 10*(2^10) chars as input seems more than enough
+    test $ac_count -gt 10 && break
+  done
+  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
+esac
+
+      $ac_path_GREP_found && break 3
+    done
+  done
+  done
+IFS=$as_save_IFS
+  if test -z "$ac_cv_path_GREP"; then
+    as_fn_error $? "no acceptable grep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
+  fi
+else
+  ac_cv_path_GREP=$GREP
+fi
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_path_GREP" >&5
+$as_echo "$ac_cv_path_GREP" >&6; }
+ GREP="$ac_cv_path_GREP"
+
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for egrep" >&5
+$as_echo_n "checking for egrep... " >&6; }
+if ${ac_cv_path_EGREP+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if echo a | $GREP -E '(a|b)' >/dev/null 2>&1
+   then ac_cv_path_EGREP="$GREP -E"
+   else
+     if test -z "$EGREP"; then
+  ac_path_EGREP_found=false
+  # Loop through the user's path and test for each of PROGNAME-LIST
+  as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH$PATH_SEPARATOR/usr/xpg4/bin
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    for ac_prog in egrep; do
+    for ac_exec_ext in '' $ac_executable_extensions; do
+      ac_path_EGREP="$as_dir/$ac_prog$ac_exec_ext"
+      { test -f "$ac_path_EGREP" && $as_test_x "$ac_path_EGREP"; } || continue
+# Check for GNU ac_path_EGREP and select it if it is found.
+  # Check for GNU $ac_path_EGREP
+case `"$ac_path_EGREP" --version 2>&1` in
+*GNU*)
+  ac_cv_path_EGREP="$ac_path_EGREP" ac_path_EGREP_found=:;;
+*)
+  ac_count=0
+  $as_echo_n 0123456789 >"conftest.in"
+  while :
+  do
+    cat "conftest.in" "conftest.in" >"conftest.tmp"
+    mv "conftest.tmp" "conftest.in"
+    cp "conftest.in" "conftest.nl"
+    $as_echo 'EGREP' >> "conftest.nl"
+    "$ac_path_EGREP" 'EGREP$' < "conftest.nl" >"conftest.out" 2>/dev/null || break
+    diff "conftest.out" "conftest.nl" >/dev/null 2>&1 || break
+    as_fn_arith $ac_count + 1 && ac_count=$as_val
+    if test $ac_count -gt ${ac_path_EGREP_max-0}; then
+      # Best one so far, save it but keep looking for a better one
+      ac_cv_path_EGREP="$ac_path_EGREP"
+      ac_path_EGREP_max=$ac_count
+    fi
+    # 10*(2^10) chars as input seems more than enough
+    test $ac_count -gt 10 && break
+  done
+  rm -f conftest.in conftest.tmp conftest.nl conftest.out;;
+esac
+
+      $ac_path_EGREP_found && break 3
+    done
+  done
+  done
+IFS=$as_save_IFS
+  if test -z "$ac_cv_path_EGREP"; then
+    as_fn_error $? "no acceptable egrep could be found in $PATH$PATH_SEPARATOR/usr/xpg4/bin" "$LINENO" 5
+  fi
+else
+  ac_cv_path_EGREP=$EGREP
+fi
+
+   fi
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_path_EGREP" >&5
+$as_echo "$ac_cv_path_EGREP" >&6; }
+ EGREP="$ac_cv_path_EGREP"
+
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for ANSI C header files" >&5
+$as_echo_n "checking for ANSI C header files... " >&6; }
+if ${ac_cv_header_stdc+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <stdlib.h>
+#include <stdarg.h>
+#include <string.h>
+#include <float.h>
+
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  ac_cv_header_stdc=yes
+else
+  ac_cv_header_stdc=no
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+if test $ac_cv_header_stdc = yes; then
+  # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <string.h>
+
+_ACEOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  $EGREP "memchr" >/dev/null 2>&1; then :
+
+else
+  ac_cv_header_stdc=no
+fi
+rm -f conftest*
+
+fi
+
+if test $ac_cv_header_stdc = yes; then
+  # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <stdlib.h>
+
+_ACEOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  $EGREP "free" >/dev/null 2>&1; then :
+
+else
+  ac_cv_header_stdc=no
+fi
+rm -f conftest*
+
+fi
+
+if test $ac_cv_header_stdc = yes; then
+  # /bin/cc in Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.
+  if test "$cross_compiling" = yes; then :
+  :
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <ctype.h>
+#include <stdlib.h>
+#if ((' ' & 0x0FF) == 0x020)
+# define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
+# define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
+#else
+# define ISLOWER(c) \
+		   (('a' <= (c) && (c) <= 'i') \
+		     || ('j' <= (c) && (c) <= 'r') \
+		     || ('s' <= (c) && (c) <= 'z'))
+# define TOUPPER(c) (ISLOWER(c) ? ((c) | 0x40) : (c))
+#endif
+
+#define XOR(e, f) (((e) && !(f)) || (!(e) && (f)))
+int
+main ()
+{
+  int i;
+  for (i = 0; i < 256; i++)
+    if (XOR (islower (i), ISLOWER (i))
+	|| toupper (i) != TOUPPER (i))
+      return 2;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_run "$LINENO"; then :
+
+else
+  ac_cv_header_stdc=no
+fi
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
+  conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+
+fi
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_header_stdc" >&5
+$as_echo "$ac_cv_header_stdc" >&6; }
+if test $ac_cv_header_stdc = yes; then
+
+$as_echo "#define STDC_HEADERS 1" >>confdefs.h
+
+fi
+
+# On IRIX 5.3, sys/types and inttypes.h are conflicting.
+for ac_header in sys/types.h sys/stat.h stdlib.h string.h memory.h strings.h \
+		  inttypes.h stdint.h unistd.h
+do :
+  as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
+ac_fn_c_check_header_compile "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default
+"
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
+  cat >>confdefs.h <<_ACEOF
+#define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+
+fi
+
+done
+
+
+for ac_header in stdio.h errno.h limits.h
+do :
+  as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
+ac_fn_c_check_header_mongrel "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default"
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
+  cat >>confdefs.h <<_ACEOF
+#define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+
+fi
+
+done
+
+if [ "x$OBJC" != "x" ]; then
+   ORIGCFLAGS=$CFLAGS
+   CFLAGS="$CFLAGS $OBJC"
+   for ac_header in objc/objc-runtime.h
+do :
+  ac_fn_c_check_header_mongrel "$LINENO" "objc/objc-runtime.h" "ac_cv_header_objc_objc_runtime_h" "$ac_includes_default"
+if test "x$ac_cv_header_objc_objc_runtime_h" = xyes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_OBJC_OBJC_RUNTIME_H 1
+_ACEOF
+
+fi
+
+done
+
+   CFLAGS="$ORIGCFLAGS"
+fi
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for max unsigned long long" >&5
+$as_echo_n "checking for max unsigned long long... " >&6; }
+cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#if HAVE_LIMITS_H
+			 #include <limits.h>
+		     #endif
+		     unsigned long long a = ULLONG_MAX;
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: ULLONG_MAX" >&5
+$as_echo "ULLONG_MAX" >&6; }
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#if HAVE_LIMITS_H
+			      #include <limits.h>
+			 #endif
+			 unsigned long long a = 18446744073709551615ULL;
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+
+$as_echo "#define ULLONG_MAX 18446744073709551615ULL" >>confdefs.h
+
+	 { $as_echo "$as_me:${as_lineno-$LINENO}: result: 18446744073709551615ULL" >&5
+$as_echo "18446744073709551615ULL" >&6; }
+else
+  { $as_echo "$as_me:${as_lineno-$LINENO}: result: none" >&5
+$as_echo "none" >&6; }
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+
+for ac_func in atexit bzero fchdir ftruncate getattrlist getpagesize gettimeofday memchr memmove memset NSIsSymbolNameDefined qsort_r qsort realpath sqrt strcasecmp strchr strdup strerror strlcat strmode strncasecmp strrchr strstr strtol strtoul utime _NSGetExecutablePath readlink
+do :
+  as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
+ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
+  cat >>confdefs.h <<_ACEOF
+#define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
+_ACEOF
+
+fi
+done
+
+
+ac_fn_c_check_decl "$LINENO" "getc_unlocked" "ac_cv_have_decl_getc_unlocked" "$ac_includes_default"
+if test "x$ac_cv_have_decl_getc_unlocked" = xyes; then :
+  ac_have_decl=1
+else
+  ac_have_decl=0
+fi
+
+cat >>confdefs.h <<_ACEOF
+#define HAVE_DECL_GETC_UNLOCKED $ac_have_decl
+_ACEOF
+
+
+
+case $host_os in
+     darwin*)
+	HAVE_FOREIGN_HEADERS=NO
+
+	;;
+     *)
+	HAVE_FOREIGN_HEADERS=YES
+
+	EMULATED_OBJ=emulated.c
+
+	 { $as_echo "$as_me:${as_lineno-$LINENO}: checking whether byte ordering is bigendian" >&5
+$as_echo_n "checking whether byte ordering is bigendian... " >&6; }
+if ${ac_cv_c_bigendian+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  ac_cv_c_bigendian=unknown
+    # See if we're dealing with a universal compiler.
+    cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#ifndef __APPLE_CC__
+	       not a universal capable compiler
+	     #endif
+	     typedef int dummy;
+
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+
+	# Check for potential -arch flags.  It is not universal unless
+	# there are at least two -arch flags with different values.
+	ac_arch=
+	ac_prev=
+	for ac_word in $CC $CFLAGS $CPPFLAGS $LDFLAGS; do
+	 if test -n "$ac_prev"; then
+	   case $ac_word in
+	     i?86 | x86_64 | ppc | ppc64)
+	       if test -z "$ac_arch" || test "$ac_arch" = "$ac_word"; then
+		 ac_arch=$ac_word
+	       else
+		 ac_cv_c_bigendian=universal
+		 break
+	       fi
+	       ;;
+	   esac
+	   ac_prev=
+	 elif test "x$ac_word" = "x-arch"; then
+	   ac_prev=arch
+	 fi
+       done
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+    if test $ac_cv_c_bigendian = unknown; then
+      # See if sys/param.h defines the BYTE_ORDER macro.
+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <sys/types.h>
+	     #include <sys/param.h>
+
+int
+main ()
+{
+#if ! (defined BYTE_ORDER && defined BIG_ENDIAN \
+		     && defined LITTLE_ENDIAN && BYTE_ORDER && BIG_ENDIAN \
+		     && LITTLE_ENDIAN)
+	      bogus endian macros
+	     #endif
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  # It does; now see whether it defined to BIG_ENDIAN or not.
+	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <sys/types.h>
+		#include <sys/param.h>
+
+int
+main ()
+{
+#if BYTE_ORDER != BIG_ENDIAN
+		 not big endian
+		#endif
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  ac_cv_c_bigendian=yes
+else
+  ac_cv_c_bigendian=no
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+    fi
+    if test $ac_cv_c_bigendian = unknown; then
+      # See if <limits.h> defines _LITTLE_ENDIAN or _BIG_ENDIAN (e.g., Solaris).
+      cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <limits.h>
+
+int
+main ()
+{
+#if ! (defined _LITTLE_ENDIAN || defined _BIG_ENDIAN)
+	      bogus endian macros
+	     #endif
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  # It does; now see whether it defined to _BIG_ENDIAN or not.
+	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <limits.h>
+
+int
+main ()
+{
+#ifndef _BIG_ENDIAN
+		 not big endian
+		#endif
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  ac_cv_c_bigendian=yes
+else
+  ac_cv_c_bigendian=no
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+    fi
+    if test $ac_cv_c_bigendian = unknown; then
+      # Compile a test program.
+      if test "$cross_compiling" = yes; then :
+  # Try to guess by grepping values from an object file.
+	 cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+short int ascii_mm[] =
+		  { 0x4249, 0x4765, 0x6E44, 0x6961, 0x6E53, 0x7953, 0 };
+		short int ascii_ii[] =
+		  { 0x694C, 0x5454, 0x656C, 0x6E45, 0x6944, 0x6E61, 0 };
+		int use_ascii (int i) {
+		  return ascii_mm[i] + ascii_ii[i];
+		}
+		short int ebcdic_ii[] =
+		  { 0x89D3, 0xE3E3, 0x8593, 0x95C5, 0x89C4, 0x9581, 0 };
+		short int ebcdic_mm[] =
+		  { 0xC2C9, 0xC785, 0x95C4, 0x8981, 0x95E2, 0xA8E2, 0 };
+		int use_ebcdic (int i) {
+		  return ebcdic_mm[i] + ebcdic_ii[i];
+		}
+		extern int foo;
+
+int
+main ()
+{
+return use_ascii (foo) == use_ebcdic (foo);
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  if grep BIGenDianSyS conftest.$ac_objext >/dev/null; then
+	      ac_cv_c_bigendian=yes
+	    fi
+	    if grep LiTTleEnDian conftest.$ac_objext >/dev/null ; then
+	      if test "$ac_cv_c_bigendian" = unknown; then
+		ac_cv_c_bigendian=no
+	      else
+		# finding both strings is unlikely to happen, but who knows?
+		ac_cv_c_bigendian=unknown
+	      fi
+	    fi
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$ac_includes_default
+int
+main ()
+{
+
+	     /* Are we little or big endian?  From Harbison&Steele.  */
+	     union
+	     {
+	       long int l;
+	       char c[sizeof (long int)];
+	     } u;
+	     u.l = 1;
+	     return u.c[sizeof (long int) - 1] == 1;
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_run "$LINENO"; then :
+  ac_cv_c_bigendian=no
+else
+  ac_cv_c_bigendian=yes
+fi
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
+  conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+
+    fi
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_bigendian" >&5
+$as_echo "$ac_cv_c_bigendian" >&6; }
+ case $ac_cv_c_bigendian in #(
+   yes)
+     ENDIAN_FLAG=-D__BIG_ENDIAN__=1
+;; #(
+   no)
+     ENDIAN_FLAG=-D__LITTLE_ENDIAN__=1
+ ;; #(
+   universal)
+
+$as_echo "#define AC_APPLE_UNIVERSAL_BUILD 1" >>confdefs.h
+
+     ;; #(
+   *)
+     as_fn_error $? "unknown endianness
+ presetting ac_cv_c_bigendian=no (or yes) will help" "$LINENO" 5 ;;
+ esac
+
+	;;
+esac
+
+# Checks for typedefs, structures, and compiler characteristics.
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for stdbool.h that conforms to C99" >&5
+$as_echo_n "checking for stdbool.h that conforms to C99... " >&6; }
+if ${ac_cv_header_stdbool_h+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+
+#include <stdbool.h>
+#ifndef bool
+ "error: bool is not defined"
+#endif
+#ifndef false
+ "error: false is not defined"
+#endif
+#if false
+ "error: false is not 0"
+#endif
+#ifndef true
+ "error: true is not defined"
+#endif
+#if true != 1
+ "error: true is not 1"
+#endif
+#ifndef __bool_true_false_are_defined
+ "error: __bool_true_false_are_defined is not defined"
+#endif
+
+	struct s { _Bool s: 1; _Bool t; } s;
+
+	char a[true == 1 ? 1 : -1];
+	char b[false == 0 ? 1 : -1];
+	char c[__bool_true_false_are_defined == 1 ? 1 : -1];
+	char d[(bool) 0.5 == true ? 1 : -1];
+	/* See body of main program for 'e'.  */
+	char f[(_Bool) 0.0 == false ? 1 : -1];
+	char g[true];
+	char h[sizeof (_Bool)];
+	char i[sizeof s.t];
+	enum { j = false, k = true, l = false * true, m = true * 256 };
+	/* The following fails for
+	   HP aC++/ANSI C B3910B A.05.55 [Dec 04 2003]. */
+	_Bool n[m];
+	char o[sizeof n == m * sizeof n[0] ? 1 : -1];
+	char p[-1 - (_Bool) 0 < 0 && -1 - (bool) 0 < 0 ? 1 : -1];
+	/* Catch a bug in an HP-UX C compiler.  See
+	   http://gcc.gnu.org/ml/gcc-patches/2003-12/msg02303.html
+	   http://lists.gnu.org/archive/html/bug-coreutils/2005-11/msg00161.html
+	 */
+	_Bool q = true;
+	_Bool *pq = &q;
+
+int
+main ()
+{
+
+	bool e = &s;
+	*pq |= q;
+	*pq |= ! q;
+	/* Refer to every declared value, to avoid compiler optimizations.  */
+	return (!a + !b + !c + !d + !e + !f + !g + !h + !i + !!j + !k + !!l
+		+ !m + !n + !o + !p + !q + !pq);
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  ac_cv_header_stdbool_h=yes
+else
+  ac_cv_header_stdbool_h=no
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_header_stdbool_h" >&5
+$as_echo "$ac_cv_header_stdbool_h" >&6; }
+ac_fn_c_check_type "$LINENO" "_Bool" "ac_cv_type__Bool" "$ac_includes_default"
+if test "x$ac_cv_type__Bool" = xyes; then :
+
+cat >>confdefs.h <<_ACEOF
+#define HAVE__BOOL 1
+_ACEOF
+
+
+fi
+
+if test $ac_cv_header_stdbool_h = yes; then
+
+$as_echo "#define HAVE_STDBOOL_H 1" >>confdefs.h
+
+fi
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for uid_t in sys/types.h" >&5
+$as_echo_n "checking for uid_t in sys/types.h... " >&6; }
+if ${ac_cv_type_uid_t+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <sys/types.h>
+
+_ACEOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  $EGREP "uid_t" >/dev/null 2>&1; then :
+  ac_cv_type_uid_t=yes
+else
+  ac_cv_type_uid_t=no
+fi
+rm -f conftest*
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_type_uid_t" >&5
+$as_echo "$ac_cv_type_uid_t" >&6; }
+if test $ac_cv_type_uid_t = no; then
+
+$as_echo "#define uid_t int" >>confdefs.h
+
+
+$as_echo "#define gid_t int" >>confdefs.h
+
+fi
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for inline" >&5
+$as_echo_n "checking for inline... " >&6; }
+if ${ac_cv_c_inline+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  ac_cv_c_inline=no
+for ac_kw in inline __inline__ __inline; do
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#ifndef __cplusplus
+typedef int foo_t;
+static $ac_kw foo_t static_foo () {return 0; }
+$ac_kw foo_t foo () {return 0; }
+#endif
+
+_ACEOF
+if ac_fn_c_try_compile "$LINENO"; then :
+  ac_cv_c_inline=$ac_kw
+fi
+rm -f core conftest.err conftest.$ac_objext conftest.$ac_ext
+  test "$ac_cv_c_inline" != no && break
+done
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_inline" >&5
+$as_echo "$ac_cv_c_inline" >&6; }
+
+case $ac_cv_c_inline in
+  inline | yes) ;;
+  *)
+    case $ac_cv_c_inline in
+      no) ac_val=;;
+      *) ac_val=$ac_cv_c_inline;;
+    esac
+    cat >>confdefs.h <<_ACEOF
+#ifndef __cplusplus
+#define inline $ac_val
+#endif
+_ACEOF
+    ;;
+esac
+
+ac_fn_c_find_intX_t "$LINENO" "16" "ac_cv_c_int16_t"
+case $ac_cv_c_int16_t in #(
+  no|yes) ;; #(
+  *)
+
+cat >>confdefs.h <<_ACEOF
+#define int16_t $ac_cv_c_int16_t
+_ACEOF
+;;
+esac
+
+ac_fn_c_find_intX_t "$LINENO" "32" "ac_cv_c_int32_t"
+case $ac_cv_c_int32_t in #(
+  no|yes) ;; #(
+  *)
+
+cat >>confdefs.h <<_ACEOF
+#define int32_t $ac_cv_c_int32_t
+_ACEOF
+;;
+esac
+
+ac_fn_c_find_intX_t "$LINENO" "64" "ac_cv_c_int64_t"
+case $ac_cv_c_int64_t in #(
+  no|yes) ;; #(
+  *)
+
+cat >>confdefs.h <<_ACEOF
+#define int64_t $ac_cv_c_int64_t
+_ACEOF
+;;
+esac
+
+ac_fn_c_find_intX_t "$LINENO" "8" "ac_cv_c_int8_t"
+case $ac_cv_c_int8_t in #(
+  no|yes) ;; #(
+  *)
+
+cat >>confdefs.h <<_ACEOF
+#define int8_t $ac_cv_c_int8_t
+_ACEOF
+;;
+esac
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for obstacks" >&5
+$as_echo_n "checking for obstacks... " >&6; }
+if ${ac_cv_func_obstack+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$ac_includes_default
+		      #include "obstack.h"
+int
+main ()
+{
+struct obstack mem;
+		       #define obstack_chunk_alloc malloc
+		       #define obstack_chunk_free free
+		       obstack_init (&mem);
+		       obstack_free (&mem, 0);
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"; then :
+  ac_cv_func_obstack=yes
+else
+  ac_cv_func_obstack=no
+fi
+rm -f core conftest.err conftest.$ac_objext \
+    conftest$ac_exeext conftest.$ac_ext
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_obstack" >&5
+$as_echo "$ac_cv_func_obstack" >&6; }
+if test $ac_cv_func_obstack = yes; then
+
+$as_echo "#define HAVE_OBSTACK 1" >>confdefs.h
+
+else
+  case " $LIBOBJS " in
+  *" obstack.$ac_objext "* ) ;;
+  *) LIBOBJS="$LIBOBJS obstack.$ac_objext"
+ ;;
+esac
+
+fi
+
+ac_fn_c_check_type "$LINENO" "off_t" "ac_cv_type_off_t" "$ac_includes_default"
+if test "x$ac_cv_type_off_t" = xyes; then :
+
+else
+
+cat >>confdefs.h <<_ACEOF
+#define off_t long int
+_ACEOF
+
+fi
+
+ac_fn_c_check_type "$LINENO" "size_t" "ac_cv_type_size_t" "$ac_includes_default"
+if test "x$ac_cv_type_size_t" = xyes; then :
+
+else
+
+cat >>confdefs.h <<_ACEOF
+#define size_t unsigned int
+_ACEOF
+
+fi
+
+ac_fn_c_check_type "$LINENO" "ssize_t" "ac_cv_type_ssize_t" "$ac_includes_default"
+if test "x$ac_cv_type_ssize_t" = xyes; then :
+
+else
+
+cat >>confdefs.h <<_ACEOF
+#define ssize_t int
+_ACEOF
+
+fi
+
+ac_fn_c_find_uintX_t "$LINENO" "16" "ac_cv_c_uint16_t"
+case $ac_cv_c_uint16_t in #(
+  no|yes) ;; #(
+  *)
+
+
+cat >>confdefs.h <<_ACEOF
+#define uint16_t $ac_cv_c_uint16_t
+_ACEOF
+;;
+  esac
+
+ac_fn_c_find_uintX_t "$LINENO" "32" "ac_cv_c_uint32_t"
+case $ac_cv_c_uint32_t in #(
+  no|yes) ;; #(
+  *)
+
+$as_echo "#define _UINT32_T 1" >>confdefs.h
+
+
+cat >>confdefs.h <<_ACEOF
+#define uint32_t $ac_cv_c_uint32_t
+_ACEOF
+;;
+  esac
+
+ac_fn_c_find_uintX_t "$LINENO" "64" "ac_cv_c_uint64_t"
+case $ac_cv_c_uint64_t in #(
+  no|yes) ;; #(
+  *)
+
+$as_echo "#define _UINT64_T 1" >>confdefs.h
+
+
+cat >>confdefs.h <<_ACEOF
+#define uint64_t $ac_cv_c_uint64_t
+_ACEOF
+;;
+  esac
+
+ac_fn_c_find_uintX_t "$LINENO" "8" "ac_cv_c_uint8_t"
+case $ac_cv_c_uint8_t in #(
+  no|yes) ;; #(
+  *)
+
+$as_echo "#define _UINT8_T 1" >>confdefs.h
+
+
+cat >>confdefs.h <<_ACEOF
+#define uint8_t $ac_cv_c_uint8_t
+_ACEOF
+;;
+  esac
+
+ac_fn_c_check_type "$LINENO" "ptrdiff_t" "ac_cv_type_ptrdiff_t" "$ac_includes_default"
+if test "x$ac_cv_type_ptrdiff_t" = xyes; then :
+
+cat >>confdefs.h <<_ACEOF
+#define HAVE_PTRDIFF_T 1
+_ACEOF
+
+
+fi
+
+
+# Checks for library functions.
+# The Ultrix 4.2 mips builtin alloca declared by alloca.h only works
+# for constant arguments.  Useless!
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for working alloca.h" >&5
+$as_echo_n "checking for working alloca.h... " >&6; }
+if ${ac_cv_working_alloca_h+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <alloca.h>
+int
+main ()
+{
+char *p = (char *) alloca (2 * sizeof (int));
+			  if (p) return 0;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"; then :
+  ac_cv_working_alloca_h=yes
+else
+  ac_cv_working_alloca_h=no
+fi
+rm -f core conftest.err conftest.$ac_objext \
+    conftest$ac_exeext conftest.$ac_ext
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_working_alloca_h" >&5
+$as_echo "$ac_cv_working_alloca_h" >&6; }
+if test $ac_cv_working_alloca_h = yes; then
+
+$as_echo "#define HAVE_ALLOCA_H 1" >>confdefs.h
+
+fi
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for alloca" >&5
+$as_echo_n "checking for alloca... " >&6; }
+if ${ac_cv_func_alloca_works+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#ifdef __GNUC__
+# define alloca __builtin_alloca
+#else
+# ifdef _MSC_VER
+#  include <malloc.h>
+#  define alloca _alloca
+# else
+#  ifdef HAVE_ALLOCA_H
+#   include <alloca.h>
+#  else
+#   ifdef _AIX
+ #pragma alloca
+#   else
+#    ifndef alloca /* predefined by HP cc +Olibcalls */
+void *alloca (size_t);
+#    endif
+#   endif
+#  endif
+# endif
+#endif
+
+int
+main ()
+{
+char *p = (char *) alloca (1);
+				    if (p) return 0;
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"; then :
+  ac_cv_func_alloca_works=yes
+else
+  ac_cv_func_alloca_works=no
+fi
+rm -f core conftest.err conftest.$ac_objext \
+    conftest$ac_exeext conftest.$ac_ext
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_alloca_works" >&5
+$as_echo "$ac_cv_func_alloca_works" >&6; }
+
+if test $ac_cv_func_alloca_works = yes; then
+
+$as_echo "#define HAVE_ALLOCA 1" >>confdefs.h
+
+else
+  # The SVR3 libPW and SVR4 libucb both contain incompatible functions
+# that cause trouble.  Some versions do not even contain alloca or
+# contain a buggy version.  If you still want to use their alloca,
+# use ar to extract alloca.o from them instead of compiling alloca.c.
+
+ALLOCA=\${LIBOBJDIR}alloca.$ac_objext
+
+$as_echo "#define C_ALLOCA 1" >>confdefs.h
+
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking whether \`alloca.c' needs Cray hooks" >&5
+$as_echo_n "checking whether \`alloca.c' needs Cray hooks... " >&6; }
+if ${ac_cv_os_cray+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#if defined CRAY && ! defined CRAY2
+webecray
+#else
+wenotbecray
+#endif
+
+_ACEOF
+if (eval "$ac_cpp conftest.$ac_ext") 2>&5 |
+  $EGREP "webecray" >/dev/null 2>&1; then :
+  ac_cv_os_cray=yes
+else
+  ac_cv_os_cray=no
+fi
+rm -f conftest*
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_os_cray" >&5
+$as_echo "$ac_cv_os_cray" >&6; }
+if test $ac_cv_os_cray = yes; then
+  for ac_func in _getb67 GETB67 getb67; do
+    as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
+ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
+
+cat >>confdefs.h <<_ACEOF
+#define CRAY_STACKSEG_END $ac_func
+_ACEOF
+
+    break
+fi
+
+  done
+fi
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking stack direction for C alloca" >&5
+$as_echo_n "checking stack direction for C alloca... " >&6; }
+if ${ac_cv_c_stack_direction+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test "$cross_compiling" = yes; then :
+  ac_cv_c_stack_direction=0
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$ac_includes_default
+int
+find_stack_direction ()
+{
+  static char *addr = 0;
+  auto char dummy;
+  if (addr == 0)
+    {
+      addr = &dummy;
+      return find_stack_direction ();
+    }
+  else
+    return (&dummy > addr) ? 1 : -1;
+}
+
+int
+main ()
+{
+  return find_stack_direction () < 0;
+}
+_ACEOF
+if ac_fn_c_try_run "$LINENO"; then :
+  ac_cv_c_stack_direction=1
+else
+  ac_cv_c_stack_direction=-1
+fi
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
+  conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_c_stack_direction" >&5
+$as_echo "$ac_cv_c_stack_direction" >&6; }
+cat >>confdefs.h <<_ACEOF
+#define STACK_DIRECTION $ac_cv_c_stack_direction
+_ACEOF
+
+
+fi
+
+for ac_header in unistd.h
+do :
+  ac_fn_c_check_header_mongrel "$LINENO" "unistd.h" "ac_cv_header_unistd_h" "$ac_includes_default"
+if test "x$ac_cv_header_unistd_h" = xyes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_UNISTD_H 1
+_ACEOF
+
+fi
+
+done
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for working chown" >&5
+$as_echo_n "checking for working chown... " >&6; }
+if ${ac_cv_func_chown_works+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test "$cross_compiling" = yes; then :
+  ac_cv_func_chown_works=no
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$ac_includes_default
+#include <fcntl.h>
+
+int
+main ()
+{
+  char *f = "conftest.chown";
+  struct stat before, after;
+
+  if (creat (f, 0600) < 0)
+    return 1;
+  if (stat (f, &before) < 0)
+    return 1;
+  if (chown (f, (uid_t) -1, (gid_t) -1) == -1)
+    return 1;
+  if (stat (f, &after) < 0)
+    return 1;
+  return ! (before.st_uid == after.st_uid && before.st_gid == after.st_gid);
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_run "$LINENO"; then :
+  ac_cv_func_chown_works=yes
+else
+  ac_cv_func_chown_works=no
+fi
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
+  conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+
+rm -f conftest.chown
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_chown_works" >&5
+$as_echo "$ac_cv_func_chown_works" >&6; }
+if test $ac_cv_func_chown_works = yes; then
+
+$as_echo "#define HAVE_CHOWN 1" >>confdefs.h
+
+fi
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for error_at_line" >&5
+$as_echo_n "checking for error_at_line... " >&6; }
+if ${ac_cv_lib_error_at_line+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#include <error.h>
+int
+main ()
+{
+error_at_line (0, 0, "", 0, "an error occurred");
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_link "$LINENO"; then :
+  ac_cv_lib_error_at_line=yes
+else
+  ac_cv_lib_error_at_line=no
+fi
+rm -f core conftest.err conftest.$ac_objext \
+    conftest$ac_exeext conftest.$ac_ext
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_lib_error_at_line" >&5
+$as_echo "$ac_cv_lib_error_at_line" >&6; }
+if test $ac_cv_lib_error_at_line = no; then
+  case " $LIBOBJS " in
+  *" error.$ac_objext "* ) ;;
+  *) LIBOBJS="$LIBOBJS error.$ac_objext"
+ ;;
+esac
+
+fi
+
+ac_fn_c_check_type "$LINENO" "pid_t" "ac_cv_type_pid_t" "$ac_includes_default"
+if test "x$ac_cv_type_pid_t" = xyes; then :
+
+else
+
+cat >>confdefs.h <<_ACEOF
+#define pid_t int
+_ACEOF
+
+fi
+
+for ac_header in vfork.h
+do :
+  ac_fn_c_check_header_mongrel "$LINENO" "vfork.h" "ac_cv_header_vfork_h" "$ac_includes_default"
+if test "x$ac_cv_header_vfork_h" = xyes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_VFORK_H 1
+_ACEOF
+
+fi
+
+done
+
+for ac_func in fork vfork
+do :
+  as_ac_var=`$as_echo "ac_cv_func_$ac_func" | $as_tr_sh`
+ac_fn_c_check_func "$LINENO" "$ac_func" "$as_ac_var"
+if eval test \"x\$"$as_ac_var"\" = x"yes"; then :
+  cat >>confdefs.h <<_ACEOF
+#define `$as_echo "HAVE_$ac_func" | $as_tr_cpp` 1
+_ACEOF
+
+fi
+done
+
+if test "x$ac_cv_func_fork" = xyes; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for working fork" >&5
+$as_echo_n "checking for working fork... " >&6; }
+if ${ac_cv_func_fork_works+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test "$cross_compiling" = yes; then :
+  ac_cv_func_fork_works=cross
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$ac_includes_default
+int
+main ()
+{
+
+	  /* By Ruediger Kuhlmann. */
+	  return fork () < 0;
+
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_run "$LINENO"; then :
+  ac_cv_func_fork_works=yes
+else
+  ac_cv_func_fork_works=no
+fi
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
+  conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_fork_works" >&5
+$as_echo "$ac_cv_func_fork_works" >&6; }
+
+else
+  ac_cv_func_fork_works=$ac_cv_func_fork
+fi
+if test "x$ac_cv_func_fork_works" = xcross; then
+  case $host in
+    *-*-amigaos* | *-*-msdosdjgpp*)
+      # Override, as these systems have only a dummy fork() stub
+      ac_cv_func_fork_works=no
+      ;;
+    *)
+      ac_cv_func_fork_works=yes
+      ;;
+  esac
+  { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: result $ac_cv_func_fork_works guessed because of cross compilation" >&5
+$as_echo "$as_me: WARNING: result $ac_cv_func_fork_works guessed because of cross compilation" >&2;}
+fi
+ac_cv_func_vfork_works=$ac_cv_func_vfork
+if test "x$ac_cv_func_vfork" = xyes; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: checking for working vfork" >&5
+$as_echo_n "checking for working vfork... " >&6; }
+if ${ac_cv_func_vfork_works+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test "$cross_compiling" = yes; then :
+  ac_cv_func_vfork_works=cross
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+/* Thanks to Paul Eggert for this test.  */
+$ac_includes_default
+#include <sys/wait.h>
+#ifdef HAVE_VFORK_H
+# include <vfork.h>
+#endif
+/* On some sparc systems, changes by the child to local and incoming
+   argument registers are propagated back to the parent.  The compiler
+   is told about this with #include <vfork.h>, but some compilers
+   (e.g. gcc -O) don't grok <vfork.h>.  Test for this by using a
+   static variable whose address is put into a register that is
+   clobbered by the vfork.  */
+static void
+#ifdef __cplusplus
+sparc_address_test (int arg)
+# else
+sparc_address_test (arg) int arg;
+#endif
+{
+  static pid_t child;
+  if (!child) {
+    child = vfork ();
+    if (child < 0) {
+      perror ("vfork");
+      _exit(2);
+    }
+    if (!child) {
+      arg = getpid();
+      write(-1, "", 0);
+      _exit (arg);
+    }
+  }
+}
+
+int
+main ()
+{
+  pid_t parent = getpid ();
+  pid_t child;
+
+  sparc_address_test (0);
+
+  child = vfork ();
+
+  if (child == 0) {
+    /* Here is another test for sparc vfork register problems.  This
+       test uses lots of local variables, at least as many local
+       variables as main has allocated so far including compiler
+       temporaries.  4 locals are enough for gcc 1.40.3 on a Solaris
+       4.1.3 sparc, but we use 8 to be safe.  A buggy compiler should
+       reuse the register of parent for one of the local variables,
+       since it will think that parent can't possibly be used any more
+       in this routine.  Assigning to the local variable will thus
+       munge parent in the parent process.  */
+    pid_t
+      p = getpid(), p1 = getpid(), p2 = getpid(), p3 = getpid(),
+      p4 = getpid(), p5 = getpid(), p6 = getpid(), p7 = getpid();
+    /* Convince the compiler that p..p7 are live; otherwise, it might
+       use the same hardware register for all 8 local variables.  */
+    if (p != p1 || p != p2 || p != p3 || p != p4
+	|| p != p5 || p != p6 || p != p7)
+      _exit(1);
+
+    /* On some systems (e.g. IRIX 3.3), vfork doesn't separate parent
+       from child file descriptors.  If the child closes a descriptor
+       before it execs or exits, this munges the parent's descriptor
+       as well.  Test for this by closing stdout in the child.  */
+    _exit(close(fileno(stdout)) != 0);
+  } else {
+    int status;
+    struct stat st;
+
+    while (wait(&status) != child)
+      ;
+    return (
+	 /* Was there some problem with vforking?  */
+	 child < 0
+
+	 /* Did the child fail?  (This shouldn't happen.)  */
+	 || status
+
+	 /* Did the vfork/compiler bug occur?  */
+	 || parent != getpid()
+
+	 /* Did the file descriptor bug occur?  */
+	 || fstat(fileno(stdout), &st) != 0
+	 );
+  }
+}
+_ACEOF
+if ac_fn_c_try_run "$LINENO"; then :
+  ac_cv_func_vfork_works=yes
+else
+  ac_cv_func_vfork_works=no
+fi
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
+  conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_vfork_works" >&5
+$as_echo "$ac_cv_func_vfork_works" >&6; }
+
+fi;
+if test "x$ac_cv_func_fork_works" = xcross; then
+  ac_cv_func_vfork_works=$ac_cv_func_vfork
+  { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: result $ac_cv_func_vfork_works guessed because of cross compilation" >&5
+$as_echo "$as_me: WARNING: result $ac_cv_func_vfork_works guessed because of cross compilation" >&2;}
+fi
+
+if test "x$ac_cv_func_vfork_works" = xyes; then
+
+$as_echo "#define HAVE_WORKING_VFORK 1" >>confdefs.h
+
+else
+
+$as_echo "#define vfork fork" >>confdefs.h
+
+fi
+if test "x$ac_cv_func_fork_works" = xyes; then
+
+$as_echo "#define HAVE_WORKING_FORK 1" >>confdefs.h
+
+fi
+
+for ac_header in stdlib.h
+do :
+  ac_fn_c_check_header_mongrel "$LINENO" "stdlib.h" "ac_cv_header_stdlib_h" "$ac_includes_default"
+if test "x$ac_cv_header_stdlib_h" = xyes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_STDLIB_H 1
+_ACEOF
+
+fi
+
+done
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for GNU libc compatible malloc" >&5
+$as_echo_n "checking for GNU libc compatible malloc... " >&6; }
+if ${ac_cv_func_malloc_0_nonnull+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test "$cross_compiling" = yes; then :
+  ac_cv_func_malloc_0_nonnull=no
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#if defined STDC_HEADERS || defined HAVE_STDLIB_H
+# include <stdlib.h>
+#else
+char *malloc ();
+#endif
+
+int
+main ()
+{
+return ! malloc (0);
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_run "$LINENO"; then :
+  ac_cv_func_malloc_0_nonnull=yes
+else
+  ac_cv_func_malloc_0_nonnull=no
+fi
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
+  conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_malloc_0_nonnull" >&5
+$as_echo "$ac_cv_func_malloc_0_nonnull" >&6; }
+if test $ac_cv_func_malloc_0_nonnull = yes; then :
+
+$as_echo "#define HAVE_MALLOC 1" >>confdefs.h
+
+else
+  $as_echo "#define HAVE_MALLOC 0" >>confdefs.h
+
+   case " $LIBOBJS " in
+  *" malloc.$ac_objext "* ) ;;
+  *) LIBOBJS="$LIBOBJS malloc.$ac_objext"
+ ;;
+esac
+
+
+$as_echo "#define malloc rpl_malloc" >>confdefs.h
+
+fi
+
+
+
+
+
+  for ac_header in $ac_header_list
+do :
+  as_ac_Header=`$as_echo "ac_cv_header_$ac_header" | $as_tr_sh`
+ac_fn_c_check_header_compile "$LINENO" "$ac_header" "$as_ac_Header" "$ac_includes_default
+"
+if eval test \"x\$"$as_ac_Header"\" = x"yes"; then :
+  cat >>confdefs.h <<_ACEOF
+#define `$as_echo "HAVE_$ac_header" | $as_tr_cpp` 1
+_ACEOF
+
+fi
+
+done
+
+
+
+
+
+
+
+
+for ac_func in getpagesize
+do :
+  ac_fn_c_check_func "$LINENO" "getpagesize" "ac_cv_func_getpagesize"
+if test "x$ac_cv_func_getpagesize" = xyes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_GETPAGESIZE 1
+_ACEOF
+
+fi
+done
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for working mmap" >&5
+$as_echo_n "checking for working mmap... " >&6; }
+if ${ac_cv_func_mmap_fixed_mapped+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test "$cross_compiling" = yes; then :
+  ac_cv_func_mmap_fixed_mapped=no
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+$ac_includes_default
+/* malloc might have been renamed as rpl_malloc. */
+#undef malloc
+
+/* Thanks to Mike Haertel and Jim Avera for this test.
+   Here is a matrix of mmap possibilities:
+	mmap private not fixed
+	mmap private fixed at somewhere currently unmapped
+	mmap private fixed at somewhere already mapped
+	mmap shared not fixed
+	mmap shared fixed at somewhere currently unmapped
+	mmap shared fixed at somewhere already mapped
+   For private mappings, we should verify that changes cannot be read()
+   back from the file, nor mmap's back from the file at a different
+   address.  (There have been systems where private was not correctly
+   implemented like the infamous i386 svr4.0, and systems where the
+   VM page cache was not coherent with the file system buffer cache
+   like early versions of FreeBSD and possibly contemporary NetBSD.)
+   For shared mappings, we should conversely verify that changes get
+   propagated back to all the places they're supposed to be.
+
+   Grep wants private fixed already mapped.
+   The main things grep needs to know about mmap are:
+   * does it exist and is it safe to write into the mmap'd area
+   * how to use it (BSD variants)  */
+
+#include <fcntl.h>
+#include <sys/mman.h>
+
+#if !defined STDC_HEADERS && !defined HAVE_STDLIB_H
+char *malloc ();
+#endif
+
+/* This mess was copied from the GNU getpagesize.h.  */
+#ifndef HAVE_GETPAGESIZE
+# ifdef _SC_PAGESIZE
+#  define getpagesize() sysconf(_SC_PAGESIZE)
+# else /* no _SC_PAGESIZE */
+#  ifdef HAVE_SYS_PARAM_H
+#   include <sys/param.h>
+#   ifdef EXEC_PAGESIZE
+#    define getpagesize() EXEC_PAGESIZE
+#   else /* no EXEC_PAGESIZE */
+#    ifdef NBPG
+#     define getpagesize() NBPG * CLSIZE
+#     ifndef CLSIZE
+#      define CLSIZE 1
+#     endif /* no CLSIZE */
+#    else /* no NBPG */
+#     ifdef NBPC
+#      define getpagesize() NBPC
+#     else /* no NBPC */
+#      ifdef PAGESIZE
+#       define getpagesize() PAGESIZE
+#      endif /* PAGESIZE */
+#     endif /* no NBPC */
+#    endif /* no NBPG */
+#   endif /* no EXEC_PAGESIZE */
+#  else /* no HAVE_SYS_PARAM_H */
+#   define getpagesize() 8192	/* punt totally */
+#  endif /* no HAVE_SYS_PARAM_H */
+# endif /* no _SC_PAGESIZE */
+
+#endif /* no HAVE_GETPAGESIZE */
+
+int
+main ()
+{
+  char *data, *data2, *data3;
+  const char *cdata2;
+  int i, pagesize;
+  int fd, fd2;
+
+  pagesize = getpagesize ();
+
+  /* First, make a file with some known garbage in it. */
+  data = (char *) malloc (pagesize);
+  if (!data)
+    return 1;
+  for (i = 0; i < pagesize; ++i)
+    *(data + i) = rand ();
+  umask (0);
+  fd = creat ("conftest.mmap", 0600);
+  if (fd < 0)
+    return 2;
+  if (write (fd, data, pagesize) != pagesize)
+    return 3;
+  close (fd);
+
+  /* Next, check that the tail of a page is zero-filled.  File must have
+     non-zero length, otherwise we risk SIGBUS for entire page.  */
+  fd2 = open ("conftest.txt", O_RDWR | O_CREAT | O_TRUNC, 0600);
+  if (fd2 < 0)
+    return 4;
+  cdata2 = "";
+  if (write (fd2, cdata2, 1) != 1)
+    return 5;
+  data2 = (char *) mmap (0, pagesize, PROT_READ | PROT_WRITE, MAP_SHARED, fd2, 0L);
+  if (data2 == MAP_FAILED)
+    return 6;
+  for (i = 0; i < pagesize; ++i)
+    if (*(data2 + i))
+      return 7;
+  close (fd2);
+  if (munmap (data2, pagesize))
+    return 8;
+
+  /* Next, try to mmap the file at a fixed address which already has
+     something else allocated at it.  If we can, also make sure that
+     we see the same garbage.  */
+  fd = open ("conftest.mmap", O_RDWR);
+  if (fd < 0)
+    return 9;
+  if (data2 != mmap (data2, pagesize, PROT_READ | PROT_WRITE,
+		     MAP_PRIVATE | MAP_FIXED, fd, 0L))
+    return 10;
+  for (i = 0; i < pagesize; ++i)
+    if (*(data + i) != *(data2 + i))
+      return 11;
+
+  /* Finally, make sure that changes to the mapped area do not
+     percolate back to the file as seen by read().  (This is a bug on
+     some variants of i386 svr4.0.)  */
+  for (i = 0; i < pagesize; ++i)
+    *(data2 + i) = *(data2 + i) + 1;
+  data3 = (char *) malloc (pagesize);
+  if (!data3)
+    return 12;
+  if (read (fd, data3, pagesize) != pagesize)
+    return 13;
+  for (i = 0; i < pagesize; ++i)
+    if (*(data + i) != *(data3 + i))
+      return 14;
+  close (fd);
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_run "$LINENO"; then :
+  ac_cv_func_mmap_fixed_mapped=yes
+else
+  ac_cv_func_mmap_fixed_mapped=no
+fi
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
+  conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_mmap_fixed_mapped" >&5
+$as_echo "$ac_cv_func_mmap_fixed_mapped" >&6; }
+if test $ac_cv_func_mmap_fixed_mapped = yes; then
+
+$as_echo "#define HAVE_MMAP 1" >>confdefs.h
+
+fi
+rm -f conftest.mmap conftest.txt
+
+for ac_header in stdlib.h
+do :
+  ac_fn_c_check_header_mongrel "$LINENO" "stdlib.h" "ac_cv_header_stdlib_h" "$ac_includes_default"
+if test "x$ac_cv_header_stdlib_h" = xyes; then :
+  cat >>confdefs.h <<_ACEOF
+#define HAVE_STDLIB_H 1
+_ACEOF
+
+fi
+
+done
+
+{ $as_echo "$as_me:${as_lineno-$LINENO}: checking for GNU libc compatible realloc" >&5
+$as_echo_n "checking for GNU libc compatible realloc... " >&6; }
+if ${ac_cv_func_realloc_0_nonnull+:} false; then :
+  $as_echo_n "(cached) " >&6
+else
+  if test "$cross_compiling" = yes; then :
+  ac_cv_func_realloc_0_nonnull=no
+else
+  cat confdefs.h - <<_ACEOF >conftest.$ac_ext
+/* end confdefs.h.  */
+#if defined STDC_HEADERS || defined HAVE_STDLIB_H
+# include <stdlib.h>
+#else
+char *realloc ();
+#endif
+
+int
+main ()
+{
+return ! realloc (0, 0);
+  ;
+  return 0;
+}
+_ACEOF
+if ac_fn_c_try_run "$LINENO"; then :
+  ac_cv_func_realloc_0_nonnull=yes
+else
+  ac_cv_func_realloc_0_nonnull=no
+fi
+rm -f core *.core core.conftest.* gmon.out bb.out conftest$ac_exeext \
+  conftest.$ac_objext conftest.beam conftest.$ac_ext
+fi
+
+fi
+{ $as_echo "$as_me:${as_lineno-$LINENO}: result: $ac_cv_func_realloc_0_nonnull" >&5
+$as_echo "$ac_cv_func_realloc_0_nonnull" >&6; }
+if test $ac_cv_func_realloc_0_nonnull = yes; then :
+
+$as_echo "#define HAVE_REALLOC 1" >>confdefs.h
+
+else
+  $as_echo "#define HAVE_REALLOC 0" >>confdefs.h
+
+   case " $LIBOBJS " in
+  *" realloc.$ac_objext "* ) ;;
+  *) LIBOBJS="$LIBOBJS realloc.$ac_objext"
+ ;;
+esac
+
+
+$as_echo "#define realloc rpl_realloc" >>confdefs.h
+
+fi
+
+
+
+# Remove otool if you do not have an Objective-C++ compiler
+COMPONENTS="ar as include libstuff libmacho ld man misc otool"
+COMPONENTS=$COMPONENTS
+
+
+ac_config_files="$ac_config_files Makefile include/Makefile libstuff/Makefile libmacho/Makefile"
+
+ac_config_files="$ac_config_files ar/Makefile"
+
+ac_config_files="$ac_config_files as/Makefile"
+
+for ast in $ASTARGETS; do
+    case $ast in
+    ppc)
+	ac_config_files="$ac_config_files as/ppc/Makefile:as/ppc/Makefile.in:as/Makefile.arch.in"
+
+	;;
+    ppc64)
+	ac_config_files="$ac_config_files as/ppc64/Makefile:as/ppc64/Makefile.in:as/Makefile.arch.in"
+
+	;;
+    i386)
+	ac_config_files="$ac_config_files as/i386/Makefile:as/i386/Makefile.in:as/Makefile.arch.in"
+
+	;;
+    x86_64)
+	ac_config_files="$ac_config_files as/x86_64/Makefile:as/x86_64/Makefile.in:as/Makefile.arch.in"
+
+    ;;
+    arm)
+	ac_config_files="$ac_config_files as/arm/Makefile:as/arm/Makefile.in:as/Makefile.arch.in"
+
+	;;
+    *)
+	as_fn_error $? "Unrecognized assembler target $ast" "$LINENO" 5
+	;;
+    esac
+done
+ac_config_files="$ac_config_files ld/Makefile"
+
+ac_config_files="$ac_config_files man/Makefile"
+
+ac_config_files="$ac_config_files misc/Makefile"
+
+ac_config_files="$ac_config_files otool/Makefile"
+
+
+cat >confcache <<\_ACEOF
+# This file is a shell script that caches the results of configure
+# tests run on this system so they can be shared between configure
+# scripts and configure runs, see configure's option --config-cache.
+# It is not useful on other systems.  If it contains results you don't
+# want to keep, you may remove or edit it.
+#
+# config.status only pays attention to the cache file if you give it
+# the --recheck option to rerun configure.
+#
+# `ac_cv_env_foo' variables (set or unset) will be overridden when
+# loading this file, other *unset* `ac_cv_foo' will be assigned the
+# following values.
+
+_ACEOF
+
+# The following way of writing the cache mishandles newlines in values,
+# but we know of no workaround that is simple, portable, and efficient.
+# So, we kill variables containing newlines.
+# Ultrix sh set writes to stderr and can't be redirected directly,
+# and sets the high bit in the cache file unless we assign to the vars.
+(
+  for ac_var in `(set) 2>&1 | sed -n 's/^\([a-zA-Z_][a-zA-Z0-9_]*\)=.*/\1/p'`; do
+    eval ac_val=\$$ac_var
+    case $ac_val in #(
+    *${as_nl}*)
+      case $ac_var in #(
+      *_cv_*) { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: cache variable $ac_var contains a newline" >&5
+$as_echo "$as_me: WARNING: cache variable $ac_var contains a newline" >&2;} ;;
+      esac
+      case $ac_var in #(
+      _ | IFS | as_nl) ;; #(
+      BASH_ARGV | BASH_SOURCE) eval $ac_var= ;; #(
+      *) { eval $ac_var=; unset $ac_var;} ;;
+      esac ;;
+    esac
+  done
+
+  (set) 2>&1 |
+    case $as_nl`(ac_space=' '; set) 2>&1` in #(
+    *${as_nl}ac_space=\ *)
+      # `set' does not quote correctly, so add quotes: double-quote
+      # substitution turns \\\\ into \\, and sed turns \\ into \.
+      sed -n \
+	"s/'/'\\\\''/g;
+	  s/^\\([_$as_cr_alnum]*_cv_[_$as_cr_alnum]*\\)=\\(.*\\)/\\1='\\2'/p"
+      ;; #(
+    *)
+      # `set' quotes correctly as required by POSIX, so do not add quotes.
+      sed -n "/^[_$as_cr_alnum]*_cv_[_$as_cr_alnum]*=/p"
+      ;;
+    esac |
+    sort
+) |
+  sed '
+     /^ac_cv_env_/b end
+     t clear
+     :clear
+     s/^\([^=]*\)=\(.*[{}].*\)$/test "${\1+set}" = set || &/
+     t end
+     s/^\([^=]*\)=\(.*\)$/\1=${\1=\2}/
+     :end' >>confcache
+if diff "$cache_file" confcache >/dev/null 2>&1; then :; else
+  if test -w "$cache_file"; then
+    if test "x$cache_file" != "x/dev/null"; then
+      { $as_echo "$as_me:${as_lineno-$LINENO}: updating cache $cache_file" >&5
+$as_echo "$as_me: updating cache $cache_file" >&6;}
+      if test ! -f "$cache_file" || test -h "$cache_file"; then
+	cat confcache >"$cache_file"
+      else
+        case $cache_file in #(
+        */* | ?:*)
+	  mv -f confcache "$cache_file"$$ &&
+	  mv -f "$cache_file"$$ "$cache_file" ;; #(
+        *)
+	  mv -f confcache "$cache_file" ;;
+	esac
+      fi
+    fi
+  else
+    { $as_echo "$as_me:${as_lineno-$LINENO}: not updating unwritable cache $cache_file" >&5
+$as_echo "$as_me: not updating unwritable cache $cache_file" >&6;}
+  fi
+fi
+rm -f confcache
+
+test "x$prefix" = xNONE && prefix=$ac_default_prefix
+# Let make expand exec_prefix.
+test "x$exec_prefix" = xNONE && exec_prefix='${prefix}'
+
+DEFS=-DHAVE_CONFIG_H
+
+ac_libobjs=
+ac_ltlibobjs=
+U=
+for ac_i in : $LIBOBJS; do test "x$ac_i" = x: && continue
+  # 1. Remove the extension, and $U if already installed.
+  ac_script='s/\$U\././;s/\.o$//;s/\.obj$//'
+  ac_i=`$as_echo "$ac_i" | sed "$ac_script"`
+  # 2. Prepend LIBOBJDIR.  When used with automake>=1.10 LIBOBJDIR
+  #    will be set to the directory where LIBOBJS objects are built.
+  as_fn_append ac_libobjs " \${LIBOBJDIR}$ac_i\$U.$ac_objext"
+  as_fn_append ac_ltlibobjs " \${LIBOBJDIR}$ac_i"'$U.lo'
+done
+LIBOBJS=$ac_libobjs
+
+LTLIBOBJS=$ac_ltlibobjs
+
+
+
+
+: "${CONFIG_STATUS=./config.status}"
+ac_write_fail=0
+ac_clean_files_save=$ac_clean_files
+ac_clean_files="$ac_clean_files $CONFIG_STATUS"
+{ $as_echo "$as_me:${as_lineno-$LINENO}: creating $CONFIG_STATUS" >&5
+$as_echo "$as_me: creating $CONFIG_STATUS" >&6;}
+as_write_fail=0
+cat >$CONFIG_STATUS <<_ASEOF || as_write_fail=1
+#! $SHELL
+# Generated by $as_me.
+# Run this file to recreate the current configuration.
+# Compiler output produced by configure, useful for debugging
+# configure, is in config.log if it exists.
+
+debug=false
+ac_cs_recheck=false
+ac_cs_silent=false
+
+SHELL=\${CONFIG_SHELL-$SHELL}
+export SHELL
+_ASEOF
+cat >>$CONFIG_STATUS <<\_ASEOF || as_write_fail=1
+## -------------------- ##
+## M4sh Initialization. ##
+## -------------------- ##
+
+# Be more Bourne compatible
+DUALCASE=1; export DUALCASE # for MKS sh
+if test -n "${ZSH_VERSION+set}" && (emulate sh) >/dev/null 2>&1; then :
+  emulate sh
+  NULLCMD=:
+  # Pre-4.2 versions of Zsh do word splitting on ${1+"$@"}, which
+  # is contrary to our usage.  Disable this feature.
+  alias -g '${1+"$@"}'='"$@"'
+  setopt NO_GLOB_SUBST
+else
+  case `(set -o) 2>/dev/null` in #(
+  *posix*) :
+    set -o posix ;; #(
+  *) :
+     ;;
+esac
+fi
+
+
+as_nl='
+'
+export as_nl
+# Printing a long string crashes Solaris 7 /usr/bin/printf.
+as_echo='\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\'
+as_echo=$as_echo$as_echo$as_echo$as_echo$as_echo
+as_echo=$as_echo$as_echo$as_echo$as_echo$as_echo$as_echo
+# Prefer a ksh shell builtin over an external printf program on Solaris,
+# but without wasting forks for bash or zsh.
+if test -z "$BASH_VERSION$ZSH_VERSION" \
+    && (test "X`print -r -- $as_echo`" = "X$as_echo") 2>/dev/null; then
+  as_echo='print -r --'
+  as_echo_n='print -rn --'
+elif (test "X`printf %s $as_echo`" = "X$as_echo") 2>/dev/null; then
+  as_echo='printf %s\n'
+  as_echo_n='printf %s'
+else
+  if test "X`(/usr/ucb/echo -n -n $as_echo) 2>/dev/null`" = "X-n $as_echo"; then
+    as_echo_body='eval /usr/ucb/echo -n "$1$as_nl"'
+    as_echo_n='/usr/ucb/echo -n'
+  else
+    as_echo_body='eval expr "X$1" : "X\\(.*\\)"'
+    as_echo_n_body='eval
+      arg=$1;
+      case $arg in #(
+      *"$as_nl"*)
+	expr "X$arg" : "X\\(.*\\)$as_nl";
+	arg=`expr "X$arg" : ".*$as_nl\\(.*\\)"`;;
+      esac;
+      expr "X$arg" : "X\\(.*\\)" | tr -d "$as_nl"
+    '
+    export as_echo_n_body
+    as_echo_n='sh -c $as_echo_n_body as_echo'
+  fi
+  export as_echo_body
+  as_echo='sh -c $as_echo_body as_echo'
+fi
+
+# The user is always right.
+if test "${PATH_SEPARATOR+set}" != set; then
+  PATH_SEPARATOR=:
+  (PATH='/bin;/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 && {
+    (PATH='/bin:/bin'; FPATH=$PATH; sh -c :) >/dev/null 2>&1 ||
+      PATH_SEPARATOR=';'
+  }
+fi
+
+
+# IFS
+# We need space, tab and new line, in precisely that order.  Quoting is
+# there to prevent editors from complaining about space-tab.
+# (If _AS_PATH_WALK were called with IFS unset, it would disable word
+# splitting by setting IFS to empty value.)
+IFS=" ""	$as_nl"
+
+# Find who we are.  Look in the path if we contain no directory separator.
+as_myself=
+case $0 in #((
+  *[\\/]* ) as_myself=$0 ;;
+  *) as_save_IFS=$IFS; IFS=$PATH_SEPARATOR
+for as_dir in $PATH
+do
+  IFS=$as_save_IFS
+  test -z "$as_dir" && as_dir=.
+    test -r "$as_dir/$0" && as_myself=$as_dir/$0 && break
+  done
+IFS=$as_save_IFS
+
+     ;;
+esac
+# We did not find ourselves, most probably we were run as `sh COMMAND'
+# in which case we are not to be found in the path.
+if test "x$as_myself" = x; then
+  as_myself=$0
+fi
+if test ! -f "$as_myself"; then
+  $as_echo "$as_myself: error: cannot find myself; rerun with an absolute file name" >&2
+  exit 1
+fi
+
+# Unset variables that we do not need and which cause bugs (e.g. in
+# pre-3.0 UWIN ksh).  But do not cause bugs in bash 2.01; the "|| exit 1"
+# suppresses any "Segmentation fault" message there.  '((' could
+# trigger a bug in pdksh 5.2.14.
+for as_var in BASH_ENV ENV MAIL MAILPATH
+do eval test x\${$as_var+set} = xset \
+  && ( (unset $as_var) || exit 1) >/dev/null 2>&1 && unset $as_var || :
+done
+PS1='$ '
+PS2='> '
+PS4='+ '
+
+# NLS nuisances.
+LC_ALL=C
+export LC_ALL
+LANGUAGE=C
+export LANGUAGE
+
+# CDPATH.
+(unset CDPATH) >/dev/null 2>&1 && unset CDPATH
+
+
+# as_fn_error STATUS ERROR [LINENO LOG_FD]
+# ----------------------------------------
+# Output "`basename $0`: error: ERROR" to stderr. If LINENO and LOG_FD are
+# provided, also output the error to LOG_FD, referencing LINENO. Then exit the
+# script with STATUS, using 1 if that was 0.
+as_fn_error ()
+{
+  as_status=$1; test $as_status -eq 0 && as_status=1
+  if test "$4"; then
+    as_lineno=${as_lineno-"$3"} as_lineno_stack=as_lineno_stack=$as_lineno_stack
+    $as_echo "$as_me:${as_lineno-$LINENO}: error: $2" >&$4
+  fi
+  $as_echo "$as_me: error: $2" >&2
+  as_fn_exit $as_status
+} # as_fn_error
+
+
+# as_fn_set_status STATUS
+# -----------------------
+# Set $? to STATUS, without forking.
+as_fn_set_status ()
+{
+  return $1
+} # as_fn_set_status
+
+# as_fn_exit STATUS
+# -----------------
+# Exit the shell with STATUS, even in a "trap 0" or "set -e" context.
+as_fn_exit ()
+{
+  set +e
+  as_fn_set_status $1
+  exit $1
+} # as_fn_exit
+
+# as_fn_unset VAR
+# ---------------
+# Portably unset VAR.
+as_fn_unset ()
+{
+  { eval $1=; unset $1;}
+}
+as_unset=as_fn_unset
+# as_fn_append VAR VALUE
+# ----------------------
+# Append the text in VALUE to the end of the definition contained in VAR. Take
+# advantage of any shell optimizations that allow amortized linear growth over
+# repeated appends, instead of the typical quadratic growth present in naive
+# implementations.
+if (eval "as_var=1; as_var+=2; test x\$as_var = x12") 2>/dev/null; then :
+  eval 'as_fn_append ()
+  {
+    eval $1+=\$2
+  }'
+else
+  as_fn_append ()
+  {
+    eval $1=\$$1\$2
+  }
+fi # as_fn_append
+
+# as_fn_arith ARG...
+# ------------------
+# Perform arithmetic evaluation on the ARGs, and store the result in the
+# global $as_val. Take advantage of shells that can avoid forks. The arguments
+# must be portable across $(()) and expr.
+if (eval "test \$(( 1 + 1 )) = 2") 2>/dev/null; then :
+  eval 'as_fn_arith ()
+  {
+    as_val=$(( $* ))
+  }'
+else
+  as_fn_arith ()
+  {
+    as_val=`expr "$@" || test $? -eq 1`
+  }
+fi # as_fn_arith
+
+
+if expr a : '\(a\)' >/dev/null 2>&1 &&
+   test "X`expr 00001 : '.*\(...\)'`" = X001; then
+  as_expr=expr
+else
+  as_expr=false
+fi
+
+if (basename -- /) >/dev/null 2>&1 && test "X`basename -- / 2>&1`" = "X/"; then
+  as_basename=basename
+else
+  as_basename=false
+fi
+
+if (as_dir=`dirname -- /` && test "X$as_dir" = X/) >/dev/null 2>&1; then
+  as_dirname=dirname
+else
+  as_dirname=false
+fi
+
+as_me=`$as_basename -- "$0" ||
+$as_expr X/"$0" : '.*/\([^/][^/]*\)/*$' \| \
+	 X"$0" : 'X\(//\)$' \| \
+	 X"$0" : 'X\(/\)' \| . 2>/dev/null ||
+$as_echo X/"$0" |
+    sed '/^.*\/\([^/][^/]*\)\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\/\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\/\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+
+# Avoid depending upon Character Ranges.
+as_cr_letters='abcdefghijklmnopqrstuvwxyz'
+as_cr_LETTERS='ABCDEFGHIJKLMNOPQRSTUVWXYZ'
+as_cr_Letters=$as_cr_letters$as_cr_LETTERS
+as_cr_digits='0123456789'
+as_cr_alnum=$as_cr_Letters$as_cr_digits
+
+ECHO_C= ECHO_N= ECHO_T=
+case `echo -n x` in #(((((
+-n*)
+  case `echo 'xy\c'` in
+  *c*) ECHO_T='	';;	# ECHO_T is single tab character.
+  xy)  ECHO_C='\c';;
+  *)   echo `echo ksh88 bug on AIX 6.1` > /dev/null
+       ECHO_T='	';;
+  esac;;
+*)
+  ECHO_N='-n';;
+esac
+
+rm -f conf$$ conf$$.exe conf$$.file
+if test -d conf$$.dir; then
+  rm -f conf$$.dir/conf$$.file
+else
+  rm -f conf$$.dir
+  mkdir conf$$.dir 2>/dev/null
+fi
+if (echo >conf$$.file) 2>/dev/null; then
+  if ln -s conf$$.file conf$$ 2>/dev/null; then
+    as_ln_s='ln -s'
+    # ... but there are two gotchas:
+    # 1) On MSYS, both `ln -s file dir' and `ln file dir' fail.
+    # 2) DJGPP < 2.04 has no symlinks; `ln -s' creates a wrapper executable.
+    # In both cases, we have to default to `cp -p'.
+    ln -s conf$$.file conf$$.dir 2>/dev/null && test ! -f conf$$.exe ||
+      as_ln_s='cp -p'
+  elif ln conf$$.file conf$$ 2>/dev/null; then
+    as_ln_s=ln
+  else
+    as_ln_s='cp -p'
+  fi
+else
+  as_ln_s='cp -p'
+fi
+rm -f conf$$ conf$$.exe conf$$.dir/conf$$.file conf$$.file
+rmdir conf$$.dir 2>/dev/null
+
+
+# as_fn_mkdir_p
+# -------------
+# Create "$as_dir" as a directory, including parents if necessary.
+as_fn_mkdir_p ()
+{
+
+  case $as_dir in #(
+  -*) as_dir=./$as_dir;;
+  esac
+  test -d "$as_dir" || eval $as_mkdir_p || {
+    as_dirs=
+    while :; do
+      case $as_dir in #(
+      *\'*) as_qdir=`$as_echo "$as_dir" | sed "s/'/'\\\\\\\\''/g"`;; #'(
+      *) as_qdir=$as_dir;;
+      esac
+      as_dirs="'$as_qdir' $as_dirs"
+      as_dir=`$as_dirname -- "$as_dir" ||
+$as_expr X"$as_dir" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$as_dir" : 'X\(//\)[^/]' \| \
+	 X"$as_dir" : 'X\(//\)$' \| \
+	 X"$as_dir" : 'X\(/\)' \| . 2>/dev/null ||
+$as_echo X"$as_dir" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+      test -d "$as_dir" && break
+    done
+    test -z "$as_dirs" || eval "mkdir $as_dirs"
+  } || test -d "$as_dir" || as_fn_error $? "cannot create directory $as_dir"
+
+
+} # as_fn_mkdir_p
+if mkdir -p . 2>/dev/null; then
+  as_mkdir_p='mkdir -p "$as_dir"'
+else
+  test -d ./-p && rmdir ./-p
+  as_mkdir_p=false
+fi
+
+if test -x / >/dev/null 2>&1; then
+  as_test_x='test -x'
+else
+  if ls -dL / >/dev/null 2>&1; then
+    as_ls_L_option=L
+  else
+    as_ls_L_option=
+  fi
+  as_test_x='
+    eval sh -c '\''
+      if test -d "$1"; then
+	test -d "$1/.";
+      else
+	case $1 in #(
+	-*)set "./$1";;
+	esac;
+	case `ls -ld'$as_ls_L_option' "$1" 2>/dev/null` in #((
+	???[sx]*):;;*)false;;esac;fi
+    '\'' sh
+  '
+fi
+as_executable_p=$as_test_x
+
+# Sed expression to map a string onto a valid CPP name.
+as_tr_cpp="eval sed 'y%*$as_cr_letters%P$as_cr_LETTERS%;s%[^_$as_cr_alnum]%_%g'"
+
+# Sed expression to map a string onto a valid variable name.
+as_tr_sh="eval sed 'y%*+%pp%;s%[^_$as_cr_alnum]%_%g'"
+
+
+exec 6>&1
+## ----------------------------------- ##
+## Main body of $CONFIG_STATUS script. ##
+## ----------------------------------- ##
+_ASEOF
+test $as_write_fail = 0 && chmod +x $CONFIG_STATUS || ac_write_fail=1
+
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+# Save the log message, to keep $0 and so on meaningful, and to
+# report actual input values of CONFIG_FILES etc. instead of their
+# values after options handling.
+ac_log="
+This file was extended by cctools $as_me 806, which was
+generated by GNU Autoconf 2.68.  Invocation command line was
+
+  CONFIG_FILES    = $CONFIG_FILES
+  CONFIG_HEADERS  = $CONFIG_HEADERS
+  CONFIG_LINKS    = $CONFIG_LINKS
+  CONFIG_COMMANDS = $CONFIG_COMMANDS
+  $ $0 $@
+
+on `(hostname || uname -n) 2>/dev/null | sed 1q`
+"
+
+_ACEOF
+
+case $ac_config_files in *"
+"*) set x $ac_config_files; shift; ac_config_files=$*;;
+esac
+
+case $ac_config_headers in *"
+"*) set x $ac_config_headers; shift; ac_config_headers=$*;;
+esac
+
+
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+# Files that config.status was made for.
+config_files="$ac_config_files"
+config_headers="$ac_config_headers"
+
+_ACEOF
+
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+ac_cs_usage="\
+\`$as_me' instantiates files and other configuration actions
+from templates according to the current configuration.  Unless the files
+and actions are specified as TAGs, all are instantiated by default.
+
+Usage: $0 [OPTION]... [TAG]...
+
+  -h, --help       print this help, then exit
+  -V, --version    print version number and configuration settings, then exit
+      --config     print configuration, then exit
+  -q, --quiet, --silent
+                   do not print progress messages
+  -d, --debug      don't remove temporary files
+      --recheck    update $as_me by reconfiguring in the same conditions
+      --file=FILE[:TEMPLATE]
+                   instantiate the configuration file FILE
+      --header=FILE[:TEMPLATE]
+                   instantiate the configuration header FILE
+
+Configuration files:
+$config_files
+
+Configuration headers:
+$config_headers
+
+Report bugs to <ddrtist@gmail.com>."
+
+_ACEOF
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+ac_cs_config="`$as_echo "$ac_configure_args" | sed 's/^ //; s/[\\""\`\$]/\\\\&/g'`"
+ac_cs_version="\\
+cctools config.status 806
+configured by $0, generated by GNU Autoconf 2.68,
+  with options \\"\$ac_cs_config\\"
+
+Copyright (C) 2010 Free Software Foundation, Inc.
+This config.status script is free software; the Free Software Foundation
+gives unlimited permission to copy, distribute and modify it."
+
+ac_pwd='$ac_pwd'
+srcdir='$srcdir'
+INSTALL='$INSTALL'
+test -n "\$AWK" || AWK=awk
+_ACEOF
+
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+# The default lists apply if the user does not specify any file.
+ac_need_defaults=:
+while test $# != 0
+do
+  case $1 in
+  --*=?*)
+    ac_option=`expr "X$1" : 'X\([^=]*\)='`
+    ac_optarg=`expr "X$1" : 'X[^=]*=\(.*\)'`
+    ac_shift=:
+    ;;
+  --*=)
+    ac_option=`expr "X$1" : 'X\([^=]*\)='`
+    ac_optarg=
+    ac_shift=:
+    ;;
+  *)
+    ac_option=$1
+    ac_optarg=$2
+    ac_shift=shift
+    ;;
+  esac
+
+  case $ac_option in
+  # Handling of the options.
+  -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
+    ac_cs_recheck=: ;;
+  --version | --versio | --versi | --vers | --ver | --ve | --v | -V )
+    $as_echo "$ac_cs_version"; exit ;;
+  --config | --confi | --conf | --con | --co | --c )
+    $as_echo "$ac_cs_config"; exit ;;
+  --debug | --debu | --deb | --de | --d | -d )
+    debug=: ;;
+  --file | --fil | --fi | --f )
+    $ac_shift
+    case $ac_optarg in
+    *\'*) ac_optarg=`$as_echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"` ;;
+    '') as_fn_error $? "missing file argument" ;;
+    esac
+    as_fn_append CONFIG_FILES " '$ac_optarg'"
+    ac_need_defaults=false;;
+  --header | --heade | --head | --hea )
+    $ac_shift
+    case $ac_optarg in
+    *\'*) ac_optarg=`$as_echo "$ac_optarg" | sed "s/'/'\\\\\\\\''/g"` ;;
+    esac
+    as_fn_append CONFIG_HEADERS " '$ac_optarg'"
+    ac_need_defaults=false;;
+  --he | --h)
+    # Conflict between --help and --header
+    as_fn_error $? "ambiguous option: \`$1'
+Try \`$0 --help' for more information.";;
+  --help | --hel | -h )
+    $as_echo "$ac_cs_usage"; exit ;;
+  -q | -quiet | --quiet | --quie | --qui | --qu | --q \
+  | -silent | --silent | --silen | --sile | --sil | --si | --s)
+    ac_cs_silent=: ;;
+
+  # This is an error.
+  -*) as_fn_error $? "unrecognized option: \`$1'
+Try \`$0 --help' for more information." ;;
+
+  *) as_fn_append ac_config_targets " $1"
+     ac_need_defaults=false ;;
+
+  esac
+  shift
+done
+
+ac_configure_extra_args=
+
+if $ac_cs_silent; then
+  exec 6>/dev/null
+  ac_configure_extra_args="$ac_configure_extra_args --silent"
+fi
+
+_ACEOF
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+if \$ac_cs_recheck; then
+  set X '$SHELL' '$0' $ac_configure_args \$ac_configure_extra_args --no-create --no-recursion
+  shift
+  \$as_echo "running CONFIG_SHELL=$SHELL \$*" >&6
+  CONFIG_SHELL='$SHELL'
+  export CONFIG_SHELL
+  exec "\$@"
+fi
+
+_ACEOF
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+exec 5>>config.log
+{
+  echo
+  sed 'h;s/./-/g;s/^.../## /;s/...$/ ##/;p;x;p;x' <<_ASBOX
+## Running $as_me. ##
+_ASBOX
+  $as_echo "$ac_log"
+} >&5
+
+_ACEOF
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+_ACEOF
+
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+
+# Handling of arguments.
+for ac_config_target in $ac_config_targets
+do
+  case $ac_config_target in
+    "include/config.h") CONFIG_HEADERS="$CONFIG_HEADERS include/config.h" ;;
+    "Makefile") CONFIG_FILES="$CONFIG_FILES Makefile" ;;
+    "include/Makefile") CONFIG_FILES="$CONFIG_FILES include/Makefile" ;;
+    "libstuff/Makefile") CONFIG_FILES="$CONFIG_FILES libstuff/Makefile" ;;
+    "libmacho/Makefile") CONFIG_FILES="$CONFIG_FILES libmacho/Makefile" ;;
+    "ar/Makefile") CONFIG_FILES="$CONFIG_FILES ar/Makefile" ;;
+    "as/Makefile") CONFIG_FILES="$CONFIG_FILES as/Makefile" ;;
+    "as/ppc/Makefile") CONFIG_FILES="$CONFIG_FILES as/ppc/Makefile:as/ppc/Makefile.in:as/Makefile.arch.in" ;;
+    "as/ppc64/Makefile") CONFIG_FILES="$CONFIG_FILES as/ppc64/Makefile:as/ppc64/Makefile.in:as/Makefile.arch.in" ;;
+    "as/i386/Makefile") CONFIG_FILES="$CONFIG_FILES as/i386/Makefile:as/i386/Makefile.in:as/Makefile.arch.in" ;;
+    "as/x86_64/Makefile") CONFIG_FILES="$CONFIG_FILES as/x86_64/Makefile:as/x86_64/Makefile.in:as/Makefile.arch.in" ;;
+    "as/arm/Makefile") CONFIG_FILES="$CONFIG_FILES as/arm/Makefile:as/arm/Makefile.in:as/Makefile.arch.in" ;;
+    "ld/Makefile") CONFIG_FILES="$CONFIG_FILES ld/Makefile" ;;
+    "man/Makefile") CONFIG_FILES="$CONFIG_FILES man/Makefile" ;;
+    "misc/Makefile") CONFIG_FILES="$CONFIG_FILES misc/Makefile" ;;
+    "otool/Makefile") CONFIG_FILES="$CONFIG_FILES otool/Makefile" ;;
+
+  *) as_fn_error $? "invalid argument: \`$ac_config_target'" "$LINENO" 5;;
+  esac
+done
+
+
+# If the user did not use the arguments to specify the items to instantiate,
+# then the envvar interface is used.  Set only those that are not.
+# We use the long form for the default assignment because of an extremely
+# bizarre bug on SunOS 4.1.3.
+if $ac_need_defaults; then
+  test "${CONFIG_FILES+set}" = set || CONFIG_FILES=$config_files
+  test "${CONFIG_HEADERS+set}" = set || CONFIG_HEADERS=$config_headers
+fi
+
+# Have a temporary directory for convenience.  Make it in the build tree
+# simply because there is no reason against having it here, and in addition,
+# creating and moving files from /tmp can sometimes cause problems.
+# Hook for its removal unless debugging.
+# Note that there is a small window in which the directory will not be cleaned:
+# after its creation but before its name has been assigned to `$tmp'.
+$debug ||
+{
+  tmp= ac_tmp=
+  trap 'exit_status=$?
+  : "${ac_tmp:=$tmp}"
+  { test ! -d "$ac_tmp" || rm -fr "$ac_tmp"; } && exit $exit_status
+' 0
+  trap 'as_fn_exit 1' 1 2 13 15
+}
+# Create a (secure) tmp directory for tmp files.
+
+{
+  tmp=`(umask 077 && mktemp -d "./confXXXXXX") 2>/dev/null` &&
+  test -d "$tmp"
+}  ||
+{
+  tmp=./conf$$-$RANDOM
+  (umask 077 && mkdir "$tmp")
+} || as_fn_error $? "cannot create a temporary directory in ." "$LINENO" 5
+ac_tmp=$tmp
+
+# Set up the scripts for CONFIG_FILES section.
+# No need to generate them if there are no CONFIG_FILES.
+# This happens for instance with `./config.status config.h'.
+if test -n "$CONFIG_FILES"; then
+
+
+ac_cr=`echo X | tr X '\015'`
+# On cygwin, bash can eat \r inside `` if the user requested igncr.
+# But we know of no other shell where ac_cr would be empty at this
+# point, so we can use a bashism as a fallback.
+if test "x$ac_cr" = x; then
+  eval ac_cr=\$\'\\r\'
+fi
+ac_cs_awk_cr=`$AWK 'BEGIN { print "a\rb" }' </dev/null 2>/dev/null`
+if test "$ac_cs_awk_cr" = "a${ac_cr}b"; then
+  ac_cs_awk_cr='\\r'
+else
+  ac_cs_awk_cr=$ac_cr
+fi
+
+echo 'BEGIN {' >"$ac_tmp/subs1.awk" &&
+_ACEOF
+
+
+{
+  echo "cat >conf$$subs.awk <<_ACEOF" &&
+  echo "$ac_subst_vars" | sed 's/.*/&!$&$ac_delim/' &&
+  echo "_ACEOF"
+} >conf$$subs.sh ||
+  as_fn_error $? "could not make $CONFIG_STATUS" "$LINENO" 5
+ac_delim_num=`echo "$ac_subst_vars" | grep -c '^'`
+ac_delim='%!_!# '
+for ac_last_try in false false false false false :; do
+  . ./conf$$subs.sh ||
+    as_fn_error $? "could not make $CONFIG_STATUS" "$LINENO" 5
+
+  ac_delim_n=`sed -n "s/.*$ac_delim\$/X/p" conf$$subs.awk | grep -c X`
+  if test $ac_delim_n = $ac_delim_num; then
+    break
+  elif $ac_last_try; then
+    as_fn_error $? "could not make $CONFIG_STATUS" "$LINENO" 5
+  else
+    ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
+  fi
+done
+rm -f conf$$subs.sh
+
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+cat >>"\$ac_tmp/subs1.awk" <<\\_ACAWK &&
+_ACEOF
+sed -n '
+h
+s/^/S["/; s/!.*/"]=/
+p
+g
+s/^[^!]*!//
+:repl
+t repl
+s/'"$ac_delim"'$//
+t delim
+:nl
+h
+s/\(.\{148\}\)..*/\1/
+t more1
+s/["\\]/\\&/g; s/^/"/; s/$/\\n"\\/
+p
+n
+b repl
+:more1
+s/["\\]/\\&/g; s/^/"/; s/$/"\\/
+p
+g
+s/.\{148\}//
+t nl
+:delim
+h
+s/\(.\{148\}\)..*/\1/
+t more2
+s/["\\]/\\&/g; s/^/"/; s/$/"/
+p
+b
+:more2
+s/["\\]/\\&/g; s/^/"/; s/$/"\\/
+p
+g
+s/.\{148\}//
+t delim
+' <conf$$subs.awk | sed '
+/^[^""]/{
+  N
+  s/\n//
+}
+' >>$CONFIG_STATUS || ac_write_fail=1
+rm -f conf$$subs.awk
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+_ACAWK
+cat >>"\$ac_tmp/subs1.awk" <<_ACAWK &&
+  for (key in S) S_is_set[key] = 1
+  FS = ""
+
+}
+{
+  line = $ 0
+  nfields = split(line, field, "@")
+  substed = 0
+  len = length(field[1])
+  for (i = 2; i < nfields; i++) {
+    key = field[i]
+    keylen = length(key)
+    if (S_is_set[key]) {
+      value = S[key]
+      line = substr(line, 1, len) "" value "" substr(line, len + keylen + 3)
+      len += length(value) + length(field[++i])
+      substed = 1
+    } else
+      len += 1 + keylen
+  }
+
+  print line
+}
+
+_ACAWK
+_ACEOF
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+if sed "s/$ac_cr//" < /dev/null > /dev/null 2>&1; then
+  sed "s/$ac_cr\$//; s/$ac_cr/$ac_cs_awk_cr/g"
+else
+  cat
+fi < "$ac_tmp/subs1.awk" > "$ac_tmp/subs.awk" \
+  || as_fn_error $? "could not setup config files machinery" "$LINENO" 5
+_ACEOF
+
+# VPATH may cause trouble with some makes, so we remove sole $(srcdir),
+# ${srcdir} and @srcdir@ entries from VPATH if srcdir is ".", strip leading and
+# trailing colons and then remove the whole line if VPATH becomes empty
+# (actually we leave an empty line to preserve line numbers).
+if test "x$srcdir" = x.; then
+  ac_vpsub='/^[	 ]*VPATH[	 ]*=[	 ]*/{
+h
+s///
+s/^/:/
+s/[	 ]*$/:/
+s/:\$(srcdir):/:/g
+s/:\${srcdir}:/:/g
+s/:@srcdir@:/:/g
+s/^:*//
+s/:*$//
+x
+s/\(=[	 ]*\).*/\1/
+G
+s/\n//
+s/^[^=]*=[	 ]*$//
+}'
+fi
+
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+fi # test -n "$CONFIG_FILES"
+
+# Set up the scripts for CONFIG_HEADERS section.
+# No need to generate them if there are no CONFIG_HEADERS.
+# This happens for instance with `./config.status Makefile'.
+if test -n "$CONFIG_HEADERS"; then
+cat >"$ac_tmp/defines.awk" <<\_ACAWK ||
+BEGIN {
+_ACEOF
+
+# Transform confdefs.h into an awk script `defines.awk', embedded as
+# here-document in config.status, that substitutes the proper values into
+# config.h.in to produce config.h.
+
+# Create a delimiter string that does not exist in confdefs.h, to ease
+# handling of long lines.
+ac_delim='%!_!# '
+for ac_last_try in false false :; do
+  ac_tt=`sed -n "/$ac_delim/p" confdefs.h`
+  if test -z "$ac_tt"; then
+    break
+  elif $ac_last_try; then
+    as_fn_error $? "could not make $CONFIG_HEADERS" "$LINENO" 5
+  else
+    ac_delim="$ac_delim!$ac_delim _$ac_delim!! "
+  fi
+done
+
+# For the awk script, D is an array of macro values keyed by name,
+# likewise P contains macro parameters if any.  Preserve backslash
+# newline sequences.
+
+ac_word_re=[_$as_cr_Letters][_$as_cr_alnum]*
+sed -n '
+s/.\{148\}/&'"$ac_delim"'/g
+t rset
+:rset
+s/^[	 ]*#[	 ]*define[	 ][	 ]*/ /
+t def
+d
+:def
+s/\\$//
+t bsnl
+s/["\\]/\\&/g
+s/^ \('"$ac_word_re"'\)\(([^()]*)\)[	 ]*\(.*\)/P["\1"]="\2"\
+D["\1"]=" \3"/p
+s/^ \('"$ac_word_re"'\)[	 ]*\(.*\)/D["\1"]=" \2"/p
+d
+:bsnl
+s/["\\]/\\&/g
+s/^ \('"$ac_word_re"'\)\(([^()]*)\)[	 ]*\(.*\)/P["\1"]="\2"\
+D["\1"]=" \3\\\\\\n"\\/p
+t cont
+s/^ \('"$ac_word_re"'\)[	 ]*\(.*\)/D["\1"]=" \2\\\\\\n"\\/p
+t cont
+d
+:cont
+n
+s/.\{148\}/&'"$ac_delim"'/g
+t clear
+:clear
+s/\\$//
+t bsnlc
+s/["\\]/\\&/g; s/^/"/; s/$/"/p
+d
+:bsnlc
+s/["\\]/\\&/g; s/^/"/; s/$/\\\\\\n"\\/p
+b cont
+' <confdefs.h | sed '
+s/'"$ac_delim"'/"\\\
+"/g' >>$CONFIG_STATUS || ac_write_fail=1
+
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+  for (key in D) D_is_set[key] = 1
+  FS = ""
+}
+/^[\t ]*#[\t ]*(define|undef)[\t ]+$ac_word_re([\t (]|\$)/ {
+  line = \$ 0
+  split(line, arg, " ")
+  if (arg[1] == "#") {
+    defundef = arg[2]
+    mac1 = arg[3]
+  } else {
+    defundef = substr(arg[1], 2)
+    mac1 = arg[2]
+  }
+  split(mac1, mac2, "(") #)
+  macro = mac2[1]
+  prefix = substr(line, 1, index(line, defundef) - 1)
+  if (D_is_set[macro]) {
+    # Preserve the white space surrounding the "#".
+    print prefix "define", macro P[macro] D[macro]
+    next
+  } else {
+    # Replace #undef with comments.  This is necessary, for example,
+    # in the case of _POSIX_SOURCE, which is predefined and required
+    # on some systems where configure will not decide to define it.
+    if (defundef == "undef") {
+      print "/*", prefix defundef, macro, "*/"
+      next
+    }
+  }
+}
+{ print }
+_ACAWK
+_ACEOF
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+  as_fn_error $? "could not setup config headers machinery" "$LINENO" 5
+fi # test -n "$CONFIG_HEADERS"
+
+
+eval set X "  :F $CONFIG_FILES  :H $CONFIG_HEADERS    "
+shift
+for ac_tag
+do
+  case $ac_tag in
+  :[FHLC]) ac_mode=$ac_tag; continue;;
+  esac
+  case $ac_mode$ac_tag in
+  :[FHL]*:*);;
+  :L* | :C*:*) as_fn_error $? "invalid tag \`$ac_tag'" "$LINENO" 5;;
+  :[FH]-) ac_tag=-:-;;
+  :[FH]*) ac_tag=$ac_tag:$ac_tag.in;;
+  esac
+  ac_save_IFS=$IFS
+  IFS=:
+  set x $ac_tag
+  IFS=$ac_save_IFS
+  shift
+  ac_file=$1
+  shift
+
+  case $ac_mode in
+  :L) ac_source=$1;;
+  :[FH])
+    ac_file_inputs=
+    for ac_f
+    do
+      case $ac_f in
+      -) ac_f="$ac_tmp/stdin";;
+      *) # Look for the file first in the build tree, then in the source tree
+	 # (if the path is not absolute).  The absolute path cannot be DOS-style,
+	 # because $ac_f cannot contain `:'.
+	 test -f "$ac_f" ||
+	   case $ac_f in
+	   [\\/$]*) false;;
+	   *) test -f "$srcdir/$ac_f" && ac_f="$srcdir/$ac_f";;
+	   esac ||
+	   as_fn_error 1 "cannot find input file: \`$ac_f'" "$LINENO" 5;;
+      esac
+      case $ac_f in *\'*) ac_f=`$as_echo "$ac_f" | sed "s/'/'\\\\\\\\''/g"`;; esac
+      as_fn_append ac_file_inputs " '$ac_f'"
+    done
+
+    # Let's still pretend it is `configure' which instantiates (i.e., don't
+    # use $as_me), people would be surprised to read:
+    #    /* config.h.  Generated by config.status.  */
+    configure_input='Generated from '`
+	  $as_echo "$*" | sed 's|^[^:]*/||;s|:[^:]*/|, |g'
+	`' by configure.'
+    if test x"$ac_file" != x-; then
+      configure_input="$ac_file.  $configure_input"
+      { $as_echo "$as_me:${as_lineno-$LINENO}: creating $ac_file" >&5
+$as_echo "$as_me: creating $ac_file" >&6;}
+    fi
+    # Neutralize special characters interpreted by sed in replacement strings.
+    case $configure_input in #(
+    *\&* | *\|* | *\\* )
+       ac_sed_conf_input=`$as_echo "$configure_input" |
+       sed 's/[\\\\&|]/\\\\&/g'`;; #(
+    *) ac_sed_conf_input=$configure_input;;
+    esac
+
+    case $ac_tag in
+    *:-:* | *:-) cat >"$ac_tmp/stdin" \
+      || as_fn_error $? "could not create $ac_file" "$LINENO" 5 ;;
+    esac
+    ;;
+  esac
+
+  ac_dir=`$as_dirname -- "$ac_file" ||
+$as_expr X"$ac_file" : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
+	 X"$ac_file" : 'X\(//\)[^/]' \| \
+	 X"$ac_file" : 'X\(//\)$' \| \
+	 X"$ac_file" : 'X\(/\)' \| . 2>/dev/null ||
+$as_echo X"$ac_file" |
+    sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)[^/].*/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\/\)$/{
+	    s//\1/
+	    q
+	  }
+	  /^X\(\/\).*/{
+	    s//\1/
+	    q
+	  }
+	  s/.*/./; q'`
+  as_dir="$ac_dir"; as_fn_mkdir_p
+  ac_builddir=.
+
+case "$ac_dir" in
+.) ac_dir_suffix= ac_top_builddir_sub=. ac_top_build_prefix= ;;
+*)
+  ac_dir_suffix=/`$as_echo "$ac_dir" | sed 's|^\.[\\/]||'`
+  # A ".." for each directory in $ac_dir_suffix.
+  ac_top_builddir_sub=`$as_echo "$ac_dir_suffix" | sed 's|/[^\\/]*|/..|g;s|/||'`
+  case $ac_top_builddir_sub in
+  "") ac_top_builddir_sub=. ac_top_build_prefix= ;;
+  *)  ac_top_build_prefix=$ac_top_builddir_sub/ ;;
+  esac ;;
+esac
+ac_abs_top_builddir=$ac_pwd
+ac_abs_builddir=$ac_pwd$ac_dir_suffix
+# for backward compatibility:
+ac_top_builddir=$ac_top_build_prefix
+
+case $srcdir in
+  .)  # We are building in place.
+    ac_srcdir=.
+    ac_top_srcdir=$ac_top_builddir_sub
+    ac_abs_top_srcdir=$ac_pwd ;;
+  [\\/]* | ?:[\\/]* )  # Absolute name.
+    ac_srcdir=$srcdir$ac_dir_suffix;
+    ac_top_srcdir=$srcdir
+    ac_abs_top_srcdir=$srcdir ;;
+  *) # Relative name.
+    ac_srcdir=$ac_top_build_prefix$srcdir$ac_dir_suffix
+    ac_top_srcdir=$ac_top_build_prefix$srcdir
+    ac_abs_top_srcdir=$ac_pwd/$srcdir ;;
+esac
+ac_abs_srcdir=$ac_abs_top_srcdir$ac_dir_suffix
+
+
+  case $ac_mode in
+  :F)
+  #
+  # CONFIG_FILE
+  #
+
+  case $INSTALL in
+  [\\/$]* | ?:[\\/]* ) ac_INSTALL=$INSTALL ;;
+  *) ac_INSTALL=$ac_top_build_prefix$INSTALL ;;
+  esac
+_ACEOF
+
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+# If the template does not know about datarootdir, expand it.
+# FIXME: This hack should be removed a few years after 2.60.
+ac_datarootdir_hack=; ac_datarootdir_seen=
+ac_sed_dataroot='
+/datarootdir/ {
+  p
+  q
+}
+/@datadir@/p
+/@docdir@/p
+/@infodir@/p
+/@localedir@/p
+/@mandir@/p'
+case `eval "sed -n \"\$ac_sed_dataroot\" $ac_file_inputs"` in
+*datarootdir*) ac_datarootdir_seen=yes;;
+*@datadir@*|*@docdir@*|*@infodir@*|*@localedir@*|*@mandir@*)
+  { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&5
+$as_echo "$as_me: WARNING: $ac_file_inputs seems to ignore the --datarootdir setting" >&2;}
+_ACEOF
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+  ac_datarootdir_hack='
+  s&@datadir@&$datadir&g
+  s&@docdir@&$docdir&g
+  s&@infodir@&$infodir&g
+  s&@localedir@&$localedir&g
+  s&@mandir@&$mandir&g
+  s&\\\${datarootdir}&$datarootdir&g' ;;
+esac
+_ACEOF
+
+# Neutralize VPATH when `$srcdir' = `.'.
+# Shell code in configure.ac might set extrasub.
+# FIXME: do we really want to maintain this feature?
+cat >>$CONFIG_STATUS <<_ACEOF || ac_write_fail=1
+ac_sed_extra="$ac_vpsub
+$extrasub
+_ACEOF
+cat >>$CONFIG_STATUS <<\_ACEOF || ac_write_fail=1
+:t
+/@[a-zA-Z_][a-zA-Z_0-9]*@/!b
+s|@configure_input@|$ac_sed_conf_input|;t t
+s&@top_builddir@&$ac_top_builddir_sub&;t t
+s&@top_build_prefix@&$ac_top_build_prefix&;t t
+s&@srcdir@&$ac_srcdir&;t t
+s&@abs_srcdir@&$ac_abs_srcdir&;t t
+s&@top_srcdir@&$ac_top_srcdir&;t t
+s&@abs_top_srcdir@&$ac_abs_top_srcdir&;t t
+s&@builddir@&$ac_builddir&;t t
+s&@abs_builddir@&$ac_abs_builddir&;t t
+s&@abs_top_builddir@&$ac_abs_top_builddir&;t t
+s&@INSTALL@&$ac_INSTALL&;t t
+$ac_datarootdir_hack
+"
+eval sed \"\$ac_sed_extra\" "$ac_file_inputs" | $AWK -f "$ac_tmp/subs.awk" \
+  >$ac_tmp/out || as_fn_error $? "could not create $ac_file" "$LINENO" 5
+
+test -z "$ac_datarootdir_hack$ac_datarootdir_seen" &&
+  { ac_out=`sed -n '/\${datarootdir}/p' "$ac_tmp/out"`; test -n "$ac_out"; } &&
+  { ac_out=`sed -n '/^[	 ]*datarootdir[	 ]*:*=/p' \
+      "$ac_tmp/out"`; test -z "$ac_out"; } &&
+  { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: $ac_file contains a reference to the variable \`datarootdir'
+which seems to be undefined.  Please make sure it is defined" >&5
+$as_echo "$as_me: WARNING: $ac_file contains a reference to the variable \`datarootdir'
+which seems to be undefined.  Please make sure it is defined" >&2;}
+
+  rm -f "$ac_tmp/stdin"
+  case $ac_file in
+  -) cat "$ac_tmp/out" && rm -f "$ac_tmp/out";;
+  *) rm -f "$ac_file" && mv "$ac_tmp/out" "$ac_file";;
+  esac \
+  || as_fn_error $? "could not create $ac_file" "$LINENO" 5
+ ;;
+  :H)
+  #
+  # CONFIG_HEADER
+  #
+  if test x"$ac_file" != x-; then
+    {
+      $as_echo "/* $configure_input  */" \
+      && eval '$AWK -f "$ac_tmp/defines.awk"' "$ac_file_inputs"
+    } >"$ac_tmp/config.h" \
+      || as_fn_error $? "could not create $ac_file" "$LINENO" 5
+    if diff "$ac_file" "$ac_tmp/config.h" >/dev/null 2>&1; then
+      { $as_echo "$as_me:${as_lineno-$LINENO}: $ac_file is unchanged" >&5
+$as_echo "$as_me: $ac_file is unchanged" >&6;}
+    else
+      rm -f "$ac_file"
+      mv "$ac_tmp/config.h" "$ac_file" \
+	|| as_fn_error $? "could not create $ac_file" "$LINENO" 5
+    fi
+  else
+    $as_echo "/* $configure_input  */" \
+      && eval '$AWK -f "$ac_tmp/defines.awk"' "$ac_file_inputs" \
+      || as_fn_error $? "could not create -" "$LINENO" 5
+  fi
+ ;;
+
+
+  esac
+
+done # for ac_tag
+
+
+as_fn_exit 0
+_ACEOF
+ac_clean_files=$ac_clean_files_save
+
+test $ac_write_fail = 0 ||
+  as_fn_error $? "write failure creating $CONFIG_STATUS" "$LINENO" 5
+
+
+# configure is writing to config.log, and then calls config.status.
+# config.status does its own redirection, appending to config.log.
+# Unfortunately, on DOS this fails, as config.log is still kept open
+# by configure, so config.status won't be able to write to it; its
+# output is simply discarded.  So we exec the FD to /dev/null,
+# effectively closing config.log, so it can be properly (re)opened and
+# appended to by config.status.  When coming back to configure, we
+# need to make the FD available again.
+if test "$no_create" != yes; then
+  ac_cs_success=:
+  ac_config_status_args=
+  test "$silent" = yes &&
+    ac_config_status_args="$ac_config_status_args --quiet"
+  exec 5>/dev/null
+  $SHELL $CONFIG_STATUS $ac_config_status_args || ac_cs_success=false
+  exec 5>>config.log
+  # Use ||, not &&, to avoid exiting from the if with $? = 1, which
+  # would make configure fail if this is the last instruction.
+  $ac_cs_success || as_fn_exit 1
+fi
+if test -n "$ac_unrecognized_opts" && test "$enable_option_checking" != no; then
+  { $as_echo "$as_me:${as_lineno-$LINENO}: WARNING: unrecognized options: $ac_unrecognized_opts" >&5
+$as_echo "$as_me: WARNING: unrecognized options: $ac_unrecognized_opts" >&2;}
+fi
+
diff -urN cctools-806-old/configure.ac cctools-806/configure.ac
--- cctools-806-old/configure.ac	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/configure.ac	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,356 @@
+#                                               -*- Autoconf -*-
+# Process this file with autoconf to produce a configure script.
+
+AC_PREREQ([2.68])
+AC_INIT([cctools], [806], [ddrtist@gmail.com])
+AC_CONFIG_SRCDIR([APPLE_LICENSE])
+AC_CONFIG_HEADERS([include/config.h])
+
+AC_CANONICAL_BUILD
+AC_CANONICAL_HOST
+AC_CANONICAL_TARGET
+
+AC_PROG_LEX
+AC_PROG_YACC
+
+AC_ARG_PROGRAM
+
+case $target_os in
+darwin*)
+	:
+	;;
+*)
+	AC_MSG_ERROR([$PACKAGE_NAME only supports targeting Darwin])
+	;;
+esac
+
+case $target_cpu in
+     arm)
+        AC_DEFINE(EMULATED_HOST_CPU_TYPE, 12, [Emulated CPU type])        
+        AC_DEFINE(EMULATED_HOST_CPU_SUBTYPE, 6, [Emulated CPU subtype])
+        AC_DEFINE(DEFAULT_MACH_ARCH, "arm", [Default Mach architecture name])
+	;;
+     powerpc)
+        AC_DEFINE(EMULATED_HOST_CPU_TYPE, 18, [Emulated CPU type])        
+        AC_DEFINE(EMULATED_HOST_CPU_SUBTYPE, 100, [Emulated CPU subtype]) 
+        AC_DEFINE(DEFAULT_MACH_ARCH, "ppc", [Default Mach architecture name])
+	;;
+     powerpc64)
+        AC_DEFINE(EMULATED_HOST_CPU_TYPE, 16777234, [Emulated CPU type])        
+        AC_DEFINE(EMULATED_HOST_CPU_SUBTYPE, 0, [Emulated CPU subtype])        
+        AC_DEFINE(DEFAULT_MACH_ARCH, "ppc64", [Default Mach architecture name])
+	;;
+     i?86)
+        AC_DEFINE(EMULATED_HOST_CPU_TYPE, 7, [Emulated CPU type])        
+        AC_DEFINE(EMULATED_HOST_CPU_SUBTYPE, 3, [Emulated CPU subtype])        
+        AC_DEFINE(DEFAULT_MACH_ARCH, "i386", [Default Mach architecture name])
+	;;
+     x86_64)
+        AC_DEFINE(EMULATED_HOST_CPU_TYPE, 16777223, [Emulated CPU type])        
+        AC_DEFINE(EMULATED_HOST_CPU_SUBTYPE, 3, [Emulated CPU subtype])        
+        AC_DEFINE(DEFAULT_MACH_ARCH, "x86_64", [Default Mach architecture name])
+	;;
+     *)
+	AC_MSG_ERROR([Unsupported target $target_cpu])
+	;;
+esac
+
+case $host_os in
+		linux*)
+				AC_DEFINE_UNQUOTED(CROSS_BIN_PREFIX, ["$target"])
+		;;
+esac
+
+# Checks for programs.
+AC_PROG_INSTALL
+AC_PROG_LN_S
+AC_PROG_CC
+AC_PROG_CXX
+
+AC_CHECK_TOOL([HOST_RANLIB], [ranlib], :)
+AC_CHECK_TOOL([HOST_AR], [ar], :)
+
+ASTARGETS=""
+conftargets=""
+AC_MSG_CHECKING([for configured assembler targets])
+AC_ARG_ENABLE([as-targets],
+		AC_HELP_STRING([--enable-as-targets],
+				[space-separated list ("arm", "ppc", "ppc64", "i386", "x86_64", "all")]),
+		[conftargets="$enableval"],
+		[conftargets="default"])
+
+case "$conftargets" in
+     all)
+        ASTARGETS="ppc ppc64 i386 x86_64 arm"
+	;;
+     default)
+	ASTARGETS="ppc ppc64 i386 x86_64 arm"
+	;;
+     yes)
+	AC_MSG_ERROR([no assembler targets configured])
+	;;
+     no)
+	AC_MSG_ERROR([no assembler targets configured])
+	;;
+     *)
+	if [[ -z "$conftargets" ]]; then
+	   AC_MSG_ERROR([no assembler targets configured])
+	fi
+	ASTARGETS="$conftargets"
+	;;
+esac
+
+AC_MSG_RESULT([$ASTARGETS])
+AC_SUBST([ASTARGETS], [$ASTARGETS]) 
+
+AC_ARG_WITH([sysroot],
+		AC_HELP_STRING([--with-sysroot],
+				[filesystem root of cross build environment]),
+		[AC_DEFINE_UNQUOTED([CROSS_SYSROOT],["$withval"],[filesystem root of cross build environment])])
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -mdynamic-no-pic"
+AC_MSG_CHECKING([if -mdynamic-no-pic is supported])
+AC_COMPILE_IFELSE(
+   [AC_LANG_SOURCE([[const char hw[] = "Hello, World\n";]])],
+   [AC_SUBST([MDYNAMICNOPIC],[-mdynamic-no-pic])
+    AC_MSG_RESULT([yes])],
+   [AC_SUBST([MDYNAMICNOPIC],[])
+    AC_MSG_RESULT([no])]
+)
+CFLAGS=$ORIGCFLAGS
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -fno-builtin-round"
+AC_MSG_CHECKING([if -fno-builtin-round is supported])
+AC_COMPILE_IFELSE(
+   [AC_LANG_SOURCE([[const char hw[] = "Hello, World\n";]])],
+   [AC_MSG_RESULT([yes])],
+   [CFLAGS=$ORIGCFLAGS
+    AC_MSG_RESULT([no])]
+)
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -fno-builtin-trunc"
+AC_MSG_CHECKING([if -fno-builtin-trunc is supported])
+AC_COMPILE_IFELSE(
+   [AC_LANG_SOURCE([[const char hw[] = "Hello, World\n";]])],
+   [AC_MSG_RESULT([yes])],
+   [CFLAGS=$ORIGCFLAGS
+    AC_MSG_RESULT([no])]
+)
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -no-cpp-precomp"
+supported=0
+AC_MSG_CHECKING([if -no-cpp-precomp is supported])
+AC_LANG_CONFTEST([[const char hw[] = "Hello, World\n";]])
+rm -f conftest.$ac_objext conftest$ac_exeext
+out=`$CC -c $CFLAGS $CPPFLAGS conftest.$ac_ext 2>&1`
+if [[ $? -ne 0 ]]; then
+   supported=0;
+else
+   unrecog=`echo $out | grep unrecog | wc -l`
+   if [[ $unrecog -gt 0 ]]; then
+      supported=0;
+   else
+      supported=1;
+   fi
+fi
+
+if [[ $supported -eq 1 ]]; then
+   AC_MSG_RESULT([yes])
+else
+   CFLAGS="$ORIGCFLAGS"
+   AC_MSG_RESULT([no])
+fi
+rm -f conftest.$ac_objext conftest$ac_exeext conftest.$ac_ext
+
+WARNINGS=""
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -Wall"
+AC_MSG_CHECKING([if -Wall is supported])
+AC_COMPILE_IFELSE(
+   [AC_LANG_SOURCE([[const char hw[] = "Hello, World\n";]])],
+   [WARNINGS="$WARNINGS -Wall"
+    AC_MSG_RESULT([yes])],
+   [AC_MSG_RESULT([no])]
+)
+CFLAGS=$ORIGCFLAGS
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -Wno-long-double"
+AC_MSG_CHECKING([if -Wno-long-double is supported])
+AC_COMPILE_IFELSE(
+   [AC_LANG_SOURCE([[const char hw[] = "Hello, World\n";
+		   void* should_warn = 5;
+		   ]])],
+   [WARNINGS="$WARNINGS -Wno-long-double"
+    AC_MSG_RESULT([yes])],
+   [AC_MSG_RESULT([no])]
+)
+CFLAGS=$ORIGCFLAGS
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -Wno-import"
+AC_MSG_CHECKING([if -Wno-import is supported])
+AC_COMPILE_IFELSE(
+   [AC_LANG_SOURCE([[const char hw[] = "Hello, World\n";
+		   void* should_warn = 5;
+		   ]])],
+   [WARNINGS="$WARNINGS -Wno-import"
+    AC_MSG_RESULT([yes])],
+   [AC_MSG_RESULT([no])]
+)
+CFLAGS=$ORIGCFLAGS
+
+AC_SUBST([WARNINGS], [$WARNINGS])
+
+ORIGCFLAGS=$CFLAGS
+CFLAGS="$CFLAGS -x objective-c"
+OBJC="-x objective-c"
+AC_MSG_CHECKING([if -x objective-c is supported])
+AC_COMPILE_IFELSE(
+   [AC_LANG_SOURCE([[@class foo;
+void bar(void) {
+     [foo alloc];
+}
+]])],
+   [AC_DEFINE(HAVE_OBJC, 1, [Have Objective-C support])
+    AC_MSG_RESULT([yes])],
+   [OBJC=""
+    AC_MSG_RESULT([no])]
+)
+AC_SUBST([OBJC], [$OBJC])
+CFLAGS=$ORIGCFLAGS
+
+AC_MSG_CHECKING([if __private_extern__ is supported])
+AC_COMPILE_IFELSE(
+   [AC_LANG_SOURCE([[__private_extern__ int foo;]])],
+   [AC_SUBST([HAVE_PRIVEXT], [YES])
+    AC_MSG_RESULT([yes])],
+   [AC_SUBST([HAVE_PRIVEXT], [NO])
+    AC_MSG_RESULT([no])]
+)
+
+ORIGLDFLAGS=$LDFLAGS
+LDFLAGS="-multiply_defined suppress"
+AC_MSG_CHECKING([if -multiply_defined suppress is supported])
+AC_LINK_IFELSE([AC_LANG_PROGRAM()],
+	[AC_MSG_RESULT([yes])],
+	[LDFLAGS="$ORIGLDFLAGS"
+	 AC_MSG_RESULT([no])]
+)
+
+AC_HEADER_STDC
+AC_CHECK_HEADERS([stdio.h errno.h limits.h])
+if [[ "x$OBJC" != "x" ]]; then
+   ORIGCFLAGS=$CFLAGS
+   CFLAGS="$CFLAGS $OBJC"
+   AC_CHECK_HEADERS([objc/objc-runtime.h])
+   CFLAGS="$ORIGCFLAGS"
+fi
+
+AC_MSG_CHECKING([for max unsigned long long])
+AC_COMPILE_IFELSE(
+   [AC_LANG_SOURCE([[#if HAVE_LIMITS_H
+			 #include <limits.h>
+		     #endif
+		     unsigned long long a = ULLONG_MAX;]])],
+   [AC_MSG_RESULT([ULLONG_MAX])],
+   [AC_COMPILE_IFELSE(
+	[AC_LANG_SOURCE([[#if HAVE_LIMITS_H
+			      #include <limits.h>
+			 #endif
+			 unsigned long long a = 18446744073709551615ULL;]])],
+	[AC_DEFINE(ULLONG_MAX, [18446744073709551615ULL], [max unsigned long long])
+	 AC_MSG_RESULT([18446744073709551615ULL])],
+	[AC_MSG_RESULT([none]) ]
+	)
+    ]
+)
+
+AC_CHECK_FUNCS([atexit bzero fchdir ftruncate getattrlist getpagesize gettimeofday memchr memmove memset NSIsSymbolNameDefined qsort_r qsort realpath sqrt strcasecmp strchr strdup strerror strlcat strmode strncasecmp strrchr strstr strtol strtoul utime _NSGetExecutablePath readlink])
+
+AC_CHECK_DECLS([getc_unlocked])
+AH_VERBATIM([HAVE_DECL_GETC_UNLOCKED_REPLACEMENT],
+[/* For systems that don't have getc_unlocked, use getc  */
+#if !HAVE_DECL_GETC_UNLOCKED
+# define getc_unlocked(a) getc(a)
+#endif])
+
+case $host_os in
+     darwin*)
+	AC_SUBST([HAVE_FOREIGN_HEADERS],[NO])
+	;;
+     *)
+	AC_SUBST([HAVE_FOREIGN_HEADERS],[YES])
+	AC_SUBST([EMULATED_OBJ], [emulated.c])
+	AC_C_BIGENDIAN([AC_SUBST([ENDIAN_FLAG],[-D__BIG_ENDIAN__=1])],
+			[AC_SUBST([ENDIAN_FLAG],[-D__LITTLE_ENDIAN__=1])])
+	;;
+esac
+
+# Checks for typedefs, structures, and compiler characteristics.
+AC_HEADER_STDBOOL
+AC_TYPE_UID_T
+AC_C_INLINE
+AC_TYPE_INT16_T
+AC_TYPE_INT32_T
+AC_TYPE_INT64_T
+AC_TYPE_INT8_T
+AC_FUNC_OBSTACK
+AC_TYPE_OFF_T
+AC_TYPE_SIZE_T
+AC_TYPE_SSIZE_T
+AC_TYPE_UINT16_T
+AC_TYPE_UINT32_T
+AC_TYPE_UINT64_T
+AC_TYPE_UINT8_T
+AC_CHECK_TYPES([ptrdiff_t])
+
+# Checks for library functions.
+AC_FUNC_ALLOCA
+AC_FUNC_CHOWN
+AC_FUNC_ERROR_AT_LINE
+AC_FUNC_FORK
+AC_FUNC_MALLOC
+AC_FUNC_MMAP
+AC_FUNC_REALLOC
+
+# Remove otool if you do not have an Objective-C++ compiler
+COMPONENTS="ar as include libstuff libmacho ld man misc otool"
+AC_SUBST([COMPONENTS], [$COMPONENTS])
+
+AC_CONFIG_FILES([Makefile include/Makefile libstuff/Makefile libmacho/Makefile])
+AC_CONFIG_FILES([ar/Makefile])
+AC_CONFIG_FILES([as/Makefile])
+for ast in $ASTARGETS; do
+    case $ast in
+    ppc)
+	AC_CONFIG_FILES([as/ppc/Makefile:as/ppc/Makefile.in:as/Makefile.arch.in])
+	;;
+    ppc64)
+	AC_CONFIG_FILES([as/ppc64/Makefile:as/ppc64/Makefile.in:as/Makefile.arch.in])
+	;;
+    i386)
+	AC_CONFIG_FILES([as/i386/Makefile:as/i386/Makefile.in:as/Makefile.arch.in])
+	;;
+    x86_64)
+	AC_CONFIG_FILES([as/x86_64/Makefile:as/x86_64/Makefile.in:as/Makefile.arch.in])
+    ;;
+    arm)
+	AC_CONFIG_FILES([as/arm/Makefile:as/arm/Makefile.in:as/Makefile.arch.in])
+	;;
+    *)
+	AC_MSG_ERROR([Unrecognized assembler target $ast])
+	;;
+    esac
+done
+AC_CONFIG_FILES([ld/Makefile])
+AC_CONFIG_FILES([man/Makefile])
+AC_CONFIG_FILES([misc/Makefile])
+AC_CONFIG_FILES([otool/Makefile])
+
+AC_OUTPUT
diff -urN cctools-806-old/efitools/Makefile cctools-806/efitools/Makefile
--- cctools-806-old/efitools/Makefile	2009-12-16 13:34:22.000000000 -0600
+++ cctools-806/efitools/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,111 +0,0 @@
-export USE_APPLE_PB_SUPPORT = all
-OFLAG = -Os
-RC_OS = macos
-X_CFLAGS =
-ifneq "" "$(SDKROOT)"
-  SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
-endif
-
-ifeq "clang" "$(notdir $(CC))"
-  CFLAGS = $(OFLAG) -g -Wall \
-	 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
-else
-  CFLAGS = $(OFLAG) -g -Wall $(X_CFLAGS) \
-	 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
-endif
-
-USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
-				  [ "$(RC_XBS)" != "YES" ]; then \
-	     echo YES ; else echo NO ; \
-	     fi; )
-
-LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-SRCROOT = .
-OBJROOT = .
-OFILE_DIR = $(OBJROOT)
-VPATH = $(OFILE_DIR)
-SYMROOT = .
-
-EFIBINDIR = /usr/local/efi/bin
-
-CFILES = makerelocs.c mtoc.c
-
-INSTALL_FILES = $(CFILES) Makefile notes
-
-PROGS = makerelocs.NEW mtoc.NEW
-
-all:	$(OFILE_DIR) $(SYMROOT) $(PROGS)
-
-vers.c:
-	vers_string -c $(VERS_STRING_FLAGS) cctools_efi > $(OFILE_DIR)/$@
-	echo "const char apple_version[]= " \"`vers_string $(VERS_STRING_FLAGS) -f cctools`\" ";" >> \
-	$(OFILE_DIR)/$@
-
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o $<
-else
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file \
-		$(OFILE_DIR)/$*.d -o $(OFILE_DIR)/$*.o $<
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-makerelocs.NEW: makerelocs.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/makerelocs.private.o \
-		$(OFILE_DIR)/makerelocs.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/makerelocs.NEW \
-		$(OFILE_DIR)/makerelocs.private.o
-
-mtoc.NEW: mtoc.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/mtoc.private.o \
-		$(OFILE_DIR)/mtoc.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/mtoc.NEW \
-		$(OFILE_DIR)/mtoc.private.o
-
-clean: shlib_clean
-	-rm -f \
-	$(SYMROOT)/makerelocs.NEW \
-	$(SYMROOT)/mtoc.NEW
-
-shlib_clean:
-	-rm -f \
-	$(OFILE_DIR)/vers.c \
-	$(OFILE_DIR)/vers.o \
-	$(OFILE_DIR)/makerelocs.o \
-	$(OFILE_DIR)/makerelocs.private.o \
-	$(OFILE_DIR)/mtoc.o \
-	$(OFILE_DIR)/mtoc.private.o
-	-rm -f $(OFILE_DIR)/Makedep make.out
-
-install: all install
-
-install:
-	$(MKDIRS) $(DSTROOT)$(EFIBINDIR)
-# For now don't overwrite the existing makerelocs program the efitools project
-# builds.
-#	install -c -s -m 555 $(SYMROOT)/makerelocs.NEW \
-#		$(DSTROOT)$(EFIBINDIR)/makerelocs
-	install -c -s -m 555 $(SYMROOT)/mtoc.NEW \
-		$(DSTROOT)$(EFIBINDIR)/mtoc
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-$(OFILE_DIR) $(SYMROOT):
-	$(MKDIRS) $@
-
--include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/efitools/Makefile.apple cctools-806/efitools/Makefile.apple
--- cctools-806-old/efitools/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/efitools/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,111 @@
+export USE_APPLE_PB_SUPPORT = all
+OFLAG = -Os
+RC_OS = macos
+X_CFLAGS =
+ifneq "" "$(SDKROOT)"
+  SDK = -isysroot $(SDKROOT)
+  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
+endif
+
+ifeq "clang" "$(notdir $(CC))"
+  CFLAGS = $(OFLAG) -g -Wall \
+	 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
+else
+  CFLAGS = $(OFLAG) -g -Wall $(X_CFLAGS) \
+	 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
+endif
+
+USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
+				  [ "$(RC_XBS)" != "YES" ]; then \
+	     echo YES ; else echo NO ; \
+	     fi; )
+
+LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+SRCROOT = .
+OBJROOT = .
+OFILE_DIR = $(OBJROOT)
+VPATH = $(OFILE_DIR)
+SYMROOT = .
+
+EFIBINDIR = /usr/local/efi/bin
+
+CFILES = makerelocs.c mtoc.c
+
+INSTALL_FILES = $(CFILES) Makefile notes
+
+PROGS = makerelocs.NEW mtoc.NEW
+
+all:	$(OFILE_DIR) $(SYMROOT) $(PROGS)
+
+vers.c:
+	vers_string -c $(VERS_STRING_FLAGS) cctools_efi > $(OFILE_DIR)/$@
+	echo "const char apple_version[]= " \"`vers_string $(VERS_STRING_FLAGS) -f cctools`\" ";" >> \
+	$(OFILE_DIR)/$@
+
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o $<
+else
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file \
+		$(OFILE_DIR)/$*.d -o $(OFILE_DIR)/$*.o $<
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+makerelocs.NEW: makerelocs.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/makerelocs.private.o \
+		$(OFILE_DIR)/makerelocs.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/makerelocs.NEW \
+		$(OFILE_DIR)/makerelocs.private.o
+
+mtoc.NEW: mtoc.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/mtoc.private.o \
+		$(OFILE_DIR)/mtoc.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/mtoc.NEW \
+		$(OFILE_DIR)/mtoc.private.o
+
+clean: shlib_clean
+	-rm -f \
+	$(SYMROOT)/makerelocs.NEW \
+	$(SYMROOT)/mtoc.NEW
+
+shlib_clean:
+	-rm -f \
+	$(OFILE_DIR)/vers.c \
+	$(OFILE_DIR)/vers.o \
+	$(OFILE_DIR)/makerelocs.o \
+	$(OFILE_DIR)/makerelocs.private.o \
+	$(OFILE_DIR)/mtoc.o \
+	$(OFILE_DIR)/mtoc.private.o
+	-rm -f $(OFILE_DIR)/Makedep make.out
+
+install: all install
+
+install:
+	$(MKDIRS) $(DSTROOT)$(EFIBINDIR)
+# For now don't overwrite the existing makerelocs program the efitools project
+# builds.
+#	install -c -s -m 555 $(SYMROOT)/makerelocs.NEW \
+#		$(DSTROOT)$(EFIBINDIR)/makerelocs
+	install -c -s -m 555 $(SYMROOT)/mtoc.NEW \
+		$(DSTROOT)$(EFIBINDIR)/mtoc
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+$(OFILE_DIR) $(SYMROOT):
+	$(MKDIRS) $@
+
+-include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/gprof/Makefile cctools-806/gprof/Makefile
--- cctools-806-old/gprof/Makefile	2009-12-16 13:34:30.000000000 -0600
+++ cctools-806/gprof/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,98 +0,0 @@
-RC_OS = macos
-OFLAG = -Os
-LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
-
-ifneq "clang" "$(notdir $(CC))"
-  GCC_FLAGS = $(X_CFLAGS)
-endif
-
-USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "clang" ] && \
-				  [ "$(RC_XBS)" != "YES" ]; then \
-	     echo YES ; else echo NO ; \
-	     fi; )
-
-ifneq "" "$(SDKROOT)"
-  SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
-endif
-CFLAGS = $(OFLAG) -g -I../include -Wall $(GCC_FLAGS) -DNeXT_MOD -DDEBUG $(SDK)
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-OBJROOT = .
-OFILE_DIR = $(OBJROOT)
-VPATH = $(OFILE_DIR)
-SYMROOT = .
-
-BINDIR = /usr/ucb
-USRBINDIR = /usr/bin
-nextstep_LIBDIR = /usr/lib
-teflon_LIBDIR   = /usr/share
-macos_LIBDIR    = /usr/share
-
-HFILES = gprof.h m68k.h vax.h
-CFILES = gprof.c arcs.c dfn.c lookup.c calls.c hertz.c printgprof.c \
-	 printlist.c getnfile.c scatter.c
-OBJS = $(CFILES:.c=.o) vers.o
-INSTALL_FILES = $(CFILES) $(HFILES) gprof.flat gprof.callg Makefile notes
-
-PRODUCT = gprof
-all: $(OFILE_DIR) $(SYMROOT) $(PRODUCT).NEW
-
-$(PRODUCT).NEW:	$(OFILE_DIR) $(SYMROOT) $(OBJS)
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(SYMROOT)/$@.private.o $(OBJS) $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/$@ $(SYMROOT)/$@.private.o
-
-vers.c:
-	vers_string -c $(VERS_STRING_FLAGS) $(PRODUCT) > $(OFILE_DIR)/$@
-
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o $<
-else
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file $(OFILE_DIR)/$*.d \
-		-o $(OFILE_DIR)/$*.o $<
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-clean: shlib_clean
-	-rm -f $(SYMROOT)/$(PRODUCT).NEW $(OFILE_DIR)/vers.c
-	-rm -f $(SYMROOT)/$(PRODUCT).NEW.private.o
-
-shlib_clean:
-	-cd $(OFILE_DIR); rm -f $(OBJS)
-	-rm -f $(OFILE_DIR)/Makedep make.out
-
-install: all common_install $(RC_OS)_install
-
-teflon_install macos_install:
-	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
-	install -c -s -m 555 $(SYMROOT)/$(PRODUCT).NEW \
-		$(DSTROOT)$(USRBINDIR)/$(PRODUCT)
-
-nextstep_install:
-	$(MKDIRS) $(DSTROOT)$(BINDIR)
-	install -c -s -m 555 $(SYMROOT)/$(PRODUCT).NEW \
-		$(DSTROOT)$(BINDIR)/$(PRODUCT)
-
-common_install:
-	$(MKDIRS) $(DSTROOT)$($(RC_OS)_LIBDIR)
-	install -c -m 444 gprof.flat $(DSTROOT)$($(RC_OS)_LIBDIR)
-	install -c -m 444 gprof.callg $(DSTROOT)$($(RC_OS)_LIBDIR)
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-$(OFILE_DIR) $(SYMROOT):
-	$(MKDIRS) $@
-
--include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/gprof/Makefile.apple cctools-806/gprof/Makefile.apple
--- cctools-806-old/gprof/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/gprof/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,98 @@
+RC_OS = macos
+OFLAG = -Os
+LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
+
+ifneq "clang" "$(notdir $(CC))"
+  GCC_FLAGS = $(X_CFLAGS)
+endif
+
+USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "clang" ] && \
+				  [ "$(RC_XBS)" != "YES" ]; then \
+	     echo YES ; else echo NO ; \
+	     fi; )
+
+ifneq "" "$(SDKROOT)"
+  SDK = -isysroot $(SDKROOT)
+  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
+endif
+CFLAGS = $(OFLAG) -g -I../include -Wall $(GCC_FLAGS) -DNeXT_MOD -DDEBUG $(SDK)
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+OBJROOT = .
+OFILE_DIR = $(OBJROOT)
+VPATH = $(OFILE_DIR)
+SYMROOT = .
+
+BINDIR = /usr/ucb
+USRBINDIR = /usr/bin
+nextstep_LIBDIR = /usr/lib
+teflon_LIBDIR   = /usr/share
+macos_LIBDIR    = /usr/share
+
+HFILES = gprof.h m68k.h vax.h
+CFILES = gprof.c arcs.c dfn.c lookup.c calls.c hertz.c printgprof.c \
+	 printlist.c getnfile.c scatter.c
+OBJS = $(CFILES:.c=.o) vers.o
+INSTALL_FILES = $(CFILES) $(HFILES) gprof.flat gprof.callg Makefile notes
+
+PRODUCT = gprof
+all: $(OFILE_DIR) $(SYMROOT) $(PRODUCT).NEW
+
+$(PRODUCT).NEW:	$(OFILE_DIR) $(SYMROOT) $(OBJS)
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(SYMROOT)/$@.private.o $(OBJS) $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/$@ $(SYMROOT)/$@.private.o
+
+vers.c:
+	vers_string -c $(VERS_STRING_FLAGS) $(PRODUCT) > $(OFILE_DIR)/$@
+
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o $<
+else
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file $(OFILE_DIR)/$*.d \
+		-o $(OFILE_DIR)/$*.o $<
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+clean: shlib_clean
+	-rm -f $(SYMROOT)/$(PRODUCT).NEW $(OFILE_DIR)/vers.c
+	-rm -f $(SYMROOT)/$(PRODUCT).NEW.private.o
+
+shlib_clean:
+	-cd $(OFILE_DIR); rm -f $(OBJS)
+	-rm -f $(OFILE_DIR)/Makedep make.out
+
+install: all common_install $(RC_OS)_install
+
+teflon_install macos_install:
+	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
+	install -c -s -m 555 $(SYMROOT)/$(PRODUCT).NEW \
+		$(DSTROOT)$(USRBINDIR)/$(PRODUCT)
+
+nextstep_install:
+	$(MKDIRS) $(DSTROOT)$(BINDIR)
+	install -c -s -m 555 $(SYMROOT)/$(PRODUCT).NEW \
+		$(DSTROOT)$(BINDIR)/$(PRODUCT)
+
+common_install:
+	$(MKDIRS) $(DSTROOT)$($(RC_OS)_LIBDIR)
+	install -c -m 444 gprof.flat $(DSTROOT)$($(RC_OS)_LIBDIR)
+	install -c -m 444 gprof.callg $(DSTROOT)$($(RC_OS)_LIBDIR)
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+$(OFILE_DIR) $(SYMROOT):
+	$(MKDIRS) $@
+
+-include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/include/Availability.h cctools-806/include/Availability.h
--- cctools-806-old/include/Availability.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/Availability.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,160 @@
+/*
+ * Copyright (c) 2007-2010 by Apple Inc.. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+ 
+#ifndef __AVAILABILITY__
+#define __AVAILABILITY__
+ /*     
+    These macros are for use in OS header files. They enable function prototypes
+    and Objective-C methods to be tagged with the OS version in which they
+    were first available; and, if applicable, the OS version in which they 
+    became deprecated.  
+     
+    The desktop Mac OS X and the iPhone OS X each have different version numbers.
+    The __OSX_AVAILABLE_STARTING() macro allows you to specify both the desktop
+    and phone OS version numbers.  For instance:
+        __OSX_AVAILABLE_STARTING(__MAC_10_2,__IPHONE_2_0)
+    means the function/method was first available on Mac OS X 10.2 on the desktop
+    and first available in OS X 2.0 on the iPhone.
+    
+    If a function is available on one platform, but not the other a _NA (not
+    applicable) parameter is used.  For instance:
+            __OSX_AVAILABLE_STARTING(__MAC_10_3,__IPHONE_NA)
+    means that the function/method was first available on Mac OS X 10.3, and it
+    currently not implemented on the iPhone.
+
+    At some point, a function/method may be deprecated.  That means Apple
+    recommends applications stop using the function, either because there is a 
+    better replacement or the functionality is being phased out.  Deprecated
+    functions/methods can be tagged with a __OSX_AVAILABLE_BUT_DEPRECATED()
+    macro which specifies the OS version where the function became available
+    as well as the OS version in which it became deprecated.  For instance:
+        __OSX_AVAILABLE_BUT_DEPRECATED(__MAC_10_0,__MAC_10_5,__IPHONE_NA,__IPHONE_NA)
+    means that the function/method was introduced in Mac OS X 10.0, then
+    became deprecated beginning in Mac OS X 10.5.  On the iPhone the function 
+    has never been available.  
+    
+    For these macros to function properly, a program must specify the OS version range 
+    it is targeting.  The min OS version is specified as an option to the compiler:
+    -mmacosx-version-min=10.x when building for Mac OS X, and -miphone-version-min=1.x.x
+    when building for the iPhone.  The upper bound for the OS version is rarely needed,
+    but it can be set on the command line via: -D__MAC_OS_X_VERSION_MAX_ALLOWED=10xx for
+    Mac OS X and __IPHONE_OS_VERSION_MAX_ALLOWED = 1xxx for iPhone.  
+    
+    Examples:
+
+        A function available in Mac OS X 10.5 and later, but not on the phone:
+        
+            extern void mymacfunc() __OSX_AVAILABLE_STARTING(__MAC_10_5,__IPHONE_NA);
+
+
+        An Objective-C method in Mac OS X 10.5 and later, but not on the phone:
+        
+            @interface MyClass : NSObject
+            -(void) mymacmethod __OSX_AVAILABLE_STARTING(__MAC_10_5,__IPHONE_NA);
+            @end
+
+        
+        An enum available on the phone, but not available on Mac OS X:
+        
+            #if __IPHONE_OS_VERSION_MIN_REQUIRED
+                enum { myEnum = 1 };
+            #endif
+           Note: this works when targeting the Mac OS X platform because 
+           __IPHONE_OS_VERSION_MIN_REQUIRED is undefined which evaluates to zero. 
+        
+
+        An enum with values added in different iPhoneOS versions:
+		
+			enum {
+			    myX  = 1,	// Usable on iPhoneOS 2.1 and later
+			    myY  = 2,	// Usable on iPhoneOS 3.0 and later
+			    myZ  = 3,	// Usable on iPhoneOS 3.0 and later
+				...
+		      Note: you do not want to use #if with enumeration values
+			  when a client needs to see all values at compile time
+			  and use runtime logic to only use the viable values.
+			  
+
+    It is also possible to use the *_VERSION_MIN_REQUIRED in source code to make one
+    source base that can be compiled to target a range of OS versions.  It is best
+    to not use the _MAC_* and __IPHONE_* macros for comparisons, but rather their values.
+    That is because you might get compiled on an old OS that does not define a later
+    OS version macro, and in the C preprocessor undefined values evaluate to zero
+    in expresssions, which could cause the #if expression to evaluate in an unexpected
+    way.
+    
+        #ifdef __MAC_OS_X_VERSION_MIN_REQUIRED
+            // code only compiled when targeting Mac OS X and not iPhone
+            // note use of 1050 instead of __MAC_10_5
+            #if __MAC_OS_X_VERSION_MIN_REQUIRED < 1050
+                // code in here might run on pre-Leopard OS
+            #else
+                // code here can assume Leopard or later
+            #endif
+        #endif
+
+
+*/
+
+#define __MAC_10_0      1000
+#define __MAC_10_1      1010
+#define __MAC_10_2      1020
+#define __MAC_10_3      1030
+#define __MAC_10_4      1040
+#define __MAC_10_5      1050
+#define __MAC_10_6      1060
+#define __MAC_10_7      1070
+#define __MAC_NA        9999   /* not available */
+
+#define __IPHONE_2_0     20000
+#define __IPHONE_2_1     20100
+#define __IPHONE_2_2     20200
+#define __IPHONE_3_0     30000
+#define __IPHONE_3_1     30100
+#define __IPHONE_3_2     30200
+#define __IPHONE_4_0     40000
+#define __IPHONE_4_1     40100
+#define __IPHONE_4_2     40200
+#define __IPHONE_4_3     40300
+#define __IPHONE_NA      99999  /* not available */
+
+#include <AvailabilityInternal.h>
+
+
+#ifdef __IPHONE_OS_VERSION_MIN_REQUIRED
+    #define __OSX_AVAILABLE_STARTING(_mac, _iphone) __AVAILABILITY_INTERNAL##_iphone
+    #define __OSX_AVAILABLE_BUT_DEPRECATED(_macIntro, _macDep, _iphoneIntro, _iphoneDep) \
+                                                    __AVAILABILITY_INTERNAL##_iphoneIntro##_DEP##_iphoneDep
+
+#elif defined(__MAC_OS_X_VERSION_MIN_REQUIRED)
+    #define __OSX_AVAILABLE_STARTING(_mac, _iphone) __AVAILABILITY_INTERNAL##_mac
+    #define __OSX_AVAILABLE_BUT_DEPRECATED(_macIntro, _macDep, _iphoneIntro, _iphoneDep) \
+                                                    __AVAILABILITY_INTERNAL##_macIntro##_DEP##_macDep
+
+#else
+    #define __OSX_AVAILABLE_STARTING(_mac, _iphone)
+    #define __OSX_AVAILABLE_BUT_DEPRECATED(_macIntro, _macDep, _iphoneIntro, _iphoneDep) 
+#endif
+
+
+#endif /* __AVAILABILITY__ */
diff -urN cctools-806-old/include/AvailabilityInternal.h cctools-806/include/AvailabilityInternal.h
--- cctools-806-old/include/AvailabilityInternal.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/AvailabilityInternal.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,761 @@
+/*
+ * Copyright (c) 2007-2010 by Apple Inc.. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+/*
+    File:       AvailabilityInternal.h
+ 
+    Contains:   implementation details of __OSX_AVAILABLE_* macros from <Availability.h>
+
+*/
+#ifndef __AVAILABILITY_INTERNAL__
+#define __AVAILABILITY_INTERNAL__
+
+
+
+#ifndef __IPHONE_OS_VERSION_MIN_REQUIRED
+    #ifdef __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__
+        /* compiler sets __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__ when -miphoneos-version-min is used */
+        #define __IPHONE_OS_VERSION_MIN_REQUIRED __ENVIRONMENT_IPHONE_OS_VERSION_MIN_REQUIRED__
+    #endif
+#endif
+
+#ifdef __IPHONE_OS_VERSION_MIN_REQUIRED
+    /* don't use visibility attribute for iPhoneOS */
+    #define __AVAILABILITY_INTERNAL_DEPRECATED         __attribute__((deprecated))
+    #define __AVAILABILITY_INTERNAL_UNAVAILABLE        __attribute__((unavailable))
+    #define __AVAILABILITY_INTERNAL_WEAK_IMPORT        __attribute__((weak_import))
+    #define __AVAILABILITY_INTERNAL_REGULAR            
+#else
+    #define __AVAILABILITY_INTERNAL_DEPRECATED         __attribute__((deprecated,visibility("default")))
+    #define __AVAILABILITY_INTERNAL_UNAVAILABLE        __attribute__((unavailable,visibility("default")))
+    #define __AVAILABILITY_INTERNAL_WEAK_IMPORT        __attribute__((weak_import,visibility("default")))
+    #define __AVAILABILITY_INTERNAL_REGULAR            __attribute__((visibility("default")))
+#endif
+
+#ifdef __IPHONE_OS_VERSION_MIN_REQUIRED
+    /* make sure a default max version is set */
+    #ifndef __IPHONE_OS_VERSION_MAX_ALLOWED
+        #define __IPHONE_OS_VERSION_MAX_ALLOWED     __IPHONE_4_3
+    #endif
+    /* make sure a valid min is set */
+    #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_0
+        #undef __IPHONE_OS_VERSION_MIN_REQUIRED
+        #define __IPHONE_OS_VERSION_MIN_REQUIRED    __IPHONE_2_0 
+    #endif
+
+    /* set up internal macros (up to 2.0) */
+    #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_2_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0                __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0                __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0                __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_NA     __AVAILABILITY_INTERNAL__IPHONE_2_0
+    #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_0    __AVAILABILITY_INTERNAL_DEPRECATED
+    /* set up internal macros (up to 2.1) */
+    #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1                __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1                __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1                __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_NA     __AVAILABILITY_INTERNAL__IPHONE_2_1
+    #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_1    __AVAILABILITY_INTERNAL__IPHONE_2_1
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_1    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_1    __AVAILABILITY_INTERNAL_DEPRECATED
+    #endif
+    /* set up internal macros (up to 2.2) */
+    #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2                __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2                __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2                __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_NA     __AVAILABILITY_INTERNAL__IPHONE_2_2
+    #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_2_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_2_2    __AVAILABILITY_INTERNAL__IPHONE_2_2
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_2_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_2_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_2_2    __AVAILABILITY_INTERNAL_DEPRECATED
+    #endif
+    /* set up internal macros (up to 3.0) */
+    #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0                __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0                __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0                __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_NA     __AVAILABILITY_INTERNAL__IPHONE_3_0
+    #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL__IPHONE_2_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL__IPHONE_2_2
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL__IPHONE_3_0
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_0    __AVAILABILITY_INTERNAL_DEPRECATED
+    #endif
+    /* set up internal macros (up to 3.1) */
+    #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1                __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1                __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1                __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_NA     __AVAILABILITY_INTERNAL__IPHONE_3_1
+    #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL__IPHONE_2_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL__IPHONE_2_2
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL__IPHONE_3_0
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL__IPHONE_3_1
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_1    __AVAILABILITY_INTERNAL_DEPRECATED
+    #endif
+    /* set up internal macros (up to 3.2) */
+    #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2                __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2                __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2                __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_NA     __AVAILABILITY_INTERNAL__IPHONE_3_2
+    #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_2_2
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_3_0
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_3_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL__IPHONE_3_2
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_3_2    __AVAILABILITY_INTERNAL_DEPRECATED
+    #endif
+    /* set up internal macros (up to 4.0) */
+    #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0                __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0                __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0                __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_NA     __AVAILABILITY_INTERNAL__IPHONE_4_0
+    #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_2_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_2_2
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_3_0
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_3_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_3_2
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL__IPHONE_4_0
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_0    __AVAILABILITY_INTERNAL_DEPRECATED
+    #endif
+    /* set up internal macros (up to 4.1) */
+    #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_4_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1                __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1                __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1                __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_NA     __AVAILABILITY_INTERNAL__IPHONE_4_1
+    #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_2_2
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_3_0
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_3_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_3_2
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_4_0
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL__IPHONE_4_1
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_1    __AVAILABILITY_INTERNAL_DEPRECATED
+    #endif
+    /* set up internal macros (up to 4.2) */
+    #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_4_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2                __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2                __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2                __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_NA     __AVAILABILITY_INTERNAL__IPHONE_4_2
+    #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_2_2
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_0
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_3_2
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_4_0
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_4_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL__IPHONE_4_2
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_2    __AVAILABILITY_INTERNAL_DEPRECATED
+    #endif
+    /* set up internal macros (up to 4.3) */
+    #if __IPHONE_OS_VERSION_MAX_ALLOWED < __IPHONE_4_3
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3                __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_3
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3                __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3                __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_NA     __AVAILABILITY_INTERNAL__IPHONE_4_3
+    #if __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_2_2
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_0
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_3_2
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_4_0
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_4_0
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_4_1
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_4_1
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_4_2
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_4_2
+    #elif __IPHONE_OS_VERSION_MIN_REQUIRED < __IPHONE_4_3
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_REGULAR
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL__IPHONE_4_3
+    #else
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_2_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_3_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_0_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_1_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_2_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__IPHONE_4_3_DEP__IPHONE_4_3    __AVAILABILITY_INTERNAL_DEPRECATED
+    #endif
+    /* set up internal macros (n/a) */
+    #define __AVAILABILITY_INTERNAL__IPHONE_NA                     __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #define __AVAILABILITY_INTERNAL__IPHONE_NA_DEP__IPHONE_NA      __AVAILABILITY_INTERNAL_UNAVAILABLE
+
+#elif defined(__ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__)
+    /* compiler for Mac OS X sets __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__ */
+    #define __MAC_OS_X_VERSION_MIN_REQUIRED __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__
+    /* make sure a default max version is set */
+    #ifndef __MAC_OS_X_VERSION_MAX_ALLOWED
+        #define __MAC_OS_X_VERSION_MAX_ALLOWED __MAC_10_7
+    #endif
+    /* set up internal macros */
+    #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_7
+        #define __AVAILABILITY_INTERNAL__MAC_10_7        __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_7
+        #define __AVAILABILITY_INTERNAL__MAC_10_7        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_7        __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_6
+        #define __AVAILABILITY_INTERNAL__MAC_10_6        __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_6
+        #define __AVAILABILITY_INTERNAL__MAC_10_6        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_6        __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_5
+        #define __AVAILABILITY_INTERNAL__MAC_10_5        __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_5
+        #define __AVAILABILITY_INTERNAL__MAC_10_5        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_5        __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_4
+        #define __AVAILABILITY_INTERNAL__MAC_10_4        __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_4
+        #define __AVAILABILITY_INTERNAL__MAC_10_4        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_4        __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_3
+        #define __AVAILABILITY_INTERNAL__MAC_10_3        __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_3
+        #define __AVAILABILITY_INTERNAL__MAC_10_3        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_3        __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_2
+        #define __AVAILABILITY_INTERNAL__MAC_10_2        __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_2
+        #define __AVAILABILITY_INTERNAL__MAC_10_2        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_2        __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_1
+        #define __AVAILABILITY_INTERNAL__MAC_10_1        __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_1
+        #define __AVAILABILITY_INTERNAL__MAC_10_1        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_1        __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #if __MAC_OS_X_VERSION_MAX_ALLOWED < __MAC_10_0
+        #define __AVAILABILITY_INTERNAL__MAC_10_0        __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #elif __MAC_OS_X_VERSION_MIN_REQUIRED < __MAC_10_0
+        #define __AVAILABILITY_INTERNAL__MAC_10_0        __AVAILABILITY_INTERNAL_WEAK_IMPORT
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_0        __AVAILABILITY_INTERNAL_REGULAR
+    #endif
+    #define __AVAILABILITY_INTERNAL__MAC_NA             __AVAILABILITY_INTERNAL_UNAVAILABLE
+    #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_1
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_1        __AVAILABILITY_INTERNAL_DEPRECATED
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_1        __AVAILABILITY_INTERNAL__MAC_10_0
+    #endif
+    #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_2
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_2        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_2        __AVAILABILITY_INTERNAL_DEPRECATED
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_2        __AVAILABILITY_INTERNAL__MAC_10_0
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_2        __AVAILABILITY_INTERNAL__MAC_10_1
+    #endif
+    #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_3
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_3        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_3        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_3        __AVAILABILITY_INTERNAL_DEPRECATED
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_3        __AVAILABILITY_INTERNAL__MAC_10_0
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_3        __AVAILABILITY_INTERNAL__MAC_10_1
+        #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_3        __AVAILABILITY_INTERNAL__MAC_10_2
+    #endif
+    #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_4
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_4        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_4        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_4        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_4        __AVAILABILITY_INTERNAL_DEPRECATED
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_4        __AVAILABILITY_INTERNAL__MAC_10_0
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_4        __AVAILABILITY_INTERNAL__MAC_10_1
+        #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_4        __AVAILABILITY_INTERNAL__MAC_10_2
+        #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_4        __AVAILABILITY_INTERNAL__MAC_10_3
+    #endif
+    #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_5
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_5        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_5        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_5        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_5        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_5        __AVAILABILITY_INTERNAL_DEPRECATED
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_5        __AVAILABILITY_INTERNAL__MAC_10_0
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_5        __AVAILABILITY_INTERNAL__MAC_10_1
+        #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_5        __AVAILABILITY_INTERNAL__MAC_10_2
+        #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_5        __AVAILABILITY_INTERNAL__MAC_10_3
+        #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_5        __AVAILABILITY_INTERNAL__MAC_10_4
+    #endif
+    #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_6
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_6        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_6        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_6        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_6        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_6        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_6        __AVAILABILITY_INTERNAL_DEPRECATED
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_6        __AVAILABILITY_INTERNAL__MAC_10_0
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_6        __AVAILABILITY_INTERNAL__MAC_10_1
+        #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_6        __AVAILABILITY_INTERNAL__MAC_10_2
+        #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_6        __AVAILABILITY_INTERNAL__MAC_10_3
+        #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_6        __AVAILABILITY_INTERNAL__MAC_10_4
+        #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_6        __AVAILABILITY_INTERNAL__MAC_10_5
+    #endif
+    #if __MAC_OS_X_VERSION_MIN_REQUIRED >= __MAC_10_7
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_7        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_7        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_7        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_7        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_7        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_7        __AVAILABILITY_INTERNAL_DEPRECATED
+        #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_7        __AVAILABILITY_INTERNAL_DEPRECATED
+    #else
+        #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_10_7        __AVAILABILITY_INTERNAL__MAC_10_0
+        #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_10_7        __AVAILABILITY_INTERNAL__MAC_10_1
+        #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_10_7        __AVAILABILITY_INTERNAL__MAC_10_2
+        #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_10_7        __AVAILABILITY_INTERNAL__MAC_10_3
+        #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_10_7        __AVAILABILITY_INTERNAL__MAC_10_4
+        #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_10_7        __AVAILABILITY_INTERNAL__MAC_10_5
+        #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_10_7        __AVAILABILITY_INTERNAL__MAC_10_6
+    #endif
+    #define __AVAILABILITY_INTERNAL__MAC_10_0_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_0
+    #define __AVAILABILITY_INTERNAL__MAC_10_1_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_1
+    #define __AVAILABILITY_INTERNAL__MAC_10_2_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_2
+    #define __AVAILABILITY_INTERNAL__MAC_10_3_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_3
+    #define __AVAILABILITY_INTERNAL__MAC_10_4_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_4
+    #define __AVAILABILITY_INTERNAL__MAC_10_5_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_5
+    #define __AVAILABILITY_INTERNAL__MAC_10_6_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_6
+    #define __AVAILABILITY_INTERNAL__MAC_10_7_DEP__MAC_NA             __AVAILABILITY_INTERNAL__MAC_10_7
+    #define __AVAILABILITY_INTERNAL__MAC_NA_DEP__MAC_NA               __AVAILABILITY_INTERNAL_UNAVAILABLE
+#endif
+
+#endif /* __AVAILABILITY_INTERNAL__ */
diff -urN cctools-806-old/include/config.h.in cctools-806/include/config.h.in
--- cctools-806-old/include/config.h.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/config.h.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,344 @@
+/* include/config.h.in.  Generated from configure.ac by autoheader.  */
+
+/* Define if building universal (internal helper macro) */
+#undef AC_APPLE_UNIVERSAL_BUILD
+
+/* Define to one of `_getb67', `GETB67', `getb67' for Cray-2 and Cray-YMP
+   systems. This function is required for `alloca.c' support on those systems.
+   */
+#undef CRAY_STACKSEG_END
+
+/* filesystem root of cross build environment */
+#undef CROSS_SYSROOT
+
+/* cross compiler binary prefix */
+#undef CROSS_BIN_PREFIX
+
+/* Define to 1 if using `alloca.c'. */
+#undef C_ALLOCA
+
+/* Default Mach architecture name */
+#undef DEFAULT_MACH_ARCH
+
+/* Emulated CPU subtype */
+#undef EMULATED_HOST_CPU_SUBTYPE
+
+/* Emulated CPU type */
+#undef EMULATED_HOST_CPU_TYPE
+
+/* Define to 1 if you have `alloca', as a function or macro. */
+#undef HAVE_ALLOCA
+
+/* Define to 1 if you have <alloca.h> and it should be used (not on Ultrix).
+   */
+#undef HAVE_ALLOCA_H
+
+/* Define to 1 if you have the `atexit' function. */
+#undef HAVE_ATEXIT
+
+/* Define to 1 if you have the `bzero' function. */
+#undef HAVE_BZERO
+
+/* Define to 1 if your system has a working `chown' function. */
+#undef HAVE_CHOWN
+
+/* Define to 1 if you have the declaration of `getc_unlocked', and to 0 if you
+   don't. */
+#undef HAVE_DECL_GETC_UNLOCKED
+
+/* For systems that don't have getc_unlocked, use getc  */
+#if !HAVE_DECL_GETC_UNLOCKED
+# define getc_unlocked(a) getc(a)
+#endif
+
+/* Define to 1 if you have the <errno.h> header file. */
+#undef HAVE_ERRNO_H
+
+/* Define to 1 if you have the `fchdir' function. */
+#undef HAVE_FCHDIR
+
+/* Define to 1 if you have the `fork' function. */
+#undef HAVE_FORK
+
+/* Define to 1 if you have the `ftruncate' function. */
+#undef HAVE_FTRUNCATE
+
+/* Define to 1 if you have the `getattrlist' function. */
+#undef HAVE_GETATTRLIST
+
+/* Define to 1 if you have the `getpagesize' function. */
+#undef HAVE_GETPAGESIZE
+
+/* Define to 1 if you have the `gettimeofday' function. */
+#undef HAVE_GETTIMEOFDAY
+
+/* Define to 1 if you have the <inttypes.h> header file. */
+#undef HAVE_INTTYPES_H
+
+/* Define to 1 if you have the <limits.h> header file. */
+#undef HAVE_LIMITS_H
+
+/* Define to 1 if your system has a GNU libc compatible `malloc' function, and
+   to 0 otherwise. */
+#undef HAVE_MALLOC
+
+/* Define to 1 if you have the `memchr' function. */
+#undef HAVE_MEMCHR
+
+/* Define to 1 if you have the `memmove' function. */
+#undef HAVE_MEMMOVE
+
+/* Define to 1 if you have the <memory.h> header file. */
+#undef HAVE_MEMORY_H
+
+/* Define to 1 if you have the `memset' function. */
+#undef HAVE_MEMSET
+
+/* Define to 1 if you have a working `mmap' system call. */
+#undef HAVE_MMAP
+
+/* Define to 1 if you have the `NSIsSymbolNameDefined' function. */
+#undef HAVE_NSISSYMBOLNAMEDEFINED
+
+/* Define to 1 if you have the `_NSGetExecutablePath' function */
+#undef HAVE__NSGETEXECUTABLEPATH
+
+/* Deifne to 1 if you have the `readlink' function */
+#undef HAVE_READLINK
+
+/* Have Objective-C support */
+#undef HAVE_OBJC
+
+/* Define to 1 if you have the <objc/objc-runtime.h> header file. */
+#undef HAVE_OBJC_OBJC_RUNTIME_H
+
+/* Define to 1 if libc includes obstacks. */
+#undef HAVE_OBSTACK
+
+/* Define to 1 if the system has the type `ptrdiff_t'. */
+#undef HAVE_PTRDIFF_T
+
+/* Define to 1 if you have the `qsort' function. */
+#undef HAVE_QSORT
+
+/* Define to 1 if you have the `qsort_r' function. */
+#undef HAVE_QSORT_R
+
+/* Define to 1 if your system has a GNU libc compatible `realloc' function,
+   and to 0 otherwise. */
+#undef HAVE_REALLOC
+
+/* Define to 1 if you have the `realpath' function. */
+#undef HAVE_REALPATH
+
+/* Define to 1 if you have the `sqrt' function. */
+#undef HAVE_SQRT
+
+/* Define to 1 if stdbool.h conforms to C99. */
+#undef HAVE_STDBOOL_H
+
+/* Define to 1 if you have the <stdint.h> header file. */
+#undef HAVE_STDINT_H
+
+/* Define to 1 if you have the <stdio.h> header file. */
+#undef HAVE_STDIO_H
+
+/* Define to 1 if you have the <stdlib.h> header file. */
+#undef HAVE_STDLIB_H
+
+/* Define to 1 if you have the `strcasecmp' function. */
+#undef HAVE_STRCASECMP
+
+/* Define to 1 if you have the `strchr' function. */
+#undef HAVE_STRCHR
+
+/* Define to 1 if you have the `strdup' function. */
+#undef HAVE_STRDUP
+
+/* Define to 1 if you have the `strerror' function. */
+#undef HAVE_STRERROR
+
+/* Define to 1 if you have the <strings.h> header file. */
+#undef HAVE_STRINGS_H
+
+/* Define to 1 if you have the <string.h> header file. */
+#undef HAVE_STRING_H
+
+/* Define to 1 if you have the `strlcat' function. */
+#undef HAVE_STRLCAT
+
+/* Define to 1 if you have the `strmode' function. */
+#undef HAVE_STRMODE
+
+/* Define to 1 if you have the `strncasecmp' function. */
+#undef HAVE_STRNCASECMP
+
+/* Define to 1 if you have the `strrchr' function. */
+#undef HAVE_STRRCHR
+
+/* Define to 1 if you have the `strstr' function. */
+#undef HAVE_STRSTR
+
+/* Define to 1 if you have the `strtol' function. */
+#undef HAVE_STRTOL
+
+/* Define to 1 if you have the `strtoul' function. */
+#undef HAVE_STRTOUL
+
+/* Define to 1 if you have the <sys/param.h> header file. */
+#undef HAVE_SYS_PARAM_H
+
+/* Define to 1 if you have the <sys/stat.h> header file. */
+#undef HAVE_SYS_STAT_H
+
+/* Define to 1 if you have the <sys/types.h> header file. */
+#undef HAVE_SYS_TYPES_H
+
+/* Define to 1 if you have the <unistd.h> header file. */
+#undef HAVE_UNISTD_H
+
+/* Define to 1 if you have the `utime' function. */
+#undef HAVE_UTIME
+
+/* Define to 1 if you have the `vfork' function. */
+#undef HAVE_VFORK
+
+/* Define to 1 if you have the <vfork.h> header file. */
+#undef HAVE_VFORK_H
+
+/* Define to 1 if `fork' works. */
+#undef HAVE_WORKING_FORK
+
+/* Define to 1 if `vfork' works. */
+#undef HAVE_WORKING_VFORK
+
+/* Define to 1 if the system has the type `_Bool'. */
+#undef HAVE__BOOL
+
+/* Define to the address where bug reports for this package should be sent. */
+#undef PACKAGE_BUGREPORT
+
+/* Define to the full name of this package. */
+#undef PACKAGE_NAME
+
+/* Define to the full name and version of this package. */
+#undef PACKAGE_STRING
+
+/* Define to the one symbol short name of this package. */
+#undef PACKAGE_TARNAME
+
+/* Define to the home page for this package. */
+#undef PACKAGE_URL
+
+/* Define to the version of this package. */
+#undef PACKAGE_VERSION
+
+/* If using the C implementation of alloca, define if you know the
+   direction of stack growth for your system; otherwise it will be
+   automatically deduced at runtime.
+	STACK_DIRECTION > 0 => grows toward higher addresses
+	STACK_DIRECTION < 0 => grows toward lower addresses
+	STACK_DIRECTION = 0 => direction of growth unknown */
+#undef STACK_DIRECTION
+
+/* Define to 1 if you have the ANSI C header files. */
+#undef STDC_HEADERS
+
+/* max unsigned long long */
+#undef ULLONG_MAX
+
+/* Define WORDS_BIGENDIAN to 1 if your processor stores words with the most
+   significant byte first (like Motorola and SPARC, unlike Intel). */
+#if defined AC_APPLE_UNIVERSAL_BUILD
+# if defined __BIG_ENDIAN__
+#  define WORDS_BIGENDIAN 1
+# endif
+#else
+# ifndef WORDS_BIGENDIAN
+#  undef WORDS_BIGENDIAN
+# endif
+#endif
+
+/* Define to 1 if `lex' declares `yytext' as a `char *' by default, not a
+   `char[]'. */
+#undef YYTEXT_POINTER
+
+/* Define for Solaris 2.5.1 so the uint32_t typedef from <sys/synch.h>,
+   <pthread.h>, or <semaphore.h> is not used. If the typedef were allowed, the
+   #define below would cause a syntax error. */
+#undef _UINT32_T
+
+/* Define for Solaris 2.5.1 so the uint64_t typedef from <sys/synch.h>,
+   <pthread.h>, or <semaphore.h> is not used. If the typedef were allowed, the
+   #define below would cause a syntax error. */
+#undef _UINT64_T
+
+/* Define for Solaris 2.5.1 so the uint8_t typedef from <sys/synch.h>,
+   <pthread.h>, or <semaphore.h> is not used. If the typedef were allowed, the
+   #define below would cause a syntax error. */
+#undef _UINT8_T
+
+/* Define to `int' if <sys/types.h> doesn't define. */
+#undef gid_t
+
+/* Define to `__inline__' or `__inline' if that's what the C compiler
+   calls it, or to nothing if 'inline' is not supported under any name.  */
+#ifndef __cplusplus
+#undef inline
+#endif
+
+/* Define to the type of a signed integer type of width exactly 16 bits if
+   such a type exists and the standard includes do not define it. */
+#undef int16_t
+
+/* Define to the type of a signed integer type of width exactly 32 bits if
+   such a type exists and the standard includes do not define it. */
+#undef int32_t
+
+/* Define to the type of a signed integer type of width exactly 64 bits if
+   such a type exists and the standard includes do not define it. */
+#undef int64_t
+
+/* Define to the type of a signed integer type of width exactly 8 bits if such
+   a type exists and the standard includes do not define it. */
+#undef int8_t
+
+/* Define to rpl_malloc if the replacement function should be used. */
+#undef malloc
+
+/* Define to `long int' if <sys/types.h> does not define. */
+#undef off_t
+
+/* Define to `int' if <sys/types.h> does not define. */
+#undef pid_t
+
+/* Define to rpl_realloc if the replacement function should be used. */
+#undef realloc
+
+/* Define to `unsigned int' if <sys/types.h> does not define. */
+#undef size_t
+
+/* Define to `int' if <sys/types.h> does not define. */
+#undef ssize_t
+
+/* Define to `int' if <sys/types.h> doesn't define. */
+#undef uid_t
+
+/* Define to the type of an unsigned integer type of width exactly 16 bits if
+   such a type exists and the standard includes do not define it. */
+#undef uint16_t
+
+/* Define to the type of an unsigned integer type of width exactly 32 bits if
+   such a type exists and the standard includes do not define it. */
+#undef uint32_t
+
+/* Define to the type of an unsigned integer type of width exactly 64 bits if
+   such a type exists and the standard includes do not define it. */
+#undef uint64_t
+
+/* Define to the type of an unsigned integer type of width exactly 8 bits if
+   such a type exists and the standard includes do not define it. */
+#undef uint8_t
+
+/* Define as `fork' if `vfork' does not work. */
+#undef vfork
diff -urN cctools-806-old/include/extern.h cctools-806/include/extern.h
--- cctools-806-old/include/extern.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/extern.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1 @@
+#define __private_extern__ __attribute__((visibility("hidden")))
diff -urN cctools-806-old/include/foreign/architecture/byte_order.h cctools-806/include/foreign/architecture/byte_order.h
--- cctools-806-old/include/foreign/architecture/byte_order.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/architecture/byte_order.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,46 @@
+#ifndef _ARCHITECTURE_BYTE_ORDER_H_
+#define _ARCHITECTURE_BYTE_ORDER_H_
+
+#include <stdint.h>
+
+#include <libkern/OSByteOrder.h>
+
+static __inline__
+unsigned short 
+NXSwapShort(
+    unsigned short x
+    )
+{
+  return ((((uint16_t)(x) & 0xff00) >> 8) | \
+   (((uint16_t)(x) & 0x00ff) << 8));
+}
+
+static __inline__
+unsigned int
+NXSwapInt(
+    unsigned int x
+    )
+{
+  return ((((uint32_t)(x) & 0xff000000) >> 24) | \
+	  (((uint32_t)(x) & 0x00ff0000) >>  8) | \
+	  (((uint32_t)(x) & 0x0000ff00) <<  8) | \
+	  (((uint32_t)(x) & 0x000000ff) << 24));
+}
+
+static __inline__
+unsigned long
+NXSwapLong(
+    unsigned long inv
+    )
+{
+  return (long)NXSwapInt((int)inv);
+}
+
+enum NXByteOrder {
+  NX_UnknownByteOrder,
+  NX_LittleEndian,
+    NX_BigEndian
+};
+
+
+#endif
diff -urN cctools-806-old/include/foreign/architecture/i386/fpu.h cctools-806/include/foreign/architecture/i386/fpu.h
--- cctools-806-old/include/foreign/architecture/i386/fpu.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/architecture/i386/fpu.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,154 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * "Portions Copyright (c) 1999 Apple Computer, Inc.  All Rights
+ * Reserved.  This file contains Original Code and/or Modifications of
+ * Original Code as defined in and that are subject to the Apple Public
+ * Source License Version 1.0 (the 'License').  You may not use this file
+ * except in compliance with the License.  Please obtain a copy of the
+ * License at http://www.apple.com/publicsource and read it before using
+ * this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License."
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ * Intel386 Family:	Floating Point unit.
+ *
+ * HISTORY
+ *
+ * 5 October 1992 ? at NeXT
+ *	Added names to previously unamed fields in the mantissa.
+ *
+ * 5 April 1992 ? at NeXT
+ *	Created.
+ */
+
+/*
+ * Data register.
+ */
+
+typedef struct fp_data_reg {
+    unsigned short		mant;
+    unsigned short		mant1	:16,
+				mant2	:16,
+				mant3	:16;
+    unsigned short		exp	:15,
+			    	sign	:1;
+} fp_data_reg_t;
+
+/*
+ * Data register stack.
+ */
+
+typedef struct fp_stack {
+    fp_data_reg_t		ST[8];
+} fp_stack_t;
+
+/*
+ * Register stack tag word.
+ */
+
+typedef struct fp_tag {
+    unsigned short		tag0	:2,
+    				tag1	:2,
+				tag2	:2,
+				tag3	:2,
+    				tag4	:2,
+				tag5	:2,
+				tag6	:2,
+				tag7	:2;
+#define FP_TAG_VALID		0
+#define FP_TAG_ZERO		1
+#define FP_TAG_SPEC		2
+#define FP_TAG_EMPTY		3
+} fp_tag_t;
+
+/*
+ * Status word.
+ */
+
+typedef struct fp_status {
+    unsigned short		invalid	:1,
+    				denorm	:1,
+				zdiv	:1,
+				ovrfl	:1,
+				undfl	:1,
+				precis	:1,
+				stkflt	:1,
+				errsumm	:1,
+				c0	:1,
+				c1	:1,
+				c2	:1,
+				tos	:3,
+				c3	:1,
+				busy	:1;
+} fp_status_t;
+
+/*
+ * Control word.
+ */
+
+typedef struct fp_control {
+    unsigned short		invalid	:1,
+    				denorm	:1,
+				zdiv	:1,
+				ovrfl	:1,
+				undfl	:1,
+				precis	:1,
+					:2,
+				pc	:2,
+#define FP_PREC_24B		0
+#define	FP_PREC_53B		2
+#define FP_PREC_64B		3
+				rc	:2,
+#define FP_RND_NEAR		0
+#define FP_RND_DOWN		1
+#define FP_RND_UP		2
+#define FP_CHOP			3
+				/*inf*/	:1,
+					:3;
+} fp_control_t;
+
+#import <architecture/i386/sel.h>
+
+/*
+ * Floating point 'environment'
+ * used by FSTENV/FLDENV instructions.
+ */
+
+typedef struct fp_env {
+    fp_control_t		control;
+    unsigned short			:16;
+    fp_status_t			status;
+    unsigned short			:16;
+    fp_tag_t			tag;
+    unsigned short			:16;
+    unsigned int		ip;
+    sel_t			cs;
+    unsigned short		opcode;
+    unsigned int		dp;
+    sel_t			ds;
+    unsigned short			:16;
+} fp_env_t;
+
+/*
+ * Floating point state
+ * used by FSAVE/FRSTOR instructions.
+ */
+ 
+typedef struct fp_state {
+    fp_env_t			environ;
+    fp_stack_t			stack;
+} fp_state_t;
diff -urN cctools-806-old/include/foreign/architecture/i386/frame.h cctools-806/include/foreign/architecture/i386/frame.h
--- cctools-806-old/include/foreign/architecture/i386/frame.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/architecture/i386/frame.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,125 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * "Portions Copyright (c) 1999 Apple Computer, Inc.  All Rights
+ * Reserved.  This file contains Original Code and/or Modifications of
+ * Original Code as defined in and that are subject to the Apple Public
+ * Source License Version 1.0 (the 'License').  You may not use this file
+ * except in compliance with the License.  Please obtain a copy of the
+ * License at http://www.apple.com/publicsource and read it before using
+ * this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License."
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ * Intel386 Family:	Processor exception frame.
+ *
+ * HISTORY
+ *
+ * 31 August 1992 ? at NeXT
+ *	Added v86 mode stuff.
+ *
+ * 8 June 1992 ? at NeXT
+ *	Changed name of write field in err_code_t
+ *	which collided with write() in shlib.
+ *
+ * 30 March 1992 ? at NeXT
+ *	Created.
+ */
+
+/*
+ * Format of the error code
+ * generated by the hardware
+ * for certain exceptions.
+ */
+ 
+typedef union err_code {
+    struct err_code_normal {
+	unsigned int	ext	:1,
+			tbl	:2,
+#define ERR_GDT		0
+#define ERR_IDT		1
+#define ERR_LDT		2
+			index	:13,
+				:16;
+    } normal;
+    struct err_code_pgfault {
+	unsigned int	prot	:1,
+			wrtflt	:1,
+			user	:1,
+				:29;
+    } pgfault;
+} err_code_t;
+
+#import <architecture/i386/sel.h>
+
+/*
+ * The actual hardware exception frame
+ * is variable in size.  An error code is
+ * only pushed for certain exceptions.
+ * Previous stack information is only
+ * pushed for exceptions that cause a
+ * change in privilege level.  The dpl
+ * field of the saved CS selector can be
+ * used to determine whether this is the
+ * case.  If the interrupted task was
+ * executing in v86 mode, then the data
+ * segment registers are also present in
+ * the exception frame (in addition to
+ * previous stack information).  This
+ * case can be determined by examining
+ * eflags.
+ */
+
+typedef struct except_frame {
+    err_code_t		err;
+    unsigned int	eip;
+    sel_t		cs;
+    unsigned int		:0;
+    unsigned int	eflags;
+    unsigned int	esp;
+    sel_t		ss;
+    unsigned int		:0;
+    unsigned short	v_es;
+    unsigned int		:0;
+    unsigned short	v_ds;
+    unsigned int		:0;
+    unsigned short	v_fs;
+    unsigned int		:0;
+    unsigned short	v_gs;
+    unsigned int		:0;
+} except_frame_t;
+
+/*
+ * Values in eflags.
+ */
+
+#define EFL_CF		0x00001
+#define EFL_PF		0x00004
+#define EFL_AF		0x00010
+#define EFL_ZF		0x00040
+#define EFL_SF		0x00080
+#define EFL_TF		0x00100
+#define EFL_IF		0x00200
+#define EFL_DF		0x00400
+#define EFL_OF		0x00800
+#define EFL_IOPL	0x03000
+#define EFL_NT		0x04000
+#define EFL_RF		0x10000
+#define EFL_VM		0x20000
+#define EFL_AC		0x40000
+
+#define EFL_CLR		0xfff88028
+#define EFL_SET		0x00000002
diff -urN cctools-806-old/include/foreign/architecture/i386/sel.h cctools-806/include/foreign/architecture/i386/sel.h
--- cctools-806-old/include/foreign/architecture/i386/sel.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/architecture/i386/sel.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,55 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * "Portions Copyright (c) 1999 Apple Computer, Inc.  All Rights
+ * Reserved.  This file contains Original Code and/or Modifications of
+ * Original Code as defined in and that are subject to the Apple Public
+ * Source License Version 1.0 (the 'License').  You may not use this file
+ * except in compliance with the License.  Please obtain a copy of the
+ * License at http://www.apple.com/publicsource and read it before using
+ * this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License."
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ * Intel386 Family:	Segment selector.
+ *
+ * HISTORY
+ *
+ * 29 March 1992 ? at NeXT
+ *	Created.
+ */
+
+/*
+ * Segment selector.
+ */
+
+#ifndef _I386_SEL_H_
+#define _I386_SEL_H_
+
+typedef struct sel {
+    unsigned short	rpl	:2,
+#define KERN_PRIV	0
+#define USER_PRIV	3
+			ti	:1,
+#define SEL_GDT		0
+#define SEL_LDT		1
+			index	:13;
+} sel_t;
+
+#define NULL_SEL	((sel_t) { 0, 0, 0 } )
+
+#endif // _I386_SEL_H_
+
diff -urN cctools-806-old/include/foreign/ar.h cctools-806/include/foreign/ar.h
--- cctools-806-old/include/foreign/ar.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/ar.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,34 @@
+#ifndef _AR_H_
+#define _AR_H_
+
+#ifdef HAVE_CONFIG_H
+#include <config.h>
+#endif
+
+#ifdef HAVE_STRING_H
+#include <string.h>
+#endif
+
+#include <sys/types.h>
+
+#define ARMAG           "!<arch>\n"     /* ar "magic number" */
+#define SARMAG          8               /* strlen(ARMAG); */
+
+#define AR_EFMT1        "#1/"           /* extended format #1 */
+
+struct ar_hdr {
+  char ar_name[16];               /* name */
+  char ar_date[12];               /* modification time */
+  char ar_uid[6];                 /* user id */
+  char ar_gid[6];                 /* group id */
+  char ar_mode[8];                /* octal file permissions */
+  char ar_size[10];               /* size in bytes */
+#define ARFMAG  "`\n"
+  char ar_fmag[2];                /* consistency check */
+};
+
+#ifndef HAVE_STRMODE
+void strmode(mode_t mode, char *bp);
+#endif
+
+#endif /* !_AR_H_ */
diff -urN cctools-806-old/include/foreign/arm/endian.h cctools-806/include/foreign/arm/endian.h
--- cctools-806-old/include/foreign/arm/endian.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/arm/endian.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,97 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright 1995 NeXT Computer, Inc. All rights reserved.
+ */
+/*
+ * Copyright (c) 1987, 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)endian.h	8.1 (Berkeley) 6/11/93
+ */
+
+#ifndef _ARM__ENDIAN_H_
+#define	_ARM__ENDIAN_H_
+
+/*
+ * Define _NOQUAD if the compiler does NOT support 64-bit integers.
+ */
+/* #define _NOQUAD */
+
+/*
+ * Define the order of 32-bit words in 64-bit words.
+ */
+#define _QUAD_HIGHWORD 1
+#define _QUAD_LOWWORD 0
+
+/*
+ * Definitions for byte order, according to byte significance from low
+ * address to high.
+ */
+#define	__DARWIN_LITTLE_ENDIAN	1234	/* LSB first: i386, vax */
+#define	__DARWIN_BIG_ENDIAN	4321	/* MSB first: 68000, ibm, net */
+#define	__DARWIN_PDP_ENDIAN	3412	/* LSB first in word, MSW first in long */
+
+#define	__DARWIN_BYTE_ORDER	__DARWIN_LITTLE_ENDIAN
+
+#if	defined(KERNEL) || !defined(_POSIX_C_SOURCE)
+
+#define	LITTLE_ENDIAN	__DARWIN_LITTLE_ENDIAN
+#define	BIG_ENDIAN	__DARWIN_BIG_ENDIAN
+#define	PDP_ENDIAN	__DARWIN_PDP_ENDIAN
+
+#define	BYTE_ORDER	__DARWIN_BYTE_ORDER
+
+#ifdef NEED_SYS_ENDIAN_H
+#include <sys/_endian.h>
+#endif
+
+#endif /* defined(KERNEL) || !defined(_POSIX_C_SOURCE) */
+#endif /* !_ARM__ENDIAN_H_ */
diff -urN cctools-806-old/include/foreign/arm/_limits.h cctools-806/include/foreign/arm/_limits.h
--- cctools-806-old/include/foreign/arm/_limits.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/arm/_limits.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,28 @@
+/*
+ * Copyright (c) 2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+#ifndef	_ARM__LIMITS_H_
+#define	_ARM__LIMITS_H_
+
+#define	__DARWIN_CLK_TCK		100	/* ticks per second */
+
+#endif	/* _ARM__LIMITS_H_ */
+
diff -urN cctools-806-old/include/foreign/arm/limits.h cctools-806/include/foreign/arm/limits.h
--- cctools-806-old/include/foreign/arm/limits.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/arm/limits.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,107 @@
+/*
+ * Copyright (c) 1988, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)limits.h	8.3 (Berkeley) 1/4/94
+ */
+
+#ifndef _ARM_LIMITS_H_
+#define _ARM_LIMITS_H_
+
+#include <arm/_limits.h>
+
+#define	CHAR_BIT	8		/* number of bits in a char */
+#define	MB_LEN_MAX	6		/* Allow 31 bit UTF2 */
+
+#define	CLK_TCK		__DARWIN_CLK_TCK	/* ticks per second */
+
+/*
+ * According to ANSI (section 2.2.4.2), the values below must be usable by
+ * #if preprocessing directives.  Additionally, the expression must have the
+ * same type as would an expression that is an object of the corresponding
+ * type converted according to the integral promotions.  The subtraction for
+ * INT_MIN and LONG_MIN is so the value is not unsigned; 2147483648 is an
+ * unsigned int for 32-bit two's complement ANSI compilers (section 3.1.3.2).
+ * These numbers work for pcc as well.  The UINT_MAX and ULONG_MAX values
+ * are written as hex so that GCC will be quiet about large integer constants.
+ */
+#define	SCHAR_MAX	127		/* min value for a signed char */
+#define	SCHAR_MIN	(-128)		/* max value for a signed char */
+
+#define	UCHAR_MAX	255		/* max value for an unsigned char */
+#define	CHAR_MAX	127		/* max value for a char */
+#define	CHAR_MIN	(-128)		/* min value for a char */
+
+#define	USHRT_MAX	65535		/* max value for an unsigned short */
+#define	SHRT_MAX	32767		/* max value for a short */
+#define	SHRT_MIN	(-32768)	/* min value for a short */
+
+#define	UINT_MAX	0xffffffff	/* max value for an unsigned int */
+#define	INT_MAX		2147483647	/* max value for an int */
+#define	INT_MIN		(-2147483647-1)	/* min value for an int */
+
+#ifdef __LP64__
+#define	ULONG_MAX	0xffffffffffffffffUL	/* max unsigned long */
+#define	LONG_MAX	0x7fffffffffffffffL	/* max signed long */
+#define	LONG_MIN	(-0x7fffffffffffffffL-1) /* min signed long */
+#else /* !__LP64__ */
+#define	ULONG_MAX	0xffffffffL	/* max value for an unsigned long */
+#define	LONG_MAX	2147483647L	/* max value for a long */
+#define	LONG_MIN	(-2147483647L-1) /* min value for a long */
+#endif /* __LP64__ */
+
+#define	ULLONG_MAX	0xffffffffffffffffULL	/* max unsigned long long */
+#define	LLONG_MAX	0x7fffffffffffffffLL	/* max signed long long */
+#define	LLONG_MIN	(-0x7fffffffffffffffLL-1) /* min signed long long */
+
+#if !defined(_ANSI_SOURCE)
+#define	SSIZE_MAX	LONG_MAX	/* max value for a ssize_t */
+
+#if !defined(_POSIX_C_SOURCE) && !defined(_XOPEN_SOURCE)
+#define	SIZE_T_MAX	ULONG_MAX	/* max value for a size_t */
+
+#define	UQUAD_MAX	ULLONG_MAX
+#define	QUAD_MAX	LLONG_MAX
+#define	QUAD_MIN	LLONG_MIN
+
+#endif /* !_POSIX_C_SOURCE && !_XOPEN_SOURCE */
+#endif /* !_ANSI_SOURCE */
+
+#if (!defined(_ANSI_SOURCE)&&!defined(_POSIX_C_SOURCE)) || defined(_XOPEN_SOURCE)
+#ifdef __LP64__
+#define LONG_BIT	64
+#else /* !__LP64__ */
+#define LONG_BIT	32
+#endif /* __LP64__ */
+#define WORD_BIT	32
+#endif /* (!(_ANSI_SOURCE) && !(_POSIX_C_SOURCE)) || (_XOPEN_SOURCE) */
+
+#endif /* _ARM_LIMITS_H_ */
diff -urN cctools-806-old/include/foreign/arm/param.h cctools-806/include/foreign/arm/param.h
--- cctools-806-old/include/foreign/arm/param.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/arm/param.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,161 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*-
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)param.h	8.1 (Berkeley) 4/4/95
+ */
+
+/*
+ * Machine dependent constants for Intel 386.
+ */
+
+#ifndef _ARM_PARAM_H_
+#define _ARM_PARAM_H_
+
+/*
+ * Round p (pointer or byte index) up to a correctly-aligned value for all
+ * data types (int, long, ...).   The result is unsigned int and must be
+ * cast to any desired pointer type.
+ */
+#define	ALIGNBYTES	3
+#define	ALIGN(p)	(((unsigned int)(p) + ALIGNBYTES) &~ ALIGNBYTES)
+
+#define	NBPG		4096		/* bytes/page */
+#define	PGOFSET		(NBPG-1)	/* byte offset into page */
+#define	PGSHIFT		12		/* LOG2(NBPG) */
+
+#define	DEV_BSIZE	512
+#define	DEV_BSHIFT	9		/* log2(DEV_BSIZE) */
+#define BLKDEV_IOSIZE	2048
+#define	MAXPHYS		(128 * 1024)	/* max raw I/O transfer size */
+
+#define	CLSIZE		1
+#define	CLSIZELOG2	0
+
+/*
+ * Constants related to network buffer management.
+ * MCLBYTES must be no larger than CLBYTES (the software page size), and,
+ * on machines that exchange pages of input or output buffers with mbuf
+ * clusters (MAPPED_MBUFS), MCLBYTES must also be an integral multiple
+ * of the hardware page size.
+ */
+#define	MSIZE		256		/* size of an mbuf */
+#define	MCLBYTES	2048		/* large enough for ether MTU */
+#define	MCLSHIFT	11
+#define	MCLOFSET	(MCLBYTES - 1)
+#ifndef NMBCLUSTERS
+#ifdef GATEWAY
+#define	NMBCLUSTERS	((1024 * 1024) / MCLBYTES)	/* cl map size: 1MB */
+#else
+#define	NMBCLUSTERS	((1024 * 512) / MCLBYTES)	/* cl map size: 0.5MB */
+#endif
+#endif
+
+/*
+ * Some macros for units conversion
+ */
+/* Core clicks (NeXT_page_size bytes) to segments and vice versa */
+#define	ctos(x)	(x)
+#define	stoc(x)	(x)
+
+/* Core clicks (4096 bytes) to disk blocks */
+#define	ctod(x)	((x)<<(PGSHIFT-DEV_BSHIFT))
+#define	dtoc(x)	((x)>>(PGSHIFT-DEV_BSHIFT))
+#define	dtob(x)	((x)<<DEV_BSHIFT)
+
+/* clicks to bytes */
+#define	ctob(x)	((x)<<PGSHIFT)
+
+/* bytes to clicks */
+#define	btoc(x)	(((unsigned)(x)+(NBPG-1))>>PGSHIFT)
+
+#ifdef __APPLE__
+#define  btodb(bytes, devBlockSize)         \
+        ((unsigned)(bytes) / devBlockSize)
+#define  dbtob(db, devBlockSize)            \
+        ((unsigned)(db) * devBlockSize)
+#else
+#define	btodb(bytes)	 		/* calculates (bytes / DEV_BSIZE) */ \
+	((unsigned)(bytes) >> DEV_BSHIFT)
+#define	dbtob(db)			/* calculates (db * DEV_BSIZE) */ \
+	((unsigned)(db) << DEV_BSHIFT)
+#endif
+
+/*
+ * Map a ``block device block'' to a file system block.
+ * This should be device dependent, and will be if we
+ * add an entry to cdevsw/bdevsw for that purpose.
+ * For now though just use DEV_BSIZE.
+ */
+#define	bdbtofsb(bn)	((bn) / (BLKDEV_IOSIZE/DEV_BSIZE))
+
+/*
+ * Macros to decode (and encode) processor status word.
+ */
+#define STATUS_WORD(rpl, ipl)	(((ipl) << 8) | (rpl))
+#define	USERMODE(x)		(((x) & 3) == 3)
+#define	BASEPRI(x)		(((x) & (255 << 8)) == 0)
+
+
+#if	defined(KERNEL) || defined(STANDALONE)
+#define	DELAY(n) delay(n)
+
+#else	/* defined(KERNEL) || defined(STANDALONE) */
+#define	DELAY(n)	{ register int N = (n); while (--N > 0); }
+#endif	/* defined(KERNEL) || defined(STANDALONE) */
+
+#endif /* _ARM_PARAM_H_ */
diff -urN cctools-806-old/include/foreign/arm/setjmp.h cctools-806/include/foreign/arm/setjmp.h
--- cctools-806-old/include/foreign/arm/setjmp.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/arm/setjmp.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,23 @@
+#ifndef _BSD_ARM_SETJMP_H_
+#define _BSD_ARM_SETJMP_H_
+
+#define _JBLEN  27
+typedef int jmp_buf[_JBLEN];
+typedef int sigjmp_buf[_JBLEN + 1];
+
+int setjmp(jmp_buf env);
+void longjmp(jmp_buf env, int val);
+
+#ifndef _ANSI_SOURCE
+int _setjmp(jmp_buf env);
+void _longjmp(jmp_buf, int val);
+int sigsetjmp(sigjmp_buf env, int val);
+void siglongjmp(sigjmp_buf env, int val);
+#endif
+
+#if !defined(_ANSI_SOURCE) && !defined(_POSIX_C_SOURCE)
+void longjmperror(void);
+#endif
+
+#endif
+
diff -urN cctools-806-old/include/foreign/arm/signal.h cctools-806/include/foreign/arm/signal.h
--- cctools-806-old/include/foreign/arm/signal.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/arm/signal.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,73 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ */
+
+#ifndef	_ARM_SIGNAL_
+#define	_ARM_SIGNAL_ 1
+
+#ifndef _ANSI_SOURCE
+typedef int sig_atomic_t; 
+
+#ifndef _POSIX_C_SOURCE
+
+#include <sys/appleapiopts.h>
+
+#ifdef __APPLE_API_OBSOLETE
+
+/*
+ * Information pushed on stack when a signal is delivered.
+ * This is used by the kernel to restore state following
+ * execution of the signal handler.  It is also made available
+ * to the handler to allow it to properly restore state if
+ * a non-standard exit is performed.
+ */
+struct	sigcontext {
+    int			sc_onstack;	/* sigstack state to restore */
+    int			sc_mask;	/* signal mask to restore */
+    unsigned int    sc_r0;
+    unsigned int    sc_r1;
+    unsigned int    sc_r2;
+    unsigned int    sc_r3;
+    unsigned int    sc_r4;
+    unsigned int    sc_r5;
+    unsigned int    sc_r6;
+    unsigned int    sc_r7;
+    unsigned int    sc_r8;
+    unsigned int    sc_r9;
+    unsigned int    sc_r10;
+    unsigned int    sc_r11;
+    unsigned int    sc_r12;
+    unsigned int    sc_r13;
+    unsigned int    sc_r14;
+    unsigned int    sc_r15;
+    unsigned int    sc_r16;
+};
+
+#endif /* __APPLE_API_OBSOLETE */
+#endif /* ! _POSIX_C_SOURCE */
+#endif /* ! _ANSI_SOURCE */
+
+#endif	/* _ARM_SIGNAL_ */
+
diff -urN cctools-806-old/include/foreign/arm/_types.h cctools-806/include/foreign/arm/_types.h
--- cctools-806-old/include/foreign/arm/_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/arm/_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,116 @@
+/*
+ * Copyright (c) 2000-2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+#ifndef	_BSD_ARM__TYPES_H_
+#define	_BSD_ARM__TYPES_H_
+
+/*
+ * This header file contains integer types.  It's intended to also contain
+ * flotaing point and other arithmetic types, as needed, later.
+ */
+
+#ifdef __GNUC__
+typedef __signed char		__int8_t;
+#else	/* !__GNUC__ */
+typedef char			__int8_t;
+#endif	/* !__GNUC__ */
+typedef unsigned char		__uint8_t;
+typedef	short			__int16_t;
+typedef	unsigned short		__uint16_t;
+typedef int			__int32_t;
+typedef unsigned int		__uint32_t;
+typedef long long		__int64_t;
+typedef unsigned long long	__uint64_t;
+
+typedef long			__darwin_intptr_t;
+typedef unsigned int		__darwin_natural_t;
+
+/*
+ * The rune type below is declared to be an ``int'' instead of the more natural
+ * ``unsigned long'' or ``long''.  Two things are happening here.  It is not
+ * unsigned so that EOF (-1) can be naturally assigned to it and used.  Also,
+ * it looks like 10646 will be a 31 bit standard.  This means that if your
+ * ints cannot hold 32 bits, you will be in trouble.  The reason an int was
+ * chosen over a long is that the is*() and to*() routines take ints (says
+ * ANSI C), but they use __darwin_ct_rune_t instead of int.  By changing it
+ * here, you lose a bit of ANSI conformance, but your programs will still
+ * work.
+ *
+ * NOTE: rune_t is not covered by ANSI nor other standards, and should not
+ * be instantiated outside of lib/libc/locale.  Use wchar_t.  wchar_t and
+ * rune_t must be the same type.  Also wint_t must be no narrower than
+ * wchar_t, and should also be able to hold all members of the largest
+ * character set plus one extra value (WEOF). wint_t must be at least 16 bits.
+ */
+
+typedef int			__darwin_ct_rune_t;	/* ct_rune_t */
+
+/*
+ * mbstate_t is an opaque object to keep conversion state, during multibyte
+ * stream conversions.  The content must not be referenced by user programs.
+ */
+#ifdef __APPLE__
+typedef union {
+	char		__mbstate8[128];
+	long long	_mbstateL;			/* for alignment */
+} __mbstate_t;
+#endif
+
+typedef __mbstate_t		__darwin_mbstate_t;	/* mbstate_t */
+
+#if defined(__GNUC__) && defined(__PTRDIFF_TYPE__)
+typedef __PTRDIFF_TYPE__	__darwin_ptrdiff_t;	/* ptr1 - ptr2 */
+#else
+typedef int			__darwin_ptrdiff_t;	/* ptr1 - ptr2 */
+#endif /* __GNUC__ */
+
+#if defined(__GNUC__) && defined(__SIZE_TYPE__)
+typedef __SIZE_TYPE__		__darwin_size_t;	/* sizeof() */
+#else
+typedef unsigned long		__darwin_size_t;	/* sizeof() */
+#endif
+
+#if (__GNUC__ > 2)
+typedef __builtin_va_list	__darwin_va_list;	/* va_list */
+#else
+typedef void *			__darwin_va_list;	/* va_list */
+#endif
+
+#if defined(__GNUC__) && defined(__WCHAR_TYPE__)
+typedef __WCHAR_TYPE__		__darwin_wchar_t;	/* wchar_t */
+#else
+typedef __darwin_ct_rune_t	__darwin_wchar_t;	/* wchar_t */
+#endif
+
+typedef __darwin_wchar_t	__darwin_rune_t;	/* rune_t */
+
+#if defined(__GNUC__) && defined(__WINT_TYPE__)
+typedef __WINT_TYPE__		__darwin_wint_t;	/* wint_t */
+#else
+typedef __darwin_ct_rune_t	__darwin_wint_t;	/* wint_t */
+#endif
+
+typedef unsigned long		__darwin_clock_t;	/* clock() */
+typedef __uint32_t		__darwin_socklen_t;	/* socklen_t (duh) */
+typedef long			__darwin_ssize_t;	/* byte count or error */
+typedef long			__darwin_time_t;	/* time() */
+
+#endif	/* _BSD_ARM__TYPES_H_ */
diff -urN cctools-806-old/include/foreign/arm/types.h cctools-806/include/foreign/arm/types.h
--- cctools-806-old/include/foreign/arm/types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/arm/types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,126 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright 1995 NeXT Computer, Inc. All rights reserved.
+ */
+/*-
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)types.h	8.3 (Berkeley) 1/5/94
+ */
+
+#ifndef	_MACHTYPES_H_
+#define	_MACHTYPES_H_
+
+#ifndef __ASSEMBLER__
+#include <arm/_types.h>
+#include <sys/cdefs.h>
+/*
+ * Basic integral types.  Omit the typedef if
+ * not possible for a machine/compiler combination.
+ */
+#ifndef _INT8_T
+#define _INT8_T
+typedef	__signed char		int8_t;
+#endif
+typedef	unsigned char		u_int8_t;
+#ifndef _INT16_T
+#define _INT16_T
+typedef	short			int16_t;
+#endif
+typedef	unsigned short		u_int16_t;
+#ifndef _INT32_T
+#define _INT32_T
+typedef	int			int32_t;
+#endif
+typedef	unsigned int		u_int32_t;
+#ifndef _INT64_T
+#define _INT64_T
+typedef	long long		int64_t;
+#endif
+typedef	unsigned long long	u_int64_t;
+
+#if __LP64__
+typedef int64_t			register_t;
+#else
+typedef int32_t			register_t;
+#endif
+
+#ifndef _INTPTR_T
+#define _INTPTR_T
+typedef __darwin_intptr_t	intptr_t;
+#endif
+#ifndef _UINTPTR_T
+#define _UINTPTR_T
+typedef unsigned long int	uintptr_t;
+#endif
+
+/* These types are used for  reserving the largest possible size. */
+// LP64todo - typedef mach_vm_address_t	user_addr_t;	/* varying length pointers from user space */ 
+// LP64todo - typedef mach_vm_size_t		user_size_t;	/* varying length values from user space (unsigned) */
+typedef u_int64_t		user_addr_t;	
+typedef u_int64_t		user_size_t;	
+typedef int64_t			user_ssize_t;
+typedef int64_t			user_long_t;
+typedef u_int64_t		user_ulong_t;
+typedef int64_t			user_time_t;
+#define USER_ADDR_NULL	((user_addr_t) 0)
+#define CAST_USER_ADDR_T(a_ptr)   ((user_addr_t)((uintptr_t)(a_ptr)))
+
+/* This defines the size of syscall arguments after copying into the kernel: */
+typedef u_int64_t		syscall_arg_t;
+
+#ifndef __offsetof
+#define __offsetof(type, field) ((size_t)(&((type *)0)->field))
+#endif
+
+#endif /* __ASSEMBLER__ */
+#endif	/* _MACHTYPES_H_ */
diff -urN cctools-806-old/include/foreign/AvailabilityMacros.h cctools-806/include/foreign/AvailabilityMacros.h
--- cctools-806-old/include/foreign/AvailabilityMacros.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/AvailabilityMacros.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,555 @@
+/*
+     File:       AvailabilityMacros.h
+ 
+     Copyright:  (c) 2001-2005 by Apple Computer, Inc., all rights reserved.
+
+     More Info:  See TechNote 2064
+
+     Contains:   Autoconfiguration of AVAILABLE_ macros for Mac OS X
+
+                 This header enables a developer to specify build time
+                 constraints on what Mac OS X versions the resulting
+                 application will be run.  There are two bounds a developer
+                 can specify:
+                 
+                      MAC_OS_X_VERSION_MIN_REQUIRED
+                      MAC_OS_X_VERSION_MAX_ALLOWED
+                      
+                The lower bound controls which calls to OS functions will 
+                be weak-importing (allowed to be unresolved at launch time).
+                The upper bound controls which OS functionality, if used,
+                will result in a compiler error because that functionality is
+                not available on on any OS is the specifed range.
+                
+                For example, suppose an application is compiled with:
+                
+                      MAC_OS_X_VERSION_MIN_REQUIRED = MAC_OS_X_VERSION_10_2
+                      MAC_OS_X_VERSION_MAX_ALLOWED  = MAC_OS_X_VERSION_10_3
+                     
+                and an OS header contains:
+                
+                     extern void funcA(void) AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER;
+                     extern void funcB(void) AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2;
+                     extern void funcC(void) AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3;
+                     extern void funcD(void) AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER;
+                     extern void funcE(void) AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER;
+                     extern void funcF(void) AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER;
+                     extern void funcG(void) AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER;
+                     
+                     typedef long TypeA DEPRECATED_IN_MAC_OS_X_VERSION_10_0_AND_LATER;
+                     typedef long TypeB DEPRECATED_IN_MAC_OS_X_VERSION_10_1_AND_LATER;
+                     typedef long TypeC DEPRECATED_IN_MAC_OS_X_VERSION_10_2_AND_LATER;
+                     typedef long TypeD DEPRECATED_IN_MAC_OS_X_VERSION_10_3_AND_LATER;
+                     typedef long TypeE DEPRECATED_IN_MAC_OS_X_VERSION_10_4_AND_LATER;
+
+                Any application code which uses these declarations will get the following:
+                
+                                compile         link          run 
+                                -------         ------        -------
+                     funcA:     normal          normal        normal
+                     funcB:     warning         normal        normal
+                     funcC:     normal          normal        normal
+                     funcD:     normal          normal        normal
+                     funcE:     normal          normal        normal
+                     funcF:     normal          weak          on 10.3 normal, on 10.2 (&funcF == NULL)
+                     funcG:     error           error         n/a
+                     typeA:     warning
+                     typeB:     warning
+                     typeC:     warning
+                     typeD:     normal
+                     typeE:     normal
+                  
+  
+*/
+#ifndef __AVAILABILITYMACROS__
+#define __AVAILABILITYMACROS__
+
+
+/*
+ * Set up standard Mac OS X versions
+ */
+#define MAC_OS_X_VERSION_10_0 1000
+#define MAC_OS_X_VERSION_10_1 1010
+#define MAC_OS_X_VERSION_10_2 1020
+#define MAC_OS_X_VERSION_10_3 1030
+#define MAC_OS_X_VERSION_10_4 1040
+#define MAC_OS_X_VERSION_10_5 1050
+
+
+/* 
+ * If min OS not specified, assume 10.1
+ * Note: gcc driver may set _ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED_ based on MACOSX_DEPLOYMENT_TARGET environment variable
+ */
+#ifndef MAC_OS_X_VERSION_MIN_REQUIRED
+    #ifdef __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__
+        #define MAC_OS_X_VERSION_MIN_REQUIRED __ENVIRONMENT_MAC_OS_X_VERSION_MIN_REQUIRED__
+    #else
+        #if __ppc64__ || __i386__ || __x86_64__
+            #define MAC_OS_X_VERSION_MIN_REQUIRED MAC_OS_X_VERSION_10_4
+        #else
+            #define MAC_OS_X_VERSION_MIN_REQUIRED MAC_OS_X_VERSION_10_1
+        #endif
+    #endif
+#endif
+
+/*
+ * if max OS not specified, assume largerof(10.5, min)
+ */
+#ifndef MAC_OS_X_VERSION_MAX_ALLOWED
+    #if MAC_OS_X_VERSION_MIN_REQUIRED > MAC_OS_X_VERSION_10_5
+        #define MAC_OS_X_VERSION_MAX_ALLOWED MAC_OS_X_VERSION_MIN_REQUIRED
+    #else
+        #define MAC_OS_X_VERSION_MAX_ALLOWED MAC_OS_X_VERSION_10_5
+    #endif
+#endif
+
+/*
+ * Error on bad values
+ */
+#if MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_MIN_REQUIRED
+    #error MAC_OS_X_VERSION_MAX_ALLOWED must be >= MAC_OS_X_VERSION_MIN_REQUIRED
+#endif
+#if MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_0
+    #error MAC_OS_X_VERSION_MIN_REQUIRED must be >= MAC_OS_X_VERSION_10_0
+#endif
+
+/*
+ * only certain compilers support __attribute__((weak_import))
+ */
+#if defined(__GNUC__) && ((__GNUC__ >= 4) || ((__GNUC__ == 3) && (__GNUC_MINOR__ >= 1))) && (MAC_OS_X_VERSION_MIN_REQUIRED >= 1020)
+    #define WEAK_IMPORT_ATTRIBUTE __attribute__((weak_import))
+#elif defined(__MWERKS__) && (__MWERKS__ >= 0x3205) && (MAC_OS_X_VERSION_MIN_REQUIRED >= 1020)
+    #define WEAK_IMPORT_ATTRIBUTE __attribute__((weak_import))
+#else
+    #define WEAK_IMPORT_ATTRIBUTE
+#endif
+
+/*
+ * only certain compilers support __attribute__((deprecated))
+ */
+#if defined(__GNUC__) && ((__GNUC__ >= 4) || ((__GNUC__ == 3) && (__GNUC_MINOR__ >= 1)))
+    #define DEPRECATED_ATTRIBUTE __attribute__((deprecated))
+#else
+    #define DEPRECATED_ATTRIBUTE
+#endif
+
+/*
+ * only certain compilers support __attribute__((unavailable))
+ */
+#if defined(__GNUC__) && ((__GNUC__ >= 4) || ((__GNUC__ == 3) && (__GNUC_MINOR__ >= 1)))
+    #define UNAVAILABLE_ATTRIBUTE __attribute__((unavailable))
+#else
+    #define UNAVAILABLE_ATTRIBUTE
+#endif
+
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+ * 
+ * Used on functions introduced in Mac OS X 10.0 
+ */
+#define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED
+ * 
+ * Used on functions introduced in Mac OS X 10.0, 
+ * and deprecated in Mac OS X 10.0
+ */
+#define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_0_AND_LATER
+ * 
+ * Used on types deprecated in Mac OS X 10.0 
+ */
+#define DEPRECATED_IN_MAC_OS_X_VERSION_10_0_AND_LATER     DEPRECATED_ATTRIBUTE
+
+
+
+
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.1 
+ */
+#if MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_1
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_1
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED
+ * 
+ * Used on declarations introduced in Mac OS X 10.1, 
+ * and deprecated in Mac OS X 10.1
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_1
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_1
+ * 
+ * Used on declarations introduced in Mac OS X 10.0, 
+ * but later deprecated in Mac OS X 10.1
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_1
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_1    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_1    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_1_AND_LATER
+ * 
+ * Used on types deprecated in Mac OS X 10.1 
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_1
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_1_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+
+
+
+
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.2 
+ */
+#if MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_2
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_2
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED
+ * 
+ * Used on declarations introduced in Mac OS X 10.2, 
+ * and deprecated in Mac OS X 10.2
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_2
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2
+ * 
+ * Used on declarations introduced in Mac OS X 10.0, 
+ * but later deprecated in Mac OS X 10.2
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_2
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2
+ * 
+ * Used on declarations introduced in Mac OS X 10.1, 
+ * but later deprecated in Mac OS X 10.2
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_2
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_2    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_2_AND_LATER
+ * 
+ * Used on types deprecated in Mac OS X 10.2 
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_2
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_2_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+
+
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.3 
+ */
+#if MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_3
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_3
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED
+ * 
+ * Used on declarations introduced in Mac OS X 10.3, 
+ * and deprecated in Mac OS X 10.3
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_3
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3
+ * 
+ * Used on declarations introduced in Mac OS X 10.0, 
+ * but later deprecated in Mac OS X 10.3
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_3
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3
+ * 
+ * Used on declarations introduced in Mac OS X 10.1, 
+ * but later deprecated in Mac OS X 10.3
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_3
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3
+ * 
+ * Used on declarations introduced in Mac OS X 10.2, 
+ * but later deprecated in Mac OS X 10.3
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_3
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_3    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_3_AND_LATER
+ * 
+ * Used on types deprecated in Mac OS X 10.3 
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_3
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_3_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+
+
+
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.4 
+ */
+#if MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED
+ * 
+ * Used on declarations introduced in Mac OS X 10.4, 
+ * and deprecated in Mac OS X 10.4
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4
+ * 
+ * Used on declarations introduced in Mac OS X 10.0, 
+ * but later deprecated in Mac OS X 10.4
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4
+ * 
+ * Used on declarations introduced in Mac OS X 10.1, 
+ * but later deprecated in Mac OS X 10.4
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4
+ * 
+ * Used on declarations introduced in Mac OS X 10.2, 
+ * but later deprecated in Mac OS X 10.4
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4
+ * 
+ * Used on declarations introduced in Mac OS X 10.3, 
+ * but later deprecated in Mac OS X 10.4
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_4
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_4    AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_4_AND_LATER
+ * 
+ * Used on types deprecated in Mac OS X 10.4 
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_4
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_4_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+
+
+
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER
+ * 
+ * Used on declarations introduced in Mac OS X 10.5 
+ */
+#if MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER     UNAVAILABLE_ATTRIBUTE
+#elif MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER     WEAK_IMPORT_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED
+ * 
+ * Used on declarations introduced in Mac OS X 10.5, 
+ * and deprecated in Mac OS X 10.5
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED    AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5
+ * 
+ * Used on declarations introduced in Mac OS X 10.0, 
+ * but later deprecated in Mac OS X 10.5
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5
+ * 
+ * Used on declarations introduced in Mac OS X 10.1, 
+ * but later deprecated in Mac OS X 10.5
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    AVAILABLE_MAC_OS_X_VERSION_10_1_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5
+ * 
+ * Used on declarations introduced in Mac OS X 10.2, 
+ * but later deprecated in Mac OS X 10.5
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    AVAILABLE_MAC_OS_X_VERSION_10_2_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5
+ * 
+ * Used on declarations introduced in Mac OS X 10.3, 
+ * but later deprecated in Mac OS X 10.5
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    AVAILABLE_MAC_OS_X_VERSION_10_3_AND_LATER
+#endif
+
+/*
+ * AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5
+ * 
+ * Used on declarations introduced in Mac OS X 10.4, 
+ * but later deprecated in Mac OS X 10.5
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    DEPRECATED_ATTRIBUTE
+#else
+    #define AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5    AVAILABLE_MAC_OS_X_VERSION_10_4_AND_LATER
+#endif
+
+/*
+ * DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER
+ * 
+ * Used on types deprecated in Mac OS X 10.5 
+ */
+#if MAC_OS_X_VERSION_MIN_REQUIRED >= MAC_OS_X_VERSION_10_5
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER    DEPRECATED_ATTRIBUTE
+#else
+    #define DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER
+#endif
+
+#endif  /* __AVAILABILITYMACROS__ */
+
+
diff -urN cctools-806-old/include/foreign/libc.h cctools-806/include/foreign/libc.h
--- cctools-806-old/include/foreign/libc.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/libc.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,18 @@
+#ifndef _LIBC_H
+#define _LIBC_H
+
+#include <stdio.h>
+#include <unistd.h>
+#include <string.h>
+#include <stdlib.h>
+#include <time.h>
+#include <stdarg.h>
+#include <string.h>
+
+#include <fcntl.h>
+
+#include <sys/stat.h>
+#include <sys/types.h>
+#include <sys/param.h>
+
+#endif
diff -urN cctools-806-old/include/foreign/libkern/machine/OSByteOrder.h cctools-806/include/foreign/libkern/machine/OSByteOrder.h
--- cctools-806-old/include/foreign/libkern/machine/OSByteOrder.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/libkern/machine/OSByteOrder.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,137 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OS_OSBYTEORDERMACHINE_H
+#define _OS_OSBYTEORDERMACHINE_H
+
+#include <stdint.h>
+
+#if !defined(OS_INLINE)
+# if defined(__STDC_VERSION__) && __STDC_VERSION__ >= 199901L
+#        define OS_INLINE static inline
+# elif defined(__cplusplus)
+#        define OS_INLINE static inline
+# else
+#        define OS_INLINE static __inline__
+# endif
+#endif
+
+/* Generic byte swapping functions. */
+
+OS_INLINE
+uint16_t
+_OSSwapInt16(
+    uint16_t                      data
+)
+{
+    return OSSwapConstInt16(data);
+}
+
+OS_INLINE
+uint32_t
+_OSSwapInt32(
+    uint32_t                      data
+)
+{
+    return OSSwapConstInt32(data);
+}
+
+OS_INLINE
+uint64_t
+_OSSwapInt64(
+    uint64_t                        data
+)
+{
+    return OSSwapConstInt64(data);
+}
+
+/* Functions for byte reversed loads. */
+
+OS_INLINE
+uint16_t
+OSReadSwapInt16(
+    const volatile void               * base,
+    uintptr_t                     byteOffset
+)
+{
+    uint16_t data = *(volatile uint16_t *)((uintptr_t)base + byteOffset);
+    return _OSSwapInt16(data);
+}
+
+OS_INLINE
+uint32_t
+OSReadSwapInt32(
+    const volatile void               * base,
+    uintptr_t                     byteOffset
+)
+{
+    uint32_t data = *(volatile uint32_t *)((uintptr_t)base + byteOffset);
+    return _OSSwapInt32(data);
+}
+
+OS_INLINE
+uint64_t
+OSReadSwapInt64(
+    const volatile void               * base,
+    uintptr_t                     byteOffset
+)
+{
+    uint64_t data = *(volatile uint64_t *)((uintptr_t)base + byteOffset);
+    return _OSSwapInt64(data);
+}
+
+/* Functions for byte reversed stores. */
+
+OS_INLINE
+void
+OSWriteSwapInt16(
+    volatile void               * base,
+    uintptr_t                     byteOffset,
+    uint16_t                      data
+)
+{
+    *(volatile uint16_t *)((uintptr_t)base + byteOffset) = _OSSwapInt16(data);
+}
+
+OS_INLINE
+void
+OSWriteSwapInt32(
+    volatile void               * base,
+    uintptr_t                     byteOffset,
+    uint32_t                      data
+)
+{
+    *(volatile uint32_t *)((uintptr_t)base + byteOffset) = _OSSwapInt32(data);
+}
+
+OS_INLINE
+void
+OSWriteSwapInt64(
+    volatile void               * base,
+    uintptr_t                     byteOffset,
+    uint64_t                      data
+)
+{
+    *(volatile uint64_t *)((uintptr_t)base + byteOffset) = _OSSwapInt64(data);
+}
+
+#endif /* ! _OS_OSBYTEORDERMACHINE_H */
diff -urN cctools-806-old/include/foreign/libkern/OSByteOrder.h cctools-806/include/foreign/libkern/OSByteOrder.h
--- cctools-806-old/include/foreign/libkern/OSByteOrder.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/libkern/OSByteOrder.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,305 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OS_OSBYTEORDER_H
+#define _OS_OSBYTEORDER_H
+
+#include <stdint.h>
+
+/* Macros for swapping constant values in the preprocessing stage. */
+#define OSSwapConstInt16(x) \
+    ((uint16_t)((((uint16_t)(x) & 0xff00) >> 8) | \
+                (((uint16_t)(x) & 0x00ff) << 8)))
+
+#define OSSwapConstInt32(x) \
+    ((uint32_t)((((uint32_t)(x) & 0xff000000) >> 24) | \
+                (((uint32_t)(x) & 0x00ff0000) >>  8) | \
+                (((uint32_t)(x) & 0x0000ff00) <<  8) | \
+                (((uint32_t)(x) & 0x000000ff) << 24)))
+
+#define OSSwapConstInt64(x) \
+    ((uint64_t)((((uint64_t)(x) & 0xff00000000000000ULL) >> 56) | \
+                (((uint64_t)(x) & 0x00ff000000000000ULL) >> 40) | \
+                (((uint64_t)(x) & 0x0000ff0000000000ULL) >> 24) | \
+                (((uint64_t)(x) & 0x000000ff00000000ULL) >>  8) | \
+                (((uint64_t)(x) & 0x00000000ff000000ULL) <<  8) | \
+                (((uint64_t)(x) & 0x0000000000ff0000ULL) << 24) | \
+                (((uint64_t)(x) & 0x000000000000ff00ULL) << 40) | \
+                (((uint64_t)(x) & 0x00000000000000ffULL) << 56)))
+
+#include <libkern/machine/OSByteOrder.h>
+
+#define OSSwapInt16(x) OSSwapConstInt16(x)
+
+#define OSSwapInt32(x) OSSwapConstInt32(x)
+
+#define OSSwapInt64(x) OSSwapConstInt64(x)
+
+enum {
+    OSUnknownByteOrder,
+    OSLittleEndian,
+    OSBigEndian
+};
+
+OS_INLINE
+int32_t
+OSHostByteOrder(void) {
+#if defined(__LITTLE_ENDIAN__)
+    return OSLittleEndian;
+#elif defined(__BIG_ENDIAN__)
+    return OSBigEndian;
+#else
+    return OSUnknownByteOrder;
+#endif
+}
+
+#define OSReadBigInt(x, y)		OSReadBigInt32(x, y)
+#define OSWriteBigInt(x, y, z)		OSWriteBigInt32(x, y, z)
+#define OSSwapBigToHostInt(x)		OSSwapBigToHostInt32(x)
+#define OSSwapHostToBigInt(x)		OSSwapHostToBigInt32(x)
+#define OSReadLittleInt(x, y)		OSReadLittleInt32(x, y)
+#define OSWriteLittleInt(x, y, z)	OSWriteLittleInt32(x, y, z)
+#define OSSwapHostToLittleInt(x)	OSSwapHostToLittleInt32(x)
+#define OSSwapLittleToHostInt(x)	OSSwapLittleToHostInt32(x)
+
+/* Functions for loading native endian values. */
+
+OS_INLINE
+uint16_t
+_OSReadInt16(
+    const volatile void               * base,
+    uintptr_t                     byteOffset
+)
+{
+    return *(volatile uint16_t *)((uintptr_t)base + byteOffset);
+}
+
+OS_INLINE
+uint32_t
+_OSReadInt32(
+    const volatile void               * base,
+    uintptr_t                     byteOffset
+)
+{
+    return *(volatile uint32_t *)((uintptr_t)base + byteOffset);
+}
+
+OS_INLINE
+uint64_t
+_OSReadInt64(
+    const volatile void               * base,
+    uintptr_t                     byteOffset
+)
+{
+    return *(volatile uint64_t *)((uintptr_t)base + byteOffset);
+}
+
+/* Functions for storing native endian values. */
+
+OS_INLINE
+void
+_OSWriteInt16(
+    volatile void               * base,
+    uintptr_t                     byteOffset,
+    uint16_t                      data
+)
+{
+    *(volatile uint16_t *)((uintptr_t)base + byteOffset) = data;
+}
+
+OS_INLINE
+void
+_OSWriteInt32(
+    volatile void               * base,
+    uintptr_t                     byteOffset,
+    uint32_t                      data
+)
+{
+    *(volatile uint32_t *)((uintptr_t)base + byteOffset) = data;
+}
+
+OS_INLINE
+void
+_OSWriteInt64(
+    volatile void               * base,
+    uintptr_t                     byteOffset,
+    uint64_t                      data
+)
+{
+    *(volatile uint64_t *)((uintptr_t)base + byteOffset) = data;
+}
+
+#if		defined(__BIG_ENDIAN__)
+
+/* Functions for loading big endian to host endianess. */
+
+#define OSReadBigInt16(base, byteOffset) _OSReadInt16(base, byteOffset)
+#define OSReadBigInt32(base, byteOffset) _OSReadInt32(base, byteOffset)
+#define OSReadBigInt64(base, byteOffset) _OSReadInt64(base, byteOffset)
+
+/* Functions for storing host endianess to big endian. */
+
+#define OSWriteBigInt16(base, byteOffset, data) _OSWriteInt16(base, byteOffset, data)
+#define OSWriteBigInt32(base, byteOffset, data) _OSWriteInt32(base, byteOffset, data)
+#define OSWriteBigInt64(base, byteOffset, data) _OSWriteInt64(base, byteOffset, data)
+
+/* Functions for loading little endian to host endianess. */
+
+#define OSReadLittleInt16(base, byteOffset) OSReadSwapInt16(base, byteOffset)
+#define OSReadLittleInt32(base, byteOffset) OSReadSwapInt32(base, byteOffset)
+#define OSReadLittleInt64(base, byteOffset) OSReadSwapInt64(base, byteOffset)
+
+/* Functions for storing host endianess to little endian. */
+
+#define OSWriteLittleInt16(base, byteOffset, data) OSWriteSwapInt16(base, byteOffset, data)
+#define OSWriteLittleInt32(base, byteOffset, data) OSWriteSwapInt32(base, byteOffset, data)
+#define OSWriteLittleInt64(base, byteOffset, data) OSWriteSwapInt64(base, byteOffset, data)
+
+/* Host endianess to big endian byte swapping macros for constants. */
+
+#define OSSwapHostToBigConstInt16(x) (x)
+#define OSSwapHostToBigConstInt32(x) (x)
+#define OSSwapHostToBigConstInt64(x) (x)
+
+/* Generic host endianess to big endian byte swapping functions. */
+
+#define OSSwapHostToBigInt16(x) ((uint16_t)(x))
+#define OSSwapHostToBigInt32(x) ((uint32_t)(x))
+#define OSSwapHostToBigInt64(x) ((uint64_t)(x))
+
+/* Host endianess to little endian byte swapping macros for constants. */
+
+#define OSSwapHostToLittleConstInt16(x) OSSwapConstInt16(x)
+#define OSSwapHostToLittleConstInt32(x) OSSwapConstInt32(x) 
+#define OSSwapHostToLittleConstInt64(x) OSSwapConstInt64(x) 
+
+/* Generic host endianess to little endian byte swapping functions. */
+
+#define OSSwapHostToLittleInt16(x) OSSwapInt16(x)
+#define OSSwapHostToLittleInt32(x) OSSwapInt32(x)
+#define OSSwapHostToLittleInt64(x) OSSwapInt64(x)
+
+/* Big endian to host endianess byte swapping macros for constants. */
+    
+#define OSSwapBigToHostConstInt16(x) (x)
+#define OSSwapBigToHostConstInt32(x) (x)
+#define OSSwapBigToHostConstInt64(x) (x)
+
+/* Generic big endian to host endianess byte swapping functions. */
+
+#define OSSwapBigToHostInt16(x) ((uint16_t)(x))
+#define OSSwapBigToHostInt32(x) ((uint32_t)(x))
+#define OSSwapBigToHostInt64(x) ((uint64_t)(x))
+
+/* Little endian to host endianess byte swapping macros for constants. */
+   
+#define OSSwapLittleToHostConstInt16(x) OSSwapConstInt16(x)
+#define OSSwapLittleToHostConstInt32(x) OSSwapConstInt32(x)
+#define OSSwapLittleToHostConstInt64(x) OSSwapConstInt64(x)
+
+/* Generic little endian to host endianess byte swapping functions. */
+
+#define OSSwapLittleToHostInt16(x) OSSwapInt16(x)
+#define OSSwapLittleToHostInt32(x) OSSwapInt32(x)
+#define OSSwapLittleToHostInt64(x) OSSwapInt64(x)
+
+#elif		defined(__LITTLE_ENDIAN__)
+
+/* Functions for loading big endian to host endianess. */
+
+#define OSReadBigInt16(base, byteOffset) OSReadSwapInt16(base, byteOffset)
+#define OSReadBigInt32(base, byteOffset) OSReadSwapInt32(base, byteOffset)
+#define OSReadBigInt64(base, byteOffset) OSReadSwapInt64(base, byteOffset)
+
+/* Functions for storing host endianess to big endian. */
+
+#define OSWriteBigInt16(base, byteOffset, data) OSWriteSwapInt16(base, byteOffset, data)
+#define OSWriteBigInt32(base, byteOffset, data) OSWriteSwapInt32(base, byteOffset, data)
+#define OSWriteBigInt64(base, byteOffset, data) OSWriteSwapInt64(base, byteOffset, data)
+
+/* Functions for loading little endian to host endianess. */
+
+#define OSReadLittleInt16(base, byteOffset) _OSReadInt16(base, byteOffset)
+#define OSReadLittleInt32(base, byteOffset) _OSReadInt32(base, byteOffset)
+#define OSReadLittleInt64(base, byteOffset) _OSReadInt64(base, byteOffset)
+
+/* Functions for storing host endianess to little endian. */
+
+#define OSWriteLittleInt16(base, byteOffset, data) _OSWriteInt16(base, byteOffset, data)
+#define OSWriteLittleInt32(base, byteOffset, data) _OSWriteInt32(base, byteOffset, data)
+#define OSWriteLittleInt64(base, byteOffset, data) _OSWriteInt64(base, byteOffset, data)
+
+/* Host endianess to big endian byte swapping macros for constants. */
+
+#define OSSwapHostToBigConstInt16(x) OSSwapConstInt16(x)
+#define OSSwapHostToBigConstInt32(x) OSSwapConstInt32(x)
+#define OSSwapHostToBigConstInt64(x) OSSwapConstInt64(x)
+
+/* Generic host endianess to big endian byte swapping functions. */
+
+#define OSSwapHostToBigInt16(x) OSSwapInt16(x)
+#define OSSwapHostToBigInt32(x) OSSwapInt32(x)
+#define OSSwapHostToBigInt64(x) OSSwapInt64(x)
+
+/* Host endianess to little endian byte swapping macros for constants. */
+
+#define OSSwapHostToLittleConstInt16(x) (x)
+#define OSSwapHostToLittleConstInt32(x) (x)
+#define OSSwapHostToLittleConstInt64(x) (x) 
+
+/* Generic host endianess to little endian byte swapping functions. */
+
+#define OSSwapHostToLittleInt16(x) ((uint16_t)(x))
+#define OSSwapHostToLittleInt32(x) ((uint32_t)(x))
+#define OSSwapHostToLittleInt64(x) ((uint64_t)(x))
+
+/* Big endian to host endianess byte swapping macros for constants. */
+
+#define OSSwapBigToHostConstInt16(x) OSSwapConstInt16(x)
+#define OSSwapBigToHostConstInt32(x) OSSwapConstInt32(x)
+#define OSSwapBigToHostConstInt64(x) OSSwapConstInt64(x)
+
+/* Generic big endian to host endianess byte swapping functions. */
+
+#define OSSwapBigToHostInt16(x) OSSwapInt16(x)
+#define OSSwapBigToHostInt32(x) OSSwapInt32(x)
+#define OSSwapBigToHostInt64(x) OSSwapInt64(x)
+
+/* Little endian to host endianess byte swapping macros for constants. */
+
+#define OSSwapLittleToHostConstInt16(x) (x)
+#define OSSwapLittleToHostConstInt32(x) (x)
+#define OSSwapLittleToHostConstInt64(x) (x)
+
+/* Generic little endian to host endianess byte swapping functions. */
+
+#define OSSwapLittleToHostInt16(x) ((uint16_t)(x))
+#define OSSwapLittleToHostInt32(x) ((uint32_t)(x))
+#define OSSwapLittleToHostInt64(x) ((uint64_t)(x))
+
+#else
+#error Unknown endianess.
+#endif
+
+#endif /* ! _OS_OSBYTEORDER_H */
+
+
diff -urN cctools-806-old/include/foreign/mach/boolean.h cctools-806/include/foreign/mach/boolean.h
--- cctools-806-old/include/foreign/mach/boolean.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/boolean.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,14 @@
+#ifndef _MACH_BOOLEAN_H_
+#define _MACH_BOOLEAN_H_
+
+#include <mach/machine/boolean.h>
+
+#ifndef TRUE
+#define TRUE    1
+#endif  /* TRUE */
+
+#ifndef FALSE
+#define FALSE   0
+#endif  /* FALSE */
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/error.h cctools-806/include/foreign/mach/error.h
--- cctools-806-old/include/foreign/mach/error.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/error.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,25 @@
+#ifndef _ERROR_H
+#define _ERROR_H
+
+#include <mach/kern_return.h>
+
+#define err_none                (mach_error_t)0
+#define ERR_SUCCESS             (mach_error_t)0
+#define ERR_ROUTINE_NIL         (mach_error_fn_t)0
+
+#define err_system(x)           (((x)&0x3f)<<26)
+#define err_sub(x)              (((x)&0xfff)<<14)
+
+#define err_get_system(err)     (((err)>>26)&0x3f)
+#define err_get_sub(err)        (((err)>>14)&0xfff)
+#define err_get_code(err)       ((err)&0x3fff)
+
+#define system_emask            (err_system(0x3f))
+#define sub_emask               (err_sub(0xfff))
+#define code_emask              (0x3fff)
+
+
+typedef kern_return_t   mach_error_t;
+
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/host_info.h cctools-806/include/foreign/mach/host_info.h
--- cctools-806-old/include/foreign/mach/host_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/host_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,45 @@
+#ifndef _MACH_HOST_INFO_H_
+#define _MACH_HOST_INFO_H_
+
+typedef integer_t       *host_info_t;           /* varying array of int. */
+
+typedef integer_t       host_flavor_t;
+#define HOST_BASIC_INFO         1       /* basic info */
+#define HOST_SCHED_INFO         3       /* scheduling info */
+#define HOST_RESOURCE_SIZES     4       /* kernel struct sizes */
+#define HOST_PRIORITY_INFO      5       /* priority information */
+#define HOST_SEMAPHORE_TRAPS    7       /* Has semaphore traps */
+#define HOST_MACH_MSG_TRAP      8       /* Has mach_msg_trap */
+
+struct host_basic_info {
+  integer_t               max_cpus;               /* max number of CPUs possible */
+  integer_t               avail_cpus;             /* number of CPUs now available */
+  natural_t               memory_size;            /* size of memory in bytes, capped at 2 GB */
+  cpu_type_t              cpu_type;               /* cpu type */
+  cpu_subtype_t           cpu_subtype;            /* cpu subtype */
+  cpu_threadtype_t        cpu_threadtype;         /* cpu threadtype */
+  integer_t               physical_cpu;           /* number of physical CPUs now available */
+  integer_t               physical_cpu_max;       /* max number of physical CPUs possible */
+  integer_t               logical_cpu;            /* number of logical cpu now available */
+  integer_t               logical_cpu_max;        /* max number of physical CPUs possible */
+  uint64_t                max_mem;                /* actual size of physical memory */
+};
+
+typedef struct host_basic_info  host_basic_info_data_t;
+typedef struct host_basic_info  *host_basic_info_t;
+#define HOST_BASIC_INFO_COUNT \
+                (sizeof(host_basic_info_data_t)/sizeof(integer_t))
+
+
+struct host_sched_info {
+  integer_t       min_timeout;    /* minimum timeout in milliseconds */
+  integer_t       min_quantum;    /* minimum quantum in milliseconds */
+};
+
+typedef struct host_sched_info  host_sched_info_data_t;
+typedef struct host_sched_info  *host_sched_info_t;
+#define HOST_SCHED_INFO_COUNT \
+                (sizeof(host_sched_info_data_t)/sizeof(integer_t))
+
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/i386/thread_status.h cctools-806/include/foreign/mach/i386/thread_status.h
--- cctools-806-old/include/foreign/mach/i386/thread_status.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/i386/thread_status.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,73 @@
+#ifndef _MACH_I386_THREAD_STATUS_H_
+#define _MACH_I386_THREAD_STATUS_H_
+
+#include <architecture/i386/frame.h>    /* FIXME */
+#include <architecture/i386/fpu.h>      /* FIXME */
+
+/*     THREAD_STATE_FLAVOR_LIST 0 */
+#define i386_NEW_THREAD_STATE   1       /* used to be i386_THREAD_STATE */
+#define i386_FLOAT_STATE        2
+#define i386_ISA_PORT_MAP_STATE 3
+#define i386_V86_ASSIST_STATE   4
+#define i386_REGS_SEGS_STATE    5
+#define THREAD_SYSCALL_STATE    6
+#define THREAD_STATE_NONE       7
+#define i386_SAVED_STATE        8
+
+#define i386_THREAD_STATE       -1
+
+typedef struct {
+  unsigned int        eax;
+  unsigned int        ebx;
+  unsigned int        ecx;
+  unsigned int        edx;
+  unsigned int        edi;
+  unsigned int        esi;
+  unsigned int        ebp;
+  unsigned int        esp;
+  unsigned int        ss;
+  unsigned int        eflags;
+  unsigned int        eip;
+  unsigned int        cs;
+  unsigned int        ds;
+  unsigned int        es;
+  unsigned int        fs;
+  unsigned int        gs;
+} i386_thread_state_t;
+
+#define i386_THREAD_STATE_COUNT         \
+    ( sizeof (i386_thread_state_t) / sizeof (int) )
+
+#define i386_THREAD_FPSTATE     -2
+
+typedef struct {
+  fp_env_t            environ;
+  fp_stack_t          stack;
+} i386_thread_fpstate_t;
+
+#define i386_THREAD_FPSTATE_COUNT       \
+    ( sizeof (i386_thread_fpstate_t) / sizeof (int) )
+
+#define i386_THREAD_EXCEPTSTATE -3
+
+typedef struct {
+  unsigned int        trapno;
+  err_code_t          err;
+} i386_thread_exceptstate_t;
+
+#define i386_THREAD_EXCEPTSTATE_COUNT   \
+    ( sizeof (i386_thread_exceptstate_t) / sizeof (int) )
+
+#define i386_THREAD_CTHREADSTATE        -4
+
+typedef struct {
+  unsigned int        self;
+} i386_thread_cthreadstate_t;
+
+#define i386_THREAD_CTHREADSTATE_COUNT  \
+    ( sizeof (i386_thread_cthreadstate_t) / sizeof (int) )
+
+#define USER_CODE_SELECTOR      0x0017
+#define USER_DATA_SELECTOR      0x001f
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/kern_return.h cctools-806/include/foreign/mach/kern_return.h
--- cctools-806-old/include/foreign/mach/kern_return.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/kern_return.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,10 @@
+#ifndef _KERN_RETURN_H_
+#define _KERN_RETURN_H_
+
+#include <stdint.h>
+
+#define KERN_SUCCESS                    0
+
+typedef    int32_t             kern_return_t;
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/mach_error.h cctools-806/include/foreign/mach/mach_error.h
--- cctools-806-old/include/foreign/mach/mach_error.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/mach_error.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,8 @@
+#ifndef _MACH_MACH_ERROR_H_
+#define _MACH_MACH_ERROR_H_
+
+#include <mach/error.h>
+
+char            *mach_error_string(mach_error_t error_value);
+
+#endif 
diff -urN cctools-806-old/include/foreign/mach/mach.h cctools-806/include/foreign/mach/mach.h
--- cctools-806-old/include/foreign/mach/mach.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/mach.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,18 @@
+#ifndef _MACH_H_
+#define _MACH_H_
+
+#include <mach/kern_return.h>
+#include <mach/machine/vm_types.h>
+#include <mach/boolean.h>
+#include <mach/port.h>
+#include <mach/machine.h>
+#include <mach/host_info.h>
+#include <mach/mach_init.h>
+#include <mach/mach_host.h>
+
+#include <mach/mach_traps.h>
+#include <mach/vm_map.h>
+
+#include <string.h>
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/mach_host.h cctools-806/include/foreign/mach/mach_host.h
--- cctools-806-old/include/foreign/mach/mach_host.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/mach_host.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,16 @@
+#ifndef _mach_host_user_
+#define _mach_host_user_
+
+#include <mach/host_info.h>
+#include <mach/mach_types.h>
+
+kern_return_t host_info
+(
+ host_t host,
+ host_flavor_t flavor,
+ host_info_t host_info_out,
+ mach_msg_type_number_t *host_info_outCnt
+ );
+
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/machine/boolean.h cctools-806/include/foreign/mach/machine/boolean.h
--- cctools-806-old/include/foreign/mach/machine/boolean.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/machine/boolean.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,6 @@
+#ifndef _MACH_MACHINE_BOOLEAN_H_
+#define _MACH_MACHINE_BOOLEAN_H_
+
+typedef unsigned int    boolean_t;
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/machine/vm_types.h cctools-806/include/foreign/mach/machine/vm_types.h
--- cctools-806-old/include/foreign/mach/machine/vm_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/machine/vm_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,21 @@
+#ifndef _MACH_MACHINE_VM_TYPES_H_
+#define _MACH_MACHINE_VM_TYPES_H_
+
+#include <stdint.h>
+
+typedef uint32_t        natural_t;
+typedef int32_t         integer_t;
+
+typedef natural_t       vm_offset_t;
+typedef natural_t       vm_size_t;
+
+typedef uint64_t        mach_vm_address_t;
+typedef uint64_t        mach_vm_offset_t;
+typedef uint64_t        mach_vm_size_t;
+
+typedef vm_offset_t             pointer_t;
+typedef vm_offset_t             vm_address_t;
+
+
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/mach_init.h cctools-806/include/foreign/mach/mach_init.h
--- cctools-806-old/include/foreign/mach/mach_init.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/mach_init.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,25 @@
+#ifndef _MACH_INIT_
+#define _MACH_INIT_
+
+#include <mach/mach_types.h>
+
+extern  mach_port_t     mach_task_self_;
+
+extern mach_port_t mach_task_self(void);
+extern mach_port_t mach_host_self(void);
+extern mach_port_t mach_thread_self(void);
+
+#define mach_task_self() mach_task_self_
+
+#define current_task()  mach_task_self()
+
+extern    vm_size_t       vm_page_size;
+
+kern_return_t mach_port_deallocate
+(
+ ipc_space_t task,
+ mach_port_name_t name
+ );
+
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/mach_traps.h cctools-806/include/foreign/mach/mach_traps.h
--- cctools-806-old/include/foreign/mach/mach_traps.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/mach_traps.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,15 @@
+#ifndef _MACH_MACH_TRAPS_H_
+#define _MACH_MACH_TRAPS_H_
+
+#include <mach/machine/vm_types.h>
+#include <mach/boolean.h>
+
+kern_return_t map_fd(
+		     int fd,
+		     vm_offset_t offset,
+		     vm_offset_t *va,
+		     boolean_t findspace,
+		     vm_size_t size);
+
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/mach_types.h cctools-806/include/foreign/mach/mach_types.h
--- cctools-806-old/include/foreign/mach/mach_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/mach_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,11 @@
+#ifndef _MACH_MACH_TYPES_H_
+#define _MACH_MACH_TYPES_H_
+
+#include <mach/port.h>
+
+typedef mach_port_t             host_t;
+typedef natural_t mach_msg_type_number_t;
+typedef mach_port_t                vm_map_t;
+typedef mach_port_t              ipc_space_t;
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/port.h cctools-806/include/foreign/mach/port.h
--- cctools-806-old/include/foreign/mach/port.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/port.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,13 @@
+#ifndef _MACH_PORT_H_
+#define _MACH_PORT_H_
+
+#include <mach/machine/vm_types.h>
+
+typedef natural_t mach_port_name_t;
+typedef mach_port_name_t *mach_port_name_array_t;
+
+typedef mach_port_name_t                mach_port_t;
+typedef mach_port_t                     *mach_port_array_t;
+
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/ppc/thread_status.h cctools-806/include/foreign/mach/ppc/thread_status.h
--- cctools-806-old/include/foreign/mach/ppc/thread_status.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/ppc/thread_status.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,233 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef	_MACH_PPC_THREAD_STATUS_H_
+#define _MACH_PPC_THREAD_STATUS_H_
+
+/*
+ * ppc_thread_state is the structure that is exported to user threads for 
+ * use in status/mutate calls.  This structure should never change.
+ *
+ */
+
+#define PPC_THREAD_STATE        1
+#define PPC_FLOAT_STATE         2
+#define PPC_EXCEPTION_STATE		3
+#define PPC_VECTOR_STATE		4
+#define PPC_THREAD_STATE64		5
+#define PPC_EXCEPTION_STATE64	6
+#define THREAD_STATE_NONE		7
+	       
+/*
+ * VALID_THREAD_STATE_FLAVOR is a platform specific macro that when passed
+ * an exception flavor will return whether that is a defined flavor for
+ * that platform.
+ * The macro must be manually updated to include all of the valid exception
+ * flavors as defined above.
+ */
+#define VALID_THREAD_STATE_FLAVOR(x)       \
+        ((x == PPC_THREAD_STATE)        || \
+         (x == PPC_FLOAT_STATE)         || \
+	 (x == PPC_EXCEPTION_STATE)     	|| \
+         (x == PPC_VECTOR_STATE)        || \
+         (x == PPC_THREAD_STATE64)      || \
+         (x == PPC_EXCEPTION_STATE64)   || \
+         (x == THREAD_STATE_NONE))
+
+typedef struct ppc_thread_state {
+	unsigned int srr0;      /* Instruction address register (PC) */
+	unsigned int srr1;	/* Machine state register (supervisor) */
+	unsigned int r0;
+	unsigned int r1;
+	unsigned int r2;
+	unsigned int r3;
+	unsigned int r4;
+	unsigned int r5;
+	unsigned int r6;
+	unsigned int r7;
+	unsigned int r8;
+	unsigned int r9;
+	unsigned int r10;
+	unsigned int r11;
+	unsigned int r12;
+	unsigned int r13;
+	unsigned int r14;
+	unsigned int r15;
+	unsigned int r16;
+	unsigned int r17;
+	unsigned int r18;
+	unsigned int r19;
+	unsigned int r20;
+	unsigned int r21;
+	unsigned int r22;
+	unsigned int r23;
+	unsigned int r24;
+	unsigned int r25;
+	unsigned int r26;
+	unsigned int r27;
+	unsigned int r28;
+	unsigned int r29;
+	unsigned int r30;
+	unsigned int r31;
+
+	unsigned int cr;        /* Condition register */
+	unsigned int xer;	/* User's integer exception register */
+	unsigned int lr;	/* Link register */
+	unsigned int ctr;	/* Count register */
+	unsigned int mq;	/* MQ register (601 only) */
+
+	unsigned int vrsave;	/* Vector Save Register */
+} ppc_thread_state_t;
+
+#pragma pack(4)							/* Make sure the structure stays as we defined it */
+typedef struct ppc_thread_state64 {
+	unsigned long long srr0;	/* Instruction address register (PC) */
+	unsigned long long srr1;	/* Machine state register (supervisor) */
+	unsigned long long r0;
+	unsigned long long r1;
+	unsigned long long r2;
+	unsigned long long r3;
+	unsigned long long r4;
+	unsigned long long r5;
+	unsigned long long r6;
+	unsigned long long r7;
+	unsigned long long r8;
+	unsigned long long r9;
+	unsigned long long r10;
+	unsigned long long r11;
+	unsigned long long r12;
+	unsigned long long r13;
+	unsigned long long r14;
+	unsigned long long r15;
+	unsigned long long r16;
+	unsigned long long r17;
+	unsigned long long r18;
+	unsigned long long r19;
+	unsigned long long r20;
+	unsigned long long r21;
+	unsigned long long r22;
+	unsigned long long r23;
+	unsigned long long r24;
+	unsigned long long r25;
+	unsigned long long r26;
+	unsigned long long r27;
+	unsigned long long r28;
+	unsigned long long r29;
+	unsigned long long r30;
+	unsigned long long r31;
+
+	unsigned int cr;			/* Condition register */
+	unsigned long long xer;		/* User's integer exception register */
+	unsigned long long lr;		/* Link register */
+	unsigned long long ctr;		/* Count register */
+
+	unsigned int vrsave;		/* Vector Save Register */
+} ppc_thread_state64_t;
+#pragma pack()
+
+/* This structure should be double-word aligned for performance */
+
+typedef struct ppc_float_state {
+	double  fpregs[32];
+
+	unsigned int fpscr_pad; /* fpscr is 64 bits, 32 bits of rubbish */
+	unsigned int fpscr;	/* floating point status register */
+} ppc_float_state_t;
+
+typedef struct ppc_vector_state {
+	unsigned long	save_vr[32][4];
+	unsigned long	save_vscr[4];
+	unsigned int	save_pad5[4];
+	unsigned int	save_vrvalid;			/* VRs that have been saved */
+	unsigned int	save_pad6[7];
+} ppc_vector_state_t;
+
+/*
+ * ppc_exception_state
+ *
+ * This structure corresponds to some additional state of the user
+ * registers as saved in the PCB upon kernel entry. They are only
+ * available if an exception is passed out of the kernel, and even
+ * then not all are guaranteed to be updated.
+ *
+ * Some padding is included in this structure which allows space for
+ * servers to store temporary values if need be, to maintain binary
+ * compatiblity.
+ */
+
+typedef struct ppc_exception_state {
+	unsigned long dar;			/* Fault registers for coredump */
+	unsigned long dsisr;
+	unsigned long exception;	/* number of powerpc exception taken */
+	unsigned long pad0;			/* align to 16 bytes */
+
+	unsigned long pad1[4];		/* space in PCB "just in case" */
+} ppc_exception_state_t;
+
+#pragma pack(4)					/* Make sure the structure stays as we defined it */
+typedef struct ppc_exception_state64 {
+	unsigned long long dar;		/* Fault registers for coredump */
+	unsigned long dsisr;
+	unsigned long exception;	/* number of powerpc exception taken */
+
+	unsigned long pad1[4];		/* space in PCB "just in case" */
+} ppc_exception_state64_t;
+#pragma pack()
+
+/*
+ * Save State Flags
+ */
+
+#define PPC_THREAD_STATE_COUNT \
+   (sizeof(struct ppc_thread_state) / sizeof(int))
+
+#define PPC_THREAD_STATE64_COUNT \
+   (sizeof(struct ppc_thread_state64) / sizeof(int))
+
+#define PPC_EXCEPTION_STATE_COUNT \
+   (sizeof(struct ppc_exception_state) / sizeof(int))
+
+#define PPC_EXCEPTION_STATE64_COUNT \
+   (sizeof(struct ppc_exception_state64) / sizeof(int))
+
+#define PPC_FLOAT_STATE_COUNT \
+   (sizeof(struct ppc_float_state) / sizeof(int))
+
+#define PPC_VECTOR_STATE_COUNT \
+   (sizeof(struct ppc_vector_state) / sizeof(int))
+
+/*
+ * Machine-independent way for servers and Mach's exception mechanism to
+ * choose the most efficient state flavor for exception RPC's:
+ */
+#define MACHINE_THREAD_STATE		PPC_THREAD_STATE
+#define MACHINE_THREAD_STATE_COUNT	PPC_THREAD_STATE_COUNT
+
+/*
+ * Largest state on this machine:
+ */
+#define THREAD_MACHINE_STATE_MAX	THREAD_STATE_MAX
+
+#endif /* _MACH_PPC_THREAD_STATUS_H_ */
diff -urN cctools-806-old/include/foreign/mach/vm_map.h cctools-806/include/foreign/mach/vm_map.h
--- cctools-806-old/include/foreign/mach/vm_map.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/vm_map.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,20 @@
+#ifndef _vm_map_user_
+#define _vm_map_user_
+
+kern_return_t vm_allocate
+(
+ vm_map_t target_task,
+ vm_address_t *address,
+ vm_size_t size,
+        int flags
+ );
+
+kern_return_t vm_deallocate
+(
+ vm_map_t target_task,
+ vm_address_t address,
+        vm_size_t size
+ );
+
+
+#endif
diff -urN cctools-806-old/include/foreign/mach/vm_prot.h cctools-806/include/foreign/mach/vm_prot.h
--- cctools-806-old/include/foreign/mach/vm_prot.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach/vm_prot.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,19 @@
+#ifndef _MACH_VM_PROT_H_
+#define _MACH_VM_PROT_H_
+
+typedef int32_t             vm_prot_t;
+
+#define VM_PROT_NONE    ((vm_prot_t) 0x00)
+
+#define VM_PROT_READ    ((vm_prot_t) 0x01)      /* read permission */
+#define VM_PROT_WRITE   ((vm_prot_t) 0x02)      /* write permission */
+#define VM_PROT_EXECUTE ((vm_prot_t) 0x04)      /* execute permission */
+
+#define VM_PROT_DEFAULT (VM_PROT_READ|VM_PROT_WRITE)
+#define VM_PROT_ALL     (VM_PROT_READ|VM_PROT_WRITE|VM_PROT_EXECUTE)
+#define VM_PROT_NO_CHANGE       ((vm_prot_t) 0x08)
+#define VM_PROT_COPY            ((vm_prot_t) 0x10)
+#define VM_PROT_WANTS_COPY      ((vm_prot_t) 0x10)
+
+
+#endif
diff -urN cctools-806-old/include/foreign/mach_debug/hash_info.h cctools-806/include/foreign/mach_debug/hash_info.h
--- cctools-806-old/include/foreign/mach_debug/hash_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach_debug/hash_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,67 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_MACH_DEBUG_HASH_INFO_H_
+#define _MACH_DEBUG_HASH_INFO_H_
+
+/*
+ *	Remember to update the mig type definitions
+ *	in mach_debug_types.defs when adding/removing fields.
+ */
+
+typedef struct hash_info_bucket {
+	natural_t	hib_count;	/* number of records in bucket */
+} hash_info_bucket_t;
+
+typedef hash_info_bucket_t *hash_info_bucket_array_t;
+
+#endif	/* _MACH_DEBUG_HASH_INFO_H_ */
diff -urN cctools-806-old/include/foreign/mach_debug/ipc_info.h cctools-806/include/foreign/mach_debug/ipc_info.h
--- cctools-806-old/include/foreign/mach_debug/ipc_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach_debug/ipc_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,104 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach_debug/ipc_info.h
+ *	Author:	Rich Draves
+ *	Date:	March, 1990
+ *
+ *	Definitions for the IPC debugging interface.
+ */
+
+#ifndef	_MACH_DEBUG_IPC_INFO_H_
+#define _MACH_DEBUG_IPC_INFO_H_
+
+#include <mach/boolean.h>
+#include <mach/port.h>
+#include <mach/machine/vm_types.h>
+
+/*
+ *	Remember to update the mig type definitions
+ *	in mach_debug_types.defs when adding/removing fields.
+ */
+
+
+typedef struct ipc_info_space {
+	natural_t iis_genno_mask;	/* generation number mask */
+	natural_t iis_table_size;	/* size of table */
+	natural_t iis_table_next;	/* next possible size of table */
+	natural_t iis_tree_size;	/* size of tree */
+	natural_t iis_tree_small;	/* # of small entries in tree */
+	natural_t iis_tree_hash;	/* # of hashed entries in tree */
+} ipc_info_space_t;
+
+
+typedef struct ipc_info_name {
+	mach_port_name_t iin_name;		/* port name, including gen number */
+/*boolean_t*/integer_t iin_collision;	/* collision at this entry? */
+	mach_port_type_t iin_type;	/* straight port type */
+	mach_port_urefs_t iin_urefs;	/* user-references */
+	natural_t iin_object;		/* object pointer/identifier */
+	natural_t iin_next;		/* marequest/next in free list */
+	natural_t iin_hash;		/* hash index */
+} ipc_info_name_t;
+
+typedef ipc_info_name_t *ipc_info_name_array_t;
+
+
+typedef struct ipc_info_tree_name {
+	ipc_info_name_t iitn_name;
+	mach_port_name_t iitn_lchild;	/* name of left child */
+	mach_port_name_t iitn_rchild;	/* name of right child */
+} ipc_info_tree_name_t;
+
+typedef ipc_info_tree_name_t *ipc_info_tree_name_array_t;
+
+#endif	/* _MACH_DEBUG_IPC_INFO_H_ */
diff -urN cctools-806-old/include/foreign/mach_debug/lockgroup_info.h cctools-806/include/foreign/mach_debug/lockgroup_info.h
--- cctools-806-old/include/foreign/mach_debug/lockgroup_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach_debug/lockgroup_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,69 @@
+/*
+ * Copyright (c) 2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ *	File:	mach/lockgroup_info.h
+ *
+ *	Definitions for host_lockgroup_info call.
+ */
+
+#ifndef	_MACH_DEBUG_LOCKGROUP_INFO_H_
+#define	_MACH_DEBUG_LOCKGROUP_INFO_H_
+
+#include <mach/mach_types.h>
+
+#define LOCKGROUP_MAX_NAME	64
+
+#define LOCKGROUP_ATTR_STAT	0x01ULL
+
+typedef struct lockgroup_info {
+	char		lockgroup_name[LOCKGROUP_MAX_NAME];
+	uint64_t	lockgroup_attr;
+	uint64_t	lock_spin_cnt;
+	uint64_t	lock_spin_util_cnt;
+	uint64_t	lock_spin_held_cnt;
+	uint64_t	lock_spin_miss_cnt;
+	uint64_t	lock_spin_held_max;
+	uint64_t	lock_spin_held_cum;
+	uint64_t	lock_mtx_cnt;
+	uint64_t	lock_mtx_util_cnt;
+	uint64_t	lock_mtx_held_cnt;
+	uint64_t	lock_mtx_miss_cnt;
+	uint64_t	lock_mtx_wait_cnt;
+	uint64_t	lock_mtx_held_max;
+	uint64_t	lock_mtx_held_cum;
+	uint64_t	lock_mtx_wait_max;
+	uint64_t	lock_mtx_wait_cum;
+	uint64_t	lock_rw_cnt;
+	uint64_t	lock_rw_util_cnt;
+	uint64_t	lock_rw_held_cnt;
+	uint64_t	lock_rw_miss_cnt;
+	uint64_t	lock_rw_wait_cnt;
+	uint64_t	lock_rw_held_max;
+	uint64_t	lock_rw_held_cum;
+	uint64_t	lock_rw_wait_max;
+	uint64_t	lock_rw_wait_cum;
+} lockgroup_info_t;
+
+typedef lockgroup_info_t *lockgroup_info_array_t;
+
+#endif	/* _MACH_DEBUG_LOCKGROUP_INFO_H_ */
+
diff -urN cctools-806-old/include/foreign/mach_debug/mach_debug.h cctools-806/include/foreign/mach_debug/mach_debug.h
--- cctools-806-old/include/foreign/mach_debug/mach_debug.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach_debug/mach_debug.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,44 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (C) Apple Computer 1998
+ * ALL Rights Reserved
+ */
+/*
+ * This file represents the interfaces that used to come
+ * from creating the user headers from the mach_debug.defs file.
+ * Because mach_debug.defs was decomposed, this file now just
+ * wraps up all the new interface headers generated from
+ * each of the new .defs resulting from that decomposition.
+ */
+#ifndef	_MACH_DEBUG_MACH_DEBUG_H_
+#define _MACH_DEBUG_MACH_DEBUG_H_
+
+#include <mach_debug/mach_debug_types.h>
+
+#include <mach/mach_host.h>
+#include <mach/mach_port.h>
+#include <mach/mach_interface.h>
+
+#endif /* _MACH_DEBUG_MACH_DEBUG_H_ */
+
+
diff -urN cctools-806-old/include/foreign/mach_debug/mach_debug_types.defs cctools-806/include/foreign/mach_debug/mach_debug_types.defs
--- cctools-806-old/include/foreign/mach_debug/mach_debug_types.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach_debug/mach_debug_types.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,94 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	Mach kernel debugging interface type declarations
+ */
+
+#ifndef	_MACH_DEBUG_MACH_DEBUG_TYPES_DEFS_
+#define _MACH_DEBUG_MACH_DEBUG_TYPES_DEFS_
+
+#include <mach/std_types.defs>
+
+type zone_name_t = struct[80] of char;
+type zone_name_array_t = array[] of zone_name_t;
+
+type zone_info_t = struct[9] of integer_t;
+type zone_info_array_t = array[] of zone_info_t;
+
+type hash_info_bucket_t = struct[1] of natural_t;
+type hash_info_bucket_array_t = array[] of hash_info_bucket_t;
+
+type ipc_info_space_t = struct[6] of natural_t;
+
+type ipc_info_name_t = struct[7] of natural_t;
+type ipc_info_name_array_t = array[] of ipc_info_name_t;
+
+type ipc_info_tree_name_t = struct[9] of natural_t;
+type ipc_info_tree_name_array_t = array[] of ipc_info_tree_name_t;
+
+type vm_info_region_t = struct[10] of natural_t;
+type vm_info_region_64_t = struct[11] of natural_t;
+type mach_vm_info_region_t = struct[14] of natural_t;
+
+type vm_info_object_t = struct[21] of natural_t;
+type vm_info_object_array_t = ^array[] of vm_info_object_t;
+
+type page_address_array_t = ^array[] of integer_t;
+
+type symtab_name_t = c_string[*:32];
+
+type lockgroup_info_t = struct[63] of integer_t;
+type lockgroup_info_array_t = array[] of lockgroup_info_t;
+
+import <mach_debug/mach_debug_types.h>;
+
+#endif	/* _MACH_DEBUG_MACH_DEBUG_TYPES_DEFS_ */
diff -urN cctools-806-old/include/foreign/mach_debug/mach_debug_types.h cctools-806/include/foreign/mach_debug/mach_debug_types.h
--- cctools-806-old/include/foreign/mach_debug/mach_debug_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach_debug/mach_debug_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,68 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	Mach kernel debugging interface type declarations
+ */
+
+#ifndef	_MACH_DEBUG_MACH_DEBUG_TYPES_H_
+#define _MACH_DEBUG_MACH_DEBUG_TYPES_H_
+
+#include <mach_debug/ipc_info.h>
+#include <mach_debug/vm_info.h>
+#include <mach_debug/zone_info.h>
+#include <mach_debug/page_info.h>
+#include <mach_debug/hash_info.h>
+#include <mach_debug/lockgroup_info.h>
+
+typedef	char	symtab_name_t[32];
+
+#endif	/* _MACH_DEBUG_MACH_DEBUG_TYPES_H_ */
diff -urN cctools-806-old/include/foreign/mach_debug/page_info.h cctools-806/include/foreign/mach_debug/page_info.h
--- cctools-806-old/include/foreign/mach_debug/page_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach_debug/page_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,58 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+#ifndef MACH_DEBUG_PAGE_INFO_H 
+#define MACH_DEBUG_PAGE_INFO_H 
+
+#include <mach/machine/vm_types.h>
+
+typedef	vm_offset_t	*page_address_array_t;
+#endif	/* MACH_DEBUG_PAGE_INFO_H */
diff -urN cctools-806-old/include/foreign/mach_debug/vm_info.h cctools-806/include/foreign/mach_debug/vm_info.h
--- cctools-806-old/include/foreign/mach_debug/vm_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach_debug/vm_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,145 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach_debug/vm_info.h
+ *	Author:	Rich Draves
+ *	Date:	March, 1990
+ *
+ *	Definitions for the VM debugging interface.
+ */
+
+#ifndef	_MACH_DEBUG_VM_INFO_H_
+#define _MACH_DEBUG_VM_INFO_H_
+
+#include <mach/boolean.h>
+#include <mach/machine/vm_types.h>
+#include <mach/vm_inherit.h>
+#include <mach/vm_prot.h>
+#include <mach/memory_object_types.h>
+
+#pragma pack(4)
+
+/*
+ *	Remember to update the mig type definitions
+ *	in mach_debug_types.defs when adding/removing fields.
+ */
+typedef struct mach_vm_info_region {
+	mach_vm_offset_t vir_start;	/* start of region */
+	mach_vm_offset_t vir_end;	/* end of region */
+	mach_vm_offset_t vir_object;	/* the mapped object(kernal addr) */
+	memory_object_offset_t vir_offset;	/* offset into object */
+	boolean_t vir_needs_copy;	/* does object need to be copied? */
+	vm_prot_t vir_protection;	/* protection code */
+	vm_prot_t vir_max_protection;	/* maximum protection */
+	vm_inherit_t vir_inheritance;	/* inheritance */
+	natural_t vir_wired_count;	/* number of times wired */
+	natural_t vir_user_wired_count; /* number of times user has wired */
+} mach_vm_info_region_t;
+
+typedef struct vm_info_region_64 {
+	natural_t vir_start;		/* start of region */
+	natural_t vir_end;		/* end of region */
+	natural_t vir_object;		/* the mapped object */
+	memory_object_offset_t vir_offset;	/* offset into object */
+	boolean_t vir_needs_copy;	/* does object need to be copied? */
+	vm_prot_t vir_protection;	/* protection code */
+	vm_prot_t vir_max_protection;	/* maximum protection */
+	vm_inherit_t vir_inheritance;	/* inheritance */
+	natural_t vir_wired_count;	/* number of times wired */
+	natural_t vir_user_wired_count; /* number of times user has wired */
+} vm_info_region_64_t;
+
+typedef struct vm_info_region {
+	natural_t vir_start;		/* start of region */
+	natural_t vir_end;		/* end of region */
+	natural_t vir_object;		/* the mapped object */
+	natural_t vir_offset;		/* offset into object */
+	boolean_t vir_needs_copy;	/* does object need to be copied? */
+	vm_prot_t vir_protection;	/* protection code */
+	vm_prot_t vir_max_protection;	/* maximum protection */
+	vm_inherit_t vir_inheritance;	/* inheritance */
+	natural_t vir_wired_count;	/* number of times wired */
+	natural_t vir_user_wired_count; /* number of times user has wired */
+} vm_info_region_t;
+
+
+typedef struct vm_info_object {
+	natural_t vio_object;		/* this object */
+	natural_t vio_size;		/* object size (valid if internal - but too small) */
+	unsigned int vio_ref_count;	/* number of references */
+	unsigned int vio_resident_page_count; /* number of resident pages */
+	unsigned int vio_absent_count;	/* number requested but not filled */
+	natural_t vio_copy;		/* copy object */
+	natural_t vio_shadow;		/* shadow object */
+	natural_t vio_shadow_offset;	/* offset into shadow object */
+	natural_t vio_paging_offset;	/* offset into memory object */
+	memory_object_copy_strategy_t vio_copy_strategy;
+					/* how to handle data copy */
+	vm_offset_t vio_last_alloc;	/* offset of last allocation */
+	/* many random attributes */
+	unsigned int vio_paging_in_progress;
+	boolean_t vio_pager_created;
+	boolean_t vio_pager_initialized;
+	boolean_t vio_pager_ready;
+	boolean_t vio_can_persist;
+	boolean_t vio_internal;
+	boolean_t vio_temporary;
+	boolean_t vio_alive;
+	boolean_t vio_purgable;
+	boolean_t vio_purgable_volatile;
+} vm_info_object_t;
+
+typedef vm_info_object_t *vm_info_object_array_t;
+
+#pragma pack()
+
+#endif	/* _MACH_DEBUG_VM_INFO_H_ */
diff -urN cctools-806-old/include/foreign/mach_debug/zone_info.h cctools-806/include/foreign/mach_debug/zone_info.h
--- cctools-806-old/include/foreign/mach_debug/zone_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/mach_debug/zone_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,87 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_MACH_DEBUG_ZONE_INFO_H_
+#define _MACH_DEBUG_ZONE_INFO_H_
+
+#include <mach/boolean.h>
+#include <mach/machine/vm_types.h>
+
+/*
+ *	Remember to update the mig type definitions
+ *	in mach_debug_types.defs when adding/removing fields.
+ */
+
+#define ZONE_NAME_MAX_LEN		80
+
+typedef struct zone_name {
+	char		zn_name[ZONE_NAME_MAX_LEN];
+} zone_name_t;
+
+typedef zone_name_t *zone_name_array_t;
+
+
+typedef struct zone_info {
+	integer_t	zi_count;	/* Number of elements used now */
+	natural_t	zi_cur_size;	/* current memory utilization */
+	natural_t	zi_max_size;	/* how large can this zone grow */
+	natural_t	zi_elem_size;	/* size of an element */
+	natural_t	zi_alloc_size;	/* size used for more memory */
+	integer_t	zi_pageable;	/* zone pageable? */
+	integer_t	zi_sleepable;	/* sleep if empty? */
+	integer_t	zi_exhaustible;	/* merely return if empty? */
+	integer_t	zi_collectable;	/* garbage collect elements? */
+} zone_info_t;
+
+typedef zone_info_t *zone_info_array_t;
+
+#endif	/* _MACH_DEBUG_ZONE_INFO_H_ */
diff -urN cctools-806-old/include/foreign/machine/endian.h cctools-806/include/foreign/machine/endian.h
--- cctools-806-old/include/foreign/machine/endian.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/machine/endian.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright 1995 NeXT Computer, Inc. All rights reserved.
+ */
+#ifndef _BSD_MACHINE_ENDIAN_H_
+#define _BSD_MACHINE_ENDIAN_H_
+
+
+#if defined (__ppc__) || defined(__ppc64__)
+#include "ppc/endian.h"
+#elif defined (__i386__) || defined(__x86_64__)
+#include "i386/endian.h"
+#elif defined(__arm__)
+#include "arm/endian.h"
+#else
+#error architecture not supported
+#endif
+
+
+#endif /* _BSD_MACHINE_ENDIAN_H_ */
diff -urN cctools-806-old/include/foreign/objc/error.h cctools-806/include/foreign/objc/error.h
--- cctools-806-old/include/foreign/objc/error.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/error.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,142 @@
+/*
+ * Copyright (c) 1999-2003, 2007 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+/*
+    error.h
+
+    This file defines the interface to the exception raising scheme.
+
+    Copyright (c) 1988-1996 NeXT Software, Inc. as an unpublished work.
+    All rights reserved.
+*/
+
+#if defined(__LP64__)
+
+// This header contains definitions for Libstreams, which will never be 64-bit.
+#warning objc/error.h is unavailable in 64-bit.
+
+#endif
+
+#warning The API in this header is obsoleted by NSException et al.
+
+#ifndef _OBJC_ERROR_H_
+#define _OBJC_ERROR_H_
+
+#include <setjmp.h>
+#import <objc/objc-api.h>
+
+
+typedef struct _NXHandler {	/* a node in the handler chain */
+    jmp_buf jumpState;			/* place to longjmp to */
+    struct _NXHandler *next;		/* ptr to next handler */
+    int code;				/* error code of exception */
+    const void *data1, *data2;		/* blind data for describing error */
+} NXHandler;
+
+
+/* Handles RAISE's with nowhere to longjmp to */
+typedef void NXUncaughtExceptionHandler(int code, const void *data1,
+						const void *data2);
+OBJC_EXPORT NXUncaughtExceptionHandler *_NXUncaughtExceptionHandler;
+#define NXGetUncaughtExceptionHandler() _NXUncaughtExceptionHandler
+#define NXSetUncaughtExceptionHandler(proc) \
+			(_NXUncaughtExceptionHandler = (proc))
+
+/* NX_DURING, NX_HANDLER and NX_ENDHANDLER are always used like:
+
+	NX_DURING
+	    some code which might raise an error
+	NX_HANDLER
+	    code that will be jumped to if an error occurs
+	NX_ENDHANDLER
+
+   If any error is raised within the first block of code, the second block
+   of code will be jumped to.  Typically, this code will clean up any
+   resources allocated in the routine, possibly case on the error code
+   and perform special processing, and default to RERAISE the error to
+   the next handler.  Within the scope of the handler, a local variable
+   called NXLocalHandler of type NXHandler holds information about the
+   error raised.
+
+   It is illegal to exit the first block of code by any other means than
+   NX_VALRETURN, NX_VOIDRETURN, or just falling out the bottom.
+ */
+
+/* private support routines.  Do not call directly. */
+OBJC_EXPORT void _NXAddHandler( NXHandler *handler );
+OBJC_EXPORT void _NXRemoveHandler( NXHandler *handler );
+
+#define NX_DURING { NXHandler NXLocalHandler;			\
+		    _NXAddHandler(&NXLocalHandler);		\
+		    if( !_setjmp(NXLocalHandler.jumpState) ) {
+
+#define NX_HANDLER _NXRemoveHandler(&NXLocalHandler); } else {
+
+#define NX_ENDHANDLER }}
+
+#define NX_VALRETURN(val)  do { typeof(val) temp = (val);	\
+			_NXRemoveHandler(&NXLocalHandler);	\
+			return(temp); } while (0)
+
+#define NX_VOIDRETURN	do { _NXRemoveHandler(&NXLocalHandler);	\
+			return; } while (0)
+
+/* RAISE and RERAISE are called to indicate an error condition.  They
+   initiate the process of jumping up the chain of handlers.
+ */
+
+OBJC_EXPORT
+#if defined(__GNUC__) && !defined(__STRICT_ANSI__)
+    volatile	/* never returns */
+#endif 
+void _NXRaiseError(int code, const void *data1, const void *data2)
+#if defined(__GNUC__)
+  __attribute__ ((noreturn))
+#endif
+;
+
+#define NX_RAISE( code, data1, data2 )	\
+		_NXRaiseError( (code), (data1), (data2) )
+
+#define NX_RERAISE() 	_NXRaiseError( NXLocalHandler.code,	\
+				NXLocalHandler.data1, NXLocalHandler.data2 )
+
+/* These routines set and return the procedure which is called when
+   exceptions are raised.  This procedure must NEVER return.  It will
+   usually either longjmp, or call the uncaught exception handler.
+   The default exception raiser is also declared
+ */
+typedef volatile void NXExceptionRaiser(int code, const void *data1, const void *data2);
+OBJC_EXPORT void NXSetExceptionRaiser(NXExceptionRaiser *proc);
+OBJC_EXPORT NXExceptionRaiser *NXGetExceptionRaiser(void);
+OBJC_EXPORT NXExceptionRaiser NXDefaultExceptionRaiser;
+
+
+/* The error buffer is used to allocate data which is passed up to other
+   handlers.  Clients should clear the error buffer in their top level
+   handler.  The Application Kit does this.
+ */
+OBJC_EXPORT void NXAllocErrorData(int size, void **data);
+OBJC_EXPORT void NXResetErrorData(void);
+
+#endif /* _OBJC_ERROR_H_ */
diff -urN cctools-806-old/include/foreign/objc/hashtable2.h cctools-806/include/foreign/objc/hashtable2.h
--- cctools-806-old/include/foreign/objc/hashtable2.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/hashtable2.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,215 @@
+/*
+ * Copyright (c) 1999-2006 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+    hashtable2.h
+    Scalable hash table.
+    Copyright 1989-1996 NeXT Software, Inc.
+*/
+
+#ifndef _OBJC_LITTLE_HASHTABLE_H_
+#define _OBJC_LITTLE_HASHTABLE_H_
+
+#ifndef _OBJC_PRIVATE_H_
+#warning The API in this header is obsoleted by NSHashtable.h
+#endif
+
+#import <objc/objc.h>
+#include <stdint.h>
+
+/*************************************************************************
+ *	Hash tables of arbitrary data
+ *************************************************************************/
+
+/* This module allows hashing of arbitrary data.  Such data must be pointers or integers, and client is responsible for allocating/deallocating this data.  A deallocation call-back is provided.
+The objective C class HashTable is preferred when dealing with (key, values) associations because it is easier to use in that situation.
+As well-behaved scalable data structures, hash tables double in size when they start becoming full, thus guaranteeing both average constant time access and linear size. */
+
+typedef struct {
+    uintptr_t	(*hash)(const void *info, const void *data);
+    int		(*isEqual)(const void *info, const void *data1, const void *data2);
+    void	(*free)(const void *info, void *data);
+    int		style; /* reserved for future expansion; currently 0 */
+    } NXHashTablePrototype;
+    
+/* the info argument allows a certain generality, such as freeing according to some owner information */
+/* invariants assumed by the implementation: 
+	1 - data1 = data2 => hash(data1) = hash(data2)
+	    when data varies over time, hash(data) must remain invariant
+		    e.g. if data hashes over a string key, the string must not be changed
+	2- isEqual (data1, data2) => data1= data2
+ */
+
+typedef struct {
+    const NXHashTablePrototype	*prototype;
+    unsigned			count;
+    unsigned			nbBuckets;
+    void			*buckets;
+    const void			*info;
+   } NXHashTable;
+    /* private data structure; may change */
+    
+OBJC_EXPORT NXHashTable *NXCreateHashTableFromZone (NXHashTablePrototype prototype, unsigned capacity, const void *info, void *z);
+OBJC_EXPORT NXHashTable *NXCreateHashTable (NXHashTablePrototype prototype, unsigned capacity, const void *info);
+    /* if hash is 0, pointer hash is assumed */
+    /* if isEqual is 0, pointer equality is assumed */
+    /* if free is 0, elements are not freed */
+    /* capacity is only a hint; 0 creates a small table */
+    /* info allows call backs to be very general */
+
+OBJC_EXPORT void NXFreeHashTable (NXHashTable *table);
+    /* calls free for each data, and recovers table */
+	
+OBJC_EXPORT void NXEmptyHashTable (NXHashTable *table);
+    /* does not deallocate table nor data; keeps current capacity */
+
+OBJC_EXPORT void NXResetHashTable (NXHashTable *table);
+    /* frees each entry; keeps current capacity */
+
+OBJC_EXPORT BOOL NXCompareHashTables (NXHashTable *table1, NXHashTable *table2);
+    /* Returns YES if the two sets are equal (each member of table1 in table2, and table have same size) */
+
+OBJC_EXPORT NXHashTable *NXCopyHashTable (NXHashTable *table);
+    /* makes a fresh table, copying data pointers, not data itself.  */
+	
+OBJC_EXPORT unsigned NXCountHashTable (NXHashTable *table);
+    /* current number of data in table */
+	
+OBJC_EXPORT int NXHashMember (NXHashTable *table, const void *data);
+    /* returns non-0 iff data is present in table.
+    Example of use when the hashed data is a struct containing the key,
+    and when the callee only has a key:
+	MyStruct	pseudo;
+	pseudo.key = myKey;
+	return NXHashMember (myTable, &pseudo)
+    */
+	
+OBJC_EXPORT void *NXHashGet (NXHashTable *table, const void *data);
+    /* return original table data or NULL.
+    Example of use when the hashed data is a struct containing the key,
+    and when the callee only has a key:
+	MyStruct	pseudo;
+	MyStruct	*original;
+	pseudo.key = myKey;
+	original = NXHashGet (myTable, &pseudo)
+    */
+	
+OBJC_EXPORT void *NXHashInsert (NXHashTable *table, const void *data);
+    /* previous data or NULL is returned. */
+	
+OBJC_EXPORT void *NXHashInsertIfAbsent (NXHashTable *table, const void *data);
+    /* If data already in table, returns the one in table
+    else adds argument to table and returns argument. */
+
+OBJC_EXPORT void *NXHashRemove (NXHashTable *table, const void *data);
+    /* previous data or NULL is returned */
+	
+/* Iteration over all elements of a table consists in setting up an iteration state and then to progress until all entries have been visited.  An example of use for counting elements in a table is:
+    unsigned	count = 0;
+    MyData	*data;
+    NXHashState	state = NXInitHashState(table);
+    while (NXNextHashState(table, &state, &data)) {
+	count++;
+    }
+*/
+
+typedef struct {int i; int j;} NXHashState;
+    /* callers should not rely on actual contents of the struct */
+
+OBJC_EXPORT NXHashState NXInitHashState(NXHashTable *table);
+
+OBJC_EXPORT int NXNextHashState(NXHashTable *table, NXHashState *state, void **data);
+    /* returns 0 when all elements have been visited */
+
+/*************************************************************************
+ *	Conveniences for writing hash, isEqual and free functions
+ *	and common prototypes
+ *************************************************************************/
+
+OBJC_EXPORT uintptr_t NXPtrHash(const void *info, const void *data);
+    /* scrambles the address bits; info unused */
+OBJC_EXPORT uintptr_t NXStrHash(const void *info, const void *data);
+    /* string hashing; info unused */
+OBJC_EXPORT int NXPtrIsEqual(const void *info, const void *data1, const void *data2);
+    /* pointer comparison; info unused */
+OBJC_EXPORT int NXStrIsEqual(const void *info, const void *data1, const void *data2);
+    /* string comparison; NULL ok; info unused */
+OBJC_EXPORT void NXNoEffectFree(const void *info, void *data);
+    /* no effect; info unused */
+OBJC_EXPORT void NXReallyFree(const void *info, void *data);
+    /* frees it; info unused */
+
+/* The two following prototypes are useful for manipulating set of pointers or set of strings; For them free is defined as NXNoEffectFree */
+OBJC_EXPORT const NXHashTablePrototype NXPtrPrototype;
+    /* prototype when data is a pointer (void *) */
+OBJC_EXPORT const NXHashTablePrototype NXStrPrototype;
+    /* prototype when data is a string (char *) */
+
+/* following prototypes help describe mappings where the key is the first element of a struct and is either a pointer or a string.
+For example NXStrStructKeyPrototype can be used to hash pointers to Example, where Example is:
+	typedef struct {
+	    char	*key;
+	    int		data1;
+	    ...
+	    } Example
+    
+For the following prototypes, free is defined as NXReallyFree.
+ */
+OBJC_EXPORT const NXHashTablePrototype NXPtrStructKeyPrototype;
+OBJC_EXPORT const NXHashTablePrototype NXStrStructKeyPrototype;
+
+/*************************************************************************
+ *	Unique strings and buffers
+ *************************************************************************/
+
+/* Unique strings allows C users to enjoy the benefits of Lisp's atoms:
+A unique string is a string that is allocated once for all (never de-allocated) and that has only one representant (thus allowing comparison with == instead of strcmp).  A unique string should never be modified (and in fact some memory protection is done to ensure that).  In order to more explicitly insist on the fact that the string has been uniqued, a synonym of (const char *) has been added, NXAtom. */
+
+typedef const char *NXAtom;
+
+OBJC_EXPORT NXAtom NXUniqueString(const char *buffer);
+    /* assumes that buffer is \0 terminated, and returns
+     a previously created string or a new string that is a copy of buffer.
+    If NULL is passed returns NULL.
+    Returned string should never be modified.  To ensure this invariant,
+    allocations are made in a special read only zone. */
+	
+OBJC_EXPORT NXAtom NXUniqueStringWithLength(const char *buffer, int length);
+    /* assumes that buffer is a non NULL buffer of at least 
+    length characters.  Returns a previously created string or 
+    a new string that is a copy of buffer. 
+    If buffer contains \0, string will be truncated.
+    As for NXUniqueString, returned string should never be modified.  */
+	
+OBJC_EXPORT NXAtom NXUniqueStringNoCopy(const char *string);
+    /* If there is already a unique string equal to string, returns the original.  
+    Otherwise, string is entered in the table, without making a copy.  Argument should then never be modified.  */
+	
+OBJC_EXPORT char *NXCopyStringBuffer(const char *buffer);
+    /* given a buffer, allocates a new string copy of buffer.  
+    Buffer should be \0 terminated; returned string is \0 terminated. */
+
+OBJC_EXPORT char *NXCopyStringBufferFromZone(const char *buffer, void *z);
+    /* given a buffer, allocates a new string copy of buffer.  
+    Buffer should be \0 terminated; returned string is \0 terminated. */
+
+#endif /* _OBJC_LITTLE_HASHTABLE_H_ */
diff -urN cctools-806-old/include/foreign/objc/hashtable.h cctools-806/include/foreign/objc/hashtable.h
--- cctools-806-old/include/foreign/objc/hashtable.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/hashtable.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,215 @@
+/*
+ * Copyright (c) 1999-2006 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+    hashtable2.h
+    Scalable hash table.
+    Copyright 1989-1996 NeXT Software, Inc.
+*/
+
+#ifndef _OBJC_LITTLE_HASHTABLE_H_
+#define _OBJC_LITTLE_HASHTABLE_H_
+
+#ifndef _OBJC_PRIVATE_H_
+#warning The API in this header is obsoleted by NSHashtable.h
+#endif
+
+#import <objc/objc.h>
+#include <stdint.h>
+
+/*************************************************************************
+ *	Hash tables of arbitrary data
+ *************************************************************************/
+
+/* This module allows hashing of arbitrary data.  Such data must be pointers or integers, and client is responsible for allocating/deallocating this data.  A deallocation call-back is provided.
+The objective C class HashTable is preferred when dealing with (key, values) associations because it is easier to use in that situation.
+As well-behaved scalable data structures, hash tables double in size when they start becoming full, thus guaranteeing both average constant time access and linear size. */
+
+typedef struct {
+    uintptr_t	(*hash)(const void *info, const void *data);
+    int		(*isEqual)(const void *info, const void *data1, const void *data2);
+    void	(*free)(const void *info, void *data);
+    int		style; /* reserved for future expansion; currently 0 */
+    } NXHashTablePrototype;
+    
+/* the info argument allows a certain generality, such as freeing according to some owner information */
+/* invariants assumed by the implementation: 
+	1 - data1 = data2 => hash(data1) = hash(data2)
+	    when data varies over time, hash(data) must remain invariant
+		    e.g. if data hashes over a string key, the string must not be changed
+	2- isEqual (data1, data2) => data1= data2
+ */
+
+typedef struct {
+    const NXHashTablePrototype	*prototype;
+    unsigned			count;
+    unsigned			nbBuckets;
+    void			*buckets;
+    const void			*info;
+   } NXHashTable;
+    /* private data structure; may change */
+    
+OBJC_EXPORT NXHashTable *NXCreateHashTableFromZone (NXHashTablePrototype prototype, unsigned capacity, const void *info, void *z);
+OBJC_EXPORT NXHashTable *NXCreateHashTable (NXHashTablePrototype prototype, unsigned capacity, const void *info);
+    /* if hash is 0, pointer hash is assumed */
+    /* if isEqual is 0, pointer equality is assumed */
+    /* if free is 0, elements are not freed */
+    /* capacity is only a hint; 0 creates a small table */
+    /* info allows call backs to be very general */
+
+OBJC_EXPORT void NXFreeHashTable (NXHashTable *table);
+    /* calls free for each data, and recovers table */
+	
+OBJC_EXPORT void NXEmptyHashTable (NXHashTable *table);
+    /* does not deallocate table nor data; keeps current capacity */
+
+OBJC_EXPORT void NXResetHashTable (NXHashTable *table);
+    /* frees each entry; keeps current capacity */
+
+OBJC_EXPORT BOOL NXCompareHashTables (NXHashTable *table1, NXHashTable *table2);
+    /* Returns YES if the two sets are equal (each member of table1 in table2, and table have same size) */
+
+OBJC_EXPORT NXHashTable *NXCopyHashTable (NXHashTable *table);
+    /* makes a fresh table, copying data pointers, not data itself.  */
+	
+OBJC_EXPORT unsigned NXCountHashTable (NXHashTable *table);
+    /* current number of data in table */
+	
+OBJC_EXPORT int NXHashMember (NXHashTable *table, const void *data);
+    /* returns non-0 iff data is present in table.
+    Example of use when the hashed data is a struct containing the key,
+    and when the callee only has a key:
+	MyStruct	pseudo;
+	pseudo.key = myKey;
+	return NXHashMember (myTable, &pseudo)
+    */
+	
+OBJC_EXPORT void *NXHashGet (NXHashTable *table, const void *data);
+    /* return original table data or NULL.
+    Example of use when the hashed data is a struct containing the key,
+    and when the callee only has a key:
+	MyStruct	pseudo;
+	MyStruct	*original;
+	pseudo.key = myKey;
+	original = NXHashGet (myTable, &pseudo)
+    */
+	
+OBJC_EXPORT void *NXHashInsert (NXHashTable *table, const void *data);
+    /* previous data or NULL is returned. */
+	
+OBJC_EXPORT void *NXHashInsertIfAbsent (NXHashTable *table, const void *data);
+    /* If data already in table, returns the one in table
+    else adds argument to table and returns argument. */
+
+OBJC_EXPORT void *NXHashRemove (NXHashTable *table, const void *data);
+    /* previous data or NULL is returned */
+	
+/* Iteration over all elements of a table consists in setting up an iteration state and then to progress until all entries have been visited.  An example of use for counting elements in a table is:
+    unsigned	count = 0;
+    MyData	*data;
+    NXHashState	state = NXInitHashState(table);
+    while (NXNextHashState(table, &state, &data)) {
+	count++;
+    }
+*/
+
+typedef struct {int i; int j;} NXHashState;
+    /* callers should not rely on actual contents of the struct */
+
+OBJC_EXPORT NXHashState NXInitHashState(NXHashTable *table);
+
+OBJC_EXPORT int NXNextHashState(NXHashTable *table, NXHashState *state, void **data);
+    /* returns 0 when all elements have been visited */
+
+/*************************************************************************
+ *	Conveniences for writing hash, isEqual and free functions
+ *	and common prototypes
+ *************************************************************************/
+
+OBJC_EXPORT uintptr_t NXPtrHash(const void *info, const void *data);
+    /* scrambles the address bits; info unused */
+OBJC_EXPORT uintptr_t NXStrHash(const void *info, const void *data);
+    /* string hashing; info unused */
+OBJC_EXPORT int NXPtrIsEqual(const void *info, const void *data1, const void *data2);
+    /* pointer comparison; info unused */
+OBJC_EXPORT int NXStrIsEqual(const void *info, const void *data1, const void *data2);
+    /* string comparison; NULL ok; info unused */
+OBJC_EXPORT void NXNoEffectFree(const void *info, void *data);
+    /* no effect; info unused */
+OBJC_EXPORT void NXReallyFree(const void *info, void *data);
+    /* frees it; info unused */
+
+/* The two following prototypes are useful for manipulating set of pointers or set of strings; For them free is defined as NXNoEffectFree */
+OBJC_EXPORT const NXHashTablePrototype NXPtrPrototype;
+    /* prototype when data is a pointer (void *) */
+OBJC_EXPORT const NXHashTablePrototype NXStrPrototype;
+    /* prototype when data is a string (char *) */
+
+/* following prototypes help describe mappings where the key is the first element of a struct and is either a pointer or a string.
+For example NXStrStructKeyPrototype can be used to hash pointers to Example, where Example is:
+	typedef struct {
+	    char	*key;
+	    int		data1;
+	    ...
+	    } Example
+    
+For the following prototypes, free is defined as NXReallyFree.
+ */
+OBJC_EXPORT const NXHashTablePrototype NXPtrStructKeyPrototype;
+OBJC_EXPORT const NXHashTablePrototype NXStrStructKeyPrototype;
+
+/*************************************************************************
+ *	Unique strings and buffers
+ *************************************************************************/
+
+/* Unique strings allows C users to enjoy the benefits of Lisp's atoms:
+A unique string is a string that is allocated once for all (never de-allocated) and that has only one representant (thus allowing comparison with == instead of strcmp).  A unique string should never be modified (and in fact some memory protection is done to ensure that).  In order to more explicitly insist on the fact that the string has been uniqued, a synonym of (const char *) has been added, NXAtom. */
+
+typedef const char *NXAtom;
+
+OBJC_EXPORT NXAtom NXUniqueString(const char *buffer);
+    /* assumes that buffer is \0 terminated, and returns
+     a previously created string or a new string that is a copy of buffer.
+    If NULL is passed returns NULL.
+    Returned string should never be modified.  To ensure this invariant,
+    allocations are made in a special read only zone. */
+	
+OBJC_EXPORT NXAtom NXUniqueStringWithLength(const char *buffer, int length);
+    /* assumes that buffer is a non NULL buffer of at least 
+    length characters.  Returns a previously created string or 
+    a new string that is a copy of buffer. 
+    If buffer contains \0, string will be truncated.
+    As for NXUniqueString, returned string should never be modified.  */
+	
+OBJC_EXPORT NXAtom NXUniqueStringNoCopy(const char *string);
+    /* If there is already a unique string equal to string, returns the original.  
+    Otherwise, string is entered in the table, without making a copy.  Argument should then never be modified.  */
+	
+OBJC_EXPORT char *NXCopyStringBuffer(const char *buffer);
+    /* given a buffer, allocates a new string copy of buffer.  
+    Buffer should be \0 terminated; returned string is \0 terminated. */
+
+OBJC_EXPORT char *NXCopyStringBufferFromZone(const char *buffer, void *z);
+    /* given a buffer, allocates a new string copy of buffer.  
+    Buffer should be \0 terminated; returned string is \0 terminated. */
+
+#endif /* _OBJC_LITTLE_HASHTABLE_H_ */
diff -urN cctools-806-old/include/foreign/objc/List.h cctools-806/include/foreign/objc/List.h
--- cctools-806-old/include/foreign/objc/List.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/List.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,124 @@
+/*
+ * Copyright (c) 1999-2002, 2005-2007 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+    List.h
+    Copyright 1988-1996 NeXT Software, Inc.
+
+    DEFINED AS:	A common class
+    HEADER FILES:	objc/List.h
+
+*/
+
+#ifndef _OBJC_LIST_H_
+#define _OBJC_LIST_H_
+
+#if defined(__LP64__)
+
+#warning class List unavailable in 64-bit Objective-C
+
+#else
+
+#warning The API in this header is obsoleted by NSArray.
+
+#import <objc/Object.h>
+#import <AvailabilityMacros.h>
+
+DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER 
+@interface List : Object
+{
+@public
+    id 		*dataPtr  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER ;	/* data of the List object */
+    unsigned 	numElements  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER ;	/* Actual number of elements */
+    unsigned 	maxElements  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER ;	/* Total allocated elements */
+}
+
+/* Creating, freeing */
+
+- free  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- freeObjects  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- copyFromZone:(void *)z  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+  
+/* Initializing */
+
+- init  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- initCount:(unsigned)numSlots  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+/* Comparing two lists */
+
+- (BOOL)isEqual: anObject  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+  
+/* Managing the storage capacity */
+
+- (unsigned)capacity  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- setAvailableCapacity:(unsigned)numSlots  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+/* Manipulating objects by index */
+
+- (unsigned)count  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- objectAt:(unsigned)index  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- lastObject  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- addObject:anObject  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- insertObject:anObject at:(unsigned)index  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- removeObjectAt:(unsigned)index  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- removeLastObject  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- replaceObjectAt:(unsigned)index with:newObject  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- appendList: (List *)otherList  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+/* Manipulating objects by id */
+
+- (unsigned)indexOf:anObject  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- addObjectIfAbsent:anObject  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- removeObject:anObject  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- replaceObject:anObject with:newObject  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+/* Emptying the list */
+
+- empty  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+/* Sending messages to elements of the list */
+
+- makeObjectsPerform:(SEL)aSelector  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- makeObjectsPerform:(SEL)aSelector with:anObject  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+/*
+ * The following new... methods are now obsolete.  They remain in this 
+ * interface file for backward compatibility only.  Use Object's alloc method 
+ * and the init... methods defined in this class instead.
+ */
+
++ new  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
++ newCount:(unsigned)numSlots  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+@end
+
+typedef struct {
+    @defs(List)
+} NXListId  DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+#define NX_ADDRESS(x) (((NXListId *)(x))->dataPtr)
+
+#define NX_NOT_IN_LIST	0xffffffff
+
+#endif
+
+#endif /* _OBJC_LIST_H_ */
diff -urN cctools-806-old/include/foreign/objc/malloc.h cctools-806/include/foreign/objc/malloc.h
--- cctools-806-old/include/foreign/objc/malloc.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/malloc.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,25 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#warning "Use <malloc/malloc.h> instead of <objc/malloc.h>"
+#include <malloc/malloc.h>
diff -urN cctools-806-old/include/foreign/objc/message.h cctools-806/include/foreign/objc/message.h
--- cctools-806-old/include/foreign/objc/message.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/message.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,173 @@
+/*
+ * Copyright (c) 1999-2007 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#import <objc/objc.h>
+#import <objc/runtime.h>
+
+
+struct objc_super {
+    id receiver;
+#if !defined(__cplusplus)  &&  !__OBJC2__
+    Class class;  /* For compatibility with old objc-runtime.h header */
+#else
+    Class super_class;
+#endif
+    /* super_class is the first class to search */
+};
+
+
+/* Basic Messaging Primitives
+ *
+ * On some architectures, use objc_msgSend_stret for some struct return types.
+ * On some architectures, use objc_msgSend_fpret for some float return types.
+ *
+ * These functions must be cast to an appropriate function pointer type 
+ * before being called. 
+ */
+OBJC_EXPORT id objc_msgSend(id self, SEL op, ...);
+OBJC_EXPORT id objc_msgSendSuper(struct objc_super *super, SEL op, ...);
+
+
+/* Struct-returning Messaging Primitives
+ *
+ * Use these functions to call methods that return structs on the stack. 
+ * On some architectures, some structures are returned in registers. 
+ * Consult your local function call ABI documentation for details.
+ * 
+ * These functions must be cast to an appropriate function pointer type 
+ * before being called. 
+ */
+#if defined(__OBJC2__)
+OBJC_EXPORT void objc_msgSend_stret(id self, SEL op, ...);
+OBJC_EXPORT void objc_msgSendSuper_stret(struct objc_super *super, SEL op, ...);
+#elif defined(__cplusplus)
+/* For compatibility with old objc-runtime.h header */
+OBJC_EXPORT id objc_msgSend_stret(id self, SEL op, ...);
+OBJC_EXPORT id objc_msgSendSuper_stret(struct objc_super *super, SEL op, ...);
+#else
+/* For compatibility with old objc-runtime.h header */
+OBJC_EXPORT void objc_msgSend_stret(void * stretAddr, id self, SEL op, ...);
+OBJC_EXPORT void objc_msgSendSuper_stret(void * stretAddr, struct objc_super *super, SEL op, ...);
+#endif
+
+
+/* Floating-point-returning Messaging Primitives
+ * 
+ * Use these functions to call methods that return floating-point values 
+ * on the stack. 
+ * Consult your local function call ABI documentation for details.
+ * 
+ * ppc:    objc_msgSend_fpret not used
+ * ppc64:  objc_msgSend_fpret not used
+ * i386:   objc_msgSend_fpret used for `float`, `double`, `long double`.
+ * x86-64: objc_msgSend_fpret used for `long double`.
+ *
+ * These functions must be cast to an appropriate function pointer type 
+ * before being called. 
+ */
+#if defined(__i386__)
+OBJC_EXPORT double objc_msgSend_fpret(id self, SEL op, ...);
+/* Use objc_msgSendSuper() for fp-returning messages to super. */
+/* See also objc_msgSendv_fpret() below. */
+#elif defined(__x86_64__)
+OBJC_EXPORT long double objc_msgSend_fpret(id self, SEL op, ...);
+/* Use objc_msgSendSuper() for fp-returning messages to super. */
+/* See also objc_msgSendv_fpret() below. */
+#endif
+
+
+/* Direct Method Invocation Primitives
+ * Use these functions to call the implementation of a given Method.
+ * This is faster than calling method_getImplementation() and method_getName().
+ *
+ * The receiver must not be nil.
+ *
+ * These functions must be cast to an appropriate function pointer type 
+ * before being called. 
+ */
+OBJC_EXPORT id method_invoke(id receiver, Method m, ...) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT void method_invoke_stret(id receiver, Method m, ...) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+
+/* Variable-argument Messaging Primitives
+ *
+ * Use these functions to call methods with a list of arguments, such 
+ * as the one passed to forward:: .
+ *
+ * The contents of the argument list are architecture-specific. 
+ * Consult your local function call ABI documentation for details.
+ * 
+ * These functions must be cast to an appropriate function pointer type 
+ * before being called, except for objc_msgSendv_stret() which must not 
+ * be cast to a struct-returning type.
+ */
+
+typedef void* marg_list;
+
+OBJC_EXPORT id objc_msgSendv(id self, SEL op, size_t arg_size, marg_list arg_frame) OBJC2_UNAVAILABLE;
+OBJC_EXPORT void objc_msgSendv_stret(void *stretAddr, id self, SEL op, size_t arg_size, marg_list arg_frame) OBJC2_UNAVAILABLE;
+/* Note that objc_msgSendv_stret() does not return a structure type, 
+ * and should not be cast to do so. This is unlike objc_msgSend_stret() 
+ * and objc_msgSendSuper_stret().
+ */
+#if defined(__i386__)
+OBJC_EXPORT double objc_msgSendv_fpret(id self, SEL op, unsigned arg_size, marg_list arg_frame) OBJC2_UNAVAILABLE;
+#endif
+
+
+/* The following marg_list macros are of marginal utility. They
+ * are included for compatibility with the old objc-class.h header. */
+
+#if !__OBJC2__
+
+#if defined(__ppc__) || defined(ppc)
+#define marg_prearg_size	(13*sizeof(double)+6*sizeof(uintptr_t))
+#else
+#define marg_prearg_size	0
+#endif
+
+#define marg_malloc(margs, method) \
+	do { \
+		margs = (marg_list *)malloc (marg_prearg_size + ((7 + method_getSizeOfArguments(method)) & ~7)); \
+	} while (0)
+
+#define marg_free(margs) \
+	do { \
+		free(margs); \
+	} while (0)
+	
+#define marg_adjustedOffset(method, offset) \
+	(marg_prearg_size + offset)
+
+#define marg_getRef(margs, offset, type) \
+	( (type *)((char *)margs + marg_adjustedOffset(method,offset) ) )
+
+#define marg_getValue(margs, offset, type) \
+	( *marg_getRef(margs, offset, type) )
+
+#define marg_setValue(margs, offset, type, value) \
+	( marg_getValue(margs, offset, type) = (value) )
+
+#endif
diff -urN cctools-806-old/include/foreign/objc/objc-api.h cctools-806/include/foreign/objc/objc-api.h
--- cctools-806-old/include/foreign/objc/objc-api.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/objc-api.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,66 @@
+/*
+ * Copyright (c) 1999-2006 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+// Copyright 1988-1996 NeXT Software, Inc.
+
+#ifndef _OBJC_OBJC_API_H_
+#define _OBJC_OBJC_API_H_
+
+#include <AvailabilityMacros.h>
+
+#undef DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER
+#define DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER
+
+/*
+ * OBJC_API_VERSION 0 or undef: Tiger and earlier API only
+ * OBJC_API_VERSION 2: Leopard and later API available
+ */
+#if !defined(OBJC_API_VERSION)
+#   if MAC_OS_X_VERSION_MIN_REQUIRED < MAC_OS_X_VERSION_10_5
+#       define OBJC_API_VERSION 0
+#   else
+#       define OBJC_API_VERSION 2
+#   endif
+#endif
+
+/* OBJC2_UNAVAILABLE: unavailable in objc 2.0, deprecated in Leopard */
+#if !defined(OBJC2_UNAVAILABLE)
+#   if __OBJC2__
+#       define OBJC2_UNAVAILABLE UNAVAILABLE_ATTRIBUTE
+#   else
+#       define OBJC2_UNAVAILABLE DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER
+#   endif
+#endif
+
+#if !defined(OBJC_EXPORT)
+#   if defined(__cplusplus)
+#       define OBJC_EXPORT extern "C" 
+#   else
+#       define OBJC_EXPORT extern
+#   endif
+#endif
+
+#if !defined(OBJC_IMPORT)
+#   define OBJC_IMPORT extern
+#endif
+
+#endif
diff -urN cctools-806-old/include/foreign/objc/objc-auto.h cctools-806/include/foreign/objc/objc-auto.h
--- cctools-806-old/include/foreign/objc/objc-auto.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/objc-auto.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,116 @@
+/*
+ * Copyright (c) 2004-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OBJC_AUTO_H_
+#define _OBJC_AUTO_H_
+
+#import <objc/objc.h>
+#include <sys/types.h>
+#include <stddef.h>
+#include <stdint.h>
+#include <AvailabilityMacros.h>
+
+/* Collection utilities */
+
+enum {
+    // choose one
+    OBJC_RATIO_COLLECTION        = (0 << 0),  // run "ratio" generational collections, then a full
+    OBJC_GENERATIONAL_COLLECTION = (1 << 0),  // run fast incremental collection
+    OBJC_FULL_COLLECTION         = (2 << 0),  // run full collection.
+    OBJC_EXHAUSTIVE_COLLECTION   = (3 << 0),  // run full collections until memory available stops improving
+    
+    OBJC_COLLECT_IF_NEEDED       = (1 << 3), // run collection only if needed (allocation threshold exceeded)
+    OBJC_WAIT_UNTIL_DONE         = (1 << 4), // wait (when possible) for collection to end before returning (when collector is running on dedicated thread)
+};
+
+OBJC_EXPORT void objc_collect(unsigned long options);
+OBJC_EXPORT BOOL objc_collectingEnabled(void);
+
+
+/* GC configuration */
+
+/* Tells collector to wait until specified bytes have been allocated before trying to collect again. */
+OBJC_EXPORT void objc_setCollectionThreshold(size_t threshold);
+
+/* Tells collector to run a full collection for every ratio generational collections. */
+OBJC_EXPORT void objc_setCollectionRatio(size_t ratio);
+
+/* Tells collector to start collecting on dedicated thread */
+OBJC_EXPORT void objc_startCollectorThread(void);
+
+
+// atomic update of a global variable
+OBJC_EXPORT BOOL objc_atomicCompareAndSwapGlobal(id predicate, id replacement, volatile id *objectLocation);
+OBJC_EXPORT BOOL objc_atomicCompareAndSwapGlobalBarrier(id predicate, id replacement, volatile id *objectLocation);
+// atomic update of an instance variable
+OBJC_EXPORT BOOL objc_atomicCompareAndSwapInstanceVariable(id predicate, id replacement, volatile id *objectLocation);
+OBJC_EXPORT BOOL objc_atomicCompareAndSwapInstanceVariableBarrier(id predicate, id replacement, volatile id *objectLocation);
+
+/* Write barriers.  Used by the compiler.  */
+OBJC_EXPORT id objc_assign_strongCast(id val, id *dest);
+OBJC_EXPORT id objc_assign_global(id val, id *dest);
+OBJC_EXPORT id objc_assign_ivar(id value, id dest, ptrdiff_t offset);
+OBJC_EXPORT void *objc_memmove_collectable(void *dst, const void *src, size_t size);
+
+OBJC_EXPORT id objc_read_weak(id *location);
+OBJC_EXPORT id objc_assign_weak(id value, id *location);
+
+
+//
+// SPI. The following routines are available as debugging and transitional aides.
+//
+
+/* Tells runtime to issue finalize calls on the main thread only. */
+OBJC_EXPORT void objc_finalizeOnMainThread(Class cls)
+    AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER_BUT_DEPRECATED;
+
+
+/* ask if object is scheduled for finalization.  Safe only when called from within a finalizer.  */
+OBJC_EXPORT BOOL objc_is_finalized(void *ptr);
+
+enum {
+    OBJC_CLEAR_RESIDENT_STACK = (1 << 0)
+};
+
+/* Stack management */
+OBJC_EXPORT void objc_clear_stack(unsigned long options);
+
+//
+// Obsolete.  Present only until all uses can be migrated to newer API.
+//
+
+OBJC_EXPORT BOOL objc_collecting_enabled(void);
+OBJC_EXPORT void objc_set_collection_threshold(size_t threshold);
+OBJC_EXPORT void objc_set_collection_ratio(size_t ratio);
+OBJC_EXPORT void objc_start_collector_thread(void);
+
+/* Memory management */
+OBJC_EXPORT id objc_allocate_object(Class cls, int extra);
+
+enum {
+    OBJC_GENERATIONAL = (1 << 0)
+};
+
+OBJC_EXPORT void objc_collect_if_needed(unsigned long options);
+
+#endif
diff -urN cctools-806-old/include/foreign/objc/objc-class.h cctools-806/include/foreign/objc/objc-class.h
--- cctools-806-old/include/foreign/objc/objc-class.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/objc-class.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,2 @@
+#import <objc/runtime.h>
+#import <objc/message.h>
diff -urN cctools-806-old/include/foreign/objc/objc-exception.h cctools-806/include/foreign/objc/objc-exception.h
--- cctools-806-old/include/foreign/objc/objc-exception.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/objc-exception.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,84 @@
+/*
+ * Copyright (c) 2002-2003, 2006-2007 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef __OBJC_EXCEPTION_H_
+#define __OBJC_EXCEPTION_H_
+
+#import <objc/objc.h>
+
+// ZEROCOST_SWITCH
+#if !__LP64__  ||  !OBJC_ZEROCOST_EXCEPTIONS
+
+// compiler reserves a setjmp buffer + 4 words as localExceptionData
+
+OBJC_EXPORT void objc_exception_throw(id exception);
+OBJC_EXPORT void objc_exception_try_enter(void *localExceptionData);
+OBJC_EXPORT void objc_exception_try_exit(void *localExceptionData);
+OBJC_EXPORT id objc_exception_extract(void *localExceptionData);
+OBJC_EXPORT int objc_exception_match(Class exceptionClass, id exception);
+
+
+typedef struct {
+    int version;
+    void (*throw_exc)(id);		// version 0
+    void (*try_enter)(void *);	// version 0
+    void (*try_exit)(void *);	// version 0
+    id	 (*extract)(void *);	// version 0
+    int	(*match)(Class, id);	// version 0
+}
+    objc_exception_functions_t;
+
+// get table; version tells how many
+OBJC_EXPORT void objc_exception_get_functions(objc_exception_functions_t *table);
+
+// set table
+OBJC_EXPORT void objc_exception_set_functions(objc_exception_functions_t *table);
+
+
+// !__LP64__
+#else
+// __LP64__
+
+typedef id (*objc_exception_preprocessor)(id exception);
+typedef int (*objc_exception_matcher)(Class catch_type, id exception);
+typedef void (*objc_uncaught_exception_handler)(id exception);
+typedef void (*objc_exception_handler)(id unused, void *context);
+
+OBJC_EXPORT void objc_exception_throw(id exception);
+OBJC_EXPORT void objc_exception_rethrow(void);
+OBJC_EXPORT id objc_begin_catch(void *exc_buf);
+OBJC_EXPORT void objc_end_catch(void);
+
+OBJC_EXPORT uintptr_t objc_addExceptionHandler(objc_exception_handler fn, void *context);
+OBJC_EXPORT void objc_removeExceptionHandler(uintptr_t token);
+
+OBJC_EXPORT objc_exception_preprocessor objc_setExceptionPreprocessor(objc_exception_preprocessor fn);
+OBJC_EXPORT objc_exception_matcher objc_setExceptionMatcher(objc_exception_matcher fn);
+OBJC_EXPORT objc_uncaught_exception_handler objc_setUncaughtExceptionHandler(objc_uncaught_exception_handler fn);
+
+
+// __LP64__
+#endif
+
+#endif  // __OBJC_EXCEPTION_H_
+
diff -urN cctools-806-old/include/foreign/objc/objc.h cctools-806/include/foreign/objc/objc.h
--- cctools-806-old/include/foreign/objc/objc.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/objc.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,97 @@
+/*
+ * Copyright (c) 1999-2007 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ *	objc.h
+ *	Copyright 1988-1996, NeXT Software, Inc.
+ */
+
+#ifndef _OBJC_OBJC_H_
+#define _OBJC_OBJC_H_
+
+#import <objc/objc-api.h>		// for OBJC_EXPORT
+#import <sys/types.h>
+
+
+typedef struct objc_class *Class;
+typedef struct objc_object {
+    Class isa;
+} *id;
+
+
+typedef struct objc_selector 	*SEL;    
+typedef id 			(*IMP)(id, SEL, ...); 
+typedef signed char		BOOL; 
+// BOOL is explicitly signed so @encode(BOOL) == "c" rather than "C" 
+// even if -funsigned-char is used.
+#define OBJC_BOOL_DEFINED
+
+
+#define YES             (BOOL)1
+#define NO              (BOOL)0
+
+#ifndef Nil
+#define Nil __DARWIN_NULL	/* id of Nil class */
+#endif
+
+#ifndef nil
+#define nil __DARWIN_NULL	/* id of Nil instance */
+#endif
+
+#ifndef __OBJC_GC__
+#define __strong /* empty */
+#endif
+
+OBJC_EXPORT const char *sel_getName(SEL sel);
+OBJC_EXPORT SEL sel_registerName(const char *str);
+OBJC_EXPORT const char *object_getClassName(id obj);
+OBJC_EXPORT void *object_getIndexedIvars(id obj);
+
+
+#if !__OBJC2__
+
+// The following declarations are provided here for source compatibility.
+
+#if defined(__LP64__)
+    typedef long arith_t;
+    typedef unsigned long uarith_t;
+#   define ARITH_SHIFT 32
+#else
+    typedef int arith_t;
+    typedef unsigned uarith_t;
+#   define ARITH_SHIFT 16
+#endif
+
+OBJC_EXPORT BOOL sel_isMapped(SEL sel);
+OBJC_EXPORT SEL sel_getUid(const char *str);
+
+typedef char *STR;
+
+#define ISSELECTOR(sel) sel_isMapped(sel)
+#define SELNAME(sel)	sel_getName(sel)
+#define SELUID(str)	sel_getUid(str)
+#define NAMEOF(obj)     object_getClassName(obj)
+#define IV(obj)         object_getIndexedIvars(obj)
+
+#endif
+
+#endif  /* _OBJC_OBJC_H_ */
diff -urN cctools-806-old/include/foreign/objc/objc-load.h cctools-806/include/foreign/objc/objc-load.h
--- cctools-806-old/include/foreign/objc/objc-load.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/objc-load.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,55 @@
+/*
+ * Copyright (c) 1999-2001, 2005-2006 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ *	objc-load.h
+ *	Copyright 1988-1996, NeXT Software, Inc.
+ */
+
+#ifndef _OBJC_LOAD_H_
+#define _OBJC_LOAD_H_
+
+#import <objc/objc-class.h>
+
+#import <mach-o/loader.h>
+#import <AvailabilityMacros.h>
+
+/* dynamically loading Mach-O object files that contain Objective-C code */
+
+OBJC_EXPORT long objc_loadModules (
+	char *modlist[], 
+	void *errStream,
+	void (*class_callback) (Class, Category),
+	/*headerType*/ struct mach_header **hdr_addr,
+	char *debug_file
+) OBJC2_UNAVAILABLE;
+OBJC_EXPORT int objc_loadModule (
+	char *	moduleName, 
+	void	(*class_callback) (Class, Category),
+	int *	errorCode
+) OBJC2_UNAVAILABLE;
+OBJC_EXPORT long objc_unloadModules(
+	void *errorStream,				/* input (optional) */
+	void (*unloadCallback)(Class, Category)		/* input (optional) */
+) OBJC2_UNAVAILABLE;
+
+#endif /* _OBJC_LOAD_H_ */
diff -urN cctools-806-old/include/foreign/objc/objc-runtime.h cctools-806/include/foreign/objc/objc-runtime.h
--- cctools-806-old/include/foreign/objc/objc-runtime.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/objc-runtime.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,2 @@
+#import <objc/runtime.h>
+#import <objc/message.h>
diff -urN cctools-806-old/include/foreign/objc/objc-sync.h cctools-806/include/foreign/objc/objc-sync.h
--- cctools-806-old/include/foreign/objc/objc-sync.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/objc-sync.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,58 @@
+/*
+ * Copyright (c) 2002, 2006 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef __OBJC_SNYC_H_
+#define __OBJC_SNYC_H_
+
+#include <objc/objc.h>
+
+// Begin synchronizing on 'obj'.  
+// Allocates recursive pthread_mutex associated with 'obj' if needed.
+// Returns OBJC_SYNC_SUCCESS once lock is acquired.  
+OBJC_EXPORT  int objc_sync_enter(id obj);
+
+// End synchronizing on 'obj'. 
+// Returns OBJC_SYNC_SUCCESS or OBJC_SYNC_NOT_OWNING_THREAD_ERROR
+OBJC_EXPORT  int objc_sync_exit(id obj);
+
+// Temporarily release lock on 'obj' and wait for another thread to notify on 'obj'
+// Return OBJC_SYNC_SUCCESS, OBJC_SYNC_NOT_OWNING_THREAD_ERROR, OBJC_SYNC_TIMED_OUT
+OBJC_EXPORT  int objc_sync_wait(id obj, long long milliSecondsMaxWait);
+
+// Wake up another thread waiting on 'obj'
+// Return OBJC_SYNC_SUCCESS, OBJC_SYNC_NOT_OWNING_THREAD_ERROR
+OBJC_EXPORT  int objc_sync_notify(id obj);
+
+// Wake up all threads waiting on 'obj'
+// Return OBJC_SYNC_SUCCESS, OBJC_SYNC_NOT_OWNING_THREAD_ERROR
+OBJC_EXPORT  int objc_sync_notifyAll(id obj);
+
+enum {
+	OBJC_SYNC_SUCCESS                 = 0,
+	OBJC_SYNC_NOT_OWNING_THREAD_ERROR = -1,
+	OBJC_SYNC_TIMED_OUT               = -2,
+	OBJC_SYNC_NOT_INITIALIZED         = -3		
+};
+
+
+#endif // __OBJC_SNYC_H_
diff -urN cctools-806-old/include/foreign/objc/Object.h cctools-806/include/foreign/objc/Object.h
--- cctools-806-old/include/foreign/objc/Object.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/Object.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,175 @@
+/*
+ * Copyright (c) 1999-2003, 2005-2007 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+	Object.h
+	Copyright 1988-1996 NeXT Software, Inc.
+  
+	DEFINED AS:	A common class
+	HEADER FILES:	<objc/Object.h>
+
+*/
+
+#ifndef _OBJC_OBJECT_H_
+#define _OBJC_OBJECT_H_
+
+#include <stdarg.h>
+#import <objc/objc-runtime.h>
+
+#if __OBJC2__
+
+@interface Object
+{
+	Class isa;	/* A pointer to the instance's class structure */
+}
+
++class;
+-(BOOL) isEqual:anObject;
+
+@end
+
+#else
+
+@interface Object
+{
+	Class isa;	/* A pointer to the instance's class structure */
+}
+
+/* Initializing classes and instances */
+
++ initialize;
+- init;
+
+/* Creating, copying, and freeing instances */
+
++ new;
++ free;
+- free;
++ alloc;
+- copy;
++ allocFromZone:(void *)zone;
+- copyFromZone:(void *)zone;
+- (void *)zone;
+
+/* Identifying classes */
+
++ class;
++ superclass;
++ (const char *) name;
+- class;
+- superclass;
+- (const char *) name;
+
+/* Identifying and comparing instances */
+
+- self;
+- (unsigned int) hash;
+- (BOOL) isEqual:anObject;
+
+/* Testing inheritance relationships */
+
+- (BOOL) isKindOf: aClassObject;
+- (BOOL) isMemberOf: aClassObject;
+- (BOOL) isKindOfClassNamed: (const char *)aClassName;
+- (BOOL) isMemberOfClassNamed: (const char *)aClassName;
+
+/* Testing class functionality */
+
++ (BOOL) instancesRespondTo:(SEL)aSelector;
+- (BOOL) respondsTo:(SEL)aSelector;
+
+/* Testing protocol conformance */
+
+- (BOOL) conformsTo: (Protocol *)aProtocolObject;
++ (BOOL) conformsTo: (Protocol *)aProtocolObject;
+
+/* Obtaining method descriptors from protocols */
+
+- (struct objc_method_description *) descriptionForMethod:(SEL)aSel;
++ (struct objc_method_description *) descriptionForInstanceMethod:(SEL)aSel;
+
+/* Obtaining method handles */
+
+- (IMP) methodFor:(SEL)aSelector;
++ (IMP) instanceMethodFor:(SEL)aSelector;
+
+/* Sending messages determined at run time */
+
+- perform:(SEL)aSelector;
+- perform:(SEL)aSelector with:anObject;
+- perform:(SEL)aSelector with:object1 with:object2;
+
+/* Posing */
+
++ poseAs: aClassObject;
+
+/* Enforcing intentions */
+ 
+- subclassResponsibility:(SEL)aSelector;
+- notImplemented:(SEL)aSelector;
+
+/* Error handling */
+
+- doesNotRecognize:(SEL)aSelector;
+- error:(const char *)aString, ...;
+
+/* Debugging */
+
+- (void) printForDebugger:(void *)stream;
+
+/* Archiving */
+
+- awake;
+- write:(void *)stream;
+- read:(void *)stream;
++ (int) version;
++ setVersion: (int) aVersion;
+
+/* Forwarding */
+
+- forward: (SEL)sel : (marg_list)args;
+- performv: (SEL)sel : (marg_list)args;
+
+@end
+
+/* Abstract Protocol for Archiving */
+
+@interface Object (Archiving)
+
+- startArchiving: (void *)stream;
+- finishUnarchiving;
+
+@end
+
+/* Abstract Protocol for Dynamic Loading */
+
+@interface Object (DynamicLoading)
+
+//+ finishLoading:(headerType *)header;
++ finishLoading:(struct mach_header *)header;
++ startUnloading;
+
+@end
+
+#endif
+
+#endif /* _OBJC_OBJECT_H_ */
diff -urN cctools-806-old/include/foreign/objc/Protocol.h cctools-806/include/foreign/objc/Protocol.h
--- cctools-806-old/include/foreign/objc/Protocol.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/Protocol.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,59 @@
+/*
+ * Copyright (c) 1999-2003, 2006-2007 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+	Protocol.h
+	Copyright 1991-1996 NeXT Software, Inc.
+*/
+
+#ifndef _OBJC_PROTOCOL_H_
+#define _OBJC_PROTOCOL_H_
+
+#import <objc/Object.h>
+
+/* Warning: All of these methods will disappear in 64-bit. */
+
+@interface Protocol : Object
+{
+@private
+    char *protocol_name OBJC2_UNAVAILABLE;
+    struct objc_protocol_list *protocol_list OBJC2_UNAVAILABLE;
+    struct objc_method_description_list *instance_methods OBJC2_UNAVAILABLE;
+    struct objc_method_description_list *class_methods OBJC2_UNAVAILABLE;
+}
+
+/* Obtaining attributes intrinsic to the protocol */
+
+- (const char *)name OBJC2_UNAVAILABLE;
+
+/* Testing protocol conformance */
+
+- (BOOL) conformsTo: (Protocol *)aProtocolObject OBJC2_UNAVAILABLE;
+
+/* Looking up information specific to a protocol */
+
+- (struct objc_method_description *) descriptionForInstanceMethod:(SEL)aSel DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+- (struct objc_method_description *) descriptionForClassMethod:(SEL)aSel DEPRECATED_IN_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+@end
+
+#endif /* _OBJC_PROTOCOL_H_ */
diff -urN cctools-806-old/include/foreign/objc/runtime.h cctools-806/include/foreign/objc/runtime.h
--- cctools-806-old/include/foreign/objc/runtime.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/runtime.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,483 @@
+/*
+ * Copyright (c) 1999-2007 Apple Inc.  All Rights Reserved.
+ * 
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OBJC_RUNTIME_H
+#define _OBJC_RUNTIME_H
+
+#import <objc/objc.h>
+
+#import <sys/types.h>
+#import <stdarg.h>
+#import <stdint.h>
+#import <stddef.h>
+#import <AvailabilityMacros.h>
+
+
+/* Types */
+
+typedef struct objc_method *Method;
+typedef struct objc_ivar *Ivar;
+typedef struct objc_category *Category;
+typedef struct objc_property *objc_property_t;
+
+struct objc_class {
+    Class isa;
+
+#if !__OBJC2__
+    Class super_class                                        OBJC2_UNAVAILABLE;
+    const char *name                                         OBJC2_UNAVAILABLE;
+    long version                                             OBJC2_UNAVAILABLE;
+    long info                                                OBJC2_UNAVAILABLE;
+    long instance_size                                       OBJC2_UNAVAILABLE;
+    struct objc_ivar_list *ivars                             OBJC2_UNAVAILABLE;
+    struct objc_method_list **methodLists                    OBJC2_UNAVAILABLE;
+    struct objc_cache *cache                                 OBJC2_UNAVAILABLE;
+    struct objc_protocol_list *protocols                     OBJC2_UNAVAILABLE;
+#endif
+
+} OBJC2_UNAVAILABLE;
+/* Use `Class` instead of `struct objc_class *` */
+
+#ifdef __OBJC__
+@class Protocol;
+#else
+typedef struct objc_object Protocol;
+#endif
+
+struct objc_method_description {
+	SEL name;
+	char *types;
+};
+struct objc_method_description_list {
+        int count;
+        struct objc_method_description list[1];
+};
+
+struct objc_protocol_list {
+    struct objc_protocol_list *next;
+    long count;
+    Protocol *list[1];
+};
+
+
+/* Functions */
+
+OBJC_EXPORT id object_copy(id obj, size_t size);
+OBJC_EXPORT id object_dispose(id obj);
+
+OBJC_EXPORT Class object_getClass(id obj) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT Class object_setClass(id obj, Class cls) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT const char *object_getClassName(id obj);
+OBJC_EXPORT void *object_getIndexedIvars(id obj);
+
+OBJC_EXPORT id object_getIvar(id obj, Ivar ivar) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT void object_setIvar(id obj, Ivar ivar, id value) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT Ivar object_setInstanceVariable(id obj, const char *name, void *value);
+OBJC_EXPORT Ivar object_getInstanceVariable(id obj, const char *name, void **outValue);
+
+OBJC_EXPORT id objc_getClass(const char *name);
+OBJC_EXPORT id objc_getMetaClass(const char *name);
+OBJC_EXPORT id objc_lookUpClass(const char *name);
+OBJC_EXPORT id objc_getRequiredClass(const char *name);
+OBJC_EXPORT Class objc_getFutureClass(const char *name) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT void objc_setFutureClass(Class cls, const char *name) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT int objc_getClassList(Class *buffer, int bufferCount);
+
+OBJC_EXPORT Protocol *objc_getProtocol(const char *name)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT Protocol **objc_copyProtocolList(unsigned int *outCount)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT const char *class_getName(Class cls) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT BOOL class_isMetaClass(Class cls) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT Class class_getSuperclass(Class cls) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT Class class_setSuperclass(Class cls, Class newSuper) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER OBJC2_UNAVAILABLE;
+
+OBJC_EXPORT int class_getVersion(Class cls);
+OBJC_EXPORT void class_setVersion(Class cls, int version);
+
+OBJC_EXPORT size_t class_getInstanceSize(Class cls) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT Ivar class_getInstanceVariable(Class cls, const char *name);
+OBJC_EXPORT Ivar class_getClassVariable(Class cls, const char *name) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT Ivar *class_copyIvarList(Class cls, unsigned int *outCount) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT Method class_getInstanceMethod(Class cls, SEL name);
+OBJC_EXPORT Method class_getClassMethod(Class cls, SEL name);
+OBJC_EXPORT IMP class_getMethodImplementation(Class cls, SEL name) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT IMP class_getMethodImplementation_stret(Class cls, SEL name) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT BOOL class_respondsToSelector(Class cls, SEL sel) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT Method *class_copyMethodList(Class cls, unsigned int *outCount) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT BOOL class_conformsToProtocol(Class cls, Protocol *protocol) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT Protocol **class_copyProtocolList(Class cls, unsigned int *outCount)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT objc_property_t class_getProperty(Class cls, const char *name)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT objc_property_t *class_copyPropertyList(Class cls, unsigned int *outCount)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT const char *class_getIvarLayout(Class cls)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT const char *class_getWeakIvarLayout(Class cls)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT id class_createInstance(Class cls, size_t extraBytes);
+
+OBJC_EXPORT Class objc_allocateClassPair(Class superclass, const char *name, 
+                                         size_t extraBytes) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT void objc_registerClassPair(Class cls) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT Class objc_duplicateClass(Class original, const char *name, 
+                                      size_t extraBytes) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT void objc_disposeClassPair(Class cls) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT BOOL class_addMethod(Class cls, SEL name, IMP imp, 
+                                 const char *types) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT IMP class_replaceMethod(Class cls, SEL name, IMP imp, 
+                                    const char *types) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT BOOL class_addIvar(Class cls, const char *name, size_t size, 
+                               uint8_t alignment, const char *types) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT BOOL class_addProtocol(Class cls, Protocol *protocol) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT void class_setIvarLayout(Class cls, const char *layout)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT void class_setWeakIvarLayout(Class cls, const char *layout)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+
+OBJC_EXPORT SEL method_getName(Method m) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT IMP method_getImplementation(Method m) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT const char *method_getTypeEncoding(Method m) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT unsigned int method_getNumberOfArguments(Method m);
+OBJC_EXPORT char *method_copyReturnType(Method m) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT char *method_copyArgumentType(Method m, unsigned int index) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT void method_getReturnType(Method m, char *dst, size_t dst_len) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT void method_getArgumentType(Method m, unsigned int index, 
+                                        char *dst, size_t dst_len) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT struct objc_method_description *method_getDescription(Method m) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT IMP method_setImplementation(Method m, IMP imp) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT void method_exchangeImplementations(Method m1, Method m2) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT const char *ivar_getName(Ivar v) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT const char *ivar_getTypeEncoding(Ivar v) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT __darwin_ptrdiff_t ivar_getOffset(Ivar v) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT const char *property_getName(objc_property_t property) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT const char *property_getAttributes(objc_property_t property) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT BOOL protocol_conformsToProtocol(Protocol *proto, Protocol *other)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT BOOL protocol_isEqual(Protocol *proto, Protocol *other)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT const char *protocol_getName(Protocol *p)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT struct objc_method_description protocol_getMethodDescription(Protocol *p, SEL aSel, BOOL isRequiredMethod, BOOL isInstanceMethod)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT struct objc_method_description *protocol_copyMethodDescriptionList(Protocol *p, BOOL isRequiredMethod, BOOL isInstanceMethod, unsigned int *outCount)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT objc_property_t protocol_getProperty(Protocol *proto, const char *name, BOOL isRequiredProperty, BOOL isInstanceProperty)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT objc_property_t *protocol_copyPropertyList(Protocol *proto, unsigned int *outCount)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT Protocol **protocol_copyProtocolList(Protocol *proto, unsigned int *outCount)
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT const char **objc_copyImageNames(unsigned int *outCount) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT const char *class_getImageName(Class cls) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT const char **objc_copyClassNamesForImage(const char *image, 
+                                                     unsigned int *outCount) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT const char *sel_getName(SEL sel);
+OBJC_EXPORT SEL sel_getUid(const char *str);
+OBJC_EXPORT SEL sel_registerName(const char *str);
+OBJC_EXPORT BOOL sel_isEqual(SEL lhs, SEL rhs) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT void objc_enumerationMutation(id) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+OBJC_EXPORT void objc_setEnumerationMutationHandler(void (*handler)(id)) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+OBJC_EXPORT void objc_setForwardHandler(void *fwd, void *fwd_stret) 
+     AVAILABLE_MAC_OS_X_VERSION_10_5_AND_LATER;
+
+#define _C_ID       '@'
+#define _C_CLASS    '#'
+#define _C_SEL      ':'
+#define _C_CHR      'c'
+#define _C_UCHR     'C'
+#define _C_SHT      's'
+#define _C_USHT     'S'
+#define _C_INT      'i'
+#define _C_UINT     'I'
+#define _C_LNG      'l'
+#define _C_ULNG     'L'
+#define _C_LNG_LNG  'q'
+#define _C_ULNG_LNG 'Q'
+#define _C_FLT      'f'
+#define _C_DBL      'd'
+#define _C_BFLD     'b'
+#define _C_BOOL     'B'
+#define _C_VOID     'v'
+#define _C_UNDEF    '?'
+#define _C_PTR      '^'
+#define _C_CHARPTR  '*'
+#define _C_ATOM     '%'
+#define _C_ARY_B    '['
+#define _C_ARY_E    ']'
+#define _C_UNION_B  '('
+#define _C_UNION_E  ')'
+#define _C_STRUCT_B '{'
+#define _C_STRUCT_E '}'
+#define _C_VECTOR   '!'
+#define _C_CONST    'r'
+
+
+/* Obsolete types */
+
+#if !__OBJC2__
+
+#define CLS_GETINFO(cls,infomask)        ((cls)->info & (infomask))
+#define CLS_SETINFO(cls,infomask)        ((cls)->info |= (infomask))
+
+// class is not a metaclass
+#define CLS_CLASS               0x1
+// class is a metaclass
+#define CLS_META                0x2
+// class's +initialize method has completed
+#define CLS_INITIALIZED         0x4
+// class is posing
+#define CLS_POSING              0x8
+// unused
+#define CLS_MAPPED              0x10
+// class and subclasses need cache flush during image loading
+#define CLS_FLUSH_CACHE         0x20
+// method cache should grow when full
+#define CLS_GROW_CACHE          0x40
+// unused
+#define CLS_NEED_BIND           0x80
+// methodLists is array of method lists
+#define CLS_METHOD_ARRAY        0x100
+// the JavaBridge constructs classes with these markers
+#define CLS_JAVA_HYBRID         0x200
+#define CLS_JAVA_CLASS          0x400
+// thread-safe +initialize
+#define CLS_INITIALIZING        0x800
+// bundle unloading
+#define CLS_FROM_BUNDLE         0x1000
+// C++ ivar support
+#define CLS_HAS_CXX_STRUCTORS   0x2000
+// Lazy method list arrays
+#define CLS_NO_METHOD_ARRAY     0x4000
+// +load implementation
+#define CLS_HAS_LOAD_METHOD     0x8000
+// objc_allocateClassPair API
+#define CLS_CONSTRUCTING        0x10000
+// class compiled with bigger class structure
+#define CLS_EXT                 0x20000
+
+
+struct objc_category {
+    char *category_name                                      OBJC2_UNAVAILABLE;
+    char *class_name                                         OBJC2_UNAVAILABLE;
+    struct objc_method_list *instance_methods                OBJC2_UNAVAILABLE;
+    struct objc_method_list *class_methods                   OBJC2_UNAVAILABLE;
+    struct objc_protocol_list *protocols                     OBJC2_UNAVAILABLE;
+}                                                            OBJC2_UNAVAILABLE;
+
+
+struct objc_ivar {
+    char *ivar_name                                          OBJC2_UNAVAILABLE;
+    char *ivar_type                                          OBJC2_UNAVAILABLE;
+    int ivar_offset                                          OBJC2_UNAVAILABLE;
+#ifdef __LP64__
+    int space                                                OBJC2_UNAVAILABLE;
+#endif
+}                                                            OBJC2_UNAVAILABLE;
+
+struct objc_ivar_list {
+    int ivar_count                                           OBJC2_UNAVAILABLE;
+#ifdef __LP64__
+    int space                                                OBJC2_UNAVAILABLE;
+#endif
+    /* variable length structure */
+    struct objc_ivar ivar_list[1]                            OBJC2_UNAVAILABLE;
+}                                                            OBJC2_UNAVAILABLE;
+
+
+struct objc_method {
+    SEL method_name                                          OBJC2_UNAVAILABLE;
+    char *method_types                                       OBJC2_UNAVAILABLE;
+    IMP method_imp                                           OBJC2_UNAVAILABLE;
+}                                                            OBJC2_UNAVAILABLE;
+
+struct objc_method_list {
+    struct objc_method_list *obsolete                        OBJC2_UNAVAILABLE;
+
+    int method_count                                         OBJC2_UNAVAILABLE;
+#ifdef __LP64__
+    int space                                                OBJC2_UNAVAILABLE;
+#endif
+    /* variable length structure */
+    struct objc_method method_list[1]                        OBJC2_UNAVAILABLE;
+}                                                            OBJC2_UNAVAILABLE;
+
+
+typedef struct objc_symtab *Symtab                           OBJC2_UNAVAILABLE;
+
+struct objc_symtab {
+    unsigned long sel_ref_cnt                                OBJC2_UNAVAILABLE;
+    SEL *refs                                                OBJC2_UNAVAILABLE;
+    unsigned short cls_def_cnt                               OBJC2_UNAVAILABLE;
+    unsigned short cat_def_cnt                               OBJC2_UNAVAILABLE;
+    void *defs[1] /* variable size */                        OBJC2_UNAVAILABLE;
+}                                                            OBJC2_UNAVAILABLE;
+
+
+typedef struct objc_cache *Cache                             OBJC2_UNAVAILABLE;
+
+#define CACHE_BUCKET_NAME(B)  ((B)->method_name)
+#define CACHE_BUCKET_IMP(B)   ((B)->method_imp)
+#define CACHE_BUCKET_VALID(B) (B)
+#ifndef __LP64__
+#define CACHE_HASH(sel, mask) (((uintptr_t)(sel)>>2) & (mask))
+#else
+#define CACHE_HASH(sel, mask) (((unsigned int)((uintptr_t)(sel)>>3)) & (mask))
+#endif
+struct objc_cache {
+    unsigned int mask /* total = mask + 1 */                 OBJC2_UNAVAILABLE;
+    unsigned int occupied                                    OBJC2_UNAVAILABLE;
+    Method buckets[1]                                        OBJC2_UNAVAILABLE;
+} /* GrP fixme should be OBJC2_UNAVAILABLE, but isn't because of spurious warnings in [super ...] calls */;
+
+
+typedef struct objc_module *Module                           OBJC2_UNAVAILABLE;
+
+struct objc_module {
+    unsigned long version                                    OBJC2_UNAVAILABLE;
+    unsigned long size                                       OBJC2_UNAVAILABLE;
+    const char *name                                         OBJC2_UNAVAILABLE;
+    Symtab symtab                                            OBJC2_UNAVAILABLE;
+}                                                            OBJC2_UNAVAILABLE;
+
+#else
+
+struct objc_method_list;
+
+#endif
+
+
+/* Obsolete functions */
+
+OBJC_EXPORT BOOL sel_isMapped(SEL sel)                       OBJC2_UNAVAILABLE;
+
+OBJC_EXPORT id object_copyFromZone(id anObject, size_t nBytes, void *z) OBJC2_UNAVAILABLE;
+OBJC_EXPORT id object_realloc(id anObject, size_t nBytes)    OBJC2_UNAVAILABLE;
+OBJC_EXPORT id object_reallocFromZone(id anObject, size_t nBytes, void *z) OBJC2_UNAVAILABLE;
+
+#define OBSOLETE_OBJC_GETCLASSES 1
+OBJC_EXPORT void *objc_getClasses(void)                      OBJC2_UNAVAILABLE;
+OBJC_EXPORT void objc_addClass(Class myClass)                OBJC2_UNAVAILABLE;
+OBJC_EXPORT void objc_setClassHandler(int (*)(const char *)) OBJC2_UNAVAILABLE;
+OBJC_EXPORT void objc_setMultithreaded (BOOL flag)           OBJC2_UNAVAILABLE;
+
+OBJC_EXPORT id class_createInstanceFromZone(Class, size_t idxIvars, void *z) OBJC2_UNAVAILABLE;
+
+OBJC_EXPORT void class_addMethods(Class, struct objc_method_list *) OBJC2_UNAVAILABLE;
+OBJC_EXPORT void class_removeMethods(Class, struct objc_method_list *) OBJC2_UNAVAILABLE;
+
+OBJC_EXPORT Class class_poseAs(Class imposter, Class original) OBJC2_UNAVAILABLE;
+
+OBJC_EXPORT unsigned int method_getSizeOfArguments(Method m) OBJC2_UNAVAILABLE;
+OBJC_EXPORT unsigned method_getArgumentInfo(struct objc_method *m, int arg, const char **type, int *offset) OBJC2_UNAVAILABLE;
+
+OBJC_EXPORT BOOL class_respondsToMethod(Class, SEL)          OBJC2_UNAVAILABLE;
+OBJC_EXPORT IMP class_lookupMethod(Class, SEL)               OBJC2_UNAVAILABLE;
+OBJC_EXPORT Class objc_getOrigClass(const char *name)        OBJC2_UNAVAILABLE;
+#define OBJC_NEXT_METHOD_LIST 1
+OBJC_EXPORT struct objc_method_list *class_nextMethodList(Class, void **) OBJC2_UNAVAILABLE;
+// usage for nextMethodList
+//
+// void *iterator = 0;
+// struct objc_method_list *mlist;
+// while ( mlist = class_nextMethodList( cls, &iterator ) )
+//    ;
+
+OBJC_EXPORT id (*_alloc)(Class, size_t)                      OBJC2_UNAVAILABLE;
+OBJC_EXPORT id (*_copy)(id, size_t)                          OBJC2_UNAVAILABLE;
+OBJC_EXPORT id (*_realloc)(id, size_t)                       OBJC2_UNAVAILABLE;
+OBJC_EXPORT id (*_dealloc)(id)                               OBJC2_UNAVAILABLE;
+OBJC_EXPORT id (*_zoneAlloc)(Class, size_t, void *)          OBJC2_UNAVAILABLE;
+OBJC_EXPORT id (*_zoneRealloc)(id, size_t, void *)           OBJC2_UNAVAILABLE;
+OBJC_EXPORT id (*_zoneCopy)(id, size_t, void *)              OBJC2_UNAVAILABLE;
+//OBJC_EXPORT void (*_error)(id, const char *, va_list)        OBJC2_UNAVAILABLE;
+
+#endif
diff -urN cctools-806-old/include/foreign/objc/zone.h cctools-806/include/foreign/objc/zone.h
--- cctools-806-old/include/foreign/objc/zone.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/objc/zone.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,66 @@
+/*
+ * Copyright (c) 1999, 2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _OBJC_ZONE_H_
+#define _OBJC_ZONE_H_
+
+#import <malloc/malloc.h>
+
+typedef malloc_zone_t NXZone;
+
+#define NX_NOZONE  ((NXZone *)0)
+
+/*********	Interface to zone based malloc	************/
+
+#include <sys/cdefs.h>
+
+#warning All the routines in objc/zone.h are deprecated and will be removed in the future
+
+__BEGIN_DECLS
+extern NXZone *NXDefaultMallocZone(void) __deprecated;
+    // Returns the default zone used by the malloc(3) calls
+
+extern NXZone *NXCreateZone(size_t startSize, size_t granularity, int canFree) __deprecated;
+    // Create a new zone with its own memory pool.
+    // canfree: if 0 the allocator will never free memory and mallocing will be fast
+
+extern void NXNameZone(NXZone *z, const char *name) __deprecated;
+    // name a zone; The string will be copied
+
+extern void *NXZoneMalloc(malloc_zone_t *zone, size_t size) __deprecated;
+
+extern void *NXZoneRealloc(malloc_zone_t *zone, void *ptr, size_t size) __deprecated;
+
+extern void *NXZoneCalloc(NXZone *zonep, size_t numElems, size_t byteSize) __deprecated;
+    // Allocates and then clears
+
+extern void NXZoneFree(malloc_zone_t *zone, void *ptr) __deprecated;
+
+extern void NXDestroyZone(malloc_zone_t *zone) __deprecated;
+
+extern NXZone *NXZoneFromPtr(void *ptr) __deprecated;
+    // Returns the zone for a pointer, or NX_NOZONE if not in any zone.
+    // The ptr must have been returned from a malloc or realloc call.
+__END_DECLS
+
+#endif /* _OBJC_ZONE_H_ */
diff -urN cctools-806-old/include/foreign/ppc/endian.h cctools-806/include/foreign/ppc/endian.h
--- cctools-806-old/include/foreign/ppc/endian.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/ppc/endian.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,112 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+/*
+ * Copyright (c) 1995 NeXT Computer, Inc. All rights reserved.
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1987, 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)endian.h	8.1 (Berkeley) 6/10/93
+ */
+
+#ifndef _PPC_ENDIAN_H_
+#define	_PPC_ENDIAN_H_
+
+/*
+ * Define the order of 32-bit words in 64-bit words.
+ */
+#define _QUAD_HIGHWORD 0
+#define _QUAD_LOWWORD 1
+
+/*
+ * Definitions for byte order, according to byte significance from low
+ * address to high.
+ */
+#define	__DARWIN_LITTLE_ENDIAN	1234	/* LSB first: i386, vax */
+#define	__DARWIN_BIG_ENDIAN	4321	/* MSB first: 68000, ibm, net, ppc */
+#define	__DARWIN_PDP_ENDIAN	3412	/* LSB first in word, MSW first in long */
+
+#define	__DARWIN_BYTE_ORDER	__DARWIN_BIG_ENDIAN
+
+#if	defined(KERNEL) || !defined(_POSIX_C_SOURCE)
+
+#define	LITTLE_ENDIAN	__DARWIN_LITTLE_ENDIAN
+#define	BIG_ENDIAN	__DARWIN_BIG_ENDIAN
+#define	PDP_ENDIAN	__DARWIN_PDP_ENDIAN
+
+#define	BYTE_ORDER	__DARWIN_BYTE_ORDER
+
+#ifdef NEED_SYS_ENDIAN_H
+#include <sys/_endian.h>
+#endif
+
+#endif /* defined(KERNEL) || !defined(_POSIX_C_SOURCE) */
+#endif /* !_PPC_ENDIAN_H_ */
diff -urN cctools-806-old/include/foreign/ppc/_limits.h cctools-806/include/foreign/ppc/_limits.h
--- cctools-806-old/include/foreign/ppc/_limits.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/ppc/_limits.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,27 @@
+/*
+ * Copyright (c) 2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+#ifndef	_PPC__LIMITS_H_
+#define	_PPC__LIMITS_H_
+
+#define	__DARWIN_CLK_TCK		100	/* ticks per second */
+
+#endif	/* _PPC__LIMITS_H_ */
diff -urN cctools-806-old/include/foreign/ppc/limits.h cctools-806/include/foreign/ppc/limits.h
--- cctools-806-old/include/foreign/ppc/limits.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/ppc/limits.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,107 @@
+/*
+ * Copyright (c) 1988, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)limits.h	8.3 (Berkeley) 1/4/94
+ */
+
+#ifndef _PPC_LIMITS_H_
+#define _PPC_LIMITS_H_
+
+#include <ppc/_limits.h>
+
+#define	CHAR_BIT	8		/* number of bits in a char */
+#define	MB_LEN_MAX	6		/* Allow 31 bit UTF2 */
+
+#define	CLK_TCK		__DARWIN_CLK_TCK	/* ticks per second */
+
+/*
+ * According to ANSI (section 2.2.4.2), the values below must be usable by
+ * #if preprocessing directives.  Additionally, the expression must have the
+ * same type as would an expression that is an object of the corresponding
+ * type converted according to the integral promotions.  The subtraction for
+ * INT_MIN and LONG_MIN is so the value is not unsigned; 2147483648 is an
+ * unsigned int for 32-bit two's complement ANSI compilers (section 3.1.3.2).
+ * These numbers work for pcc as well.  The UINT_MAX and ULONG_MAX values
+ * are written as hex so that GCC will be quiet about large integer constants.
+ */
+#define	SCHAR_MAX	127		/* min value for a signed char */
+#define	SCHAR_MIN	(-128)		/* max value for a signed char */
+
+#define	UCHAR_MAX	255		/* max value for an unsigned char */
+#define	CHAR_MAX	127		/* max value for a char */
+#define	CHAR_MIN	(-128)		/* min value for a char */
+
+#define	USHRT_MAX	65535		/* max value for an unsigned short */
+#define	SHRT_MAX	32767		/* max value for a short */
+#define	SHRT_MIN	(-32768)	/* min value for a short */
+
+#define	UINT_MAX	0xffffffff	/* max value for an unsigned int */
+#define	INT_MAX		2147483647	/* max value for an int */
+#define	INT_MIN		(-2147483647-1)	/* min value for an int */
+
+#ifdef __LP64__
+#define	ULONG_MAX	0xffffffffffffffffUL	/* max unsigned long */
+#define	LONG_MAX	0x7fffffffffffffffL	/* max signed long */
+#define	LONG_MIN	(-0x7fffffffffffffffL-1) /* min signed long */
+#else /* !__LP64__ */
+#define	ULONG_MAX	0xffffffffL	/* max value for an unsigned long */
+#define	LONG_MAX	2147483647L	/* max value for a long */
+#define	LONG_MIN	(-2147483647L-1) /* min value for a long */
+#endif /* __LP64__ */
+
+#define	ULLONG_MAX	0xffffffffffffffffULL	/* max unsigned long long */
+#define	LLONG_MAX	0x7fffffffffffffffLL	/* max signed long long */
+#define	LLONG_MIN	(-0x7fffffffffffffffLL-1) /* min signed long long */
+
+#if !defined(_ANSI_SOURCE)
+#define	SSIZE_MAX	LONG_MAX	/* max value for a ssize_t */
+
+#if !defined(_POSIX_C_SOURCE) && !defined(_XOPEN_SOURCE)
+#define	SIZE_T_MAX	ULONG_MAX	/* max value for a size_t */
+
+#define	UQUAD_MAX	ULLONG_MAX
+#define	QUAD_MAX	LLONG_MAX
+#define	QUAD_MIN	LLONG_MIN
+
+#endif /* !_POSIX_C_SOURCE && !_XOPEN_SOURCE */
+#endif /* !_ANSI_SOURCE */
+
+#if (!defined(_ANSI_SOURCE)&&!defined(_POSIX_C_SOURCE)) || defined(_XOPEN_SOURCE)
+#ifdef __LP64__
+#define LONG_BIT	64
+#else /* !__LP64__ */
+#define LONG_BIT	32
+#endif /* __LP64__ */
+#define WORD_BIT	32
+#endif /* (!(_ANSI_SOURCE) && !(_POSIX_C_SOURCE)) || (_XOPEN_SOURCE) */
+
+#endif /* _PPC_LIMITS_H_ */
diff -urN cctools-806-old/include/foreign/ppc/param.h cctools-806/include/foreign/ppc/param.h
--- cctools-806-old/include/foreign/ppc/param.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/ppc/param.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,133 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1993,1995 NeXT Computer, Inc. All Rights Reserved */
+
+#ifndef	_PPC_PARAM_H_
+#define	_PPC_PARAM_H_
+
+/*
+ * Round p (pointer or byte index) up to a correctly-aligned value for all
+ * data types (int, long, ...).   The result is unsigned int and must be
+ * cast to any desired pointer type.
+ */
+#define	ALIGNBYTES	3
+#define	ALIGN(p)	(((unsigned int)(p) + ALIGNBYTES) &~ ALIGNBYTES)
+
+#define	NBPG		4096		/* bytes/page */
+#define	PGOFSET		(NBPG-1)	/* byte offset into page */
+#define	PGSHIFT		12		/* LOG2(NBPG) */
+
+#define NBSEG		0x40000000	/* bytes/segment (quadrant) */
+#define	SEGOFSET	(NBSEG-1)	/* byte offset into segment */
+#define	SEGSHIFT	30		/* LOG2(NBSEG) */
+
+#define	DEV_BSIZE	512
+#define	DEV_BSHIFT	9		/* log2(DEV_BSIZE) */
+#define BLKDEV_IOSIZE	2048
+#define	MAXPHYS		(128 * 1024)	/* max raw I/O transfer size */
+
+#define	STACK_GROWTH_UP	0		/* stack grows to lower addresses */
+
+#define	CLSIZE		1
+#define	CLSIZELOG2	0
+
+#define STACKSIZE 4			/* pages in kernel stack */
+#define	UPAGES	0	/* total pages in u-area */
+					/* red zone is beyond this */
+
+/*
+ * Constants related to network buffer management.
+ * MCLBYTES must be no larger than CLBYTES (the software page size), and,
+ * on machines that exchange pages of input or output buffers with mbuf
+ * clusters (MAPPED_MBUFS), MCLBYTES must also be an integral multiple
+ * of the hardware page size.
+ */
+#define	MSIZE		256		/* size of an mbuf */
+#define	MCLBYTES	2048		/* large enough for ether MTU */
+#define	MCLSHIFT	11
+#define	MCLOFSET	(MCLBYTES - 1)
+#ifndef NMBCLUSTERS
+#if GATEWAY
+#define	NMBCLUSTERS	((1024 * 1024) / MCLBYTES)	/* cl map size: 1MB */
+#else
+#define	NMBCLUSTERS	((1024 * 1024) / MCLBYTES)	
+		/* cl map size was  0.5MB when MSIZE was 128, now it's 1MB*/
+#endif
+#endif
+
+/* pages ("clicks") (NBPG bytes) to disk blocks */
+#define	ctod(x)	((x)<<(PGSHIFT-DEV_BSHIFT))
+#define	dtoc(x)	((x)>>(PGSHIFT-DEV_BSHIFT))
+#define	dtob(x)	((x)<<DEV_BSHIFT)
+
+/* pages to bytes */
+#define	ctob(x)	((x)<<PGSHIFT)
+
+/* bytes to pages */
+#define	btoc(x)	(((unsigned)(x)+(PGOFSET))>>PGSHIFT)
+#ifdef __APPLE__
+#define  btodb(bytes, devBlockSize)         \
+        ((unsigned)(bytes) / devBlockSize)
+#define  dbtob(db, devBlockSize)            \
+             ((unsigned)(db) * devBlockSize)
+#else
+#define	btodb(bytes)	 		/* calculates (bytes / DEV_BSIZE) */ \
+	((unsigned)(bytes) >> DEV_BSHIFT)
+#define	dbtob(db)			/* calculates (db * DEV_BSIZE) */ \
+	((unsigned)(db) << DEV_BSHIFT)
+#endif
+
+/*
+ * Map a ``block device block'' to a file system block.
+ * This should be device dependent, and should use the bsize
+ * field from the disk label.
+ * For now though just use DEV_BSIZE.
+ */
+#define	bdbtofsb(bn)	((bn) / (BLKDEV_IOSIZE/DEV_BSIZE))
+
+/* from machdep/ppc/proc_reg.h */
+#ifdef __BIG_ENDIAN__
+#define ENDIAN_MASK(val,size) (1 << (size-1 - val))
+#else
+#error code not ported to little endian targets yet
+#endif /* __BIG_ENDIAN__ */
+
+#ifndef MASK
+#define MASK(PART)	ENDIAN_MASK(PART ## _BIT, 32)
+#endif
+
+#define	MSR_EE_BIT	16
+#define	MSR_PR_BIT	17
+#define USERMODE(msr) (msr & MASK(MSR_PR) ? TRUE : FALSE)
+#define BASEPRI(msr) (msr & MASK(MSR_EE) ? TRUE : FALSE)
+/* end of from proc_reg.h */
+
+#if	defined(KERNEL) || defined(STANDALONE)
+#define	DELAY(n) delay(n)
+#else
+#define	DELAY(n)	{ register int N = (n); while (--N > 0); }
+#endif	/* defined(KERNEL) || defined(STANDALONE) */
+
+#define	NPIDS		16	/* maximum number of PIDs per process */
+#define	NIOPIDS		8	/* maximum number of IO space PIDs */
+
+#endif	/* _PPC_PARAM_H_ */
diff -urN cctools-806-old/include/foreign/ppc/profile.h cctools-806/include/foreign/ppc/profile.h
--- cctools-806-old/include/foreign/ppc/profile.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/ppc/profile.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,33 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1997, Apple Computer, Inc. All rights reserved.
+ *
+ */
+
+#ifndef _BSD_PPC_PROFILE_H_
+#define _BSD_PPC_PROFILE_H_
+
+#include <sys/appleapiopts.h>
+
+
+#endif /* _BSD_PPC_PROFILE_H_ */
diff -urN cctools-806-old/include/foreign/ppc/setjmp.h cctools-806/include/foreign/ppc/setjmp.h
--- cctools-806-old/include/foreign/ppc/setjmp.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/ppc/setjmp.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,102 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1998 Apple Computer, Inc.  All rights reserved.
+ *
+ *	File:	ppc/setjmp.h
+ *
+ *	Declaration of setjmp routines and data structures.
+ */
+#ifndef _BSD_PPC_SETJMP_H_
+#define _BSD_PPC_SETJMP_H_
+
+#include <sys/cdefs.h>
+#include <machine/signal.h>
+
+struct _jmp_buf {
+	struct sigcontext	sigcontext; /* kernel state preserved by set/longjmp */
+	unsigned int vmask __attribute__((aligned(8))); /* vector mask register */
+	unsigned int vreg[32 * 4] __attribute__((aligned(16)));
+		/* 32 128-bit vector registers */
+};
+
+/*
+ *	_JBLEN is number of ints required to save the following:
+ *	r1, r2, r13-r31, lr, cr, ctr, xer, sig  == 26 register_t sized
+ *	fr14 -  fr31 = 18 doubles
+ *	vmask, 32 vector registers = 129 ints
+ *	2 ints to get all the elements aligned 
+ *
+ *	register_t is 2 ints for ppc64 threads
+ */
+#define _JBLEN64	(26*2 + 18*2 + 129 + 1)
+#define _JBLEN32	(26 + 18*2 + 129 + 1)
+#define _JBLEN_MAX	_JBLEN64
+
+/*
+ * Locally scoped sizes
+ */
+#if defined(__ppc64__)
+#define _JBLEN _JBLEN64
+#else
+#define _JBLEN _JBLEN32
+#endif
+
+#if defined(KERNEL)
+typedef struct sigcontext32 jmp_buf32[1];
+typedef struct __sigjmp_buf32 {
+		int __storage[_JBLEN32 + 1] __attribute__((aligned(8)));
+		} sigjmp_buf32[1];
+
+typedef struct sigcontext64 jmp_buf64[1];
+typedef struct __sigjmp_buf64 {
+		int __storage[_JBLEN64 + 1] __attribute__((aligned(8)));
+		} sigjmp_buf64[1];
+
+/*
+ * JMM - have to decide how the kernel will deal with this.
+ * For now, hard-code the 32-bit types.
+ */
+typedef struct sigcontext32 jmp_buf[1];
+typedef struct __sigjmp_buf32 sigjmp_buf[1];
+
+#else
+typedef int jmp_buf[_JBLEN];
+typedef int sigjmp_buf[_JBLEN + 1];
+#endif
+
+__BEGIN_DECLS
+extern int setjmp(jmp_buf env);
+extern void longjmp(jmp_buf env, int val);
+
+#ifndef _ANSI_SOURCE
+int	_setjmp(jmp_buf env);
+void	_longjmp(jmp_buf, int val);
+int sigsetjmp(sigjmp_buf env, int val);
+void siglongjmp(sigjmp_buf env, int val);
+#endif /* _ANSI_SOURCE  */
+
+#if !defined(_ANSI_SOURCE) && !defined(_POSIX_C_SOURCE)
+void	longjmperror(void);
+#endif /* neither ANSI nor POSIX */
+__END_DECLS
+
+#endif /* !_BSD_PPC_SETJMP_H_ */
diff -urN cctools-806-old/include/foreign/ppc/signal.h cctools-806/include/foreign/ppc/signal.h
--- cctools-806-old/include/foreign/ppc/signal.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/ppc/signal.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,100 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992, 1993 NeXT Computer, Inc.
+ */
+
+#ifndef	_PPC_SIGNAL_
+#define	_PPC_SIGNAL_ 1
+
+#include <sys/appleapiopts.h>
+
+#ifdef __APPLE_API_OBSOLETE
+typedef int sig_atomic_t; 
+
+/*
+ * Machine-dependant flags used in sigvec call.
+ */
+#define	SV_SAVE_REGS	0x1000	/* Save all regs in sigcontext */
+
+/*
+ * regs_saved_t -- Describes which registers beyond what the kernel cares
+ *		   about are saved to and restored from this sigcontext.
+ *
+ * The default is REGS_SAVED_CALLER, only the caller saved registers
+ * are saved.  If the SV_SAVE_REGS flag was set when the signal
+ * handler was registered with sigvec() then all the registers will be
+ * saved in the sigcontext, and REGS_SAVED_ALL will be set.  The C
+ * library uses REGS_SAVED_NONE in order to quickly restore kernel
+ * state during a longjmp().
+ */
+typedef enum {
+	REGS_SAVED_NONE,		/* Only kernel managed regs restored */
+	REGS_SAVED_CALLER,		/* "Caller saved" regs: rpc, a0-a7,
+					   t0-t4, at, lk0-lk1, xt1-xt20,
+					   xr0-xr1 */
+	REGS_SAVED_ALL			/* All registers */
+} regs_saved_t;
+
+
+/*
+ * Information pushed on stack when a signal is delivered.
+ * This is used by the kernel to restore state following
+ * execution of the signal handler.  It is also made available
+ * to the handler to allow it to properly restore state if
+ * a non-standard exit is performed.
+ */
+struct sigcontext32 {
+    int		sc_onstack;     /* sigstack state to restore */
+    int		sc_mask;        /* signal mask to restore */
+    int		sc_ir;			/* pc */
+    int		sc_psw;         /* processor status word */
+    int		sc_sp;      	/* stack pointer if sc_regs == NULL */
+    void	*sc_regs;		/* (kernel private) saved state */
+};
+
+struct sigcontext64 {
+    int		sc_onstack;     /* sigstack state to restore */
+    int		sc_mask;        /* signal mask to restore */
+    long long	sc_ir;		/* pc */
+    long long	sc_psw;         /* processor status word */
+    long long	sc_sp;      	/* stack pointer if sc_regs == NULL */
+    void	*sc_regs;	/* (kernel private) saved state */
+};
+
+/*
+ * LP64todo - Have to decide how to handle this.
+ * For now, just duplicate the 32-bit context as the generic one.
+ */
+struct sigcontext {
+    int		sc_onstack;     /* sigstack state to restore */
+    int		sc_mask;        /* signal mask to restore */
+    int		sc_ir;			/* pc */
+    int		sc_psw;         /* processor status word */
+    int		sc_sp;      	/* stack pointer if sc_regs == NULL */
+    void	*sc_regs;		/* (kernel private) saved state */
+};
+
+#endif /* __APPLE_API_OBSOLETE */
+
+#endif /* _PPC_SIGNAL_ */
+
diff -urN cctools-806-old/include/foreign/ppc/_types.h cctools-806/include/foreign/ppc/_types.h
--- cctools-806-old/include/foreign/ppc/_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/ppc/_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,116 @@
+/*
+ * Copyright (c) 2000-2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+#ifndef	_BSD_PPC__TYPES_H_
+#define	_BSD_PPC__TYPES_H_
+
+/*
+ * This header file contains integer types.  It's intended to also contain
+ * flotaing point and other arithmetic types, as needed, later.
+ */
+
+#ifdef __GNUC__
+typedef __signed char		__int8_t;
+#else	/* !__GNUC__ */
+typedef char			__int8_t;
+#endif	/* !__GNUC__ */
+typedef unsigned char		__uint8_t;
+typedef	short			__int16_t;
+typedef	unsigned short		__uint16_t;
+typedef int			__int32_t;
+typedef unsigned int		__uint32_t;
+typedef long long		__int64_t;
+typedef unsigned long long	__uint64_t;
+
+typedef long			__darwin_intptr_t;
+typedef unsigned int		__darwin_natural_t;
+
+/*
+ * The rune type below is declared to be an ``int'' instead of the more natural
+ * ``unsigned long'' or ``long''.  Two things are happening here.  It is not
+ * unsigned so that EOF (-1) can be naturally assigned to it and used.  Also,
+ * it looks like 10646 will be a 31 bit standard.  This means that if your
+ * ints cannot hold 32 bits, you will be in trouble.  The reason an int was
+ * chosen over a long is that the is*() and to*() routines take ints (says
+ * ANSI C), but they use __darwin_ct_rune_t instead of int.  By changing it
+ * here, you lose a bit of ANSI conformance, but your programs will still
+ * work.
+ *
+ * NOTE: rune_t is not covered by ANSI nor other standards, and should not
+ * be instantiated outside of lib/libc/locale.  Use wchar_t.  wchar_t and
+ * rune_t must be the same type.  Also wint_t must be no narrower than
+ * wchar_t, and should also be able to hold all members of the largest
+ * character set plus one extra value (WEOF). wint_t must be at least 16 bits.
+ */
+
+typedef int			__darwin_ct_rune_t;	/* ct_rune_t */
+
+/*
+ * mbstate_t is an opaque object to keep conversion state, during multibyte
+ * stream conversions.  The content must not be referenced by user programs.
+ */
+#ifdef __APPLE__
+typedef union {
+	char		__mbstate8[128];
+	long long	_mbstateL;			/* for alignment */
+} __mbstate_t;
+#endif
+
+typedef __mbstate_t		__darwin_mbstate_t;	/* mbstate_t */
+
+#if defined(__GNUC__) && defined(__PTRDIFF_TYPE__)
+typedef __PTRDIFF_TYPE__	__darwin_ptrdiff_t;	/* ptr1 - ptr2 */
+#else
+typedef int			__darwin_ptrdiff_t;	/* ptr1 - ptr2 */
+#endif /* __GNUC__ */
+
+#if defined(__GNUC__) && defined(__SIZE_TYPE__)
+typedef __SIZE_TYPE__		__darwin_size_t;	/* sizeof() */
+#else
+typedef unsigned long		__darwin_size_t;	/* sizeof() */
+#endif
+
+#if (__GNUC__ > 2)
+typedef __builtin_va_list	__darwin_va_list;	/* va_list */
+#else
+typedef char *			__darwin_va_list;	/* va_list */
+#endif
+
+#if defined(__GNUC__) && defined(__WCHAR_TYPE__)
+typedef __WCHAR_TYPE__		__darwin_wchar_t;	/* wchar_t */
+#else
+typedef __darwin_ct_rune_t	__darwin_wchar_t;	/* wchar_t */
+#endif
+
+typedef __darwin_wchar_t	__darwin_rune_t;	/* rune_t */
+
+#if defined(__GNUC__) && defined(__WINT_TYPE__)
+typedef __WINT_TYPE__		__darwin_wint_t;	/* wint_t */
+#else
+typedef __darwin_ct_rune_t	__darwin_wint_t;	/* wint_t */
+#endif
+
+typedef unsigned long		__darwin_clock_t;	/* clock() */
+typedef __uint32_t		__darwin_socklen_t;	/* socklen_t (duh) */
+typedef long			__darwin_ssize_t;	/* byte count or error */
+typedef long			__darwin_time_t;	/* time() */
+
+#endif	/* _BSD_PPC__TYPES_H_ */
diff -urN cctools-806-old/include/foreign/ppc/types.h cctools-806/include/foreign/ppc/types.h
--- cctools-806-old/include/foreign/ppc/types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/ppc/types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,129 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright 1995 NeXT Computer, Inc. All rights reserved.
+ */
+/*-
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)types.h	8.3 (Berkeley) 1/5/94
+ */
+
+#ifndef	_MACHTYPES_H_
+#define	_MACHTYPES_H_
+
+#ifndef __ASSEMBLER__
+#include <ppc/_types.h>
+#include <sys/cdefs.h>
+/*
+ * Basic integral types.  Omit the typedef if
+ * not possible for a machine/compiler combination.
+ */
+#ifndef _INT8_T
+#define _INT8_T
+typedef	__signed char		int8_t;
+#endif
+typedef	unsigned char		u_int8_t;
+#ifndef _INT16_T
+#define _INT16_T
+typedef	short			int16_t;
+#endif
+typedef	unsigned short		u_int16_t;
+#ifndef _INT32_T
+#define _INT32_T
+typedef	int			int32_t;
+#endif
+typedef	unsigned int		u_int32_t;
+#ifndef _INT64_T
+#define _INT64_T
+typedef	long long		int64_t;
+#endif
+typedef	unsigned long long	u_int64_t;
+
+#if defined(__ppc64__)
+typedef int64_t			register_t;
+#else
+typedef int32_t			register_t;
+#endif
+
+#ifndef _INTPTR_T
+#define _INTPTR_T
+typedef __darwin_intptr_t	intptr_t;
+#endif
+#ifndef _UINTPTR_T
+#define _UINTPTR_T
+typedef unsigned long		uintptr_t;
+#endif
+
+/* with LP64 support pointers and longs from user address space may vary */
+/* in size depending on the type of process (currently 32 or 64-bit, but */
+/* may change in the future).  These types are used for  reserving the largest */
+/* possible size. */
+// LP64todo - typedef mach_vm_address_t	user_addr_t;	/* varying length pointers from user space */ 
+// LP64todo - typedef mach_vm_size_t		user_size_t;	/* varying length values from user space (unsigned) */
+typedef u_int64_t	user_addr_t;	
+typedef u_int64_t	user_size_t;	
+typedef int64_t		user_ssize_t;	
+typedef int64_t		user_long_t;
+typedef u_int64_t	user_ulong_t;
+typedef int64_t		user_time_t;
+#define USER_ADDR_NULL	((user_addr_t) 0)
+#define CAST_USER_ADDR_T(a_ptr)   ((user_addr_t)((uintptr_t)(a_ptr)))
+
+/* This defines the size of syscall arguments after copying into the kernel: */
+typedef u_int64_t	syscall_arg_t;
+
+#ifndef __offsetof
+#define __offsetof(type, field) ((size_t)(&((type *)0)->field))
+#endif
+
+#endif /* __ASSEMBLER__ */
+#endif	/* _MACHTYPES_H_ */
diff -urN cctools-806-old/include/foreign/ppc/ucontext.h cctools-806/include/foreign/ppc/ucontext.h
--- cctools-806-old/include/foreign/ppc/ucontext.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/ppc/ucontext.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,67 @@
+/*
+ * Copyright (c) 2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _PPC_UCONTEXT_H_
+#define _PPC_UCONTEXT_H_
+
+
+#include <mach/ppc/_types.h>
+
+#ifndef _POSIX_C_SOURCE
+struct mcontext {
+	struct ppc_exception_state	es;
+	struct ppc_thread_state		ss;
+	struct ppc_float_state		fs;
+	struct ppc_vector_state		vs;
+};
+#define PPC_MCONTEXT_SIZE	(PPC_THREAD_STATE_COUNT + PPC_FLOAT_STATE_COUNT + PPC_EXCEPTION_STATE_COUNT + PPC_VECTOR_STATE_COUNT) * sizeof(int)
+#else /* _POSIX_C_SOURCE */
+struct __darwin_mcontext {
+	struct __darwin_ppc_exception_state	es;
+	struct __darwin_ppc_thread_state	ss;
+	struct __darwin_ppc_float_state		fs;
+	struct __darwin_ppc_vector_state	vs;
+};
+#endif /* _POSIX_C_SOURCE */
+
+#ifndef _MCONTEXT_T
+#define _MCONTEXT_T
+typedef __darwin_mcontext_t		mcontext_t;
+#endif
+
+#ifndef _POSIX_C_SOURCE
+struct mcontext64 {
+	struct ppc_exception_state64	es;
+	struct ppc_thread_state64	ss;
+	struct ppc_float_state		fs;
+	struct ppc_vector_state		vs;
+};
+#define PPC_MCONTEXT64_SIZE	(PPC_THREAD_STATE64_COUNT + PPC_FLOAT_STATE_COUNT + PPC_EXCEPTION_STATE_COUNT + PPC_VECTOR_STATE_COUNT) * sizeof(int)
+
+#ifndef _MCONTEXT64_T
+#define _MCONTEXT64_T
+typedef struct mcontext64  * mcontext64_t;
+#endif
+
+#endif /* _POSIX_C_SOURCE */
+
+#endif /* _PPC_UCONTEXT_H_ */
diff -urN cctools-806-old/include/foreign/ppc/vmparam.h cctools-806/include/foreign/ppc/vmparam.h
--- cctools-806-old/include/foreign/ppc/vmparam.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/ppc/vmparam.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,58 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef	_BSD_PPC_VMPARAM_H_
+#define	_BSD_PPC_VMPARAM_H_ 1
+
+#include <sys/resource.h>
+
+#define	USRSTACK	(0xc0000000)
+
+/* 
+ * put the default 64-bit stack at the max address
+ * (minus one 32-bit address space for other incidentals)
+ */
+#define	USRSTACK64	(MACH_VM_MAX_ADDRESS - VM_MAX_ADDRESS)
+
+/*
+ * Virtual memory related constants, all in bytes
+ */
+#ifndef DFLDSIZ
+#define	DFLDSIZ		(6*1024*1024)		/* initial data size limit */
+#endif
+#ifndef MAXDSIZ
+#define	MAXDSIZ		(RLIM_INFINITY)		/* max data size */
+#endif
+#ifndef	DFLSSIZ
+#define	DFLSSIZ		(8*1024*1024)		/* initial stack size limit */
+#endif
+#ifndef	MAXSSIZ
+#define	MAXSSIZ		(64*1024*1024)		/* max stack size */
+#endif
+#ifndef	DFLCSIZ
+#define DFLCSIZ		(0)			/* initial core size limit */
+#endif
+#ifndef	MAXCSIZ
+#define MAXCSIZ		(RLIM_INFINITY)		/* max core size */
+#endif
+
+#endif	/* _BSD_PPC_VMPARAM_H_ */
diff -urN cctools-806-old/include/foreign/sys/attr.h cctools-806/include/foreign/sys/attr.h
--- cctools-806-old/include/foreign/sys/attr.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/sys/attr.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,25 @@
+#ifndef _SYS_ATTR_H_
+#define _SYS_ATTR_H_
+
+#include <sys/types.h>
+#include <stdint.h>
+
+typedef u_int32_t attrgroup_t;
+struct attrlist {
+  u_short bitmapcount;                    /* number of attr. bit sets in list (should be 5) */
+  u_int16_t reserved;                             /* (to maintain 4-byte alignment) */
+  attrgroup_t commonattr;                 /* common attribute group */
+  attrgroup_t volattr;                    /* Volume attribute group */
+  attrgroup_t dirattr;                    /* directory attribute group */
+  attrgroup_t fileattr;                   /* file attribute group */
+  attrgroup_t forkattr;                   /* fork attribute group */
+};
+#define ATTR_BIT_MAP_COUNT 5
+
+#define ATTR_CMN_FNDRINFO 1
+#define ATTR_FILE_DATALENGTH 2
+#define ATTR_FILE_RSRCLENGTH 4
+
+int    getattrlist(const char*,void*,void*,size_t,unsigned int);
+
+#endif
diff -urN cctools-806-old/include/foreign/uuid/uuid.h cctools-806/include/foreign/uuid/uuid.h
--- cctools-806-old/include/foreign/uuid/uuid.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/foreign/uuid/uuid.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,78 @@
+/*
+ * Public include file for the UUID library
+ * 
+ * Copyright (C) 1996, 1997, 1998 Theodore Ts'o.
+ *
+ * %Begin-Header%
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, and the entire permission notice in its entirety,
+ *    including the disclaimer of warranties.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. The name of the author may not be used to endorse or promote
+ *    products derived from this software without specific prior
+ *    written permission.
+ * 
+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESS OR IMPLIED
+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE, ALL OF
+ * WHICH ARE HEREBY DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR BE
+ * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
+ * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT
+ * OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
+ * BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
+ * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
+ * USE OF THIS SOFTWARE, EVEN IF NOT ADVISED OF THE POSSIBILITY OF SUCH
+ * DAMAGE.
+ * %End-Header%
+ */
+
+#ifndef _UUID_UUID_H
+#define _UUID_UUID_H
+
+#ifdef __APPLE__
+#include <sys/_types.h>
+#else
+typedef unsigned char   __darwin_uuid_t[16];
+#endif
+
+#ifndef _UUID_T
+#define _UUID_T
+typedef __darwin_uuid_t	uuid_t;
+#endif /* _UUID_T */
+
+#define UUID_DEFINE(name,u0,u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,u13,u14,u15) \
+	static const uuid_t name __attribute__ ((unused)) = {u0,u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,u13,u14,u15}
+
+#ifdef __cplusplus
+extern "C" {
+#endif
+
+void uuid_clear(uuid_t uu);
+
+int uuid_compare(const uuid_t uu1, const uuid_t uu2);
+
+void uuid_copy(uuid_t dst, const uuid_t src);
+
+void uuid_generate(uuid_t out);
+void uuid_generate_random(uuid_t out);
+void uuid_generate_time(uuid_t out);
+
+int uuid_is_null(const uuid_t uu);
+
+int uuid_parse(const char *in, uuid_t uu);
+
+void uuid_unparse(const uuid_t uu, char *out);
+void uuid_unparse_lower(const uuid_t uu, char *out);
+void uuid_unparse_upper(const uuid_t uu, char *out);
+
+#ifdef __cplusplus
+}
+#endif
+
+#endif /* _UUID_UUID_H */
diff -urN cctools-806-old/include/i386/eflags.h cctools-806/include/i386/eflags.h
--- cctools-806-old/include/i386/eflags.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/eflags.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,94 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_I386_EFLAGS_H_
+#define	_I386_EFLAGS_H_
+
+/*
+ *	i386 flags register
+ */
+
+#ifndef EFL_CF
+#define	EFL_CF		0x00000001		/* carry */
+#define	EFL_PF		0x00000004		/* parity of low 8 bits */
+#define	EFL_AF		0x00000010		/* carry out of bit 3 */
+#define	EFL_ZF		0x00000040		/* zero */
+#define	EFL_SF		0x00000080		/* sign */
+#define	EFL_TF		0x00000100		/* trace trap */
+#define	EFL_IF		0x00000200		/* interrupt enable */
+#define	EFL_DF		0x00000400		/* direction */
+#define	EFL_OF		0x00000800		/* overflow */
+#define	EFL_IOPL	0x00003000		/* IO privilege level: */
+#define	EFL_IOPL_KERNEL	0x00000000			/* kernel */
+#define	EFL_IOPL_USER	0x00003000			/* user */
+#define	EFL_NT		0x00004000		/* nested task */
+#define	EFL_RF		0x00010000		/* resume without tracing */
+#define	EFL_VM		0x00020000		/* virtual 8086 mode */
+#define EFL_AC		0x00040000		/* alignment check */
+#define EFL_VIF		0x00080000		/* virtual interrupt flag */
+#define EFL_VIP		0x00100000		/* virtual interrupt pending */
+#define EFL_ID		0x00200000		/* cpuID instruction */
+#endif
+
+#define EFL_CLR		0xfff88028
+#define EFL_SET		0x00000002
+
+#define	EFL_USER_SET	(EFL_IF)
+#define	EFL_USER_CLEAR	(EFL_IOPL|EFL_NT|EFL_RF)
+
+#endif	/* _I386_EFLAGS_H_ */
diff -urN cctools-806-old/include/i386/endian.h cctools-806/include/i386/endian.h
--- cctools-806-old/include/i386/endian.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/endian.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,102 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright 1995 NeXT Computer, Inc. All rights reserved.
+ */
+/*
+ * Copyright (c) 1987, 1991, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)endian.h	8.1 (Berkeley) 6/11/93
+ */
+
+#ifndef _I386__ENDIAN_H_
+#define	_I386__ENDIAN_H_
+
+#include <sys/cdefs.h>
+/*
+ * Define _NOQUAD if the compiler does NOT support 64-bit integers.
+ */
+/* #define _NOQUAD */
+
+/*
+ * Define the order of 32-bit words in 64-bit words.
+ */
+#define _QUAD_HIGHWORD 1
+#define _QUAD_LOWWORD 0
+
+/*
+ * Definitions for byte order, according to byte significance from low
+ * address to high.
+ */
+#define	__DARWIN_LITTLE_ENDIAN	1234	/* LSB first: i386, vax */
+#define	__DARWIN_BIG_ENDIAN	4321	/* MSB first: 68000, ibm, net */
+#define	__DARWIN_PDP_ENDIAN	3412	/* LSB first in word, MSW first in long */
+
+#define	__DARWIN_BYTE_ORDER	__DARWIN_LITTLE_ENDIAN
+
+#if	defined(KERNEL) || (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+
+#define	LITTLE_ENDIAN	__DARWIN_LITTLE_ENDIAN
+#define	BIG_ENDIAN	__DARWIN_BIG_ENDIAN
+#define	PDP_ENDIAN	__DARWIN_PDP_ENDIAN
+
+#define	BYTE_ORDER	__DARWIN_BYTE_ORDER
+
+#include <sys/_endian.h>
+
+#endif /* defined(KERNEL) || (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)) */
+#endif /* !_I386__ENDIAN_H_ */
diff -urN cctools-806-old/include/i386/fasttrap_isa.h cctools-806/include/i386/fasttrap_isa.h
--- cctools-806-old/include/i386/fasttrap_isa.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/fasttrap_isa.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,116 @@
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License (the "License").
+ * You may not use this file except in compliance with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+/*
+ * Copyright 2006 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef	_FASTTRAP_ISA_H
+#define	_FASTTRAP_ISA_H
+
+/*
+ * #pragma ident	"@(#)fasttrap_isa.h	1.6	06/09/19 SMI"
+ */
+
+#include <sys/types.h>
+#include <stdint.h>
+
+#ifdef	__cplusplus
+extern "C" {
+#endif
+
+#define	FASTTRAP_MAX_INSTR_SIZE		15
+
+#define	FASTTRAP_INSTR			0xcc
+
+#define	FASTTRAP_SUNWDTRACE_SIZE	64
+
+typedef	uint8_t		fasttrap_instr_t;
+
+typedef struct fasttrap_machtp {
+	uint8_t		ftmt_instr[FASTTRAP_MAX_INSTR_SIZE]; /* orig. instr. */
+	uint8_t		ftmt_size;	/* instruction size */
+#if __sol64 || defined(__APPLE__)
+	uint8_t		ftmt_ripmode;	/* %rip-relative handling mode */
+	uint8_t		ftmt_modrm;	/* saved modrm byte */
+#endif
+	uint8_t		ftmt_type;	/* emulation type */
+	uint8_t		ftmt_code;	/* branch condition */
+	uint8_t		ftmt_base;	/* branch base */
+	uint8_t		ftmt_index;	/* branch index */
+	uint8_t		ftmt_scale;	/* branch scale */
+	uint8_t		ftmt_segment;	/* segment for memory accesses */
+	user_addr_t	ftmt_dest;	/* destination of control flow */
+} fasttrap_machtp_t;
+
+#define	ftt_instr	ftt_mtp.ftmt_instr
+#if __sol64 || defined(__APPLE__)
+#define	ftt_ripmode	ftt_mtp.ftmt_ripmode
+#define	ftt_modrm	ftt_mtp.ftmt_modrm
+#endif
+#define	ftt_size	ftt_mtp.ftmt_size
+#define	ftt_type	ftt_mtp.ftmt_type
+#define	ftt_code	ftt_mtp.ftmt_code
+#define	ftt_base	ftt_mtp.ftmt_base
+#define	ftt_index	ftt_mtp.ftmt_index
+#define	ftt_scale	ftt_mtp.ftmt_scale
+#define	ftt_segment	ftt_mtp.ftmt_segment
+#define	ftt_dest	ftt_mtp.ftmt_dest
+
+#define	FASTTRAP_T_COMMON	0x00	/* common case -- no emulation */
+#define	FASTTRAP_T_JCC		0x01	/* near and far conditional jumps */
+#define	FASTTRAP_T_LOOP		0x02	/* loop instructions */
+#define	FASTTRAP_T_JCXZ		0x03	/* jump if %ecx/%rcx is zero */
+#define	FASTTRAP_T_JMP		0x04	/* relative jump */
+#define	FASTTRAP_T_CALL		0x05	/* near call (and link) */
+#define	FASTTRAP_T_RET		0x06	/* ret */
+#define	FASTTRAP_T_RET16	0x07	/* ret <imm16> */
+
+/*
+ * For performance rather than correctness.
+ */
+#define	FASTTRAP_T_PUSHL_EBP	0x10	/* pushl %ebp (for function entry) */
+#define	FASTTRAP_T_NOP		0x11	/* nop */
+
+#define	FASTTRAP_RIP_1		0x1
+#define	FASTTRAP_RIP_2		0x2
+#define	FASTTRAP_RIP_X		0x4
+
+/*
+ * Segment values.
+ */
+#define	FASTTRAP_SEG_NONE		0
+#define	FASTTRAP_SEG_CS			1
+#define	FASTTRAP_SEG_DS			2
+#define	FASTTRAP_SEG_ES			3
+#define	FASTTRAP_SEG_FS			4
+#define	FASTTRAP_SEG_GS			5
+#define	FASTTRAP_SEG_SS			6
+
+#define	FASTTRAP_RETURN_AFRAMES		6	
+#define	FASTTRAP_ENTRY_AFRAMES		5
+#define	FASTTRAP_OFFSET_AFRAMES		5
+
+#ifdef	__cplusplus
+}
+#endif
+
+#endif	/* _FASTTRAP_ISA_H */
diff -urN cctools-806-old/include/i386/_limits.h cctools-806/include/i386/_limits.h
--- cctools-806-old/include/i386/_limits.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/_limits.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,27 @@
+/*
+ * Copyright (c) 2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+#ifndef	_I386__LIMITS_H_
+#define	_I386__LIMITS_H_
+
+#define	__DARWIN_CLK_TCK		100	/* ticks per second */
+
+#endif	/* _I386__LIMITS_H_ */
diff -urN cctools-806-old/include/i386/limits.h cctools-806/include/i386/limits.h
--- cctools-806-old/include/i386/limits.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/limits.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,107 @@
+/*
+ * Copyright (c) 1988, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)limits.h	8.3 (Berkeley) 1/4/94
+ */
+
+#ifndef _I386_LIMITS_H_
+#define _I386_LIMITS_H_
+
+#include <sys/cdefs.h>
+#include <i386/_limits.h>
+
+#define	CHAR_BIT	8		/* number of bits in a char */
+#define	MB_LEN_MAX	6		/* Allow 31 bit UTF2 */
+
+#if !defined(_ANSI_SOURCE) && (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+#define	CLK_TCK		__DARWIN_CLK_TCK	/* ticks per second */
+#endif /* !_ANSI_SOURCE && (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/*
+ * According to ANSI (section 2.2.4.2), the values below must be usable by
+ * #if preprocessing directives.  Additionally, the expression must have the
+ * same type as would an expression that is an object of the corresponding
+ * type converted according to the integral promotions.  The subtraction for
+ * INT_MIN and LONG_MIN is so the value is not unsigned; 2147483648 is an
+ * unsigned int for 32-bit two's complement ANSI compilers (section 3.1.3.2).
+ * These numbers work for pcc as well.  The UINT_MAX and ULONG_MAX values
+ * are written as hex so that GCC will be quiet about large integer constants.
+ */
+#define	SCHAR_MAX	127		/* min value for a signed char */
+#define	SCHAR_MIN	(-128)		/* max value for a signed char */
+
+#define	UCHAR_MAX	255		/* max value for an unsigned char */
+#define	CHAR_MAX	127		/* max value for a char */
+#define	CHAR_MIN	(-128)		/* min value for a char */
+
+#define	USHRT_MAX	65535		/* max value for an unsigned short */
+#define	SHRT_MAX	32767		/* max value for a short */
+#define	SHRT_MIN	(-32768)	/* min value for a short */
+
+#define	UINT_MAX	0xffffffff	/* max value for an unsigned int */
+#define	INT_MAX		2147483647	/* max value for an int */
+#define	INT_MIN		(-2147483647-1)	/* min value for an int */
+
+#ifdef __LP64__
+#define	ULONG_MAX	0xffffffffffffffffUL	/* max unsigned long */
+#define	LONG_MAX	0x7fffffffffffffffL	/* max signed long */
+#define	LONG_MIN	(-0x7fffffffffffffffL-1) /* min signed long */
+#else /* !__LP64__ */
+#define	ULONG_MAX	0xffffffffUL	/* max unsigned long */
+#define	LONG_MAX	2147483647L	/* max signed long */
+#define	LONG_MIN	(-2147483647L-1) /* min signed long */
+#endif /* __LP64__ */
+
+#define	ULLONG_MAX	0xffffffffffffffffULL	/* max unsigned long long */
+#define	LLONG_MAX	0x7fffffffffffffffLL	/* max signed long long */
+#define	LLONG_MIN	(-0x7fffffffffffffffLL-1) /* min signed long long */
+
+#if !defined(_ANSI_SOURCE)
+#ifdef __LP64__
+#define LONG_BIT	64
+#else /* !__LP64__ */
+#define LONG_BIT	32
+#endif /* __LP64__ */
+#define	SSIZE_MAX	LONG_MAX	/* max value for a ssize_t */
+#define WORD_BIT	32
+
+#if (!defined(_POSIX_C_SOURCE) && !defined(_XOPEN_SOURCE)) || defined(_DARWIN_C_SOURCE)
+#define	SIZE_T_MAX	ULONG_MAX	/* max value for a size_t */
+
+#define	UQUAD_MAX	ULLONG_MAX
+#define	QUAD_MAX	LLONG_MAX
+#define	QUAD_MIN	LLONG_MIN
+
+#endif /* (!_POSIX_C_SOURCE && !_XOPEN_SOURCE) || _DARWIN_C_SOURCE */
+#endif /* !_ANSI_SOURCE */
+
+#endif /* _I386_LIMITS_H_ */
diff -urN cctools-806-old/include/i386/_param.h cctools-806/include/i386/_param.h
--- cctools-806-old/include/i386/_param.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/_param.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,46 @@
+/*
+ * Copyright (c) 2008 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _I386__PARAM_H_
+#define _I386__PARAM_H_
+
+#include <i386/_types.h>
+
+/*
+ * Round p (pointer or byte index) up to a correctly-aligned value for all
+ * data types (int, long, ...).   The result is unsigned int and must be
+ * cast to any desired pointer type.
+ */
+#define	__DARWIN_ALIGNBYTES	(sizeof(__darwin_size_t) - 1)
+#define	__DARWIN_ALIGN(p)	((__darwin_size_t)((char *)(__darwin_size_t)(p) + __DARWIN_ALIGNBYTES) &~ __DARWIN_ALIGNBYTES)
+
+#define      __DARWIN_ALIGNBYTES32     (sizeof(__uint32_t) - 1)
+#define       __DARWIN_ALIGN32(p)       ((__darwin_size_t)((char *)(__darwin_size_t)(p) + __DARWIN_ALIGNBYTES32) &~ __DARWIN_ALIGNBYTES32)
+
+
+#endif /* _I386__PARAM_H_ */
diff -urN cctools-806-old/include/i386/param.h cctools-806/include/i386/param.h
--- cctools-806-old/include/i386/param.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/param.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,175 @@
+/*
+ * Copyright (c) 2000-2010 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*-
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ * (c) UNIX System Laboratories, Inc.
+ * All or some portions of this file are derived from material licensed
+ * to the University of California by American Telephone and Telegraph
+ * Co. or Unix System Laboratories, Inc. and are reproduced herein with
+ * the permission of UNIX System Laboratories, Inc.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)param.h	8.1 (Berkeley) 4/4/95
+ */
+
+/*
+ * Machine dependent constants for Intel 386.
+ */
+
+#ifndef _I386_PARAM_H_
+#define _I386_PARAM_H_
+
+#include <i386/_param.h>
+
+/*
+ * Round p (pointer or byte index) up to a correctly-aligned value for all
+ * data types (int, long, ...).   The result is unsigned int and must be
+ * cast to any desired pointer type.
+ */
+#define	ALIGNBYTES	__DARWIN_ALIGNBYTES
+#define	ALIGN(p)	__DARWIN_ALIGN(p)
+
+#define	NBPG		4096		/* bytes/page */
+#define	PGOFSET		(NBPG-1)	/* byte offset into page */
+#define	PGSHIFT		12		/* LOG2(NBPG) */
+
+#define	DEV_BSIZE	512
+#define	DEV_BSHIFT	9		/* log2(DEV_BSIZE) */
+#define BLKDEV_IOSIZE	2048
+#define	MAXPHYS		(128 * 1024)	/* max raw I/O transfer size */
+
+#define	CLSIZE		1
+#define	CLSIZELOG2	0
+
+/*
+ * Constants related to network buffer management.
+ * MCLBYTES must be no larger than CLBYTES (the software page size), and,
+ * on machines that exchange pages of input or output buffers with mbuf
+ * clusters (MAPPED_MBUFS), MCLBYTES must also be an integral multiple
+ * of the hardware page size.
+ */
+#define	MSIZESHIFT	8			/* 256 */
+#define	MSIZE		(1 << MSIZESHIFT)	/* size of an mbuf */
+#define	MCLSHIFT	11			/* 2048 */
+#define	MCLBYTES	(1 << MCLSHIFT)		/* size of an mbuf cluster */
+#define	MBIGCLSHIFT	12			/* 4096 */
+#define	MBIGCLBYTES	(1 << MBIGCLSHIFT)	/* size of a big cluster */
+#define	M16KCLSHIFT	14			/* 16384 */
+#define	M16KCLBYTES	(1 << M16KCLSHIFT)	/* size of a jumbo cluster */
+
+#define	MCLOFSET	(MCLBYTES - 1)
+#ifndef NMBCLUSTERS
+#ifdef GATEWAY
+#define	NMBCLUSTERS	((1024 * 1024) / MCLBYTES)	/* cl map size: 1MB */
+#else
+#define	NMBCLUSTERS	((1024 * 512) / MCLBYTES)	/* cl map size: 0.5MB */
+#endif
+#endif
+
+/*
+ * Some macros for units conversion
+ */
+/* Core clicks (NeXT_page_size bytes) to segments and vice versa */
+#define	ctos(x)	(x)
+#define	stoc(x)	(x)
+
+/* Core clicks (4096 bytes) to disk blocks */
+#define	ctod(x)	((x)<<(PGSHIFT-DEV_BSHIFT))
+#define	dtoc(x)	((x)>>(PGSHIFT-DEV_BSHIFT))
+#define	dtob(x)	((x)<<DEV_BSHIFT)
+
+/* clicks to bytes */
+#define	ctob(x)	((x)<<PGSHIFT)
+
+/* bytes to clicks */
+#define	btoc(x)	(((unsigned)(x)+(NBPG-1))>>PGSHIFT)
+
+#ifdef __APPLE__
+#define  btodb(bytes, devBlockSize)         \
+        ((unsigned)(bytes) / devBlockSize)
+#define  dbtob(db, devBlockSize)            \
+        ((unsigned)(db) * devBlockSize)
+#else
+#define	btodb(bytes)	 		/* calculates (bytes / DEV_BSIZE) */ \
+	((unsigned)(bytes) >> DEV_BSHIFT)
+#define	dbtob(db)			/* calculates (db * DEV_BSIZE) */ \
+	((unsigned)(db) << DEV_BSHIFT)
+#endif
+
+/*
+ * Map a ``block device block'' to a file system block.
+ * This should be device dependent, and will be if we
+ * add an entry to cdevsw/bdevsw for that purpose.
+ * For now though just use DEV_BSIZE.
+ */
+#define	bdbtofsb(bn)	((bn) / (BLKDEV_IOSIZE/DEV_BSIZE))
+
+/*
+ * Macros to decode (and encode) processor status word.
+ */
+#define STATUS_WORD(rpl, ipl)	(((ipl) << 8) | (rpl))
+#define	USERMODE(x)		(((x) & 3) == 3)
+#define	BASEPRI(x)		(((x) & (255 << 8)) == 0)
+
+
+#if	defined(KERNEL) || defined(STANDALONE)
+#define	DELAY(n) delay(n)
+
+#else	/* defined(KERNEL) || defined(STANDALONE) */
+#define	DELAY(n)	{ register int N = (n); while (--N > 0); }
+#endif	/* defined(KERNEL) || defined(STANDALONE) */
+
+#endif /* _I386_PARAM_H_ */
diff -urN cctools-806-old/include/i386/profile.h cctools-806/include/i386/profile.h
--- cctools-806-old/include/i386/profile.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/profile.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,39 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1997, Apple Computer, Inc. All rights reserved.
+ *
+ */
+
+#ifndef _BSD_I386_PROFILE_H_
+#define _BSD_I386_PROFILE_H_
+
+#include <sys/appleapiopts.h>
+
+
+#endif /* _BSD_I386_PROFILE_H_ */
diff -urN cctools-806-old/include/i386/setjmp.h cctools-806/include/i386/setjmp.h
--- cctools-806-old/include/i386/setjmp.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/setjmp.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,80 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* Copyright (c) 1992 NeXT Computer, Inc.  All rights reserved.
+ *
+ *	File:	setjmp.h
+ *
+ *	Declaration of setjmp routines and data structures.
+ */
+#ifndef _BSD_I386_SETJMP_H
+#define _BSD_I386_SETJMP_H
+
+#include <sys/cdefs.h>
+
+#if defined(__x86_64__)
+/*
+ * _JBLEN is number of ints required to save the following:
+ * rflags, rip, rbp, rsp, rbx, r12, r13, r14, r15... these are 8 bytes each
+ * mxcsr, fp control word, sigmask... these are 4 bytes each
+ * add 16 ints for future expansion needs...
+ */
+#define _JBLEN ((9 * 2) + 3 + 16)
+typedef int jmp_buf[_JBLEN];
+typedef int sigjmp_buf[_JBLEN + 1];
+
+#else
+
+/*
+ * _JBLEN is number of ints required to save the following:
+ * eax, ebx, ecx, edx, edi, esi, ebp, esp, ss, eflags, eip,
+ * cs, de, es, fs, gs == 16 ints
+ * onstack, mask = 2 ints
+ */
+
+#define _JBLEN (18)
+typedef int jmp_buf[_JBLEN];
+typedef int sigjmp_buf[_JBLEN + 1];
+
+#endif
+
+__BEGIN_DECLS
+int	setjmp(jmp_buf);
+void	longjmp(jmp_buf, int);
+
+#ifndef _ANSI_SOURCE
+int	_setjmp(jmp_buf);
+void	_longjmp(jmp_buf, int);
+int	sigsetjmp(sigjmp_buf, int);
+void	siglongjmp(sigjmp_buf, int);
+#endif /* _ANSI_SOURCE  */
+
+#if !defined(_ANSI_SOURCE) && (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+void	longjmperror(void);
+#endif /* neither ANSI nor POSIX */
+__END_DECLS
+#endif /* !_BSD_I386_SETJMP_H */
diff -urN cctools-806-old/include/i386/signal.h cctools-806/include/i386/signal.h
--- cctools-806-old/include/i386/signal.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/signal.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,62 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (c) 1992 NeXT Computer, Inc.
+ *
+ */
+
+#ifndef	_I386_SIGNAL_H_
+#define	_I386_SIGNAL_H_ 1
+
+#include <sys/cdefs.h>
+
+#ifndef _ANSI_SOURCE
+typedef int sig_atomic_t; 
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+
+#include <sys/appleapiopts.h>
+
+#ifdef __APPLE_API_OBSOLETE
+
+/*
+ * Information pushed on stack when a signal is delivered.
+ * This is used by the kernel to restore state following
+ * execution of the signal handler.  It is also made available
+ * to the handler to allow it to properly restore state if
+ * a non-standard exit is performed.
+ */
+#define __need_struct_sigcontext
+#include <i386/_structs.h>
+
+#endif /* __APPLE_API_OBSOLETE */
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+#endif /* ! _ANSI_SOURCE */
+
+#endif	/* _I386_SIGNAL_H_ */
+
diff -urN cctools-806-old/include/i386/_structs.h cctools-806/include/i386/_structs.h
--- cctools-806-old/include/i386/_structs.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/_structs.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,141 @@
+/*
+ * Copyright (c) 2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#include <sys/appleapiopts.h>
+
+#ifdef __need_mcontext_t
+#ifndef __need_struct_mcontext
+#define __need_struct_mcontext
+#endif /* __need_struct_mcontext */
+#endif /* __need_mcontext_t */
+
+#if defined(__need_struct_mcontext)
+#include <mach/i386/_structs.h>
+#endif /* __need_struct_mcontext */
+
+
+#ifdef __need_struct_mcontext
+#undef __need_struct_mcontext
+
+#ifndef _STRUCT_MCONTEXT32
+#if __DARWIN_UNIX03
+#define	_STRUCT_MCONTEXT32	struct __darwin_mcontext32
+_STRUCT_MCONTEXT32
+{
+	_STRUCT_X86_EXCEPTION_STATE32	__es;
+	_STRUCT_X86_THREAD_STATE32	__ss;
+	_STRUCT_X86_FLOAT_STATE32	__fs;
+};
+
+#define	_STRUCT_MCONTEXT_AVX32	struct __darwin_mcontext_avx32
+_STRUCT_MCONTEXT_AVX32
+{
+	_STRUCT_X86_EXCEPTION_STATE32	__es;
+	_STRUCT_X86_THREAD_STATE32	__ss;
+	_STRUCT_X86_AVX_STATE32		__fs;
+};
+
+#else /* !__DARWIN_UNIX03 */
+#define	_STRUCT_MCONTEXT32	struct mcontext32
+_STRUCT_MCONTEXT32
+{
+	_STRUCT_X86_EXCEPTION_STATE32	es;
+	_STRUCT_X86_THREAD_STATE32	ss;
+	_STRUCT_X86_FLOAT_STATE32	fs;
+};
+
+#define	_STRUCT_MCONTEXT_AVX32	struct mcontext_avx32
+_STRUCT_MCONTEXT_AVX32
+{
+	_STRUCT_X86_EXCEPTION_STATE32	es;
+	_STRUCT_X86_THREAD_STATE32	ss;
+	_STRUCT_X86_AVX_STATE32		fs;
+};
+
+#endif /* __DARWIN_UNIX03 */
+#endif /* _STRUCT_MCONTEXT32 */
+
+#ifndef _STRUCT_MCONTEXT64
+#if __DARWIN_UNIX03
+#define	_STRUCT_MCONTEXT64	struct __darwin_mcontext64
+_STRUCT_MCONTEXT64
+{
+	_STRUCT_X86_EXCEPTION_STATE64	__es;
+	_STRUCT_X86_THREAD_STATE64	__ss;
+	_STRUCT_X86_FLOAT_STATE64	__fs;
+};
+
+#define	_STRUCT_MCONTEXT_AVX64	struct __darwin_mcontext_avx64
+_STRUCT_MCONTEXT_AVX64
+{
+	_STRUCT_X86_EXCEPTION_STATE64	__es;
+	_STRUCT_X86_THREAD_STATE64	__ss;
+	_STRUCT_X86_AVX_STATE64		__fs;
+};
+
+#else /* !__DARWIN_UNIX03 */
+#define	_STRUCT_MCONTEXT64	struct mcontext64
+_STRUCT_MCONTEXT64
+{
+	_STRUCT_X86_EXCEPTION_STATE64	es;
+	_STRUCT_X86_THREAD_STATE64	ss;
+	_STRUCT_X86_FLOAT_STATE64	fs;
+};
+
+#define	_STRUCT_MCONTEXT_AVX64	struct mcontext_avx64
+_STRUCT_MCONTEXT_AVX64
+{
+	_STRUCT_X86_EXCEPTION_STATE64	es;
+	_STRUCT_X86_THREAD_STATE64	ss;
+	_STRUCT_X86_AVX_STATE64		fs;
+};
+
+#endif /* __DARWIN_UNIX03 */
+#endif /* _STRUCT_MCONTEXT64 */
+#endif /* __need_struct_mcontext */
+
+#ifdef __need_mcontext_t
+#undef __need_mcontext_t
+#ifndef _MCONTEXT_T
+#define _MCONTEXT_T
+#if defined(__LP64__)
+typedef _STRUCT_MCONTEXT64	*mcontext_t;
+#define _STRUCT_MCONTEXT _STRUCT_MCONTEXT64
+#else
+typedef _STRUCT_MCONTEXT32	*mcontext_t;
+#define _STRUCT_MCONTEXT	_STRUCT_MCONTEXT32
+#endif
+#endif /* _MCONTEXT_T */
+#endif /* __need_mcontext_t */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#ifndef I386_MCONTEXT_SIZE
+#define I386_MCONTEXT_SIZE	sizeof(struct mcontext)	
+#endif /* I386_MCONTEXT_SIZE */
+#endif /* (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
diff -urN cctools-806-old/include/i386/_types.h cctools-806/include/i386/_types.h
--- cctools-806-old/include/i386/_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,123 @@
+/*
+ * Copyright (c) 2000-2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef	_BSD_I386__TYPES_H_
+#define	_BSD_I386__TYPES_H_
+
+/*
+ * This header file contains integer types.  It's intended to also contain
+ * flotaing point and other arithmetic types, as needed, later.
+ */
+
+#ifdef __GNUC__
+typedef __signed char		__int8_t;
+#else	/* !__GNUC__ */
+typedef char			__int8_t;
+#endif	/* !__GNUC__ */
+typedef unsigned char		__uint8_t;
+typedef	short			__int16_t;
+typedef	unsigned short		__uint16_t;
+typedef int			__int32_t;
+typedef unsigned int		__uint32_t;
+/* TODO: Look into having autoconf check and define __int64_t if necessary */
+typedef long long		__int64_t;
+typedef unsigned long long	__uint64_t;
+
+typedef long			__darwin_intptr_t;
+typedef unsigned int		__darwin_natural_t;
+
+/*
+ * The rune type below is declared to be an ``int'' instead of the more natural
+ * ``unsigned long'' or ``long''.  Two things are happening here.  It is not
+ * unsigned so that EOF (-1) can be naturally assigned to it and used.  Also,
+ * it looks like 10646 will be a 31 bit standard.  This means that if your
+ * ints cannot hold 32 bits, you will be in trouble.  The reason an int was
+ * chosen over a long is that the is*() and to*() routines take ints (says
+ * ANSI C), but they use __darwin_ct_rune_t instead of int.  By changing it
+ * here, you lose a bit of ANSI conformance, but your programs will still
+ * work.
+ *
+ * NOTE: rune_t is not covered by ANSI nor other standards, and should not
+ * be instantiated outside of lib/libc/locale.  Use wchar_t.  wchar_t and
+ * rune_t must be the same type.  Also wint_t must be no narrower than
+ * wchar_t, and should also be able to hold all members of the largest
+ * character set plus one extra value (WEOF). wint_t must be at least 16 bits.
+ */
+
+typedef int			__darwin_ct_rune_t;	/* ct_rune_t */
+
+/*
+ * mbstate_t is an opaque object to keep conversion state, during multibyte
+ * stream conversions.  The content must not be referenced by user programs.
+ */
+#if !defined(__GNUC__)
+typedef union {
+	char		__mbstate8[128];
+	long long	_mbstateL;			/* for alignment */
+} __mbstate_t;
+#endif
+
+/*typedef __mbstate_t		__darwin_mbstate_t;*/	/* mbstate_t */
+
+#if defined(__GNUC__) && defined(__PTRDIFF_TYPE__)
+typedef __PTRDIFF_TYPE__	__darwin_ptrdiff_t;	/* ptr1 - ptr2 */
+#else
+typedef int			__darwin_ptrdiff_t;	/* ptr1 - ptr2 */
+#endif /* __GNUC__ */
+
+#if defined(__GNUC__) && defined(__SIZE_TYPE__)
+typedef __SIZE_TYPE__		__darwin_size_t;	/* sizeof() */
+#else
+typedef unsigned long		__darwin_size_t;	/* sizeof() */
+#endif
+
+#if (__GNUC__ > 2)
+typedef __builtin_va_list	__darwin_va_list;	/* va_list */
+#else
+typedef void *			__darwin_va_list;	/* va_list */
+#endif
+
+#if defined(__GNUC__) && defined(__WCHAR_TYPE__)
+typedef __WCHAR_TYPE__		__darwin_wchar_t;	/* wchar_t */
+#else
+typedef __darwin_ct_rune_t	__darwin_wchar_t;	/* wchar_t */
+#endif
+
+typedef __darwin_wchar_t	__darwin_rune_t;	/* rune_t */
+
+#if defined(__GNUC__) && defined(__WINT_TYPE__)
+typedef __WINT_TYPE__		__darwin_wint_t;	/* wint_t */
+#else
+typedef __darwin_ct_rune_t	__darwin_wint_t;	/* wint_t */
+#endif
+
+typedef unsigned long		__darwin_clock_t;	/* clock() */
+typedef __uint32_t		__darwin_socklen_t;	/* socklen_t (duh) */
+typedef long			__darwin_ssize_t;	/* byte count or error */
+typedef long			__darwin_time_t;	/* time() */
+
+#endif	/* _BSD_I386__TYPES_H_ */
diff -urN cctools-806-old/include/i386/types.h cctools-806/include/i386/types.h
--- cctools-806-old/include/i386/types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,135 @@
+/*
+ * Copyright (c) 2000-2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright 1995 NeXT Computer, Inc. All rights reserved.
+ */
+/*
+ * Copyright (c) 1990, 1993
+ *	The Regents of the University of California.  All rights reserved.
+ *
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 1. Redistributions of source code must retain the above copyright
+ *    notice, this list of conditions and the following disclaimer.
+ * 2. Redistributions in binary form must reproduce the above copyright
+ *    notice, this list of conditions and the following disclaimer in the
+ *    documentation and/or other materials provided with the distribution.
+ * 3. All advertising materials mentioning features or use of this software
+ *    must display the following acknowledgement:
+ *	This product includes software developed by the University of
+ *	California, Berkeley and its contributors.
+ * 4. Neither the name of the University nor the names of its contributors
+ *    may be used to endorse or promote products derived from this software
+ *    without specific prior written permission.
+ *
+ * THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
+ * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
+ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
+ * ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
+ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
+ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
+ * OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
+ * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
+ * LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
+ * OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
+ * SUCH DAMAGE.
+ *
+ *	@(#)types.h	8.3 (Berkeley) 1/5/94
+ */
+
+#ifndef	_MACHTYPES_H_
+#define	_MACHTYPES_H_
+
+#ifndef __ASSEMBLER__
+#include <i386/_types.h>
+#include <sys/cdefs.h>
+/*
+ * Basic integral types.  Omit the typedef if
+ * not possible for a machine/compiler combination.
+ */
+#ifndef _INT8_T
+#define _INT8_T
+typedef	__signed char		int8_t;
+#endif
+typedef	unsigned char		u_int8_t;
+#ifndef _INT16_T
+#define _INT16_T
+typedef	short			int16_t;
+#endif
+typedef	unsigned short		u_int16_t;
+#ifndef _INT32_T
+#define _INT32_T
+typedef	int			int32_t;
+#endif
+typedef	unsigned int		u_int32_t;
+#ifndef _INT64_T
+#define _INT64_T
+typedef	long long		int64_t;
+#endif
+typedef	unsigned long long	u_int64_t;
+
+#if __LP64__
+typedef int64_t			register_t;
+#else
+typedef int32_t			register_t;
+#endif
+
+#ifndef _INTPTR_T
+#define _INTPTR_T
+typedef __darwin_intptr_t	intptr_t;
+#endif
+#ifndef _UINTPTR_T
+#define _UINTPTR_T
+typedef unsigned long		uintptr_t;
+#endif
+
+#if !defined(_ANSI_SOURCE) && (!defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE))
+/* These types are used for reserving the largest possible size. */
+typedef u_int64_t		user_addr_t;	
+typedef u_int64_t		user_size_t;	
+typedef int64_t			user_ssize_t;
+typedef int64_t			user_long_t;
+typedef u_int64_t		user_ulong_t;
+typedef int64_t			user_time_t;
+typedef int64_t			user_off_t;
+#define USER_ADDR_NULL	((user_addr_t) 0)
+#define CAST_USER_ADDR_T(a_ptr)   ((user_addr_t)((uintptr_t)(a_ptr)))
+
+
+#endif /* !_ANSI_SOURCE && (!_POSIX_C_SOURCE || _DARWIN_C_SOURCE) */
+
+/* This defines the size of syscall arguments after copying into the kernel: */
+typedef u_int64_t		syscall_arg_t;
+
+#ifndef __offsetof
+#define __offsetof(type, field) ((size_t)(&((type *)0)->field))
+#endif
+
+#endif /* __ASSEMBLER__ */
+#endif	/* _MACHTYPES_H_ */
diff -urN cctools-806-old/include/i386/user_ldt.h cctools-806/include/i386/user_ldt.h
--- cctools-806-old/include/i386/user_ldt.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/user_ldt.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,80 @@
+/*
+ * Copyright (c) 2000-2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon 
+ * the rights to redistribute these changes.
+ */
+
+/*
+ */
+
+#ifndef	_I386_USER_LDT_H_
+#define	_I386_USER_LDT_H_
+
+/*
+ * User LDT management.
+ *
+ * Each task may have its own LDT.
+ */
+
+#define	LDT_AUTO_ALLOC	0xffffffff
+
+#include <sys/cdefs.h>
+
+union ldt_entry;
+
+__BEGIN_DECLS
+int i386_get_ldt(int, union ldt_entry *, int);
+int i386_set_ldt(int, const union ldt_entry *, int);
+__END_DECLS
+
+#endif	/* _I386_USER_LDT_H_ */
diff -urN cctools-806-old/include/i386/vmparam.h cctools-806/include/i386/vmparam.h
--- cctools-806-old/include/i386/vmparam.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/i386/vmparam.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,62 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef	_BSD_I386_VMPARAM_H_
+#define	_BSD_I386_VMPARAM_H_ 1
+
+#include <sys/resource.h>
+
+/* Rosetta dependency on this address */
+#define	USRSTACK	VM_USRSTACK32
+
+#define	USRSTACK64	VM_USRSTACK64
+
+
+/*
+ * Virtual memory related constants, all in bytes
+ */
+#ifndef DFLDSIZ
+#define	DFLDSIZ		(RLIM_INFINITY)		/* initial data size limit */
+#endif
+#ifndef MAXDSIZ
+#define	MAXDSIZ		(RLIM_INFINITY)		/* max data size */
+#endif
+#ifndef	DFLSSIZ
+#define	DFLSSIZ		(8*1024*1024)		/* initial stack size limit */
+#endif
+#ifndef	MAXSSIZ
+#define	MAXSSIZ		(64*1024*1024)		/* max stack size */
+#endif
+#ifndef	DFLCSIZ
+#define DFLCSIZ		(0)			/* initial core size limit */
+#endif
+#ifndef	MAXCSIZ
+#define MAXCSIZ		(RLIM_INFINITY)		/* max core size */
+#endif	/* MAXCSIZ */
+
+#endif	/* _BSD_I386_VMPARAM_H_ */
diff -urN cctools-806-old/include/mach/audit_triggers.defs cctools-806/include/mach/audit_triggers.defs
--- cctools-806-old/include/mach/audit_triggers.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/audit_triggers.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,49 @@
+/*
+ * Copyright (c) 2004-2008, Apple Inc.  All rights reserved.
+ * 
+ * @APPLE_BSD_LICENSE_HEADER_START@
+ * 
+ * Redistribution and use in source and binary forms, with or without
+ * modification, are permitted provided that the following conditions
+ * are met:
+ * 
+ * 1.  Redistributions of source code must retain the above copyright
+ *     notice, this list of conditions and the following disclaimer. 
+ * 2.  Redistributions in binary form must reproduce the above copyright
+ *     notice, this list of conditions and the following disclaimer in the
+ *     documentation and/or other materials provided with the distribution. 
+ * 3.  Neither the name of Apple Inc. ("Apple") nor the names of
+ *     its contributors may be used to endorse or promote products derived
+ *     from this software without specific prior written permission. 
+ * 
+ * THIS SOFTWARE IS PROVIDED BY APPLE AND ITS CONTRIBUTORS "AS IS" AND ANY
+ * EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
+ * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
+ * DISCLAIMED. IN NO EVENT SHALL APPLE OR ITS CONTRIBUTORS BE LIABLE FOR ANY
+ * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
+ * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
+ * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
+ * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
+ * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
+ * 
+ * @APPLE_BSD_LICENSE_HEADER_END@
+*/
+
+/*
+ *  Interface definition for the audit logging facility.
+ */
+
+subsystem
+#if	KERNEL_USER
+    KernelUser
+#endif	/* KERNEL_USER */
+    audit_triggers 123;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+simpleroutine	audit_triggers(
+		audit_port	: mach_port_t; 
+	in	flags		: int);
+
diff -urN cctools-806-old/include/mach/boolean.h cctools-806/include/mach/boolean.h
--- cctools-806-old/include/mach/boolean.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/boolean.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,88 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/boolean.h
+ *
+ *	Boolean data type.
+ *
+ */
+
+#ifndef	_MACH_BOOLEAN_H_
+#define	_MACH_BOOLEAN_H_
+
+/*
+ *	Pick up "boolean_t" type definition
+ */
+
+#ifndef	ASSEMBLER
+#include <mach/machine/boolean.h>
+#endif	/* ASSEMBLER */
+
+/*
+ *	Define TRUE and FALSE if not defined.
+ */
+
+#ifndef	TRUE
+#define TRUE	1
+#endif	/* TRUE */
+
+#ifndef	FALSE
+#define FALSE	0
+#endif	/* FALSE */
+
+#endif	/* _MACH_BOOLEAN_H_ */
diff -urN cctools-806-old/include/mach/bootstrap.h cctools-806/include/mach/bootstrap.h
--- cctools-806-old/include/mach/bootstrap.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/bootstrap.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,34 @@
+/*
+ * Copyright (c) 2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Mach bootstrap interfaces (obsolete: header included only for compatibility)
+ */
+#ifndef	_MACH_BOOTSTRAP_H_
+#define _MACH_BOOTSTRAP_H_
+
+#endif /* _MACH_BOOTSTRAP_H_ */
diff -urN cctools-806-old/include/mach/clock.defs cctools-806/include/mach/clock.defs
--- cctools-806-old/include/mach/clock.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/clock.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,81 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ * 	File:		mach/clock.defs
+ *	Purpose:	Kernel clock subsystem definitions. This
+ *			file defines the clock request interface.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		       clock 1000;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach/clock_types.defs>
+
+/*
+ * References to clock objects are returned by:
+ *	host_get_clock_service(host_t,...)
+ *	host_get_clock_control(host_priv_t,...) - Priviledged subclass
+ */
+
+/*
+ *	Get the clock time.
+ *	Available to all.
+ */
+routine	clock_get_time(
+		clock_serv	: clock_serv_t;
+	out	cur_time	: mach_timespec_t);
+
+/*
+ *	Get clock attributes.
+ *	Available to all.
+ */
+routine	clock_get_attributes(
+		clock_serv	: clock_serv_t;
+	in	flavor		: clock_flavor_t;
+	out	clock_attr	: clock_attr_t, CountInOut);
+
+/*
+ *	Setup a clock alarm.
+ *	Available to all.
+ */
+routine clock_alarm(
+		clock_serv	: clock_serv_t;
+		alarm_type	: alarm_type_t;
+		alarm_time	: mach_timespec_t;
+                alarm_port      : clock_reply_t =
+			MACH_MSG_TYPE_MAKE_SEND_ONCE|polymorphic);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/clock.h cctools-806/include/mach/clock.h
--- cctools-806-old/include/mach/clock.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/clock.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,222 @@
+#ifndef	_clock_user_
+#define	_clock_user_
+
+/* Module clock */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	clock_MSG_COUNT
+#define	clock_MSG_COUNT	3
+#endif	/* clock_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine clock_get_time */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t clock_get_time
+(
+	clock_serv_t clock_serv,
+	mach_timespec_t *cur_time
+);
+
+/* Routine clock_get_attributes */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t clock_get_attributes
+(
+	clock_serv_t clock_serv,
+	clock_flavor_t flavor,
+	clock_attr_t clock_attr,
+	mach_msg_type_number_t *clock_attrCnt
+);
+
+/* Routine clock_alarm */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t clock_alarm
+(
+	clock_serv_t clock_serv,
+	alarm_type_t alarm_type,
+	mach_timespec_t alarm_time,
+	clock_reply_t alarm_port
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__clock_subsystem__defined
+#define __Request__clock_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__clock_get_time_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		clock_flavor_t flavor;
+		mach_msg_type_number_t clock_attrCnt;
+	} __Request__clock_get_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t alarm_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		alarm_type_t alarm_type;
+		mach_timespec_t alarm_time;
+	} __Request__clock_alarm_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__clock_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__clock_subsystem__defined
+#define __RequestUnion__clock_subsystem__defined
+union __RequestUnion__clock_subsystem {
+	__Request__clock_get_time_t Request_clock_get_time;
+	__Request__clock_get_attributes_t Request_clock_get_attributes;
+	__Request__clock_alarm_t Request_clock_alarm;
+};
+#endif /* !__RequestUnion__clock_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__clock_subsystem__defined
+#define __Reply__clock_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_timespec_t cur_time;
+	} __Reply__clock_get_time_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t clock_attrCnt;
+		int clock_attr[1];
+	} __Reply__clock_get_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__clock_alarm_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__clock_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__clock_subsystem__defined
+#define __ReplyUnion__clock_subsystem__defined
+union __ReplyUnion__clock_subsystem {
+	__Reply__clock_get_time_t Reply_clock_get_time;
+	__Reply__clock_get_attributes_t Reply_clock_get_attributes;
+	__Reply__clock_alarm_t Reply_clock_alarm;
+};
+#endif /* !__RequestUnion__clock_subsystem__defined */
+
+#ifndef subsystem_to_name_map_clock
+#define subsystem_to_name_map_clock \
+    { "clock_get_time", 1000 },\
+    { "clock_get_attributes", 1001 },\
+    { "clock_alarm", 1002 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _clock_user_ */
diff -urN cctools-806-old/include/mach/clock_priv.defs cctools-806/include/mach/clock_priv.defs
--- cctools-806-old/include/mach/clock_priv.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/clock_priv.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,69 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ * 	File:		mach/clock_priv.defs
+ *	Purpose:	Kernel clock subsystem definitions. This
+ *			file defines the clock request interface.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		       clock_priv 1200;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach/clock_types.defs>
+
+/*
+ * References to clock_priv objects are returned by:
+ *	host_get_clock_control(host_priv_t,...) - Priviledged subclass
+ */
+
+/*
+ *	Set the clock time.
+ *	Privileged.
+ */
+routine	clock_set_time(
+		clock_ctrl	: clock_ctrl_t;
+		new_time	: mach_timespec_t);
+
+/*
+ *	Set clock attributes.
+ *	Privileged.
+ */
+routine	clock_set_attributes(
+		clock_ctrl	: clock_ctrl_t;
+	in	flavor		: clock_flavor_t;
+	in	clock_attr	: clock_attr_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/clock_priv.h cctools-806/include/mach/clock_priv.h
--- cctools-806-old/include/mach/clock_priv.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/clock_priv.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,176 @@
+#ifndef	_clock_priv_user_
+#define	_clock_priv_user_
+
+/* Module clock_priv */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	clock_priv_MSG_COUNT
+#define	clock_priv_MSG_COUNT	2
+#endif	/* clock_priv_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine clock_set_time */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t clock_set_time
+(
+	clock_ctrl_t clock_ctrl,
+	mach_timespec_t new_time
+);
+
+/* Routine clock_set_attributes */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t clock_set_attributes
+(
+	clock_ctrl_t clock_ctrl,
+	clock_flavor_t flavor,
+	clock_attr_t clock_attr,
+	mach_msg_type_number_t clock_attrCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__clock_priv_subsystem__defined
+#define __Request__clock_priv_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_timespec_t new_time;
+	} __Request__clock_set_time_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		clock_flavor_t flavor;
+		mach_msg_type_number_t clock_attrCnt;
+		int clock_attr[1];
+	} __Request__clock_set_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__clock_priv_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__clock_priv_subsystem__defined
+#define __RequestUnion__clock_priv_subsystem__defined
+union __RequestUnion__clock_priv_subsystem {
+	__Request__clock_set_time_t Request_clock_set_time;
+	__Request__clock_set_attributes_t Request_clock_set_attributes;
+};
+#endif /* !__RequestUnion__clock_priv_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__clock_priv_subsystem__defined
+#define __Reply__clock_priv_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__clock_set_time_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__clock_set_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__clock_priv_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__clock_priv_subsystem__defined
+#define __ReplyUnion__clock_priv_subsystem__defined
+union __ReplyUnion__clock_priv_subsystem {
+	__Reply__clock_set_time_t Reply_clock_set_time;
+	__Reply__clock_set_attributes_t Reply_clock_set_attributes;
+};
+#endif /* !__RequestUnion__clock_priv_subsystem__defined */
+
+#ifndef subsystem_to_name_map_clock_priv
+#define subsystem_to_name_map_clock_priv \
+    { "clock_set_time", 1200 },\
+    { "clock_set_attributes", 1201 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _clock_priv_user_ */
diff -urN cctools-806-old/include/mach/clock_reply.defs cctools-806/include/mach/clock_reply.defs
--- cctools-806-old/include/mach/clock_reply.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/clock_reply.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,56 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ *	File:		clock_reply.defs
+ *	Purpose:	Kernel clock subsystem definitions. This
+ *			file defines the clock reply interface.
+ */
+
+subsystem
+#if	KERNEL_USER
+	  KernelUser
+#endif	/* KERNEL_USER */
+		     clock_reply 3125107;  /* Matches up with old value */
+
+#include <mach/std_types.defs>
+#include <mach/clock_types.defs>
+
+
+/*
+ *	Reply routine for clock_alarm. 
+ */
+simpleroutine clock_alarm_reply(
+                alarm_port      : clock_reply_t;
+		alarm_code	: kern_return_t;
+		alarm_type	: alarm_type_t;
+		alarm_time	: mach_timespec_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/clock_reply.h cctools-806/include/mach/clock_reply.h
--- cctools-806-old/include/mach/clock_reply.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/clock_reply.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,136 @@
+#ifndef	_clock_reply_user_
+#define	_clock_reply_user_
+
+/* Module clock_reply */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	clock_reply_MSG_COUNT
+#define	clock_reply_MSG_COUNT	1
+#endif	/* clock_reply_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* SimpleRoutine clock_alarm_reply */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t clock_alarm_reply
+(
+	clock_reply_t alarm_port,
+	mach_msg_type_name_t alarm_portPoly,
+	kern_return_t alarm_code,
+	alarm_type_t alarm_type,
+	mach_timespec_t alarm_time
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__clock_reply_subsystem__defined
+#define __Request__clock_reply_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t alarm_code;
+		alarm_type_t alarm_type;
+		mach_timespec_t alarm_time;
+	} __Request__clock_alarm_reply_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__clock_reply_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__clock_reply_subsystem__defined
+#define __RequestUnion__clock_reply_subsystem__defined
+union __RequestUnion__clock_reply_subsystem {
+	__Request__clock_alarm_reply_t Request_clock_alarm_reply;
+};
+#endif /* !__RequestUnion__clock_reply_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__clock_reply_subsystem__defined
+#define __Reply__clock_reply_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__clock_alarm_reply_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__clock_reply_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__clock_reply_subsystem__defined
+#define __ReplyUnion__clock_reply_subsystem__defined
+union __ReplyUnion__clock_reply_subsystem {
+	__Reply__clock_alarm_reply_t Reply_clock_alarm_reply;
+};
+#endif /* !__RequestUnion__clock_reply_subsystem__defined */
+
+#ifndef subsystem_to_name_map_clock_reply
+#define subsystem_to_name_map_clock_reply \
+    { "clock_alarm_reply", 3125107 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _clock_reply_user_ */
diff -urN cctools-806-old/include/mach/clock_types.defs cctools-806/include/mach/clock_types.defs
--- cctools-806-old/include/mach/clock_types.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/clock_types.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,73 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ *	File:		clock_types.defs
+ *	Purpose:
+ *		Clock kernel interface type declarations
+ */
+
+#ifndef	_MACH_CLOCK_TYPES_DEFS_
+#define _MACH_CLOCK_TYPES_DEFS_
+
+#include <mach/std_types.defs>
+
+type clock_serv_t = mach_port_t
+		cusertype: clock_serv_t
+#if	KERNEL_SERVER
+		intran: clock_serv_t convert_port_to_clock(mach_port_t)
+		outtran: mach_port_t convert_clock_to_port(clock_serv_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type clock_ctrl_t = mach_port_t
+		cusertype: clock_ctrl_t
+#if	KERNEL_SERVER
+		intran: clock_ctrl_t convert_port_to_clock_ctrl(mach_port_t)
+		outtran: mach_port_t convert_clock_ctrl_to_port(clock_ctrl_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type clock_reply_t = polymorphic|MACH_MSG_TYPE_MAKE_SEND_ONCE;
+
+type clock_flavor_t = int;
+type clock_attr_t = array[*:1] of int;
+type mach_timespec_t	= struct[2] of int;
+type time_t = int;
+type sleep_type_t = int;
+type alarm_type_t = int;
+type clock_res_t = int;
+type clock_id_t = int;
+
+import <mach/mach_types.h>;
+
+#endif	/* _MACH_CLOCK_TYPES_DEFS_ */
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/clock_types.h cctools-806/include/mach/clock_types.h
--- cctools-806-old/include/mach/clock_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/clock_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,127 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ *	File:		clock_types.h
+ *	Purpose:	Clock facility header definitions. These
+ *				definitons are needed by both kernel and
+ *				user-level software.
+ */
+
+/*
+ *	All interfaces defined here are obsolete.
+ */
+
+#ifndef	_MACH_CLOCK_TYPES_H_
+#define	_MACH_CLOCK_TYPES_H_
+
+#include <stdint.h>
+#include <mach/time_value.h>
+
+/*
+ * Type definitions.
+ */
+typedef	int	alarm_type_t;		/* alarm time type */
+typedef int	sleep_type_t;		/* sleep time type */
+typedef	int	clock_id_t;			/* clock identification type */
+typedef int	clock_flavor_t;		/* clock flavor type */
+typedef int	*clock_attr_t;		/* clock attribute type */
+typedef int	clock_res_t;		/* clock resolution type */
+
+/*
+ * Normal time specification used by the kernel clock facility.
+ */
+struct mach_timespec {
+	unsigned int	tv_sec;			/* seconds */
+	clock_res_t		tv_nsec;		/* nanoseconds */
+};
+typedef struct mach_timespec	mach_timespec_t;
+
+/*
+ * Reserved clock id values for default clocks.
+ */
+#define SYSTEM_CLOCK		0
+#define CALENDAR_CLOCK		1
+
+#define REALTIME_CLOCK		0
+
+/*
+ * Attribute names.
+ */
+#define	CLOCK_GET_TIME_RES	1	/* get_time call resolution */
+/*							2	 * was map_time call resolution */
+#define CLOCK_ALARM_CURRES	3	/* current alarm resolution */
+#define CLOCK_ALARM_MINRES	4	/* minimum alarm resolution */
+#define CLOCK_ALARM_MAXRES	5	/* maximum alarm resolution */
+
+#define NSEC_PER_USEC	1000		/* nanoseconds per microsecond */
+#define USEC_PER_SEC	1000000		/* microseconds per second */
+#define NSEC_PER_SEC	1000000000	/* nanoseconds per second */
+#define NSEC_PER_MSEC	1000000ull	/* nanoseconds per millisecond */
+
+#define BAD_MACH_TIMESPEC(t)						\
+	((t)->tv_nsec < 0 || (t)->tv_nsec >= NSEC_PER_SEC)
+
+/* t1 <=> t2, also (t1 - t2) in nsec with max of +- 1 sec */
+#define CMP_MACH_TIMESPEC(t1, t2)					\
+	((t1)->tv_sec > (t2)->tv_sec ? +NSEC_PER_SEC :	\
+	((t1)->tv_sec < (t2)->tv_sec ? -NSEC_PER_SEC :	\
+			(t1)->tv_nsec - (t2)->tv_nsec))
+
+/* t1  += t2 */
+#define ADD_MACH_TIMESPEC(t1, t2)								\
+  do {															\
+	if (((t1)->tv_nsec += (t2)->tv_nsec) >= NSEC_PER_SEC) {		\
+		(t1)->tv_nsec -= NSEC_PER_SEC;							\
+		(t1)->tv_sec  += 1;										\
+	}															\
+	(t1)->tv_sec += (t2)->tv_sec;								\
+  } while (0)
+
+/* t1  -= t2 */
+#define SUB_MACH_TIMESPEC(t1, t2)								\
+  do {															\
+	if (((t1)->tv_nsec -= (t2)->tv_nsec) < 0) {					\
+		(t1)->tv_nsec += NSEC_PER_SEC;							\
+		(t1)->tv_sec  -= 1;										\
+	}															\
+	(t1)->tv_sec -= (t2)->tv_sec;								\
+  } while (0)
+
+/*
+ * Alarm parameter defines.
+ */
+#define ALRMTYPE			0xff		/* type (8-bit field)	*/
+#define TIME_ABSOLUTE		0x00		/* absolute time */
+#define	TIME_RELATIVE		0x01		/* relative time */
+
+#define BAD_ALRMTYPE(t)		(((t) &~ TIME_RELATIVE) != 0)
+
+#endif /* _MACH_CLOCK_TYPES_H_ */
diff -urN cctools-806-old/include/mach/error.h cctools-806/include/mach/error.h
--- cctools-806-old/include/mach/error.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/error.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,114 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ * File:	mach/error.h
+ * Purpose:
+ *	error module definitions
+ *
+ */
+
+#ifndef	_MACH_ERROR_H_
+#define	_MACH_ERROR_H_
+
+#include <mach/kern_return.h>
+
+/*
+ *	error number layout as follows:
+ *
+ *	hi		 		       lo
+ *	| system(6) | subsystem(12) | code(14) |
+ */
+
+
+#define	err_none		(mach_error_t)0
+#define ERR_SUCCESS		(mach_error_t)0
+#define	ERR_ROUTINE_NIL		(mach_error_fn_t)0
+
+
+#define	err_system(x)		(((x)&0x3f)<<26)
+#define err_sub(x)		(((x)&0xfff)<<14)
+
+#define err_get_system(err)	(((err)>>26)&0x3f)
+#define err_get_sub(err)	(((err)>>14)&0xfff)
+#define err_get_code(err)	((err)&0x3fff)
+
+#define system_emask		(err_system(0x3f))
+#define sub_emask		(err_sub(0xfff))
+#define code_emask		(0x3fff)
+
+
+/*	major error systems	*/
+#define	err_kern		err_system(0x0)		/* kernel */
+#define	err_us			err_system(0x1)		/* user space library */
+#define	err_server		err_system(0x2)		/* user space servers */
+#define	err_ipc			err_system(0x3)		/* old ipc errors */
+#define err_mach_ipc		err_system(0x4)		/* mach-ipc errors */
+#define	err_dipc		err_system(0x7)		/* distributed ipc */
+#define err_local		err_system(0x3e)	/* user defined errors */
+#define	err_ipc_compat		err_system(0x3f)	/* (compatibility) mach-ipc errors */
+
+#define	err_max_system		0x3f
+
+
+/*	unix errors get lumped into one subsystem  */
+#define	unix_err(errno)		(err_kern|err_sub(3)|errno)
+
+typedef	kern_return_t	mach_error_t;
+typedef mach_error_t	(* mach_error_fn_t)( void );
+
+#endif	/* _MACH_ERROR_H_ */
diff -urN cctools-806-old/include/mach/exc.defs cctools-806/include/mach/exc.defs
--- cctools-806-old/include/mach/exc.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/exc.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,119 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ * Abstract:
+ *	MiG definitions file for Mach exception interface.
+ */
+
+subsystem
+#if	KERNEL_USER
+	  KernelUser
+#endif
+		     exc 2401;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+ServerPrefix catch_;
+
+type exception_data_t		= array[*:2] of integer_t;
+type exception_type_t		= int;
+
+routine		exception_raise(
+#if	KERNEL_USER
+			exception_port	: mach_port_move_send_t;
+			thread		: mach_port_move_send_t;
+			task		: mach_port_move_send_t;
+#else	/* KERNEL_USER */
+			exception_port	: mach_port_t;
+			thread		: mach_port_t;
+			task		: mach_port_t;
+#endif	/* KERNEL_USER */
+			exception	: exception_type_t;
+			code		: exception_data_t
+			);
+
+routine		exception_raise_state(
+#if	KERNEL_USER
+			exception_port	: mach_port_move_send_t;
+#else	/* KERNEL_USER */
+			exception_port	: mach_port_t;
+#endif	/* KERNEL_USER */
+			exception	: exception_type_t;
+			code		: exception_data_t, const;
+		  inout flavor		: int;
+			old_state	: thread_state_t, const;
+		    out new_state	: thread_state_t);
+
+routine		exception_raise_state_identity(
+#if	KERNEL_USER
+			exception_port  : mach_port_move_send_t;
+			thread		: mach_port_move_send_t;
+			task		: mach_port_move_send_t;
+#else	/* KERNEL_USER */
+			exception_port  : mach_port_t;
+			thread          : mach_port_t;
+			task            : mach_port_t;
+#endif	/* KERNEL_USER */
+			exception       : exception_type_t;
+			code            : exception_data_t;
+		  inout flavor          : int;
+			old_state       : thread_state_t;
+		    out new_state       : thread_state_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/exception.h cctools-806/include/mach/exception.h
--- cctools-806-old/include/mach/exception.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/exception.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,62 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+
+#ifndef	_MACH_EXCEPTION_H_
+#define	_MACH_EXCEPTION_H_
+
+#include <mach/exception_types.h>
+
+#endif	/* _MACH_EXCEPTION_H_ */
diff -urN cctools-806-old/include/mach/exception_types.h cctools-806/include/mach/exception_types.h
--- cctools-806-old/include/mach/exception_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/exception_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,181 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_MACH_EXCEPTION_TYPES_H_
+#define	_MACH_EXCEPTION_TYPES_H_
+
+#include <mach/machine/exception.h>
+
+/*
+ *	Machine-independent exception definitions.
+ */
+
+#define EXC_BAD_ACCESS		1	/* Could not access memory */
+		/* Code contains kern_return_t describing error. */
+		/* Subcode contains bad memory address. */
+
+#define EXC_BAD_INSTRUCTION	2	/* Instruction failed */
+		/* Illegal or undefined instruction or operand */
+
+#define EXC_ARITHMETIC		3	/* Arithmetic exception */
+		/* Exact nature of exception is in code field */
+
+#define EXC_EMULATION		4	/* Emulation instruction */
+		/* Emulation support instruction encountered */
+		/* Details in code and subcode fields	*/
+
+#define EXC_SOFTWARE		5	/* Software generated exception */
+		/* Exact exception is in code field. */
+		/* Codes 0 - 0xFFFF reserved to hardware */
+		/* Codes 0x10000 - 0x1FFFF reserved for OS emulation (Unix) */
+
+#define EXC_BREAKPOINT		6	/* Trace, breakpoint, etc. */
+		/* Details in code field. */
+
+#define EXC_SYSCALL		7	/* System calls. */
+
+#define EXC_MACH_SYSCALL	8	/* Mach system calls. */
+
+#define EXC_RPC_ALERT		9	/* RPC alert */
+ 
+#define EXC_CRASH		10	/* Abnormal process exit */
+
+/*
+ *	Machine-independent exception behaviors
+ */
+
+# define EXCEPTION_DEFAULT		1
+/*	Send a catch_exception_raise message including the identity.
+ */
+
+# define EXCEPTION_STATE		2
+/*	Send a catch_exception_raise_state message including the
+ *	thread state.
+ */
+
+# define EXCEPTION_STATE_IDENTITY	3
+/*	Send a catch_exception_raise_state_identity message including
+ *	the thread identity and state.
+ */
+
+#define MACH_EXCEPTION_CODES		0x80000000
+/*	Send 64-bit code and subcode in the exception header */
+
+/*
+ * Masks for exception definitions, above
+ * bit zero is unused, therefore 1 word = 31 exception types
+ */
+
+#define EXC_MASK_BAD_ACCESS		(1 << EXC_BAD_ACCESS)
+#define EXC_MASK_BAD_INSTRUCTION	(1 << EXC_BAD_INSTRUCTION)
+#define EXC_MASK_ARITHMETIC		(1 << EXC_ARITHMETIC)
+#define EXC_MASK_EMULATION		(1 << EXC_EMULATION)
+#define EXC_MASK_SOFTWARE		(1 << EXC_SOFTWARE)
+#define EXC_MASK_BREAKPOINT		(1 << EXC_BREAKPOINT)
+#define EXC_MASK_SYSCALL		(1 << EXC_SYSCALL)
+#define EXC_MASK_MACH_SYSCALL		(1 << EXC_MACH_SYSCALL)
+#define EXC_MASK_RPC_ALERT		(1 << EXC_RPC_ALERT)
+#define EXC_MASK_CRASH			(1 << EXC_CRASH)
+
+#define EXC_MASK_ALL	(EXC_MASK_BAD_ACCESS |			\
+			 EXC_MASK_BAD_INSTRUCTION |		\
+			 EXC_MASK_ARITHMETIC |			\
+			 EXC_MASK_EMULATION |			\
+			 EXC_MASK_SOFTWARE |			\
+			 EXC_MASK_BREAKPOINT |			\
+			 EXC_MASK_SYSCALL |			\
+			 EXC_MASK_MACH_SYSCALL |		\
+			 EXC_MASK_RPC_ALERT |			\
+			 EXC_MASK_MACHINE)
+
+
+#define FIRST_EXCEPTION		1	/* ZERO is illegal */
+
+/*
+ * Machine independent codes for EXC_SOFTWARE
+ * Codes 0x10000 - 0x1FFFF reserved for OS emulation (Unix) 
+ * 0x10000 - 0x10002 in use for unix signals
+ */
+#define	EXC_SOFT_SIGNAL		0x10003	/* Unix signal exceptions */
+
+#ifndef	ASSEMBLER
+
+#include <mach/port.h>
+#include <mach/thread_status.h>
+#include <mach/machine/vm_types.h>
+/*
+ * Exported types
+ */
+
+typedef int				exception_type_t;
+typedef	integer_t			exception_data_type_t;
+typedef	int64_t				mach_exception_data_type_t;
+typedef int				exception_behavior_t;
+typedef exception_data_type_t		*exception_data_t;
+typedef mach_exception_data_type_t	*mach_exception_data_t;
+typedef	unsigned int			exception_mask_t;
+typedef	exception_mask_t		*exception_mask_array_t;
+typedef exception_behavior_t		*exception_behavior_array_t;
+typedef thread_state_flavor_t		*exception_flavor_array_t;
+typedef mach_port_t			*exception_port_array_t;
+typedef	mach_exception_data_type_t	mach_exception_code_t;
+typedef	mach_exception_data_type_t	mach_exception_subcode_t;
+
+#endif	/* ASSEMBLER */
+
+#endif	/* _MACH_EXCEPTION_TYPES_H_ */
diff -urN cctools-806-old/include/mach/exc.h cctools-806/include/mach/exc.h
--- cctools-806-old/include/mach/exc.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/exc.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,258 @@
+#ifndef	_exc_user_
+#define	_exc_user_
+
+/* Module exc */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	exc_MSG_COUNT
+#define	exc_MSG_COUNT	3
+#endif	/* exc_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine exception_raise */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t exception_raise
+(
+	mach_port_t exception_port,
+	mach_port_t thread,
+	mach_port_t task,
+	exception_type_t exception,
+	exception_data_t code,
+	mach_msg_type_number_t codeCnt
+);
+
+/* Routine exception_raise_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t exception_raise_state
+(
+	mach_port_t exception_port,
+	exception_type_t exception,
+	const exception_data_t code,
+	mach_msg_type_number_t codeCnt,
+	int *flavor,
+	const thread_state_t old_state,
+	mach_msg_type_number_t old_stateCnt,
+	thread_state_t new_state,
+	mach_msg_type_number_t *new_stateCnt
+);
+
+/* Routine exception_raise_state_identity */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t exception_raise_state_identity
+(
+	mach_port_t exception_port,
+	mach_port_t thread,
+	mach_port_t task,
+	exception_type_t exception,
+	exception_data_t code,
+	mach_msg_type_number_t codeCnt,
+	int *flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t old_stateCnt,
+	thread_state_t new_state,
+	mach_msg_type_number_t *new_stateCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__exc_subsystem__defined
+#define __Request__exc_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t thread;
+		mach_msg_port_descriptor_t task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_type_t exception;
+		mach_msg_type_number_t codeCnt;
+		integer_t code[2];
+	} __Request__exception_raise_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_type_t exception;
+		mach_msg_type_number_t codeCnt;
+		integer_t code[2];
+		int flavor;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[144];
+	} __Request__exception_raise_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t thread;
+		mach_msg_port_descriptor_t task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_type_t exception;
+		mach_msg_type_number_t codeCnt;
+		integer_t code[2];
+		int flavor;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[144];
+	} __Request__exception_raise_state_identity_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__exc_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__exc_subsystem__defined
+#define __RequestUnion__exc_subsystem__defined
+union __RequestUnion__exc_subsystem {
+	__Request__exception_raise_t Request_exception_raise;
+	__Request__exception_raise_state_t Request_exception_raise_state;
+	__Request__exception_raise_state_identity_t Request_exception_raise_state_identity;
+};
+#endif /* !__RequestUnion__exc_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__exc_subsystem__defined
+#define __Reply__exc_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__exception_raise_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		int flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Reply__exception_raise_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		int flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Reply__exception_raise_state_identity_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__exc_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__exc_subsystem__defined
+#define __ReplyUnion__exc_subsystem__defined
+union __ReplyUnion__exc_subsystem {
+	__Reply__exception_raise_t Reply_exception_raise;
+	__Reply__exception_raise_state_t Reply_exception_raise_state;
+	__Reply__exception_raise_state_identity_t Reply_exception_raise_state_identity;
+};
+#endif /* !__RequestUnion__exc_subsystem__defined */
+
+#ifndef subsystem_to_name_map_exc
+#define subsystem_to_name_map_exc \
+    { "exception_raise", 2401 },\
+    { "exception_raise_state", 2402 },\
+    { "exception_raise_state_identity", 2403 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _exc_user_ */
diff -urN cctools-806-old/include/mach/host_info.h cctools-806/include/mach/host_info.h
--- cctools-806-old/include/mach/host_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/host_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,229 @@
+/*
+ * Copyright (c) 2000-2009 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	mach/host_info.h
+ *
+ *	Definitions for host_info call.
+ */
+
+#ifndef	_MACH_HOST_INFO_H_
+#define	_MACH_HOST_INFO_H_
+
+#include <mach/message.h>
+#include <mach/vm_statistics.h>
+#include <mach/machine.h>
+#include <mach/machine/vm_types.h>
+#include <mach/time_value.h>
+
+#include <sys/cdefs.h>
+
+/*
+ *	Generic information structure to allow for expansion.
+ */
+typedef integer_t	*host_info_t;		/* varying array of int. */
+typedef integer_t	*host_info64_t;		/* varying array of int. */
+
+#define	HOST_INFO_MAX	(1024)		/* max array size */
+typedef integer_t	host_info_data_t[HOST_INFO_MAX];
+
+#define KERNEL_VERSION_MAX (512)
+typedef char	kernel_version_t[KERNEL_VERSION_MAX];
+
+#define KERNEL_BOOT_INFO_MAX (4096)
+typedef char	kernel_boot_info_t[KERNEL_BOOT_INFO_MAX];
+
+/*
+ *	Currently defined information.
+ */
+/* host_info() */
+typedef	integer_t	host_flavor_t;
+#define HOST_BASIC_INFO		1	/* basic info */
+#define HOST_SCHED_INFO		3	/* scheduling info */
+#define HOST_RESOURCE_SIZES	4	/* kernel struct sizes */
+#define HOST_PRIORITY_INFO	5	/* priority information */
+#define HOST_SEMAPHORE_TRAPS	7	/* Has semaphore traps */
+#define HOST_MACH_MSG_TRAP	8	/* Has mach_msg_trap */
+
+
+#pragma pack(4)
+
+struct host_basic_info {
+	integer_t		max_cpus;		/* max number of CPUs possible */
+	integer_t		avail_cpus;		/* number of CPUs now available */
+	natural_t		memory_size;		/* size of memory in bytes, capped at 2 GB */
+	cpu_type_t		cpu_type;		/* cpu type */
+	cpu_subtype_t		cpu_subtype;		/* cpu subtype */
+	cpu_threadtype_t	cpu_threadtype;		/* cpu threadtype */
+	integer_t		physical_cpu;		/* number of physical CPUs now available */
+	integer_t		physical_cpu_max;	/* max number of physical CPUs possible */
+	integer_t		logical_cpu;		/* number of logical cpu now available */
+	integer_t		logical_cpu_max;	/* max number of physical CPUs possible */
+	uint64_t		max_mem;		/* actual size of physical memory */
+};
+
+#pragma pack()
+
+typedef	struct host_basic_info	host_basic_info_data_t;
+typedef struct host_basic_info	*host_basic_info_t;
+#define HOST_BASIC_INFO_COUNT ((mach_msg_type_number_t) \
+		(sizeof(host_basic_info_data_t)/sizeof(integer_t)))
+
+struct host_sched_info {
+	integer_t	min_timeout;	/* minimum timeout in milliseconds */
+	integer_t	min_quantum;	/* minimum quantum in milliseconds */
+};
+
+typedef	struct host_sched_info	host_sched_info_data_t;
+typedef struct host_sched_info	*host_sched_info_t;
+#define HOST_SCHED_INFO_COUNT ((mach_msg_type_number_t) \
+		(sizeof(host_sched_info_data_t)/sizeof(integer_t)))
+
+struct kernel_resource_sizes {
+	natural_t	task;
+        natural_t	thread;
+        natural_t	port;
+        natural_t	memory_region;
+        natural_t	memory_object;
+};
+
+typedef struct kernel_resource_sizes	kernel_resource_sizes_data_t;
+typedef struct kernel_resource_sizes	*kernel_resource_sizes_t;
+#define HOST_RESOURCE_SIZES_COUNT ((mach_msg_type_number_t) \
+		(sizeof(kernel_resource_sizes_data_t)/sizeof(integer_t)))
+
+struct host_priority_info {
+    	integer_t	kernel_priority;
+    	integer_t	system_priority;
+    	integer_t	server_priority;
+    	integer_t	user_priority;
+    	integer_t	depress_priority;
+    	integer_t	idle_priority;
+    	integer_t	minimum_priority;
+	integer_t	maximum_priority;
+};
+
+typedef struct host_priority_info	host_priority_info_data_t;
+typedef struct host_priority_info	*host_priority_info_t;
+#define HOST_PRIORITY_INFO_COUNT ((mach_msg_type_number_t) \
+		(sizeof(host_priority_info_data_t)/sizeof(integer_t)))
+
+/* host_statistics() */
+#define	HOST_LOAD_INFO		1	/* System loading stats */
+#define HOST_VM_INFO		2	/* Virtual memory stats */
+#define HOST_CPU_LOAD_INFO	3	/* CPU load stats */
+
+/* host_statistics64() */
+#define HOST_VM_INFO64		4	/* 64-bit virtual memory stats */
+#define HOST_EXTMOD_INFO64	5	/* External modification stats */
+
+
+struct host_load_info {
+	integer_t	avenrun[3];	/* scaled by LOAD_SCALE */
+	integer_t	mach_factor[3];	/* scaled by LOAD_SCALE */
+};
+
+typedef struct host_load_info	host_load_info_data_t;
+typedef struct host_load_info	*host_load_info_t;
+#define	HOST_LOAD_INFO_COUNT ((mach_msg_type_number_t) \
+		(sizeof(host_load_info_data_t)/sizeof(integer_t)))
+
+/* in <mach/vm_statistics.h> */
+/* vm_statistics64 */
+#define	HOST_VM_INFO64_COUNT ((mach_msg_type_number_t) \
+		(sizeof(vm_statistics64_data_t)/sizeof(integer_t)))
+
+/* size of the latest version of the structure */
+#define HOST_VM_INFO64_LATEST_COUNT HOST_VM_INFO64_COUNT
+
+/* in <mach/vm_statistics.h> */
+/* vm_extmod_statistics */
+#define HOST_EXTMOD_INFO64_COUNT ((mach_msg_type_number_t) \
+	    (sizeof(vm_extmod_statistics_data_t)/sizeof(integer_t)))
+
+/* size of the latest version of the structure */
+#define HOST_EXTMOD_INFO64_LATEST_COUNT HOST_EXTMOD_INFO64_COUNT
+
+/* vm_statistics */
+#define	HOST_VM_INFO_COUNT ((mach_msg_type_number_t) \
+		(sizeof(vm_statistics_data_t)/sizeof(integer_t)))
+
+/* size of the latest version of the structure */
+#define HOST_VM_INFO_LATEST_COUNT HOST_VM_INFO_COUNT
+#define	HOST_VM_INFO_REV2_COUNT HOST_VM_INFO_LATEST_COUNT
+/* previous versions: adjust the size according to what was added each time */
+#define	HOST_VM_INFO_REV1_COUNT /* added "speculative_count" (1 int) */	\
+	((mach_msg_type_number_t) \
+	 (HOST_VM_INFO_REV2_COUNT - 1))
+#define	HOST_VM_INFO_REV0_COUNT /* added "purgable" info (2 ints) */ 	\
+	((mach_msg_type_number_t) \
+	 (HOST_VM_INFO_REV1_COUNT - 2))
+
+struct host_cpu_load_info {		/* number of ticks while running... */
+	natural_t	cpu_ticks[CPU_STATE_MAX]; /* ... in the given mode */
+};
+
+typedef struct host_cpu_load_info	host_cpu_load_info_data_t;
+typedef struct host_cpu_load_info	*host_cpu_load_info_t;
+#define HOST_CPU_LOAD_INFO_COUNT ((mach_msg_type_number_t) \
+		(sizeof (host_cpu_load_info_data_t) / sizeof (integer_t)))
+
+
+
+
+#endif	/* _MACH_HOST_INFO_H_ */
diff -urN cctools-806-old/include/mach/host_notify.h cctools-806/include/mach/host_notify.h
--- cctools-806-old/include/mach/host_notify.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/host_notify.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef	_MACH_HOST_NOTIFY_H_
+#define	_MACH_HOST_NOTIFY_H_
+
+#define HOST_NOTIFY_CALENDAR_CHANGE		0
+#define HOST_NOTIFY_TYPE_MAX			0
+
+#define HOST_CALENDAR_CHANGED_REPLYID	950
+
+#endif /* _MACH_HOST_NOTIFY_H_ */
diff -urN cctools-806-old/include/mach/host_notify_reply.defs cctools-806/include/mach/host_notify_reply.defs
--- cctools-806-old/include/mach/host_notify_reply.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/host_notify_reply.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+subsystem
+#if	KERNEL_USER
+		KernelUser
+#endif	/* KERN_USER */
+			host_notify_reply 950;
+
+#include <mach/std_types.defs>
+
+simpleroutine host_calendar_changed(
+		notify_port	: mach_port_move_send_once_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/host_priv.defs cctools-806/include/mach/host_priv.defs
--- cctools-806-old/include/mach/host_priv.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/host_priv.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,380 @@
+/*
+ * Copyright (c) 2000-2004 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	Matchmaker definitions file for Mach kernel interface.
+ */
+subsystem
+#if	KERNEL_USER
+	  KernelUser
+#endif	/* KERNEL_USER */
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		       host_priv 400;
+
+#ifdef	KERNEL_USER
+userprefix r_;
+#endif	/* KERNEL_USER */
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach/clock_types.defs>
+#include <mach_debug/mach_debug_types.defs>
+
+/*
+ *      Get boot configuration information from kernel.
+ */
+routine host_get_boot_info(
+		host_priv	: host_priv_t;
+	out	boot_info	: kernel_boot_info_t);
+
+/*
+ *	Reboot this host.
+ *	Only available to privileged users.
+ */
+routine host_reboot(
+		host_priv	: host_priv_t;
+		options		: int);
+
+
+/*
+ *	Return privileged statistics from this host.
+ */
+routine host_priv_statistics(
+		host_priv	: host_priv_t;
+		flavor		: host_flavor_t;
+	out	host_info_out	: host_info_t, CountInOut);
+
+/*
+ *	Sets the default memory manager, the port to which
+ *	newly-created temporary memory objects are delivered.
+ *	[See (memory_object_default)memory_object_create.]
+ *	Also sets the default cluster size used for pagein/pageout
+ *	to this port.
+ *	The old memory manager port is returned.
+ */
+routine host_default_memory_manager(
+		host_priv	: host_priv_t;
+	inout	default_manager	: memory_object_default_t = 
+					MACH_MSG_TYPE_MAKE_SEND;
+		cluster_size	: memory_object_cluster_size_t);
+
+
+/*
+ *	Specify that the range of the virtual address space
+ *	of the target task must not cause page faults for
+ *	the indicated accesses.
+ *
+ *	[ To unwire the pages, specify VM_PROT_NONE. ]
+ */
+routine	vm_wire(
+		host_priv	: host_priv_t;
+		task		: vm_map_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		desired_access	: vm_prot_t);
+
+/*
+ *	Specify that the target thread must always be able
+ *	to run and to allocate memory.
+ */
+routine	thread_wire(
+		host_priv	: host_priv_t;
+		thread		: thread_act_t;
+		wired		: boolean_t);
+
+/*
+ *	Allocate zero-filled, wired, contiguous physical memory
+ *	in the address space of the target task, either at the
+ *	specified address, or wherever space can be found (if
+ *	anywhere is TRUE), of the specified size.  The address
+ *	at which the allocation actually took place is returned.
+ *	All pages will be entered into the task's pmap immediately,
+ *	with VM_PROT_ALL.
+ *
+ *	In addition to all the failure modes of its cousin,
+ *	vm_allocate, this call may also fail if insufficient
+ *	contiguous memory exists to satisfy the request.
+ *
+ *	Memory obtained from this call should be freed the
+ *	normal way, via vm_deallocate.
+ *
+ *	N.B.  This is an EXPERIMENTAL interface!
+ */
+routine	vm_allocate_cpm(
+		host_priv	: host_priv_t;
+		task		: vm_map_t;
+	inout	address		: vm_address_t;
+		size		: vm_size_t;
+		flags		: int);
+
+/*
+ *	Get list of processors on this host.
+ */
+routine host_processors(
+		host_priv		: host_priv_t;
+	out	out_processor_list	: processor_array_t);
+
+
+/*
+ *	Get control port for a system-wide clock.
+ *	Privileged.
+ */
+routine host_get_clock_control(
+		host_priv	: host_priv_t;
+		clock_id	: clock_id_t;
+	out	clock_ctrl	: clock_ctrl_t);
+
+
+/*
+ * kernel module interface (obsolete as of SnowLeopard)
+ * see mach/kmod.h
+ */
+/* kmod_ MIG calls now return KERN_NOT_SUPPORTED on PPC/i386/x86_64. */
+routine kmod_create(
+		host_priv	: host_priv_t;
+		info		: vm_address_t;
+	out	module		: kmod_t);
+
+routine kmod_destroy(
+		host_priv	: host_priv_t;
+		module		: kmod_t);
+
+routine	kmod_control(
+		host_priv	: host_priv_t;
+		module		: kmod_t;
+		flavor		: kmod_control_flavor_t;
+	inout	data		: kmod_args_t);
+
+/*
+ * 	Get a given special port for a given node.
+ * 	Special ports are defined in host_special_ports.h;
+ * 	examples include the master device port.
+ * 	There are a limited number of slots available for system servers.
+ */
+routine host_get_special_port(
+                host_priv       : host_priv_t;
+                node            : int;
+                which           : int;
+        out     port            : mach_port_t);
+
+/*
+ * 	Set a given special port for the local node.
+ * 	See host_get_special_port.
+ */
+routine host_set_special_port(
+                host_priv       : host_priv_t;
+                which           : int;
+                port            : mach_port_t);
+
+/*
+ * Set an exception handler for a host on one or more exception types.
+ * These handlers are invoked for all threads on the host if there are
+ * no task or thread-specific exception handlers or those handlers returned
+ * an error.
+ */
+routine	host_set_exception_ports(
+		host_priv	: host_priv_t;
+		exception_mask	: exception_mask_t;
+		new_port	: mach_port_t;
+		behavior	: exception_behavior_t;
+		new_flavor	: thread_state_flavor_t);
+
+
+/*
+ * Lookup some of the old exception handlers for a host
+ */
+routine	host_get_exception_ports(
+		host_priv	: host_priv_t;
+		exception_mask	: exception_mask_t;
+	  out	masks		: exception_mask_array_t;
+	  out	old_handlers	: exception_handler_array_t, SameCount;
+	  out	old_behaviors	: exception_behavior_array_t, SameCount;
+	  out	old_flavors	: exception_flavor_array_t, SameCount);
+
+
+/*
+ * Set an exception handler for a host on one or more exception types.
+ * At the same time, return the previously defined exception handlers for
+ * those types.
+ */
+routine	host_swap_exception_ports(
+		host_priv	: host_priv_t;
+		exception_mask	: exception_mask_t;
+		new_port	: mach_port_t;
+		behavior	: exception_behavior_t;
+		new_flavor	: thread_state_flavor_t;
+	  out	masks		: exception_mask_array_t;
+	  out	old_handlerss	: exception_handler_array_t, SameCount;
+	  out	old_behaviors	: exception_behavior_array_t, SameCount;
+	  out	old_flavors	: exception_flavor_array_t, SameCount);
+
+/*
+ *	Loads a symbol table for an external file into the kernel debugger.
+ *	The symbol table data is an array of characters.  It is assumed that
+ *	the caller and the kernel debugger agree on its format.
+ *      This call is only supported in MACH_DEBUG and MACH_KDB kernels,
+ *      otherwise KERN_FAILURE is returned.
+ */
+routine host_load_symbol_table(
+		host		: host_priv_t;
+		task		: task_t;
+		name		: symtab_name_t;
+		symtab		: pointer_t);
+
+/*
+ *	Specify that the range of the virtual address space
+ *	of the target task must not cause page faults for
+ *	the indicated accesses.
+ *
+ *	[ To unwire the pages, specify VM_PROT_NONE. ]
+ */
+routine	mach_vm_wire(
+		host_priv	: host_priv_t;
+		task		: vm_map_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		desired_access	: vm_prot_t);
+
+/*
+ * JMM - Keep all processor_set related items at the end for easy
+ * removal.
+ */
+/*
+ *	List all processor sets on host.
+ */
+routine host_processor_sets(
+		host_priv	: host_priv_t;
+	out	processor_sets	: processor_set_name_array_t);
+
+/*
+ *	Get control port for a processor set.
+ */
+routine host_processor_set_priv(
+		host_priv	: host_priv_t;
+		set_name	: processor_set_name_t;
+	out	set		: processor_set_t);
+
+/************************** Warning *************************************/
+/*       The following routines are going away in a future release	*/
+/*	use the appropriate variant of host_set_special_port instead	*/
+/************************************************************************/
+ 
+/*
+ *	Set the dynamic_pager control port. Other entities
+ *	can request a send right to this port to talk with
+ *	the dynamic_pager utility, setting behavioral parameters
+ *	within the dynamic pager and getting low/high backing store
+ *	resource notifications.
+ */
+routine set_dp_control_port(    
+		host		: host_priv_t;
+	in	control_port	: mach_port_t);
+
+/*
+ *	Get the dynamic_pager control port.  This port
+ *	allows the holder to talk directly with the dynamic
+ *	pager utility.
+ */
+routine get_dp_control_port(    
+		host		: host_priv_t;
+	out	contorl_port    :mach_port_t);
+
+/*
+ *	Set the UserNotification daemon access port for this host. 
+ *	If this value is already set, the kernel will discard its
+ *	reference to the previously registered port.
+ */
+routine host_set_UNDServer(    
+		host		: host_priv_t;
+	in	server		: UNDServerRef);
+
+/*
+ *	Get the UserNotification daemon access port for this host.
+ *	This can then be used to communicate with that daemon, which
+ *	in turn communicates with the User through whatever means
+ *	available (pop-up-menus for GUI systems, text for non-GUI, etc..).
+ *
+ *	Access to this port is restricted to privileged clients because
+ *	it is a special purpose port intended for kernel clients.  User
+ *	level clients should go directly to the CFUserNotifcation services.
+ */
+routine host_get_UNDServer(    
+		host		: host_priv_t;
+	out	server		: UNDServerRef);
+
+/*
+ * Perform an operation with a kernel extension, on the kext loading system,
+ * or request information about loaded kexts or the state of the kext loading
+ * system.
+ * Active operations (load, unload, disable/enable) require host_priv/root access.
+ * Info retrieval does not.
+ *
+ * WARNING: THIS ROUTINE IS PRIVATE TO THE KEXT-MANAGEMENT STACK AND IS
+ * SUBJECT TO CHANGE AT ANY TIME.
+ */
+routine kext_request(
+        host_priv      : host_priv_t;
+    in  user_log_flags : uint32_t;
+    in  request_data   : pointer_t;
+    out response_data  : pointer_t;
+    out log_data       : pointer_t;
+    out op_result      : kern_return_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/host_priv.h cctools-806/include/mach/host_priv.h
--- cctools-806-old/include/mach/host_priv.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/host_priv.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1270 @@
+#ifndef	_host_priv_user_
+#define	_host_priv_user_
+
+/* Module host_priv */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	host_priv_MSG_COUNT
+#define	host_priv_MSG_COUNT	26
+#endif	/* host_priv_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine host_get_boot_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_boot_info
+(
+	host_priv_t host_priv,
+	kernel_boot_info_t boot_info
+);
+
+/* Routine host_reboot */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_reboot
+(
+	host_priv_t host_priv,
+	int options
+);
+
+/* Routine host_priv_statistics */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_priv_statistics
+(
+	host_priv_t host_priv,
+	host_flavor_t flavor,
+	host_info_t host_info_out,
+	mach_msg_type_number_t *host_info_outCnt
+);
+
+/* Routine host_default_memory_manager */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_default_memory_manager
+(
+	host_priv_t host_priv,
+	memory_object_default_t *default_manager,
+	memory_object_cluster_size_t cluster_size
+);
+
+/* Routine vm_wire */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_wire
+(
+	host_priv_t host_priv,
+	vm_map_t task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_prot_t desired_access
+);
+
+/* Routine thread_wire */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_wire
+(
+	host_priv_t host_priv,
+	thread_act_t thread,
+	boolean_t wired
+);
+
+/* Routine vm_allocate_cpm */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_allocate_cpm
+(
+	host_priv_t host_priv,
+	vm_map_t task,
+	vm_address_t *address,
+	vm_size_t size,
+	int flags
+);
+
+/* Routine host_processors */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_processors
+(
+	host_priv_t host_priv,
+	processor_array_t *out_processor_list,
+	mach_msg_type_number_t *out_processor_listCnt
+);
+
+/* Routine host_get_clock_control */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_clock_control
+(
+	host_priv_t host_priv,
+	clock_id_t clock_id,
+	clock_ctrl_t *clock_ctrl
+);
+
+/* Routine kmod_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t kmod_create
+(
+	host_priv_t host_priv,
+	vm_address_t info,
+	kmod_t *module
+);
+
+/* Routine kmod_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t kmod_destroy
+(
+	host_priv_t host_priv,
+	kmod_t module
+);
+
+/* Routine kmod_control */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t kmod_control
+(
+	host_priv_t host_priv,
+	kmod_t module,
+	kmod_control_flavor_t flavor,
+	kmod_args_t *data,
+	mach_msg_type_number_t *dataCnt
+);
+
+/* Routine host_get_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_special_port
+(
+	host_priv_t host_priv,
+	int node,
+	int which,
+	mach_port_t *port
+);
+
+/* Routine host_set_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_set_special_port
+(
+	host_priv_t host_priv,
+	int which,
+	mach_port_t port
+);
+
+/* Routine host_set_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_set_exception_ports
+(
+	host_priv_t host_priv,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor
+);
+
+/* Routine host_get_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_exception_ports
+(
+	host_priv_t host_priv,
+	exception_mask_t exception_mask,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine host_swap_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_swap_exception_ports
+(
+	host_priv_t host_priv,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlerss,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine host_load_symbol_table */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_load_symbol_table
+(
+	host_priv_t host,
+	task_t task,
+	symtab_name_t name,
+	vm_offset_t symtab,
+	mach_msg_type_number_t symtabCnt
+);
+
+/* Routine mach_vm_wire */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_wire
+(
+	host_priv_t host_priv,
+	vm_map_t task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	vm_prot_t desired_access
+);
+
+/* Routine host_processor_sets */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_processor_sets
+(
+	host_priv_t host_priv,
+	processor_set_name_array_t *processor_sets,
+	mach_msg_type_number_t *processor_setsCnt
+);
+
+/* Routine host_processor_set_priv */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_processor_set_priv
+(
+	host_priv_t host_priv,
+	processor_set_name_t set_name,
+	processor_set_t *set
+);
+
+/* Routine set_dp_control_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t set_dp_control_port
+(
+	host_priv_t host,
+	mach_port_t control_port
+);
+
+/* Routine get_dp_control_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t get_dp_control_port
+(
+	host_priv_t host,
+	mach_port_t *contorl_port
+);
+
+/* Routine host_set_UNDServer */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_set_UNDServer
+(
+	host_priv_t host,
+	UNDServerRef server
+);
+
+/* Routine host_get_UNDServer */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_UNDServer
+(
+	host_priv_t host,
+	UNDServerRef *server
+);
+
+/* Routine kext_request */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t kext_request
+(
+	host_priv_t host_priv,
+	uint32_t user_log_flags,
+	vm_offset_t request_data,
+	mach_msg_type_number_t request_dataCnt,
+	vm_offset_t *response_data,
+	mach_msg_type_number_t *response_dataCnt,
+	vm_offset_t *log_data,
+	mach_msg_type_number_t *log_dataCnt,
+	kern_return_t *op_result
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__host_priv_subsystem__defined
+#define __Request__host_priv_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_get_boot_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int options;
+	} __Request__host_reboot_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		host_flavor_t flavor;
+		mach_msg_type_number_t host_info_outCnt;
+	} __Request__host_priv_statistics_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t default_manager;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		memory_object_cluster_size_t cluster_size;
+	} __Request__host_default_memory_manager_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_prot_t desired_access;
+	} __Request__vm_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t thread;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t wired;
+	} __Request__thread_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		int flags;
+	} __Request__vm_allocate_cpm_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_processors_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		clock_id_t clock_id;
+	} __Request__host_get_clock_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t info;
+	} __Request__kmod_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kmod_t module;
+	} __Request__kmod_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		kmod_t module;
+		kmod_control_flavor_t flavor;
+		mach_msg_type_number_t dataCnt;
+	} __Request__kmod_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int node;
+		int which;
+	} __Request__host_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int which;
+	} __Request__host_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__host_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+	} __Request__host_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__host_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t task;
+		mach_msg_ool_descriptor_t symtab;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t nameOffset; /* MiG doesn't use it */
+		mach_msg_type_number_t nameCnt;
+		char name[32];
+		mach_msg_type_number_t symtabCnt;
+	} __Request__host_load_symbol_table_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		vm_prot_t desired_access;
+	} __Request__mach_vm_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_processor_sets_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t set_name;
+		/* end of the kernel processed data */
+	} __Request__host_processor_set_priv_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t control_port;
+		/* end of the kernel processed data */
+	} __Request__set_dp_control_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__get_dp_control_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t server;
+		/* end of the kernel processed data */
+	} __Request__host_set_UNDServer_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_get_UNDServer_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t request_data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		uint32_t user_log_flags;
+		mach_msg_type_number_t request_dataCnt;
+	} __Request__kext_request_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__host_priv_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__host_priv_subsystem__defined
+#define __RequestUnion__host_priv_subsystem__defined
+union __RequestUnion__host_priv_subsystem {
+	__Request__host_get_boot_info_t Request_host_get_boot_info;
+	__Request__host_reboot_t Request_host_reboot;
+	__Request__host_priv_statistics_t Request_host_priv_statistics;
+	__Request__host_default_memory_manager_t Request_host_default_memory_manager;
+	__Request__vm_wire_t Request_vm_wire;
+	__Request__thread_wire_t Request_thread_wire;
+	__Request__vm_allocate_cpm_t Request_vm_allocate_cpm;
+	__Request__host_processors_t Request_host_processors;
+	__Request__host_get_clock_control_t Request_host_get_clock_control;
+	__Request__kmod_create_t Request_kmod_create;
+	__Request__kmod_destroy_t Request_kmod_destroy;
+	__Request__kmod_control_t Request_kmod_control;
+	__Request__host_get_special_port_t Request_host_get_special_port;
+	__Request__host_set_special_port_t Request_host_set_special_port;
+	__Request__host_set_exception_ports_t Request_host_set_exception_ports;
+	__Request__host_get_exception_ports_t Request_host_get_exception_ports;
+	__Request__host_swap_exception_ports_t Request_host_swap_exception_ports;
+	__Request__host_load_symbol_table_t Request_host_load_symbol_table;
+	__Request__mach_vm_wire_t Request_mach_vm_wire;
+	__Request__host_processor_sets_t Request_host_processor_sets;
+	__Request__host_processor_set_priv_t Request_host_processor_set_priv;
+	__Request__set_dp_control_port_t Request_set_dp_control_port;
+	__Request__get_dp_control_port_t Request_get_dp_control_port;
+	__Request__host_set_UNDServer_t Request_host_set_UNDServer;
+	__Request__host_get_UNDServer_t Request_host_get_UNDServer;
+	__Request__kext_request_t Request_kext_request;
+};
+#endif /* !__RequestUnion__host_priv_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__host_priv_subsystem__defined
+#define __Reply__host_priv_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t boot_infoOffset; /* MiG doesn't use it */
+		mach_msg_type_number_t boot_infoCnt;
+		char boot_info[4096];
+	} __Reply__host_get_boot_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_reboot_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t host_info_outCnt;
+		integer_t host_info_out[15];
+	} __Reply__host_priv_statistics_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t default_manager;
+		/* end of the kernel processed data */
+	} __Reply__host_default_memory_manager_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t address;
+	} __Reply__vm_allocate_cpm_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t out_processor_list;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t out_processor_listCnt;
+	} __Reply__host_processors_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t clock_ctrl;
+		/* end of the kernel processed data */
+	} __Reply__host_get_clock_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		kmod_t module;
+	} __Reply__kmod_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__kmod_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t dataCnt;
+	} __Reply__kmod_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t port;
+		/* end of the kernel processed data */
+	} __Reply__host_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__host_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlerss[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__host_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_load_symbol_table_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t processor_sets;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t processor_setsCnt;
+	} __Reply__host_processor_sets_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t set;
+		/* end of the kernel processed data */
+	} __Reply__host_processor_set_priv_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__set_dp_control_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t contorl_port;
+		/* end of the kernel processed data */
+	} __Reply__get_dp_control_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_set_UNDServer_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t server;
+		/* end of the kernel processed data */
+	} __Reply__host_get_UNDServer_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t response_data;
+		mach_msg_ool_descriptor_t log_data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t response_dataCnt;
+		mach_msg_type_number_t log_dataCnt;
+		kern_return_t op_result;
+	} __Reply__kext_request_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__host_priv_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__host_priv_subsystem__defined
+#define __ReplyUnion__host_priv_subsystem__defined
+union __ReplyUnion__host_priv_subsystem {
+	__Reply__host_get_boot_info_t Reply_host_get_boot_info;
+	__Reply__host_reboot_t Reply_host_reboot;
+	__Reply__host_priv_statistics_t Reply_host_priv_statistics;
+	__Reply__host_default_memory_manager_t Reply_host_default_memory_manager;
+	__Reply__vm_wire_t Reply_vm_wire;
+	__Reply__thread_wire_t Reply_thread_wire;
+	__Reply__vm_allocate_cpm_t Reply_vm_allocate_cpm;
+	__Reply__host_processors_t Reply_host_processors;
+	__Reply__host_get_clock_control_t Reply_host_get_clock_control;
+	__Reply__kmod_create_t Reply_kmod_create;
+	__Reply__kmod_destroy_t Reply_kmod_destroy;
+	__Reply__kmod_control_t Reply_kmod_control;
+	__Reply__host_get_special_port_t Reply_host_get_special_port;
+	__Reply__host_set_special_port_t Reply_host_set_special_port;
+	__Reply__host_set_exception_ports_t Reply_host_set_exception_ports;
+	__Reply__host_get_exception_ports_t Reply_host_get_exception_ports;
+	__Reply__host_swap_exception_ports_t Reply_host_swap_exception_ports;
+	__Reply__host_load_symbol_table_t Reply_host_load_symbol_table;
+	__Reply__mach_vm_wire_t Reply_mach_vm_wire;
+	__Reply__host_processor_sets_t Reply_host_processor_sets;
+	__Reply__host_processor_set_priv_t Reply_host_processor_set_priv;
+	__Reply__set_dp_control_port_t Reply_set_dp_control_port;
+	__Reply__get_dp_control_port_t Reply_get_dp_control_port;
+	__Reply__host_set_UNDServer_t Reply_host_set_UNDServer;
+	__Reply__host_get_UNDServer_t Reply_host_get_UNDServer;
+	__Reply__kext_request_t Reply_kext_request;
+};
+#endif /* !__RequestUnion__host_priv_subsystem__defined */
+
+#ifndef subsystem_to_name_map_host_priv
+#define subsystem_to_name_map_host_priv \
+    { "host_get_boot_info", 400 },\
+    { "host_reboot", 401 },\
+    { "host_priv_statistics", 402 },\
+    { "host_default_memory_manager", 403 },\
+    { "vm_wire", 404 },\
+    { "thread_wire", 405 },\
+    { "vm_allocate_cpm", 406 },\
+    { "host_processors", 407 },\
+    { "host_get_clock_control", 408 },\
+    { "kmod_create", 409 },\
+    { "kmod_destroy", 410 },\
+    { "kmod_control", 411 },\
+    { "host_get_special_port", 412 },\
+    { "host_set_special_port", 413 },\
+    { "host_set_exception_ports", 414 },\
+    { "host_get_exception_ports", 415 },\
+    { "host_swap_exception_ports", 416 },\
+    { "host_load_symbol_table", 417 },\
+    { "mach_vm_wire", 418 },\
+    { "host_processor_sets", 419 },\
+    { "host_processor_set_priv", 420 },\
+    { "set_dp_control_port", 421 },\
+    { "get_dp_control_port", 422 },\
+    { "host_set_UNDServer", 423 },\
+    { "host_get_UNDServer", 424 },\
+    { "kext_request", 425 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _host_priv_user_ */
diff -urN cctools-806-old/include/mach/host_reboot.h cctools-806/include/mach/host_reboot.h
--- cctools-806-old/include/mach/host_reboot.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/host_reboot.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,39 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef _MACH_HOST_REBOOT_
+#define _MACH_HOST_REBOOT_
+
+#define HOST_REBOOT_HALT        0x0008
+#define HOST_REBOOT_UPSDELAY    0x0100
+#define	HOST_REBOOT_DEBUGGER	0x1000
+
+#endif	/* _MACH_HOST_REBOOT_ */
diff -urN cctools-806-old/include/mach/host_security.defs cctools-806/include/mach/host_security.defs
--- cctools-806-old/include/mach/host_security.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/host_security.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,101 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ * File:	mach/host_security.defs
+ *
+ * Abstract:
+ *	Mach host security operations support.
+ */
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		      host_security 600;
+
+/*
+ *	Basic types
+ */
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+
+/*
+ *	Create a new task with an explicit security token
+ */
+routine host_security_create_task_token(
+		host_security	: host_security_t;
+		parent_task	: task_t;
+		sec_token	: security_token_t;
+		audit_token	: audit_token_t;
+		host		: host_t;
+		ledgers		: ledger_array_t;
+		inherit_memory	: boolean_t;
+	out	child_task	: task_t);
+
+/*
+ *	Change a task's security token
+ */
+routine host_security_set_task_token(
+		host_security	: host_security_t;
+		target_task	: task_t;
+		sec_token	: security_token_t;
+		audit_token	: audit_token_t;
+		host		: host_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/host_security.h cctools-806/include/mach/host_security.h
--- cctools-806-old/include/mach/host_security.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/host_security.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,198 @@
+#ifndef	_host_security_user_
+#define	_host_security_user_
+
+/* Module host_security */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	host_security_MSG_COUNT
+#define	host_security_MSG_COUNT	2
+#endif	/* host_security_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine host_security_create_task_token */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_security_create_task_token
+(
+	host_security_t host_security,
+	task_t parent_task,
+	security_token_t sec_token,
+	audit_token_t audit_token,
+	host_t host,
+	ledger_array_t ledgers,
+	mach_msg_type_number_t ledgersCnt,
+	boolean_t inherit_memory,
+	task_t *child_task
+);
+
+/* Routine host_security_set_task_token */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_security_set_task_token
+(
+	host_security_t host_security,
+	task_t target_task,
+	security_token_t sec_token,
+	audit_token_t audit_token,
+	host_t host
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__host_security_subsystem__defined
+#define __Request__host_security_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t parent_task;
+		mach_msg_port_descriptor_t host;
+		mach_msg_ool_ports_descriptor_t ledgers;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		security_token_t sec_token;
+		audit_token_t audit_token;
+		mach_msg_type_number_t ledgersCnt;
+		boolean_t inherit_memory;
+	} __Request__host_security_create_task_token_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t target_task;
+		mach_msg_port_descriptor_t host;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		security_token_t sec_token;
+		audit_token_t audit_token;
+	} __Request__host_security_set_task_token_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__host_security_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__host_security_subsystem__defined
+#define __RequestUnion__host_security_subsystem__defined
+union __RequestUnion__host_security_subsystem {
+	__Request__host_security_create_task_token_t Request_host_security_create_task_token;
+	__Request__host_security_set_task_token_t Request_host_security_set_task_token;
+};
+#endif /* !__RequestUnion__host_security_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__host_security_subsystem__defined
+#define __Reply__host_security_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_task;
+		/* end of the kernel processed data */
+	} __Reply__host_security_create_task_token_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_security_set_task_token_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__host_security_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__host_security_subsystem__defined
+#define __ReplyUnion__host_security_subsystem__defined
+union __ReplyUnion__host_security_subsystem {
+	__Reply__host_security_create_task_token_t Reply_host_security_create_task_token;
+	__Reply__host_security_set_task_token_t Reply_host_security_set_task_token;
+};
+#endif /* !__RequestUnion__host_security_subsystem__defined */
+
+#ifndef subsystem_to_name_map_host_security
+#define subsystem_to_name_map_host_security \
+    { "host_security_create_task_token", 600 },\
+    { "host_security_set_task_token", 601 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _host_security_user_ */
diff -urN cctools-806-old/include/mach/host_special_ports.h cctools-806/include/mach/host_special_ports.h
--- cctools-806-old/include/mach/host_special_ports.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/host_special_ports.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,180 @@
+/*
+ * Copyright (c) 2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/host_special_ports.h
+ *
+ *	Defines codes for access to host-wide special ports.
+ */
+
+#ifndef _MACH_HOST_SPECIAL_PORTS_H_
+#define _MACH_HOST_SPECIAL_PORTS_H_
+
+/*
+ * Cannot be set or gotten from user space
+ */
+#define HOST_SECURITY_PORT               0
+
+/*
+ * Always provided by kernel (cannot be set from user-space).
+ */
+#define HOST_PORT                        1
+#define HOST_PRIV_PORT                   2
+#define HOST_IO_MASTER_PORT              3
+#define HOST_MAX_SPECIAL_KERNEL_PORT     7 /* room to grow */
+
+/*
+ * Not provided by kernel
+ */
+#define HOST_DYNAMIC_PAGER_PORT         (1 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_AUDIT_CONTROL_PORT         (2 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_USER_NOTIFICATION_PORT     (3 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_AUTOMOUNTD_PORT            (4 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_LOCKD_PORT                 (5 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_SEATBELT_PORT              (7 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_KEXTD_PORT                 (8 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_CHUD_PORT                  (9 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_UNFREED_PORT		(10 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_AMFID_PORT			(11 + HOST_MAX_SPECIAL_KERNEL_PORT)
+#define HOST_MAX_SPECIAL_PORT           (12 + HOST_MAX_SPECIAL_KERNEL_PORT)
+                                        /* room to grow here as well */
+
+/*
+ * Special node identifier to always represent the local node.
+ */
+#define HOST_LOCAL_NODE	                 -1
+			
+/*
+ * Definitions for ease of use.
+ *
+ * In the get call, the host parameter can be any host, but will generally
+ * be the local node host port. In the set call, the host must the per-node
+ * host port for the node being affected.
+ */
+#define host_get_host_port(host, port)	\
+	(host_get_special_port((host), 	\
+	HOST_LOCAL_NODE, HOST_PORT, (port)))
+#define host_set_host_port(host, port) (KERN_INVALID_ARGUMENT)
+
+#define host_get_host_priv_port(host, port)	\
+	(host_get_special_port((host), 		\
+	HOST_LOCAL_NODE, HOST_PRIV_PORT, (port)))
+#define host_set_host_priv_port(host, port) (KERN_INVALID_ARGUMENT)
+
+#define host_get_io_master_port(host, port)	\
+	(host_get_special_port((host), 		\
+	HOST_LOCAL_NODE, HOST_IO_MASTER_PORT, (port)))
+#define host_set_io_master_port(host, port) (KERN_INVALID_ARGUMENT)
+
+/*
+ * User-settable special ports.
+ */
+#define host_get_dynamic_pager_port(host, port)	\
+	(host_get_special_port((host),			\
+	HOST_LOCAL_NODE, HOST_DYNAMIC_PAGER_PORT, (port)))
+#define host_set_dynamic_pager_port(host, port)	\
+	(host_set_special_port((host), HOST_DYNAMIC_PAGER_PORT, (port)))
+
+#define host_get_audit_control_port(host, port)	\
+	(host_get_special_port((host), 		\
+	HOST_LOCAL_NODE, HOST_AUDIT_CONTROL_PORT, (port)))
+#define host_set_audit_control_port(host, port)	\
+	(host_set_special_port((host), HOST_AUDIT_CONTROL_PORT, (port)))
+
+#define host_get_user_notification_port(host, port)	\
+	(host_get_special_port((host), 			\
+	HOST_LOCAL_NODE, HOST_USER_NOTIFICATION_PORT, (port)))
+#define host_set_user_notification_port(host, port)	\
+	(host_set_special_port((host), HOST_USER_NOTIFICATION_PORT, (port)))
+
+#define host_get_automountd_port(host, port)	\
+	(host_get_special_port((host), 		\
+	HOST_LOCAL_NODE, HOST_AUTOMOUNTD_PORT, (port)))
+#define host_set_automountd_port(host, port)	\
+	(host_set_special_port((host), HOST_AUTOMOUNTD_PORT, (port)))
+
+#define host_get_lockd_port(host, port)	\
+	(host_get_special_port((host), 			\
+	HOST_LOCAL_NODE, HOST_LOCKD_PORT, (port)))
+#define host_set_lockd_port(host, port)	\
+	(host_set_special_port((host), HOST_LOCKD_PORT, (port)))
+
+#define host_get_kextd_port(host, port)	\
+	(host_get_special_port((host), 			\
+	HOST_LOCAL_NODE, HOST_KEXTD_PORT, (port)))
+#define host_set_kextd_port(host, port)	\
+	(host_set_special_port((host), HOST_KEXTD_PORT, (port)))
+
+#define host_get_chud_port(host, port)	\
+	(host_get_special_port((host), 			\
+	HOST_LOCAL_NODE, HOST_CHUD_PORT, (port)))
+#define host_set_chud_port(host, port)	\
+	(host_set_special_port((host), HOST_CHUD_PORT, (port)))
+
+#define host_get_unfreed_port(host, port)	\
+	(host_get_special_port((host), 			\
+	HOST_LOCAL_NODE, HOST_UNFREED_PORT, (port)))
+#define host_set_unfreed_port(host, port)	\
+	(host_set_special_port((host), HOST_UNFREED_PORT, (port)))
+
+#define host_get_amfid_port(host, port)	\
+	(host_get_special_port((host), 			\
+	HOST_LOCAL_NODE, HOST_AMFID_PORT, (port)))
+#define host_set_amfid_port(host, port)	\
+	(host_set_special_port((host), HOST_AMFID_PORT, (port)))
+
+#endif	/* _MACH_HOST_SPECIAL_PORTS_H_ */
diff -urN cctools-806-old/include/mach/i386/asm.h cctools-806/include/mach/i386/asm.h
--- cctools-806-old/include/mach/i386/asm.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/asm.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,408 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+
+#ifndef	_I386_ASM_H_
+#define	_I386_ASM_H_
+
+#ifdef _KERNEL
+#include <gprof.h>
+#endif	/* _KERNEL */
+
+#ifdef MACH_KERNEL
+#include <mach_kdb.h>
+#else	/* !MACH_KERNEL */
+#define	MACH_KDB 0
+#endif	/* !MACH_KERNEL */
+
+
+#if	defined(MACH_KERNEL) || defined(_KERNEL)
+#include <gprof.h>
+#endif	/* MACH_KERNEL || _KERNEL */
+
+#if defined(__i386__)
+
+#define S_PC	 (%esp)
+#define S_ARG0	 4(%esp)
+#define S_ARG1	 8(%esp)
+#define S_ARG2	12(%esp)
+#define S_ARG3	16(%esp)
+#define S_ARG4	20(%esp)
+
+#define FRAME	pushl %ebp; movl %esp, %ebp
+#define EMARF	leave
+
+#define B_LINK	 (%ebp)
+#define B_PC	 4(%ebp)
+#define B_ARG0	 8(%ebp)
+#define B_ARG1	12(%ebp)
+#define B_ARG2	16(%ebp)
+#define B_ARG3	20(%ebp)
+
+#elif defined(__x86_64__)
+
+#define S_PC	 (%rsp)
+
+#define FRAME	pushq %rbp; movq %rsp, %rbp
+#define EMARF	leave
+
+#define B_LINK	 (%rbp)
+#define B_PC	 8(%rbp)
+
+#else
+#error unsupported architecture
+#endif
+
+/* There is another definition of ALIGN for .c sources */
+#ifdef ASSEMBLER
+#define ALIGN 4,0x90
+#endif /* ASSEMBLER */
+
+#ifndef FALIGN
+#define FALIGN ALIGN
+#endif
+
+#define LB(x,n) n
+#if	__STDC__
+#ifndef __NO_UNDERSCORES__
+#define	LCL(x)	L ## x
+#define EXT(x) _ ## x
+#define LEXT(x) _ ## x ## :
+#else
+#define	LCL(x)	.L ## x
+#define EXT(x) x
+#define LEXT(x) x ## :
+#endif
+#define LBc(x,n) n ## :
+#define LBb(x,n) n ## b
+#define LBf(x,n) n ## f
+#else /* __STDC__ */
+#ifndef __NO_UNDERSCORES__
+#define LCL(x) L/**/x
+#define EXT(x) _/**/x
+#define LEXT(x) _/**/x/**/:
+#else /* __NO_UNDERSCORES__ */
+#define	LCL(x)	.L/**/x
+#define EXT(x) x
+#define LEXT(x) x/**/:
+#endif /* __NO_UNDERSCORES__ */
+#define LBc(x,n) n/**/:
+#define LBb(x,n) n/**/b
+#define LBf(x,n) n/**/f
+#endif /* __STDC__ */
+
+#define SVC .byte 0x9a; .long 0; .word 0x7
+
+#define RPC_SVC .byte 0x9a; .long 0; .word 0xf
+
+#define String	.asciz
+#define Value	.word
+#define Times(a,b) (a*b)
+#define Divide(a,b) (a/b)
+
+#define INB	inb	%dx, %al
+#define OUTB	outb	%al, %dx
+#define INL	inl	%dx, %eax
+#define OUTL	outl	%eax, %dx
+
+#define data16	.byte 0x66
+#define addr16	.byte 0x67
+
+#if !GPROF
+#define MCOUNT
+
+#elif defined(__SHARED__)
+#define MCOUNT		; .data;\
+			.align ALIGN;\
+			LBc(x, 8) .long 0;\
+			.text;\
+			Gpush;\
+			Gload;\
+			leal Gotoff(LBb(x,8)),%edx;\
+			Egaddr(%eax,_mcount_ptr);\
+			Gpop;\
+			call *(%eax);
+
+#else	/* !GPROF, !__SHARED__ */
+#define MCOUNT		; call mcount;
+#endif /* GPROF */
+
+#ifdef __ELF__
+#define ELF_FUNC(x)	.type x,@function
+#define ELF_DATA(x)	.type x,@object
+#define ELF_SIZE(x,s)	.size x,s
+#else
+#define ELF_FUNC(x)
+#define ELF_DATA(x)
+#define ELF_SIZE(x,s)
+#endif
+
+#define	Entry(x)	.globl EXT(x); ELF_FUNC(EXT(x)); .align FALIGN; LEXT(x)
+#define	ENTRY(x)	Entry(x) MCOUNT
+#define	ENTRY2(x,y)	.globl EXT(x); .globl EXT(y); \
+			ELF_FUNC(EXT(x)); ELF_FUNC(EXT(y)); \
+			.align FALIGN; LEXT(x); LEXT(y) \
+			MCOUNT
+#if __STDC__
+#define	ASENTRY(x) 	.globl x; .align FALIGN; x ## : ELF_FUNC(x) MCOUNT
+#else
+#define	ASENTRY(x) 	.globl x; .align FALIGN; x: ELF_FUNC(x) MCOUNT
+#endif /* __STDC__ */
+
+#define	DATA(x)		.globl EXT(x); ELF_DATA(EXT(x)); .align ALIGN; LEXT(x)
+
+#define End(x)		ELF_SIZE(x,.-x)
+#define END(x)		End(EXT(x))
+#define ENDDATA(x)	END(x)
+#define Enddata(x)	End(x)
+
+/*
+ * ELF shared library accessor macros.
+ * Gpush saves the %ebx register used for the GOT address
+ * Gpop pops %ebx if we need a GOT
+ * Gload loads %ebx with the GOT address if shared libraries are used
+ * Gcall calls an external function.
+ * Gotoff allows you to reference local labels.
+ * Gotoff2 allows you to reference local labels with an index reg.
+ * Gotoff3 allows you to reference local labels with an index reg & size.
+ * Gaddr loads up a register with an address of an external item.
+ * Gstack is the number of bytes that Gpush pushes on the stack.
+ *
+ * Varients of the above with E or L prefixes do EXT(name) or LCL(name)
+ * respectively.
+ */
+
+#ifndef __SHARED__
+#define Gpush
+#define Gpop
+#define Gload
+#define Gcall(func)		call func
+#define Gotoff(lab)		lab
+#define Gotoff2(l,r)		l(r)
+#define Gotoff3(l,r,s)		l(,r,s)
+#define Gaddr(to,lab)		movl $lab,to
+#define Gcmp(lab,reg)		cmpl $lab,reg
+#define Gmemload(lab,reg)	movl lab,reg
+#define Gmemstore(reg,lab,tmp)	movl reg,lab
+#define Gstack			0
+
+#else
+#ifdef __ELF__			/* ELF shared libraries */
+#define Gpush			pushl %ebx
+#define Gpop			popl %ebx
+#define Gload			call 9f; 9: popl %ebx; addl $_GLOBAL_OFFSET_TABLE_+[.-9b],%ebx
+#define Gcall(func)		call EXT(func)@PLT
+#define Gotoff(lab)		lab@GOTOFF(%ebx)
+#define Gotoff2(l,r)		l@GOTOFF(%ebx,r)
+#define Gotoff3(l,r,s)		l@GOTOFF(%ebx,r,s)
+#define Gaddr(to,lab)		movl lab@GOT(%ebx),to
+#define Gcmp(lab,reg)		cmpl reg,lab@GOT(%ebx)
+#define Gmemload(lab,reg)	movl lab@GOT(%ebx),reg; movl (reg),reg
+#define Gmemstore(reg,lab,tmp)	movl lab@GOT(%ebx),tmp; movl reg,(tmp)
+#define Gstack			4
+
+#else				/* ROSE shared libraries */
+#define Gpush
+#define Gpop
+#define Gload
+#define Gcall(func)		call *9f; .data; .align ALIGN; 9: .long func; .text
+#define Gotoff(lab)		lab
+#define Gotoff2(l,r)		l(r)
+#define Gotoff3(l,r,s)		l(,r,s)
+#define Gaddr(to,lab)		movl 9f,to; .data; .align ALIGN; 9: .long lab; .text
+#define Gcmp(lab,reg)		cmpl reg,9f; .data; .align ALIGN; 9: .long lab; .text
+#define Gmemload(lab,reg)	movl 9f,reg; movl (reg),reg; .data; .align ALIGN; 9: .long lab; .text
+#define Gmemstore(reg,lab,tmp)	movl 9f,tmp; movl reg,(tmp); .data; .align ALIGN; 9: .long lab; .text
+#define Gstack			0
+#endif	/* __ELF__ */
+#endif	/* __SHARED__ */
+
+/* Egotoff is not provided, since external symbols should not use @GOTOFF
+   relocations.  */
+#define Egcall(func)		Gcall(EXT(func))
+#define Egaddr(to,lab)		Gaddr(to,EXT(lab))
+#define Egcmp(lab,reg)		Gcmp(EXT(lab),reg)
+#define Egmemload(lab,reg)	Gmemload(EXT(lab),reg)
+#define Egmemstore(reg,lab,tmp)	Gmemstore(reg,EXT(lab),tmp)
+
+#define Lgotoff(lab)		Gotoff(LCL(lab))
+#define Lgotoff2(l,r)		Gotoff2(LCL(l),r)
+#define Lgotoff3(l,r,s)		Gotoff3(LCL(l),r,s)
+#define Lgcmp(lab,reg)		Gcmp(LCL(lab),reg)
+#define Lgmemload(lab,reg)	movl Lgotoff(lab),reg
+#define Lgmemstore(reg,lab,tmp)	movl reg,Lgotoff(lab)
+
+#ifdef ASSEMBLER
+#if	MACH_KDB
+#include <ddb/stab.h>
+/*
+ * This pseudo-assembler line is added so that there will be at least
+ *	one N_SO entry in the symbol stable to define the current file name.
+ */
+#endif	/* MACH_KDB */
+
+#else /* NOT ASSEMBLER */
+
+/* These defines are here for .c files that wish to reference global symbols
+ * within __asm__ statements. 
+ */
+#ifndef __NO_UNDERSCORES__
+#define CC_SYM_PREFIX "_"
+#else
+#define CC_SYM_PREFIX ""
+#endif /* __NO_UNDERSCORES__ */
+#endif /* ASSEMBLER */
+
+/*
+ * The following macros make calls into C code.
+ * They dynamically align the stack to 16 bytes.
+ */
+#if defined(__i386__)
+/*
+ * Arguments are moved (not pushed) onto the correctly aligned stack.
+ * NOTE: ESI is destroyed in the process, and hence cannot
+ * be directly used as a parameter. Users of this macro must
+ * independently preserve ESI (a non-volatile) if the routine is
+ * intended to be called from C, for instance.
+ */
+
+#define CCALL(fn)			\
+	movl	%esp, %esi		;\
+	andl	$0xFFFFFFF0, %esp	;\
+	call	EXT(fn)			;\
+	movl	%esi, %esp
+
+#define CCALL1(fn, arg1)		\
+	movl	%esp, %esi		;\
+	subl	$4, %esp		;\
+	andl	$0xFFFFFFF0, %esp	;\
+	movl	arg1, (%esp)		;\
+	call	EXT(fn)			;\
+	movl	%esi, %esp
+
+#define CCALL2(fn, arg1, arg2)		\
+	movl	%esp, %esi		;\
+	subl	$8, %esp		;\
+	andl	$0xFFFFFFF0, %esp	;\
+	movl	arg2, 4(%esp)		;\
+	movl	arg1, (%esp)		;\
+	call	EXT(fn)			;\
+	movl	%esi, %esp
+
+/* This variant exists to permit adjustment of the stack by "dtrace" */
+#define CCALL1WITHSP(fn, arg1)		\
+	movl	%esp, %esi		;\
+	subl	$12, %esp		;\
+	andl	$0xFFFFFFF0, %esp	;\
+	movl	%esi, 8(%esp)		;\
+	leal	8(%esp), %esi		;\
+	movl	%esi, 4(%esp)		;\
+	movl	arg1, (%esp)		;\
+	call	EXT(fn)			;\
+	movl	8(%esp), %esp
+
+/*
+ * CCALL5 is used for callee functions with 3 arguments but
+ * where arg2 (a3:a2) and arg3 (a5:a4) are 64-bit values.
+ */
+#define CCALL5(fn, a1, a2, a3, a4, a5)	\
+	movl	%esp, %esi		;\
+	subl	$20, %esp		;\
+	andl	$0xFFFFFFF0, %esp	;\
+	movl	a5, 16(%esp)		;\
+	movl	a4, 12(%esp)		;\
+	movl	a3,  8(%esp)		;\
+	movl	a2,  4(%esp)		;\
+	movl	a1,  (%esp)		;\
+	call	EXT(fn)			;\
+	movl	%esi, %esp
+
+#elif defined(__x86_64__)
+
+/* This variant exists to permit adjustment of the stack by "dtrace" */
+#define CCALLWITHSP(fn)				 \
+	mov	%rsp, %r12			;\
+	sub	$8, %rsp			;\
+	and	$0xFFFFFFFFFFFFFFF0, %rsp	;\
+	mov	%r12, (%rsp)			;\
+	leaq	(%rsp), %rsi			;\
+	call	EXT(fn)				;\
+	mov	(%rsp), %rsp
+	
+#define CCALL(fn)				 \
+	mov	%rsp, %r12			;\
+	and	$0xFFFFFFFFFFFFFFF0, %rsp	;\
+	call	EXT(fn)				;\
+	mov	%r12, %rsp
+
+#define CCALL1(fn, arg1) 			 \
+	mov	arg1, %rdi 			;\
+	CCALL(fn)
+
+#define CCALL2(fn, arg1, arg2)		 	 \
+	mov	arg1, %rdi 			;\
+	CCALL(fn)
+
+#define CCALL3(fn, arg1, arg2, arg3) 		 \
+	mov	arg1, %rdi 			;\
+	mov	arg2, %rsi 			;\
+	mov	arg3, %rdx 			;\
+	CCALL(fn)
+
+#else
+#error unsupported architecture
+#endif
+
+#endif /* _I386_ASM_H_ */
diff -urN cctools-806-old/include/mach/i386/boolean.h cctools-806/include/mach/i386/boolean.h
--- cctools-806-old/include/mach/i386/boolean.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/boolean.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,74 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	boolean.h
+ *
+ *	Boolean type, for I386.
+ */
+
+#ifndef	_MACH_I386_BOOLEAN_H_
+#define _MACH_I386_BOOLEAN_H_
+
+#if defined(__x86_64__) && !defined(KERNEL)
+typedef unsigned int	boolean_t;
+#else
+typedef int		boolean_t;
+#endif
+
+#endif	/* _MACH_I386_BOOLEAN_H_ */
diff -urN cctools-806-old/include/mach/i386/exception.h cctools-806/include/mach/i386/exception.h
--- cctools-806-old/include/mach/i386/exception.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/exception.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,135 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_MACH_I386_EXCEPTION_H_
+#define _MACH_I386_EXCEPTION_H_
+
+/*
+ * No machine dependent types for the 80386
+ */
+
+#define	EXC_TYPES_COUNT	11	/* incl. illegal exception 0 */
+
+/*
+ *	Codes and subcodes for 80386 exceptions.
+ */
+
+#define EXCEPTION_CODE_MAX	2	/* currently code and subcode */
+
+/*
+ *	EXC_BAD_INSTRUCTION
+ */
+
+#define EXC_I386_INVOP			1
+
+/*
+ *	EXC_ARITHMETIC
+ */
+
+#define EXC_I386_DIV			1
+#define EXC_I386_INTO			2
+#define EXC_I386_NOEXT			3
+#define EXC_I386_EXTOVR			4
+#define EXC_I386_EXTERR			5
+#define EXC_I386_EMERR			6
+#define EXC_I386_BOUND			7
+#define EXC_I386_SSEEXTERR              8
+
+/*
+ *	EXC_SOFTWARE
+ *	Note: 0x10000-0x10003 in use for unix signal
+ */
+
+/*
+ *	EXC_BAD_ACCESS
+ */
+
+/*
+ *	EXC_BREAKPOINT
+ */
+
+#define EXC_I386_SGL			1
+#define EXC_I386_BPT			2
+
+#define EXC_I386_DIVERR		0	/* divide by 0 eprror		*/
+#define EXC_I386_SGLSTP		1	/* single step			*/
+#define EXC_I386_NMIFLT		2	/* NMI				*/
+#define EXC_I386_BPTFLT		3	/* breakpoint fault		*/
+#define EXC_I386_INTOFLT	4	/* INTO overflow fault		*/
+#define EXC_I386_BOUNDFLT	5	/* BOUND instruction fault	*/
+#define EXC_I386_INVOPFLT	6	/* invalid opcode fault		*/
+#define EXC_I386_NOEXTFLT	7	/* extension not available fault*/
+#define EXC_I386_DBLFLT		8	/* double fault			*/
+#define EXC_I386_EXTOVRFLT	9	/* extension overrun fault	*/
+#define EXC_I386_INVTSSFLT	10	/* invalid TSS fault		*/
+#define EXC_I386_SEGNPFLT	11	/* segment not present fault	*/
+#define EXC_I386_STKFLT		12	/* stack fault			*/
+#define EXC_I386_GPFLT		13	/* general protection fault	*/
+#define EXC_I386_PGFLT		14	/* page fault			*/
+#define EXC_I386_EXTERRFLT	16	/* extension error fault	*/
+#define	EXC_I386_ALIGNFLT	17	/* Alignment fault */
+#define EXC_I386_ENDPERR	33	/* emulated extension error flt	*/
+#define EXC_I386_ENOEXTFLT	32	/* emulated ext not present	*/
+
+
+/*
+ *	machine dependent exception masks
+ */
+#define	EXC_MASK_MACHINE	0
+
+#endif	/* _MACH_I386_EXCEPTION_H_ */
diff -urN cctools-806-old/include/mach/i386/fp_reg.h cctools-806/include/mach/i386/fp_reg.h
--- cctools-806-old/include/mach/i386/fp_reg.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/fp_reg.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,118 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1992-1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_I386_FP_SAVE_H_
+#define	_I386_FP_SAVE_H_
+
+/*
+ * Control register
+ */
+#define	FPC_IE		0x0001		/* enable invalid operation
+					   exception */
+#define FPC_IM		FPC_IE
+#define	FPC_DE		0x0002		/* enable denormalized operation
+					   exception */
+#define FPC_DM		FPC_DE
+#define	FPC_ZE		0x0004		/* enable zero-divide exception */
+#define FPC_ZM		FPC_ZE
+#define	FPC_OE		0x0008		/* enable overflow exception */
+#define FPC_OM		FPC_OE
+#define	FPC_UE		0x0010		/* enable underflow exception */
+#define	FPC_PE		0x0020		/* enable precision exception */
+#define	FPC_PC		0x0300		/* precision control: */
+#define	FPC_PC_24	0x0000			/* 24 bits */
+#define	FPC_PC_53	0x0200			/* 53 bits */
+#define	FPC_PC_64	0x0300			/* 64 bits */
+#define	FPC_RC		0x0c00		/* rounding control: */
+#define	FPC_RC_RN	0x0000			/* round to nearest or even */
+#define	FPC_RC_RD	0x0400			/* round down */
+#define	FPC_RC_RU	0x0800			/* round up */
+#define	FPC_RC_CHOP	0x0c00			/* chop */
+#define	FPC_IC		0x1000		/* infinity control (obsolete) */
+#define	FPC_IC_PROJ	0x0000			/* projective infinity */
+#define	FPC_IC_AFF	0x1000			/* affine infinity (std) */
+
+/*
+ * Status register
+ */
+#define	FPS_IE		0x0001		/* invalid operation */
+#define	FPS_DE		0x0002		/* denormalized operand */
+#define	FPS_ZE		0x0004		/* divide by zero */
+#define	FPS_OE		0x0008		/* overflow */
+#define	FPS_UE		0x0010		/* underflow */
+#define	FPS_PE		0x0020		/* precision */
+#define	FPS_SF		0x0040		/* stack flag */
+#define	FPS_ES		0x0080		/* error summary */
+#define	FPS_C0		0x0100		/* condition code bit 0 */
+#define	FPS_C1		0x0200		/* condition code bit 1 */
+#define	FPS_C2		0x0400		/* condition code bit 2 */
+#define	FPS_TOS		0x3800		/* top-of-stack pointer */
+#define	FPS_TOS_SHIFT	11
+#define	FPS_C3		0x4000		/* condition code bit 3 */
+#define	FPS_BUSY	0x8000		/* FPU busy */
+
+/*
+ * Kind of floating-point support provided by kernel.
+ */
+#define	FP_NO		0		/* no floating point */
+#define	FP_SOFT		1		/* software FP emulator */
+#define	FP_287		2		/* 80287 */
+#define	FP_387		3		/* 80387 or 80486 */
+#define FP_FXSR		4		/* Fast save/restore SIMD Extension */
+
+#endif	/* _I386_FP_SAVE_H_ */
diff -urN cctools-806-old/include/mach/i386/kern_return.h cctools-806/include/mach/i386/kern_return.h
--- cctools-806-old/include/mach/i386/kern_return.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/kern_return.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,74 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	kern_return.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *	Date:	1985
+ *
+ *	Machine-dependent kernel return definitions.
+ */
+
+#ifndef	_MACH_I386_KERN_RETURN_H_
+#define _MACH_I386_KERN_RETURN_H_
+
+#ifndef	ASSEMBLER
+typedef	int		kern_return_t;
+#endif	/* ASSEMBLER */
+
+#endif	/* _MACH_I386_KERN_RETURN_H_ */
diff -urN cctools-806-old/include/mach/i386/machine_types.defs cctools-806/include/mach/i386/machine_types.defs
--- cctools-806-old/include/mach/i386/machine_types.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/machine_types.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,127 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+/*
+ *	Header file for basic, machine-dependent data types.  i386 version.
+ */
+
+#ifndef	_MACHINE_VM_TYPES_DEFS_
+#define	_MACHINE_VM_TYPES_DEFS_	1
+
+type short = int16_t;
+type int = int32_t;
+type unsigned = uint32_t;
+
+type float = MACH_MSG_TYPE_REAL_32;
+type double = MACH_MSG_TYPE_REAL_64;
+
+
+/* from ISO/IEC 988:1999 spec */
+/* 7.18.1.4 Integer types capable of hgolding object pointers */
+/*
+ * The [u]intptr_t types for the native
+ * integer type, e.g. 32 or 64 or.. whatever
+ * register size the machine has.  They are
+ * used for entities that might be either
+ * [unsigned] integers or pointers, and for
+ * type-casting between the two.
+ *
+ * For instance, the IPC system represents
+ * a port in user space as an integer and
+ * in kernel space as a pointer.
+ */
+#if defined(__LP64__)
+type uintptr_t = uint64_t;
+type intptr_t = int64_t;
+#else
+type uintptr_t = uint32_t;
+type intptr_t = int32_t;
+#endif
+
+/*
+ * These are the legacy Mach types that are
+ * the [rough] equivalents of the standards above.
+ * They were defined in terms of int, not
+ * long int, so they remain separate.
+ */
+#if defined(__LP64__)
+type register_t = int64_t;
+#else
+type register_t = int32_t;
+#endif
+type integer_t = int32_t;
+type natural_t = uint32_t;
+
+/*
+ * These are the VM types that scale with the address
+ * space size of a given process.
+ */
+
+#if defined(__LP64__)
+type vm_address_t = uint64_t;
+type vm_offset_t = uint64_t;
+type vm_size_t = uint64_t;
+#else
+type vm_address_t = natural_t;
+type vm_offset_t = natural_t;
+type vm_size_t = natural_t;
+#endif
+
+/*
+ * The mach_vm_xxx_t types are sized to hold the
+ * maximum pointer, offset, etc... supported on the
+ * platform.
+ */
+type mach_vm_address_t = uint64_t;
+type mach_vm_offset_t = uint64_t;
+type mach_vm_size_t = uint64_t;
+
+#if	MACH_IPC_COMPAT
+/*
+ * For the old IPC interface
+ */
+#define	MSG_TYPE_PORT_NAME	natural_t
+
+#endif	/* MACH_IPC_COMPAT */
+
+/*
+ * These are types used internal to Mach to implement the
+ * legacy 32-bit VM APIs published by the kernel.
+ */
+#define	VM32_SUPPORT	1
+
+type vm32_address_t = uint32_t;
+type vm32_offset_t = uint32_t;
+type vm32_size_t = uint32_t;
+
+#endif	/* _MACHINE_VM_TYPES_DEFS_ */
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/i386/ndr_def.h cctools-806/include/mach/i386/ndr_def.h
--- cctools-806-old/include/mach/i386/ndr_def.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/ndr_def.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,45 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+/* NDR record for Intel x86s */
+
+#include <mach/ndr.h>
+
+NDR_record_t NDR_record = {
+	0,			/* mig_reserved */
+	0,			/* mig_reserved */
+	0,			/* mig_reserved */
+	NDR_PROTOCOL_2_0,		
+	NDR_INT_LITTLE_ENDIAN,
+	NDR_CHAR_ASCII,
+	NDR_FLOAT_IEEE,
+	0,
+};
diff -urN cctools-806-old/include/mach/i386/processor_info.h cctools-806/include/mach/i386/processor_info.h
--- cctools-806-old/include/mach/i386/processor_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/processor_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ *	File:	mach/i386/processor_info.h
+ *
+ *	Data structure definitions for i386 specific processor control
+ */
+
+#ifndef	_MACH_I386_PROCESSOR_INFO_H_
+#define _MACH_I386_PROCESSOR_INFO_H_
+
+#endif	/* _MACH_I386_PROCESSOR_INFO_H_ */
diff -urN cctools-806-old/include/mach/i386/rpc.h cctools-806/include/mach/i386/rpc.h
--- cctools-806-old/include/mach/i386/rpc.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/rpc.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,36 @@
+/*
+ * Copyright (c) 2002,2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef	_MACH_I386_RPC_H_
+#define	_MACH_I386_RPC_H_
+
+#endif	/* _MACH_I386_RPC_H_ */
+
diff -urN cctools-806-old/include/mach/i386/sdt_isa.h cctools-806/include/mach/i386/sdt_isa.h
--- cctools-806-old/include/mach/i386/sdt_isa.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/sdt_isa.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,414 @@
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License, Version 1.0 only
+ * (the "License").  You may not use this file except in compliance
+ * with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+/*
+ * Copyright 2004 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef _MACH_I386_SDT_ISA_H
+#define	_MACH_I386_SDT_ISA_H
+
+/*
+ * Only define when testing.  This makes the calls into actual calls to
+ * test functions.
+ */
+/* #define DTRACE_CALL_TEST */
+
+#define DTRACE_STRINGIFY(s) #s
+#define DTRACE_TOSTRING(s) DTRACE_STRINGIFY(s)
+#define DTRACE_LABEL(p, n)									\
+	"__dtrace_probe$" DTRACE_TOSTRING(%=__LINE__) DTRACE_STRINGIFY(_##p##___##n) ":"	"\n\t"
+
+#ifdef DTRACE_CALL_TEST
+
+#define DTRACE_CALL(p,n)	\
+	DTRACE_LABEL(p,n)	\
+	DTRACE_CALL_INSN(p,n)
+
+#else
+
+#define DTRACE_CALL(p,n)	\
+	DTRACE_LABEL(p,n)	\
+	DTRACE_NOPS
+
+#endif
+
+#ifdef __x86_64__
+
+#define DTRACE_NOPS			\
+	"nop"			"\n\t"	\
+	"nop"			"\n\t"	\
+	"nop"			"\n\t"	
+
+#define DTRACE_CALL_INSN(p,n)						\
+	"call _dtracetest" DTRACE_STRINGIFY(_##p##_##n)	"\n\t"
+
+#define ARG1_EXTENT	1
+#define ARGS2_EXTENT	2
+#define ARGS3_EXTENT	3
+#define ARGS4_EXTENT	4
+#define ARGS5_EXTENT	5
+#define ARGS6_EXTENT	6
+#define ARGS7_EXTENT	7
+#define ARGS8_EXTENT	8
+#define ARGS9_EXTENT	10	
+#define ARGS10_EXTENT	10	
+
+#define DTRACE_CALL0ARGS(provider, name)							\
+	asm volatile (										\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              :										\
+	);
+
+#define DTRACE_CALL1ARG(provider, name)								\
+	asm volatile ("movq\t0x0(%0),%%rdi"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi"								\
+	);
+
+#define DTRACE_CALL2ARGS(provider, name)							\
+	asm volatile ("movq\t0x0(%0),%%rdi"						"\n\t"	\
+	              "movq\t0x8(%0),%%rsi"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi", "rsi"							\
+	);
+
+#define DTRACE_CALL3ARGS(provider, name)							\
+	asm volatile ("movq\t0x0(%0),%%rdi"						"\n\t"	\
+	              "movq\t0x8(%0),%%rsi"						"\n\t"	\
+	              "movq\t0x10(%0),%%rdx"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi", "rsi", "rdx"						\
+	);
+
+#define DTRACE_CALL4ARGS(provider, name)							\
+	asm volatile ("movq\t0x0(%0),%%rdi"						"\n\t"	\
+	              "movq\t0x8(%0),%%rsi"						"\n\t"	\
+	              "movq\t0x10(%0),%%rdx"						"\n\t"	\
+	              "movq\t0x18(%0),%%rcx"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi", "rsi", "rdx", "rcx"					\
+	);
+
+#define DTRACE_CALL5ARGS(provider, name)							\
+	asm volatile ("movq\t0x0(%0),%%rdi"						"\n\t"	\
+	              "movq\t0x8(%0),%%rsi"						"\n\t"	\
+	              "movq\t0x10(%0),%%rdx"						"\n\t"	\
+	              "movq\t0x18(%0),%%rcx"						"\n\t"	\
+	              "movq\t0x20(%0),%%r8"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi", "rsi", "rdx", "rcx", "r8"				\
+	);
+
+#define DTRACE_CALL6ARGS(provider, name)							\
+	asm volatile ("movq\t0x0(%0),%%rdi"						"\n\t"	\
+	              "movq\t0x8(%0),%%rsi"						"\n\t"	\
+	              "movq\t0x10(%0),%%rdx"						"\n\t"	\
+	              "movq\t0x18(%0),%%rcx"						"\n\t"	\
+	              "movq\t0x20(%0),%%r8"						"\n\t"	\
+	              "movq\t0x28(%0),%%r9"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi", "rsi", "rdx", "rcx", "r8", "r9"			\
+	);
+
+#define DTRACE_CALL7ARGS(provider, name)							\
+	asm volatile ("subq\t$0x8,%%rsp"						"\n\t"	\
+	              "movq\t0x0(%0),%%rdi"						"\n\t"	\
+	              "movq\t0x8(%0),%%rsi"						"\n\t"	\
+	              "movq\t0x10(%0),%%rdx"						"\n\t"	\
+	              "movq\t0x18(%0),%%rcx"						"\n\t"	\
+	              "movq\t0x20(%0),%%r8"						"\n\t"	\
+	              "movq\t0x28(%0),%%r9"						"\n\t"	\
+	              "movq\t0x30(%0),%%rax"						"\n\t"	\
+	              "movq\t%%rax,0x0(%%rsp)"						"\n\t"	\
+		      DTRACE_CALL(provider, name)						\
+	              "addq\t$0x8,%%rsp"						"\n\t"	\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "rdi", "rsi", "rdx", "rcx", "r8", "r9", "rax"			\
+	);
+
+#endif // __x86_64__
+
+#ifdef __i386__
+
+#define DTRACE_NOPS			\
+	"nop"			"\n\t"	\
+	"leal 0(%%esi), %%esi"	"\n\t"	
+
+#define DTRACE_CALL_INSN(p,n)						\
+	"call _dtracetest" DTRACE_STRINGIFY(_##p##_##n)	"\n\t"
+
+#define ARG1_EXTENT	1
+#define ARGS2_EXTENT	2
+#define ARGS3_EXTENT	4
+#define ARGS4_EXTENT	4
+#define ARGS5_EXTENT	8
+#define ARGS6_EXTENT	8
+#define ARGS7_EXTENT	8
+#define ARGS8_EXTENT	8
+#define ARGS9_EXTENT	12	
+#define ARGS10_EXTENT	12	
+
+/*
+ * Because this code is used in the kernel, we must not touch any floating point
+ * or specialized registers. This leaves the following registers:
+ *
+ * eax ; volatile, safe to use
+ * ebx ; PIC register, gcc error when used
+ * ecx ; volatile, safe to use
+ * edx ; volatile, safe to use
+ * esi ; non-volatile, otherwise safe to use
+ * edi ; non-volatile, otherwise safe to use
+ *
+ * Using any of the non volatile register causes a spill to stack which is almost
+ * certainly a net performance loss. Also, note that the array ref (__dtrace_args)
+ * consumes one free register. If all three of the volatile regs are used for load/store,
+ * the compiler will spill a register to hold the array ref.
+ *
+ * The end result is that we only pipeline two loads/stores at a time. Blech.
+ */
+
+#define DTRACE_CALL0ARGS(provider, name)							\
+	asm volatile (										\
+	              DTRACE_CALL(provider, name)						\
+	              "# eat trailing nl +tabfrom DTRACE_CALL"					\
+	              :										\
+	              :										\
+	);
+
+#define DTRACE_CALL1ARG(provider, name)								\
+	asm volatile ("subl\t$0x10,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x10,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)		       					\
+	              : "memory", "eax"								\
+	);
+
+#define DTRACE_CALL2ARGS(provider, name)							\
+	asm volatile ("subl\t$0x10,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x10,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"							\
+	);
+
+#define DTRACE_CALL3ARGS(provider, name)							\
+	asm volatile ("subl\t$0x10,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x10,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"							\
+	);
+
+#define DTRACE_CALL4ARGS(provider, name)							\
+	asm volatile ("subl\t$0x10,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x10,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#define DTRACE_CALL5ARGS(provider, name)							\
+	asm volatile ("subl\t$0x20,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              "movl\t0x10(%0),%%eax"						"\n\t"	\
+	              "movl\t%%eax,0x10(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x20,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#define DTRACE_CALL6ARGS(provider, name)							\
+	asm volatile ("subl\t$0x20,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              "movl\t0x10(%0),%%eax"						"\n\t"	\
+		      "movl\t0x14(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x10(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x14(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x20,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#define DTRACE_CALL7ARGS(provider, name)							\
+	asm volatile ("subl\t$0x20,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              "movl\t0x10(%0),%%eax"						"\n\t"	\
+		      "movl\t0x14(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x10(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x14(%%esp)"						"\n\t"	\
+	              "movl\t0x18(%0),%%eax"						"\n\t"	\
+	              "movl\t%%eax,0x18(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x20,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#define DTRACE_CALL8ARGS(provider, name)							\
+	asm volatile ("subl\t$0x20,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              "movl\t0x10(%0),%%eax"						"\n\t"	\
+		      "movl\t0x14(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x10(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x14(%%esp)"						"\n\t"	\
+	              "movl\t0x18(%0),%%eax"						"\n\t"	\
+		      "movl\t0x1C(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x18(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x1C(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x20,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#define DTRACE_CALL9ARGS(provider, name)							\
+	asm volatile ("subl\t$0x30,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              "movl\t0x10(%0),%%eax"						"\n\t"	\
+		      "movl\t0x14(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x10(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x14(%%esp)"						"\n\t"	\
+	              "movl\t0x18(%0),%%eax"						"\n\t"	\
+		      "movl\t0x1C(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x18(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x1C(%%esp)"						"\n\t"	\
+	              "movl\t0x20(%0),%%eax"						"\n\t"	\
+	              "movl\t%%eax,0x20(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x30,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#define DTRACE_CALL10ARGS(provider, name)							\
+	asm volatile ("subl\t$0x30,%%esp"						"\n\t"	\
+	              "movl\t0x0(%0),%%eax"						"\n\t"	\
+		      "movl\t0x4(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x0(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x4(%%esp)"						"\n\t"	\
+	              "movl\t0x8(%0),%%eax"						"\n\t"	\
+		      "movl\t0xC(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x8(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0xC(%%esp)"						"\n\t"	\
+	              "movl\t0x10(%0),%%eax"						"\n\t"	\
+		      "movl\t0x14(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x10(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x14(%%esp)"						"\n\t"	\
+	              "movl\t0x18(%0),%%eax"						"\n\t"	\
+		      "movl\t0x1C(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x18(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x1C(%%esp)"						"\n\t"	\
+	              "movl\t0x20(%0),%%eax"						"\n\t"	\
+		      "movl\t0x24(%0),%%edx"						"\n\t"	\
+	              "movl\t%%eax,0x20(%%esp)"						"\n\t"	\
+	              "movl\t%%edx,0x24(%%esp)"						"\n\t"	\
+	              DTRACE_CALL(provider, name)						\
+                      "addl\t$0x30,%%esp"							\
+	              :										\
+	              : "r" (__dtrace_args)							\
+	              : "memory", "eax", "edx"	       						\
+	);
+
+#endif // __i386__
+
+#endif	/* _MACH_I386_SDT_ISA_H */
diff -urN cctools-806-old/include/mach/i386/_structs.h cctools-806/include/mach/i386/_structs.h
--- cctools-806-old/include/mach/i386/_structs.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/_structs.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,797 @@
+/*
+ * Copyright (c) 2004-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef	_MACH_I386__STRUCTS_H_
+#define	_MACH_I386__STRUCTS_H_
+
+/*
+ * i386 is the structure that is exported to user threads for 
+ * use in status/mutate calls.  This structure should never change.
+ *
+ */
+
+#if __DARWIN_UNIX03
+#define	_STRUCT_X86_THREAD_STATE32	struct __darwin_i386_thread_state
+_STRUCT_X86_THREAD_STATE32
+{
+    unsigned int	__eax;
+    unsigned int	__ebx;
+    unsigned int	__ecx;
+    unsigned int	__edx;
+    unsigned int	__edi;
+    unsigned int	__esi;
+    unsigned int	__ebp;
+    unsigned int	__esp;
+    unsigned int	__ss;
+    unsigned int	__eflags;
+    unsigned int	__eip;
+    unsigned int	__cs;
+    unsigned int	__ds;
+    unsigned int	__es;
+    unsigned int	__fs;
+    unsigned int	__gs;
+};
+#else /* !__DARWIN_UNIX03 */
+#define	_STRUCT_X86_THREAD_STATE32	struct i386_thread_state
+_STRUCT_X86_THREAD_STATE32
+{
+    unsigned int	eax;
+    unsigned int	ebx;
+    unsigned int	ecx;
+    unsigned int	edx;
+    unsigned int	edi;
+    unsigned int	esi;
+    unsigned int	ebp;
+    unsigned int	esp;
+    unsigned int	ss;
+    unsigned int	eflags;
+    unsigned int	eip;
+    unsigned int	cs;
+    unsigned int	ds;
+    unsigned int	es;
+    unsigned int	fs;
+    unsigned int	gs;
+};
+#endif /* !__DARWIN_UNIX03 */
+
+/* This structure should be double-word aligned for performance */
+
+#if __DARWIN_UNIX03
+#define _STRUCT_FP_CONTROL	struct __darwin_fp_control
+_STRUCT_FP_CONTROL
+{
+    unsigned short		__invalid	:1,
+    				__denorm	:1,
+				__zdiv		:1,
+				__ovrfl		:1,
+				__undfl		:1,
+				__precis	:1,
+						:2,
+				__pc		:2,
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define FP_PREC_24B		0
+#define	FP_PREC_53B		2
+#define FP_PREC_64B		3
+#endif /* !_POSIX_C_SOURCE || _DARWIN_C_SOURCE */
+				__rc		:2,
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define FP_RND_NEAR		0
+#define FP_RND_DOWN		1
+#define FP_RND_UP		2
+#define FP_CHOP			3
+#endif /* !_POSIX_C_SOURCE || _DARWIN_C_SOURCE */
+					/*inf*/	:1,
+						:3;
+};
+typedef _STRUCT_FP_CONTROL	__darwin_fp_control_t;
+#else /* !__DARWIN_UNIX03 */
+#define _STRUCT_FP_CONTROL	struct fp_control
+_STRUCT_FP_CONTROL
+{
+    unsigned short		invalid	:1,
+    				denorm	:1,
+				zdiv	:1,
+				ovrfl	:1,
+				undfl	:1,
+				precis	:1,
+					:2,
+				pc	:2,
+#define FP_PREC_24B		0
+#define	FP_PREC_53B		2
+#define FP_PREC_64B		3
+				rc	:2,
+#define FP_RND_NEAR		0
+#define FP_RND_DOWN		1
+#define FP_RND_UP		2
+#define FP_CHOP			3
+				/*inf*/	:1,
+					:3;
+};
+typedef _STRUCT_FP_CONTROL	fp_control_t;
+#endif /* !__DARWIN_UNIX03 */
+
+/*
+ * Status word.
+ */
+
+#if __DARWIN_UNIX03
+#define _STRUCT_FP_STATUS	struct __darwin_fp_status
+_STRUCT_FP_STATUS
+{
+    unsigned short		__invalid	:1,
+    				__denorm	:1,
+				__zdiv		:1,
+				__ovrfl		:1,
+				__undfl		:1,
+				__precis	:1,
+				__stkflt	:1,
+				__errsumm	:1,
+				__c0		:1,
+				__c1		:1,
+				__c2		:1,
+				__tos		:3,
+				__c3		:1,
+				__busy		:1;
+};
+typedef _STRUCT_FP_STATUS	__darwin_fp_status_t;
+#else /* !__DARWIN_UNIX03 */
+#define _STRUCT_FP_STATUS	struct fp_status
+_STRUCT_FP_STATUS
+{
+    unsigned short		invalid	:1,
+    				denorm	:1,
+				zdiv	:1,
+				ovrfl	:1,
+				undfl	:1,
+				precis	:1,
+				stkflt	:1,
+				errsumm	:1,
+				c0	:1,
+				c1	:1,
+				c2	:1,
+				tos	:3,
+				c3	:1,
+				busy	:1;
+};
+typedef _STRUCT_FP_STATUS	fp_status_t;
+#endif /* !__DARWIN_UNIX03 */
+				
+/* defn of 80bit x87 FPU or MMX register  */
+
+#if __DARWIN_UNIX03
+#define _STRUCT_MMST_REG	struct __darwin_mmst_reg
+_STRUCT_MMST_REG
+{
+	char	__mmst_reg[10];
+	char	__mmst_rsrv[6];
+};
+#else /* !__DARWIN_UNIX03 */
+#define _STRUCT_MMST_REG	struct mmst_reg
+_STRUCT_MMST_REG
+{
+	char	mmst_reg[10];
+	char	mmst_rsrv[6];
+};
+#endif /* !__DARWIN_UNIX03 */
+
+
+/* defn of 128 bit XMM regs */
+
+#if __DARWIN_UNIX03
+#define _STRUCT_XMM_REG		struct __darwin_xmm_reg
+_STRUCT_XMM_REG
+{
+	char		__xmm_reg[16];
+};
+#else /* !__DARWIN_UNIX03 */
+#define _STRUCT_XMM_REG		struct xmm_reg
+_STRUCT_XMM_REG
+{
+	char		xmm_reg[16];
+};
+#endif /* !__DARWIN_UNIX03 */
+
+/* 
+ * Floating point state.
+ */
+
+#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#define FP_STATE_BYTES		512	/* number of chars worth of data from fpu_fcw */
+#endif /* !_POSIX_C_SOURCE || _DARWIN_C_SOURCE */
+
+#if __DARWIN_UNIX03
+#define	_STRUCT_X86_FLOAT_STATE32	struct __darwin_i386_float_state
+_STRUCT_X86_FLOAT_STATE32
+{
+	int 			__fpu_reserved[2];
+	_STRUCT_FP_CONTROL	__fpu_fcw;		/* x87 FPU control word */
+	_STRUCT_FP_STATUS	__fpu_fsw;		/* x87 FPU status word */
+	__uint8_t		__fpu_ftw;		/* x87 FPU tag word */
+	__uint8_t		__fpu_rsrv1;		/* reserved */ 
+	__uint16_t		__fpu_fop;		/* x87 FPU Opcode */
+	__uint32_t		__fpu_ip;		/* x87 FPU Instruction Pointer offset */
+	__uint16_t		__fpu_cs;		/* x87 FPU Instruction Pointer Selector */
+	__uint16_t		__fpu_rsrv2;		/* reserved */
+	__uint32_t		__fpu_dp;		/* x87 FPU Instruction Operand(Data) Pointer offset */
+	__uint16_t		__fpu_ds;		/* x87 FPU Instruction Operand(Data) Pointer Selector */
+	__uint16_t		__fpu_rsrv3;		/* reserved */
+	__uint32_t		__fpu_mxcsr;		/* MXCSR Register state */
+	__uint32_t		__fpu_mxcsrmask;	/* MXCSR mask */
+	_STRUCT_MMST_REG	__fpu_stmm0;		/* ST0/MM0   */
+	_STRUCT_MMST_REG	__fpu_stmm1;		/* ST1/MM1  */
+	_STRUCT_MMST_REG	__fpu_stmm2;		/* ST2/MM2  */
+	_STRUCT_MMST_REG	__fpu_stmm3;		/* ST3/MM3  */
+	_STRUCT_MMST_REG	__fpu_stmm4;		/* ST4/MM4  */
+	_STRUCT_MMST_REG	__fpu_stmm5;		/* ST5/MM5  */
+	_STRUCT_MMST_REG	__fpu_stmm6;		/* ST6/MM6  */
+	_STRUCT_MMST_REG	__fpu_stmm7;		/* ST7/MM7  */
+	_STRUCT_XMM_REG		__fpu_xmm0;		/* XMM 0  */
+	_STRUCT_XMM_REG		__fpu_xmm1;		/* XMM 1  */
+	_STRUCT_XMM_REG		__fpu_xmm2;		/* XMM 2  */
+	_STRUCT_XMM_REG		__fpu_xmm3;		/* XMM 3  */
+	_STRUCT_XMM_REG		__fpu_xmm4;		/* XMM 4  */
+	_STRUCT_XMM_REG		__fpu_xmm5;		/* XMM 5  */
+	_STRUCT_XMM_REG		__fpu_xmm6;		/* XMM 6  */
+	_STRUCT_XMM_REG		__fpu_xmm7;		/* XMM 7  */
+	char			__fpu_rsrv4[14*16];	/* reserved */
+	int 			__fpu_reserved1;
+};
+
+#define	_STRUCT_X86_AVX_STATE32	struct __darwin_i386_avx_state
+_STRUCT_X86_AVX_STATE32
+{
+	int 			__fpu_reserved[2];
+	_STRUCT_FP_CONTROL	__fpu_fcw;		/* x87 FPU control word */
+	_STRUCT_FP_STATUS	__fpu_fsw;		/* x87 FPU status word */
+	__uint8_t		__fpu_ftw;		/* x87 FPU tag word */
+	__uint8_t		__fpu_rsrv1;		/* reserved */ 
+	__uint16_t		__fpu_fop;		/* x87 FPU Opcode */
+	__uint32_t		__fpu_ip;		/* x87 FPU Instruction Pointer offset */
+	__uint16_t		__fpu_cs;		/* x87 FPU Instruction Pointer Selector */
+	__uint16_t		__fpu_rsrv2;		/* reserved */
+	__uint32_t		__fpu_dp;		/* x87 FPU Instruction Operand(Data) Pointer offset */
+	__uint16_t		__fpu_ds;		/* x87 FPU Instruction Operand(Data) Pointer Selector */
+	__uint16_t		__fpu_rsrv3;		/* reserved */
+	__uint32_t		__fpu_mxcsr;		/* MXCSR Register state */
+	__uint32_t		__fpu_mxcsrmask;	/* MXCSR mask */
+	_STRUCT_MMST_REG	__fpu_stmm0;		/* ST0/MM0   */
+	_STRUCT_MMST_REG	__fpu_stmm1;		/* ST1/MM1  */
+	_STRUCT_MMST_REG	__fpu_stmm2;		/* ST2/MM2  */
+	_STRUCT_MMST_REG	__fpu_stmm3;		/* ST3/MM3  */
+	_STRUCT_MMST_REG	__fpu_stmm4;		/* ST4/MM4  */
+	_STRUCT_MMST_REG	__fpu_stmm5;		/* ST5/MM5  */
+	_STRUCT_MMST_REG	__fpu_stmm6;		/* ST6/MM6  */
+	_STRUCT_MMST_REG	__fpu_stmm7;		/* ST7/MM7  */
+	_STRUCT_XMM_REG		__fpu_xmm0;		/* XMM 0  */
+	_STRUCT_XMM_REG		__fpu_xmm1;		/* XMM 1  */
+	_STRUCT_XMM_REG		__fpu_xmm2;		/* XMM 2  */
+	_STRUCT_XMM_REG		__fpu_xmm3;		/* XMM 3  */
+	_STRUCT_XMM_REG		__fpu_xmm4;		/* XMM 4  */
+	_STRUCT_XMM_REG		__fpu_xmm5;		/* XMM 5  */
+	_STRUCT_XMM_REG		__fpu_xmm6;		/* XMM 6  */
+	_STRUCT_XMM_REG		__fpu_xmm7;		/* XMM 7  */
+	char			__fpu_rsrv4[14*16];	/* reserved */
+	int 			__fpu_reserved1;
+	char			__avx_reserved1[64];
+	_STRUCT_XMM_REG		__fpu_ymmh0;		/* YMMH 0  */
+	_STRUCT_XMM_REG		__fpu_ymmh1;		/* YMMH 1  */
+	_STRUCT_XMM_REG		__fpu_ymmh2;		/* YMMH 2  */
+	_STRUCT_XMM_REG		__fpu_ymmh3;		/* YMMH 3  */
+	_STRUCT_XMM_REG		__fpu_ymmh4;		/* YMMH 4  */
+	_STRUCT_XMM_REG		__fpu_ymmh5;		/* YMMH 5  */
+	_STRUCT_XMM_REG		__fpu_ymmh6;		/* YMMH 6  */
+	_STRUCT_XMM_REG		__fpu_ymmh7;		/* YMMH 7  */
+};
+
+#else /* !__DARWIN_UNIX03 */
+#define	_STRUCT_X86_FLOAT_STATE32	struct i386_float_state
+_STRUCT_X86_FLOAT_STATE32
+{
+	int 			fpu_reserved[2];
+	_STRUCT_FP_CONTROL	fpu_fcw;		/* x87 FPU control word */
+	_STRUCT_FP_STATUS	fpu_fsw;		/* x87 FPU status word */
+	__uint8_t		fpu_ftw;		/* x87 FPU tag word */
+	__uint8_t		fpu_rsrv1;		/* reserved */ 
+	__uint16_t		fpu_fop;		/* x87 FPU Opcode */
+	__uint32_t		fpu_ip;			/* x87 FPU Instruction Pointer offset */
+	__uint16_t		fpu_cs;			/* x87 FPU Instruction Pointer Selector */
+	__uint16_t		fpu_rsrv2;		/* reserved */
+	__uint32_t		fpu_dp;			/* x87 FPU Instruction Operand(Data) Pointer offset */
+	__uint16_t		fpu_ds;			/* x87 FPU Instruction Operand(Data) Pointer Selector */
+	__uint16_t		fpu_rsrv3;		/* reserved */
+	__uint32_t		fpu_mxcsr;		/* MXCSR Register state */
+	__uint32_t		fpu_mxcsrmask;		/* MXCSR mask */
+	_STRUCT_MMST_REG	fpu_stmm0;		/* ST0/MM0   */
+	_STRUCT_MMST_REG	fpu_stmm1;		/* ST1/MM1  */
+	_STRUCT_MMST_REG	fpu_stmm2;		/* ST2/MM2  */
+	_STRUCT_MMST_REG	fpu_stmm3;		/* ST3/MM3  */
+	_STRUCT_MMST_REG	fpu_stmm4;		/* ST4/MM4  */
+	_STRUCT_MMST_REG	fpu_stmm5;		/* ST5/MM5  */
+	_STRUCT_MMST_REG	fpu_stmm6;		/* ST6/MM6  */
+	_STRUCT_MMST_REG	fpu_stmm7;		/* ST7/MM7  */
+	_STRUCT_XMM_REG		fpu_xmm0;		/* XMM 0  */
+	_STRUCT_XMM_REG		fpu_xmm1;		/* XMM 1  */
+	_STRUCT_XMM_REG		fpu_xmm2;		/* XMM 2  */
+	_STRUCT_XMM_REG		fpu_xmm3;		/* XMM 3  */
+	_STRUCT_XMM_REG		fpu_xmm4;		/* XMM 4  */
+	_STRUCT_XMM_REG		fpu_xmm5;		/* XMM 5  */
+	_STRUCT_XMM_REG		fpu_xmm6;		/* XMM 6  */
+	_STRUCT_XMM_REG		fpu_xmm7;		/* XMM 7  */
+	char			fpu_rsrv4[14*16];	/* reserved */
+	int 			fpu_reserved1;
+};
+
+#define	_STRUCT_X86_AVX_STATE32	struct i386_avx_state
+_STRUCT_X86_AVX_STATE32
+{
+	int 			fpu_reserved[2];
+	_STRUCT_FP_CONTROL	fpu_fcw;		/* x87 FPU control word */
+	_STRUCT_FP_STATUS	fpu_fsw;		/* x87 FPU status word */
+	__uint8_t		fpu_ftw;		/* x87 FPU tag word */
+	__uint8_t		fpu_rsrv1;		/* reserved */ 
+	__uint16_t		fpu_fop;		/* x87 FPU Opcode */
+	__uint32_t		fpu_ip;			/* x87 FPU Instruction Pointer offset */
+	__uint16_t		fpu_cs;			/* x87 FPU Instruction Pointer Selector */
+	__uint16_t		fpu_rsrv2;		/* reserved */
+	__uint32_t		fpu_dp;			/* x87 FPU Instruction Operand(Data) Pointer offset */
+	__uint16_t		fpu_ds;			/* x87 FPU Instruction Operand(Data) Pointer Selector */
+	__uint16_t		fpu_rsrv3;		/* reserved */
+	__uint32_t		fpu_mxcsr;		/* MXCSR Register state */
+	__uint32_t		fpu_mxcsrmask;		/* MXCSR mask */
+	_STRUCT_MMST_REG	fpu_stmm0;		/* ST0/MM0   */
+	_STRUCT_MMST_REG	fpu_stmm1;		/* ST1/MM1  */
+	_STRUCT_MMST_REG	fpu_stmm2;		/* ST2/MM2  */
+	_STRUCT_MMST_REG	fpu_stmm3;		/* ST3/MM3  */
+	_STRUCT_MMST_REG	fpu_stmm4;		/* ST4/MM4  */
+	_STRUCT_MMST_REG	fpu_stmm5;		/* ST5/MM5  */
+	_STRUCT_MMST_REG	fpu_stmm6;		/* ST6/MM6  */
+	_STRUCT_MMST_REG	fpu_stmm7;		/* ST7/MM7  */
+	_STRUCT_XMM_REG		fpu_xmm0;		/* XMM 0  */
+	_STRUCT_XMM_REG		fpu_xmm1;		/* XMM 1  */
+	_STRUCT_XMM_REG		fpu_xmm2;		/* XMM 2  */
+	_STRUCT_XMM_REG		fpu_xmm3;		/* XMM 3  */
+	_STRUCT_XMM_REG		fpu_xmm4;		/* XMM 4  */
+	_STRUCT_XMM_REG		fpu_xmm5;		/* XMM 5  */
+	_STRUCT_XMM_REG		fpu_xmm6;		/* XMM 6  */
+	_STRUCT_XMM_REG		fpu_xmm7;		/* XMM 7  */
+	char			fpu_rsrv4[14*16];	/* reserved */
+	int 			fpu_reserved1;
+	char			__avx_reserved1[64];
+	_STRUCT_XMM_REG		__fpu_ymmh0;		/* YMMH 0  */
+	_STRUCT_XMM_REG		__fpu_ymmh1;		/* YMMH 1  */
+	_STRUCT_XMM_REG		__fpu_ymmh2;		/* YMMH 2  */
+	_STRUCT_XMM_REG		__fpu_ymmh3;		/* YMMH 3  */
+	_STRUCT_XMM_REG		__fpu_ymmh4;		/* YMMH 4  */
+	_STRUCT_XMM_REG		__fpu_ymmh5;		/* YMMH 5  */
+	_STRUCT_XMM_REG		__fpu_ymmh6;		/* YMMH 6  */
+	_STRUCT_XMM_REG		__fpu_ymmh7;		/* YMMH 7  */
+};
+
+#endif /* !__DARWIN_UNIX03 */
+
+#if __DARWIN_UNIX03
+#define _STRUCT_X86_EXCEPTION_STATE32	struct __darwin_i386_exception_state
+_STRUCT_X86_EXCEPTION_STATE32
+{
+	__uint16_t	__trapno;
+	__uint16_t	__cpu;
+	__uint32_t	__err;
+	__uint32_t	__faultvaddr;
+};
+#else /* !__DARWIN_UNIX03 */
+#define _STRUCT_X86_EXCEPTION_STATE32	struct i386_exception_state
+_STRUCT_X86_EXCEPTION_STATE32
+{
+	__uint16_t	trapno;
+	__uint16_t	cpu;
+	__uint32_t	err;
+	__uint32_t	faultvaddr;
+};
+#endif /* !__DARWIN_UNIX03 */
+
+#if __DARWIN_UNIX03
+#define _STRUCT_X86_DEBUG_STATE32	struct __darwin_x86_debug_state32
+_STRUCT_X86_DEBUG_STATE32
+{
+	unsigned int	__dr0;
+	unsigned int	__dr1;
+	unsigned int	__dr2;
+	unsigned int	__dr3;
+	unsigned int	__dr4;
+	unsigned int	__dr5;
+	unsigned int	__dr6;
+	unsigned int	__dr7;
+};
+#else /* !__DARWIN_UNIX03 */
+#define _STRUCT_X86_DEBUG_STATE32	struct x86_debug_state32
+_STRUCT_X86_DEBUG_STATE32
+{
+	unsigned int	dr0;
+	unsigned int	dr1;
+	unsigned int	dr2;
+	unsigned int	dr3;
+	unsigned int	dr4;
+	unsigned int	dr5;
+	unsigned int	dr6;
+	unsigned int	dr7;
+};
+#endif /* !__DARWIN_UNIX03 */
+
+/*
+ * 64 bit versions of the above
+ */
+
+#if __DARWIN_UNIX03
+#define	_STRUCT_X86_THREAD_STATE64	struct __darwin_x86_thread_state64
+_STRUCT_X86_THREAD_STATE64
+{
+	__uint64_t	__rax;
+	__uint64_t	__rbx;
+	__uint64_t	__rcx;
+	__uint64_t	__rdx;
+	__uint64_t	__rdi;
+	__uint64_t	__rsi;
+	__uint64_t	__rbp;
+	__uint64_t	__rsp;
+	__uint64_t	__r8;
+	__uint64_t	__r9;
+	__uint64_t	__r10;
+	__uint64_t	__r11;
+	__uint64_t	__r12;
+	__uint64_t	__r13;
+	__uint64_t	__r14;
+	__uint64_t	__r15;
+	__uint64_t	__rip;
+	__uint64_t	__rflags;
+	__uint64_t	__cs;
+	__uint64_t	__fs;
+	__uint64_t	__gs;
+};
+#else /* !__DARWIN_UNIX03 */
+#define	_STRUCT_X86_THREAD_STATE64	struct x86_thread_state64
+_STRUCT_X86_THREAD_STATE64
+{
+	__uint64_t	rax;
+	__uint64_t	rbx;
+	__uint64_t	rcx;
+	__uint64_t	rdx;
+	__uint64_t	rdi;
+	__uint64_t	rsi;
+	__uint64_t	rbp;
+	__uint64_t	rsp;
+	__uint64_t	r8;
+	__uint64_t	r9;
+	__uint64_t	r10;
+	__uint64_t	r11;
+	__uint64_t	r12;
+	__uint64_t	r13;
+	__uint64_t	r14;
+	__uint64_t	r15;
+	__uint64_t	rip;
+	__uint64_t	rflags;
+	__uint64_t	cs;
+	__uint64_t	fs;
+	__uint64_t	gs;
+};
+#endif /* !__DARWIN_UNIX03 */
+
+
+#if __DARWIN_UNIX03
+#define	_STRUCT_X86_FLOAT_STATE64	struct __darwin_x86_float_state64
+_STRUCT_X86_FLOAT_STATE64
+{
+	int 			__fpu_reserved[2];
+	_STRUCT_FP_CONTROL	__fpu_fcw;		/* x87 FPU control word */
+	_STRUCT_FP_STATUS	__fpu_fsw;		/* x87 FPU status word */
+	__uint8_t		__fpu_ftw;		/* x87 FPU tag word */
+	__uint8_t		__fpu_rsrv1;		/* reserved */ 
+	__uint16_t		__fpu_fop;		/* x87 FPU Opcode */
+
+	/* x87 FPU Instruction Pointer */
+	__uint32_t		__fpu_ip;		/* offset */
+	__uint16_t		__fpu_cs;		/* Selector */
+
+	__uint16_t		__fpu_rsrv2;		/* reserved */
+
+	/* x87 FPU Instruction Operand(Data) Pointer */
+	__uint32_t		__fpu_dp;		/* offset */
+	__uint16_t		__fpu_ds;		/* Selector */
+
+	__uint16_t		__fpu_rsrv3;		/* reserved */
+	__uint32_t		__fpu_mxcsr;		/* MXCSR Register state */
+	__uint32_t		__fpu_mxcsrmask;	/* MXCSR mask */
+	_STRUCT_MMST_REG	__fpu_stmm0;		/* ST0/MM0   */
+	_STRUCT_MMST_REG	__fpu_stmm1;		/* ST1/MM1  */
+	_STRUCT_MMST_REG	__fpu_stmm2;		/* ST2/MM2  */
+	_STRUCT_MMST_REG	__fpu_stmm3;		/* ST3/MM3  */
+	_STRUCT_MMST_REG	__fpu_stmm4;		/* ST4/MM4  */
+	_STRUCT_MMST_REG	__fpu_stmm5;		/* ST5/MM5  */
+	_STRUCT_MMST_REG	__fpu_stmm6;		/* ST6/MM6  */
+	_STRUCT_MMST_REG	__fpu_stmm7;		/* ST7/MM7  */
+	_STRUCT_XMM_REG		__fpu_xmm0;		/* XMM 0  */
+	_STRUCT_XMM_REG		__fpu_xmm1;		/* XMM 1  */
+	_STRUCT_XMM_REG		__fpu_xmm2;		/* XMM 2  */
+	_STRUCT_XMM_REG		__fpu_xmm3;		/* XMM 3  */
+	_STRUCT_XMM_REG		__fpu_xmm4;		/* XMM 4  */
+	_STRUCT_XMM_REG		__fpu_xmm5;		/* XMM 5  */
+	_STRUCT_XMM_REG		__fpu_xmm6;		/* XMM 6  */
+	_STRUCT_XMM_REG		__fpu_xmm7;		/* XMM 7  */
+	_STRUCT_XMM_REG		__fpu_xmm8;		/* XMM 8  */
+	_STRUCT_XMM_REG		__fpu_xmm9;		/* XMM 9  */
+	_STRUCT_XMM_REG		__fpu_xmm10;		/* XMM 10  */
+	_STRUCT_XMM_REG		__fpu_xmm11;		/* XMM 11 */
+	_STRUCT_XMM_REG		__fpu_xmm12;		/* XMM 12  */
+	_STRUCT_XMM_REG		__fpu_xmm13;		/* XMM 13  */
+	_STRUCT_XMM_REG		__fpu_xmm14;		/* XMM 14  */
+	_STRUCT_XMM_REG		__fpu_xmm15;		/* XMM 15  */
+	char			__fpu_rsrv4[6*16];	/* reserved */
+	int 			__fpu_reserved1;
+};
+
+#define	_STRUCT_X86_AVX_STATE64	struct __darwin_x86_avx_state64
+_STRUCT_X86_AVX_STATE64
+{
+	int 			__fpu_reserved[2];
+	_STRUCT_FP_CONTROL	__fpu_fcw;		/* x87 FPU control word */
+	_STRUCT_FP_STATUS	__fpu_fsw;		/* x87 FPU status word */
+	__uint8_t		__fpu_ftw;		/* x87 FPU tag word */
+	__uint8_t		__fpu_rsrv1;		/* reserved */ 
+	__uint16_t		__fpu_fop;		/* x87 FPU Opcode */
+
+	/* x87 FPU Instruction Pointer */
+	__uint32_t		__fpu_ip;		/* offset */
+	__uint16_t		__fpu_cs;		/* Selector */
+
+	__uint16_t		__fpu_rsrv2;		/* reserved */
+
+	/* x87 FPU Instruction Operand(Data) Pointer */
+	__uint32_t		__fpu_dp;		/* offset */
+	__uint16_t		__fpu_ds;		/* Selector */
+
+	__uint16_t		__fpu_rsrv3;		/* reserved */
+	__uint32_t		__fpu_mxcsr;		/* MXCSR Register state */
+	__uint32_t		__fpu_mxcsrmask;	/* MXCSR mask */
+	_STRUCT_MMST_REG	__fpu_stmm0;		/* ST0/MM0   */
+	_STRUCT_MMST_REG	__fpu_stmm1;		/* ST1/MM1  */
+	_STRUCT_MMST_REG	__fpu_stmm2;		/* ST2/MM2  */
+	_STRUCT_MMST_REG	__fpu_stmm3;		/* ST3/MM3  */
+	_STRUCT_MMST_REG	__fpu_stmm4;		/* ST4/MM4  */
+	_STRUCT_MMST_REG	__fpu_stmm5;		/* ST5/MM5  */
+	_STRUCT_MMST_REG	__fpu_stmm6;		/* ST6/MM6  */
+	_STRUCT_MMST_REG	__fpu_stmm7;		/* ST7/MM7  */
+	_STRUCT_XMM_REG		__fpu_xmm0;		/* XMM 0  */
+	_STRUCT_XMM_REG		__fpu_xmm1;		/* XMM 1  */
+	_STRUCT_XMM_REG		__fpu_xmm2;		/* XMM 2  */
+	_STRUCT_XMM_REG		__fpu_xmm3;		/* XMM 3  */
+	_STRUCT_XMM_REG		__fpu_xmm4;		/* XMM 4  */
+	_STRUCT_XMM_REG		__fpu_xmm5;		/* XMM 5  */
+	_STRUCT_XMM_REG		__fpu_xmm6;		/* XMM 6  */
+	_STRUCT_XMM_REG		__fpu_xmm7;		/* XMM 7  */
+	_STRUCT_XMM_REG		__fpu_xmm8;		/* XMM 8  */
+	_STRUCT_XMM_REG		__fpu_xmm9;		/* XMM 9  */
+	_STRUCT_XMM_REG		__fpu_xmm10;		/* XMM 10  */
+	_STRUCT_XMM_REG		__fpu_xmm11;		/* XMM 11 */
+	_STRUCT_XMM_REG		__fpu_xmm12;		/* XMM 12  */
+	_STRUCT_XMM_REG		__fpu_xmm13;		/* XMM 13  */
+	_STRUCT_XMM_REG		__fpu_xmm14;		/* XMM 14  */
+	_STRUCT_XMM_REG		__fpu_xmm15;		/* XMM 15  */
+	char			__fpu_rsrv4[6*16];	/* reserved */
+	int 			__fpu_reserved1;
+	char			__avx_reserved1[64];
+	_STRUCT_XMM_REG		__fpu_ymmh0;		/* YMMH 0  */
+	_STRUCT_XMM_REG		__fpu_ymmh1;		/* YMMH 1  */
+	_STRUCT_XMM_REG		__fpu_ymmh2;		/* YMMH 2  */
+	_STRUCT_XMM_REG		__fpu_ymmh3;		/* YMMH 3  */
+	_STRUCT_XMM_REG		__fpu_ymmh4;		/* YMMH 4  */
+	_STRUCT_XMM_REG		__fpu_ymmh5;		/* YMMH 5  */
+	_STRUCT_XMM_REG		__fpu_ymmh6;		/* YMMH 6  */
+	_STRUCT_XMM_REG		__fpu_ymmh7;		/* YMMH 7  */
+	_STRUCT_XMM_REG		__fpu_ymmh8;		/* YMMH 8  */
+	_STRUCT_XMM_REG		__fpu_ymmh9;		/* YMMH 9  */
+	_STRUCT_XMM_REG		__fpu_ymmh10;		/* YMMH 10  */
+	_STRUCT_XMM_REG		__fpu_ymmh11;		/* YMMH 11  */
+	_STRUCT_XMM_REG		__fpu_ymmh12;		/* YMMH 12  */
+	_STRUCT_XMM_REG		__fpu_ymmh13;		/* YMMH 13  */
+	_STRUCT_XMM_REG		__fpu_ymmh14;		/* YMMH 14  */
+	_STRUCT_XMM_REG		__fpu_ymmh15;		/* YMMH 15  */
+};
+
+#else /* !__DARWIN_UNIX03 */
+#define	_STRUCT_X86_FLOAT_STATE64	struct x86_float_state64
+_STRUCT_X86_FLOAT_STATE64
+{
+	int 			fpu_reserved[2];
+	_STRUCT_FP_CONTROL	fpu_fcw;		/* x87 FPU control word */
+	_STRUCT_FP_STATUS	fpu_fsw;		/* x87 FPU status word */
+	__uint8_t		fpu_ftw;		/* x87 FPU tag word */
+	__uint8_t		fpu_rsrv1;		/* reserved */ 
+	__uint16_t		fpu_fop;		/* x87 FPU Opcode */
+
+	/* x87 FPU Instruction Pointer */
+	__uint32_t		fpu_ip;			/* offset */
+	__uint16_t		fpu_cs;			/* Selector */
+
+	__uint16_t		fpu_rsrv2;		/* reserved */
+
+	/* x87 FPU Instruction Operand(Data) Pointer */
+	__uint32_t		fpu_dp;			/* offset */
+	__uint16_t		fpu_ds;			/* Selector */
+
+	__uint16_t		fpu_rsrv3;		/* reserved */
+	__uint32_t		fpu_mxcsr;		/* MXCSR Register state */
+	__uint32_t		fpu_mxcsrmask;		/* MXCSR mask */
+	_STRUCT_MMST_REG	fpu_stmm0;		/* ST0/MM0   */
+	_STRUCT_MMST_REG	fpu_stmm1;		/* ST1/MM1  */
+	_STRUCT_MMST_REG	fpu_stmm2;		/* ST2/MM2  */
+	_STRUCT_MMST_REG	fpu_stmm3;		/* ST3/MM3  */
+	_STRUCT_MMST_REG	fpu_stmm4;		/* ST4/MM4  */
+	_STRUCT_MMST_REG	fpu_stmm5;		/* ST5/MM5  */
+	_STRUCT_MMST_REG	fpu_stmm6;		/* ST6/MM6  */
+	_STRUCT_MMST_REG	fpu_stmm7;		/* ST7/MM7  */
+	_STRUCT_XMM_REG		fpu_xmm0;		/* XMM 0  */
+	_STRUCT_XMM_REG		fpu_xmm1;		/* XMM 1  */
+	_STRUCT_XMM_REG		fpu_xmm2;		/* XMM 2  */
+	_STRUCT_XMM_REG		fpu_xmm3;		/* XMM 3  */
+	_STRUCT_XMM_REG		fpu_xmm4;		/* XMM 4  */
+	_STRUCT_XMM_REG		fpu_xmm5;		/* XMM 5  */
+	_STRUCT_XMM_REG		fpu_xmm6;		/* XMM 6  */
+	_STRUCT_XMM_REG		fpu_xmm7;		/* XMM 7  */
+	_STRUCT_XMM_REG		fpu_xmm8;		/* XMM 8  */
+	_STRUCT_XMM_REG		fpu_xmm9;		/* XMM 9  */
+	_STRUCT_XMM_REG		fpu_xmm10;		/* XMM 10  */
+	_STRUCT_XMM_REG		fpu_xmm11;		/* XMM 11 */
+	_STRUCT_XMM_REG		fpu_xmm12;		/* XMM 12  */
+	_STRUCT_XMM_REG		fpu_xmm13;		/* XMM 13  */
+	_STRUCT_XMM_REG		fpu_xmm14;		/* XMM 14  */
+	_STRUCT_XMM_REG		fpu_xmm15;		/* XMM 15  */
+	char			fpu_rsrv4[6*16];	/* reserved */
+	int 			fpu_reserved1;
+};
+
+#define	_STRUCT_X86_AVX_STATE64	struct x86_avx_state64
+_STRUCT_X86_AVX_STATE64
+{
+	int 			fpu_reserved[2];
+	_STRUCT_FP_CONTROL	fpu_fcw;		/* x87 FPU control word */
+	_STRUCT_FP_STATUS	fpu_fsw;		/* x87 FPU status word */
+	__uint8_t		fpu_ftw;		/* x87 FPU tag word */
+	__uint8_t		fpu_rsrv1;		/* reserved */ 
+	__uint16_t		fpu_fop;		/* x87 FPU Opcode */
+
+	/* x87 FPU Instruction Pointer */
+	__uint32_t		fpu_ip;			/* offset */
+	__uint16_t		fpu_cs;			/* Selector */
+
+	__uint16_t		fpu_rsrv2;		/* reserved */
+
+	/* x87 FPU Instruction Operand(Data) Pointer */
+	__uint32_t		fpu_dp;			/* offset */
+	__uint16_t		fpu_ds;			/* Selector */
+
+	__uint16_t		fpu_rsrv3;		/* reserved */
+	__uint32_t		fpu_mxcsr;		/* MXCSR Register state */
+	__uint32_t		fpu_mxcsrmask;		/* MXCSR mask */
+	_STRUCT_MMST_REG	fpu_stmm0;		/* ST0/MM0   */
+	_STRUCT_MMST_REG	fpu_stmm1;		/* ST1/MM1  */
+	_STRUCT_MMST_REG	fpu_stmm2;		/* ST2/MM2  */
+	_STRUCT_MMST_REG	fpu_stmm3;		/* ST3/MM3  */
+	_STRUCT_MMST_REG	fpu_stmm4;		/* ST4/MM4  */
+	_STRUCT_MMST_REG	fpu_stmm5;		/* ST5/MM5  */
+	_STRUCT_MMST_REG	fpu_stmm6;		/* ST6/MM6  */
+	_STRUCT_MMST_REG	fpu_stmm7;		/* ST7/MM7  */
+	_STRUCT_XMM_REG		fpu_xmm0;		/* XMM 0  */
+	_STRUCT_XMM_REG		fpu_xmm1;		/* XMM 1  */
+	_STRUCT_XMM_REG		fpu_xmm2;		/* XMM 2  */
+	_STRUCT_XMM_REG		fpu_xmm3;		/* XMM 3  */
+	_STRUCT_XMM_REG		fpu_xmm4;		/* XMM 4  */
+	_STRUCT_XMM_REG		fpu_xmm5;		/* XMM 5  */
+	_STRUCT_XMM_REG		fpu_xmm6;		/* XMM 6  */
+	_STRUCT_XMM_REG		fpu_xmm7;		/* XMM 7  */
+	_STRUCT_XMM_REG		fpu_xmm8;		/* XMM 8  */
+	_STRUCT_XMM_REG		fpu_xmm9;		/* XMM 9  */
+	_STRUCT_XMM_REG		fpu_xmm10;		/* XMM 10  */
+	_STRUCT_XMM_REG		fpu_xmm11;		/* XMM 11 */
+	_STRUCT_XMM_REG		fpu_xmm12;		/* XMM 12  */
+	_STRUCT_XMM_REG		fpu_xmm13;		/* XMM 13  */
+	_STRUCT_XMM_REG		fpu_xmm14;		/* XMM 14  */
+	_STRUCT_XMM_REG		fpu_xmm15;		/* XMM 15  */
+	char			fpu_rsrv4[6*16];	/* reserved */
+	int 			fpu_reserved1;
+	char			__avx_reserved1[64];
+	_STRUCT_XMM_REG		__fpu_ymmh0;		/* YMMH 0  */
+	_STRUCT_XMM_REG		__fpu_ymmh1;		/* YMMH 1  */
+	_STRUCT_XMM_REG		__fpu_ymmh2;		/* YMMH 2  */
+	_STRUCT_XMM_REG		__fpu_ymmh3;		/* YMMH 3  */
+	_STRUCT_XMM_REG		__fpu_ymmh4;		/* YMMH 4  */
+	_STRUCT_XMM_REG		__fpu_ymmh5;		/* YMMH 5  */
+	_STRUCT_XMM_REG		__fpu_ymmh6;		/* YMMH 6  */
+	_STRUCT_XMM_REG		__fpu_ymmh7;		/* YMMH 7  */
+	_STRUCT_XMM_REG		__fpu_ymmh8;		/* YMMH 8  */
+	_STRUCT_XMM_REG		__fpu_ymmh9;		/* YMMH 9  */
+	_STRUCT_XMM_REG		__fpu_ymmh10;		/* YMMH 10  */
+	_STRUCT_XMM_REG		__fpu_ymmh11;		/* YMMH 11  */
+	_STRUCT_XMM_REG		__fpu_ymmh12;		/* YMMH 12  */
+	_STRUCT_XMM_REG		__fpu_ymmh13;		/* YMMH 13  */
+	_STRUCT_XMM_REG		__fpu_ymmh14;		/* YMMH 14  */
+	_STRUCT_XMM_REG		__fpu_ymmh15;		/* YMMH 15  */
+};
+
+#endif /* !__DARWIN_UNIX03 */
+
+#if __DARWIN_UNIX03
+#define _STRUCT_X86_EXCEPTION_STATE64	struct __darwin_x86_exception_state64
+_STRUCT_X86_EXCEPTION_STATE64
+{
+    __uint16_t	__trapno;
+    __uint16_t	__cpu;
+    __uint32_t	__err;
+    __uint64_t	__faultvaddr;
+};
+#else /* !__DARWIN_UNIX03 */
+#define _STRUCT_X86_EXCEPTION_STATE64	struct x86_exception_state64
+_STRUCT_X86_EXCEPTION_STATE64
+{
+    __uint16_t	trapno;
+    __uint16_t	cpu;
+    __uint32_t	err;
+    __uint64_t	faultvaddr;
+};
+#endif /* !__DARWIN_UNIX03 */
+
+#if __DARWIN_UNIX03
+#define _STRUCT_X86_DEBUG_STATE64	struct __darwin_x86_debug_state64
+_STRUCT_X86_DEBUG_STATE64
+{
+	__uint64_t	__dr0;
+	__uint64_t	__dr1;
+	__uint64_t	__dr2;
+	__uint64_t	__dr3;
+	__uint64_t	__dr4;
+	__uint64_t	__dr5;
+	__uint64_t	__dr6;
+	__uint64_t	__dr7;
+};
+#else /* !__DARWIN_UNIX03 */
+#define _STRUCT_X86_DEBUG_STATE64	struct x86_debug_state64
+_STRUCT_X86_DEBUG_STATE64
+{
+	__uint64_t	dr0;
+	__uint64_t	dr1;
+	__uint64_t	dr2;
+	__uint64_t	dr3;
+	__uint64_t	dr4;
+	__uint64_t	dr5;
+	__uint64_t	dr6;
+	__uint64_t	dr7;
+};
+#endif /* !__DARWIN_UNIX03 */
+
+#endif /* _MACH_I386__STRUCTS_H_ */
diff -urN cctools-806-old/include/mach/i386/task.h cctools-806/include/mach/i386/task.h
--- cctools-806-old/include/mach/i386/task.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/task.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1626 @@
+#ifndef	_task_user_
+#define	_task_user_
+
+/* Module task */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	task_MSG_COUNT
+#define	task_MSG_COUNT	35
+#endif	/* task_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine task_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_create
+(
+	task_t target_task,
+	ledger_array_t ledgers,
+	mach_msg_type_number_t ledgersCnt,
+	boolean_t inherit_memory,
+	task_t *child_task
+);
+
+/* Routine task_terminate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_terminate
+(
+	task_t target_task
+);
+
+/* Routine task_threads */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_threads
+(
+	task_t target_task,
+	thread_act_array_t *act_list,
+	mach_msg_type_number_t *act_listCnt
+);
+
+/* Routine mach_ports_register */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_ports_register
+(
+	task_t target_task,
+	mach_port_array_t init_port_set,
+	mach_msg_type_number_t init_port_setCnt
+);
+
+/* Routine mach_ports_lookup */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_ports_lookup
+(
+	task_t target_task,
+	mach_port_array_t *init_port_set,
+	mach_msg_type_number_t *init_port_setCnt
+);
+
+/* Routine task_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_info
+(
+	task_name_t target_task,
+	task_flavor_t flavor,
+	task_info_t task_info_out,
+	mach_msg_type_number_t *task_info_outCnt
+);
+
+/* Routine task_set_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_info
+(
+	task_t target_task,
+	task_flavor_t flavor,
+	task_info_t task_info_in,
+	mach_msg_type_number_t task_info_inCnt
+);
+
+/* Routine task_suspend */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_suspend
+(
+	task_t target_task
+);
+
+/* Routine task_resume */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_resume
+(
+	task_t target_task
+);
+
+/* Routine task_get_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_special_port
+(
+	task_t task,
+	int which_port,
+	mach_port_t *special_port
+);
+
+/* Routine task_set_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_special_port
+(
+	task_t task,
+	int which_port,
+	mach_port_t special_port
+);
+
+/* Routine thread_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_create
+(
+	task_t parent_task,
+	thread_act_t *child_act
+);
+
+/* Routine thread_create_running */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_create_running
+(
+	task_t parent_task,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt,
+	thread_act_t *child_act
+);
+
+/* Routine task_set_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor
+);
+
+/* Routine task_get_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine task_swap_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_swap_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlerss,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine lock_set_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_set_create
+(
+	task_t task,
+	lock_set_t *new_lock_set,
+	int n_ulocks,
+	int policy
+);
+
+/* Routine lock_set_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_set_destroy
+(
+	task_t task,
+	lock_set_t lock_set
+);
+
+/* Routine semaphore_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t semaphore_create
+(
+	task_t task,
+	semaphore_t *semaphore,
+	int policy,
+	int value
+);
+
+/* Routine semaphore_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t semaphore_destroy
+(
+	task_t task,
+	semaphore_t semaphore
+);
+
+/* Routine task_policy_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy_set
+(
+	task_t task,
+	task_policy_flavor_t flavor,
+	task_policy_t policy_info,
+	mach_msg_type_number_t policy_infoCnt
+);
+
+/* Routine task_policy_get */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy_get
+(
+	task_t task,
+	task_policy_flavor_t flavor,
+	task_policy_t policy_info,
+	mach_msg_type_number_t *policy_infoCnt,
+	boolean_t *get_default
+);
+
+/* Routine task_sample */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_sample
+(
+	task_t task,
+	mach_port_t reply
+);
+
+/* Routine task_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy
+(
+	task_t task,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	boolean_t set_limit,
+	boolean_t change
+);
+
+/* Routine task_set_emulation */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_emulation
+(
+	task_t target_port,
+	vm_address_t routine_entry_pt,
+	int routine_number
+);
+
+/* Routine task_get_emulation_vector */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_emulation_vector
+(
+	task_t task,
+	int *vector_start,
+	emulation_vector_t *emulation_vector,
+	mach_msg_type_number_t *emulation_vectorCnt
+);
+
+/* Routine task_set_emulation_vector */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_emulation_vector
+(
+	task_t task,
+	int vector_start,
+	emulation_vector_t emulation_vector,
+	mach_msg_type_number_t emulation_vectorCnt
+);
+
+/* Routine task_set_ras_pc */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_ras_pc
+(
+	task_t target_task,
+	vm_address_t basepc,
+	vm_address_t boundspc
+);
+
+/* Routine task_zone_info */
+/*#ifdef	mig_external
+mig_external
+#else
+extern
+#endif*/	/* mig_external */
+/* NOTE: These are defined in mach_debug directory in Kernel.framework */
+/*kern_return_t task_zone_info
+(
+	task_t target_task,
+	mach_zone_name_array_t *names,
+	mach_msg_type_number_t *namesCnt,
+	task_zone_info_array_t *info,
+	mach_msg_type_number_t *infoCnt
+);*/
+
+/* Routine task_assign */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_assign
+(
+	task_t task,
+	processor_set_t new_set,
+	boolean_t assign_threads
+);
+
+/* Routine task_assign_default */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_assign_default
+(
+	task_t task,
+	boolean_t assign_threads
+);
+
+/* Routine task_get_assignment */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_assignment
+(
+	task_t task,
+	processor_set_name_t *assigned_set
+);
+
+/* Routine task_set_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_policy
+(
+	task_t task,
+	processor_set_t pset,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	policy_limit_t limit,
+	mach_msg_type_number_t limitCnt,
+	boolean_t change
+);
+
+/* Routine task_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_state
+(
+	task_t task,
+	thread_state_flavor_t flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine task_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_state
+(
+	task_t task,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__task_subsystem__defined
+#define __Request__task_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t ledgers;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t ledgersCnt;
+		boolean_t inherit_memory;
+	} __Request__task_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t init_port_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t init_port_setCnt;
+	} __Request__mach_ports_register_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__mach_ports_lookup_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_flavor_t flavor;
+		mach_msg_type_number_t task_info_outCnt;
+	} __Request__task_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_flavor_t flavor;
+		mach_msg_type_number_t task_info_inCnt;
+		integer_t task_info_in[32];
+	} __Request__task_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__task_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__task_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__thread_create_running_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__task_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+	} __Request__task_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__task_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int n_ulocks;
+		int policy;
+	} __Request__lock_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t lock_set;
+		/* end of the kernel processed data */
+	} __Request__lock_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int policy;
+		int value;
+	} __Request__semaphore_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t semaphore;
+		/* end of the kernel processed data */
+	} __Request__semaphore_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+	} __Request__task_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		boolean_t get_default;
+	} __Request__task_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t reply;
+		/* end of the kernel processed data */
+	} __Request__task_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		boolean_t set_limit;
+		boolean_t change;
+	} __Request__task_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t routine_entry_pt;
+		int routine_number;
+	} __Request__task_set_emulation_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_get_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t emulation_vector;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int vector_start;
+		mach_msg_type_number_t emulation_vectorCnt;
+	} __Request__task_set_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t basepc;
+		vm_address_t boundspc;
+	} __Request__task_set_ras_pc_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t assign_threads;
+	} __Request__task_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		boolean_t assign_threads;
+	} __Request__task_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pset;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		mach_msg_type_number_t limitCnt;
+		integer_t limit[1];
+		boolean_t change;
+	} __Request__task_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__task_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__task_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__task_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__task_subsystem__defined
+#define __RequestUnion__task_subsystem__defined
+union __RequestUnion__task_subsystem {
+	__Request__task_create_t Request_task_create;
+	__Request__task_terminate_t Request_task_terminate;
+	__Request__task_threads_t Request_task_threads;
+	__Request__mach_ports_register_t Request_mach_ports_register;
+	__Request__mach_ports_lookup_t Request_mach_ports_lookup;
+	__Request__task_info_t Request_task_info;
+	__Request__task_set_info_t Request_task_set_info;
+	__Request__task_suspend_t Request_task_suspend;
+	__Request__task_resume_t Request_task_resume;
+	__Request__task_get_special_port_t Request_task_get_special_port;
+	__Request__task_set_special_port_t Request_task_set_special_port;
+	__Request__thread_create_t Request_thread_create;
+	__Request__thread_create_running_t Request_thread_create_running;
+	__Request__task_set_exception_ports_t Request_task_set_exception_ports;
+	__Request__task_get_exception_ports_t Request_task_get_exception_ports;
+	__Request__task_swap_exception_ports_t Request_task_swap_exception_ports;
+	__Request__lock_set_create_t Request_lock_set_create;
+	__Request__lock_set_destroy_t Request_lock_set_destroy;
+	__Request__semaphore_create_t Request_semaphore_create;
+	__Request__semaphore_destroy_t Request_semaphore_destroy;
+	__Request__task_policy_set_t Request_task_policy_set;
+	__Request__task_policy_get_t Request_task_policy_get;
+	__Request__task_sample_t Request_task_sample;
+	__Request__task_policy_t Request_task_policy;
+	__Request__task_set_emulation_t Request_task_set_emulation;
+	__Request__task_get_emulation_vector_t Request_task_get_emulation_vector;
+	__Request__task_set_emulation_vector_t Request_task_set_emulation_vector;
+	__Request__task_set_ras_pc_t Request_task_set_ras_pc;
+	__Request__task_zone_info_t Request_task_zone_info;
+	__Request__task_assign_t Request_task_assign;
+	__Request__task_assign_default_t Request_task_assign_default;
+	__Request__task_get_assignment_t Request_task_get_assignment;
+	__Request__task_set_policy_t Request_task_set_policy;
+	__Request__task_get_state_t Request_task_get_state;
+	__Request__task_set_state_t Request_task_set_state;
+};
+#endif /* !__RequestUnion__task_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__task_subsystem__defined
+#define __Reply__task_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_task;
+		/* end of the kernel processed data */
+	} __Reply__task_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t act_list;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t act_listCnt;
+	} __Reply__task_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_ports_register_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t init_port_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t init_port_setCnt;
+	} __Reply__mach_ports_lookup_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t task_info_outCnt;
+		integer_t task_info_out[32];
+	} __Reply__task_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+	} __Reply__task_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_act;
+		/* end of the kernel processed data */
+	} __Reply__thread_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_act;
+		/* end of the kernel processed data */
+	} __Reply__thread_create_running_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__task_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlerss[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__task_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_lock_set;
+		/* end of the kernel processed data */
+	} __Reply__lock_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t semaphore;
+		/* end of the kernel processed data */
+	} __Reply__semaphore_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__semaphore_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+		boolean_t get_default;
+	} __Reply__task_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_emulation_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t emulation_vector;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int vector_start;
+		mach_msg_type_number_t emulation_vectorCnt;
+	} __Reply__task_get_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_ras_pc_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t names;
+		mach_msg_ool_descriptor_t info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t namesCnt;
+		mach_msg_type_number_t infoCnt;
+	} __Reply__task_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t assigned_set;
+		/* end of the kernel processed data */
+	} __Reply__task_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[144];
+	} __Reply__task_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__task_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__task_subsystem__defined
+#define __ReplyUnion__task_subsystem__defined
+union __ReplyUnion__task_subsystem {
+	__Reply__task_create_t Reply_task_create;
+	__Reply__task_terminate_t Reply_task_terminate;
+	__Reply__task_threads_t Reply_task_threads;
+	__Reply__mach_ports_register_t Reply_mach_ports_register;
+	__Reply__mach_ports_lookup_t Reply_mach_ports_lookup;
+	__Reply__task_info_t Reply_task_info;
+	__Reply__task_set_info_t Reply_task_set_info;
+	__Reply__task_suspend_t Reply_task_suspend;
+	__Reply__task_resume_t Reply_task_resume;
+	__Reply__task_get_special_port_t Reply_task_get_special_port;
+	__Reply__task_set_special_port_t Reply_task_set_special_port;
+	__Reply__thread_create_t Reply_thread_create;
+	__Reply__thread_create_running_t Reply_thread_create_running;
+	__Reply__task_set_exception_ports_t Reply_task_set_exception_ports;
+	__Reply__task_get_exception_ports_t Reply_task_get_exception_ports;
+	__Reply__task_swap_exception_ports_t Reply_task_swap_exception_ports;
+	__Reply__lock_set_create_t Reply_lock_set_create;
+	__Reply__lock_set_destroy_t Reply_lock_set_destroy;
+	__Reply__semaphore_create_t Reply_semaphore_create;
+	__Reply__semaphore_destroy_t Reply_semaphore_destroy;
+	__Reply__task_policy_set_t Reply_task_policy_set;
+	__Reply__task_policy_get_t Reply_task_policy_get;
+	__Reply__task_sample_t Reply_task_sample;
+	__Reply__task_policy_t Reply_task_policy;
+	__Reply__task_set_emulation_t Reply_task_set_emulation;
+	__Reply__task_get_emulation_vector_t Reply_task_get_emulation_vector;
+	__Reply__task_set_emulation_vector_t Reply_task_set_emulation_vector;
+	__Reply__task_set_ras_pc_t Reply_task_set_ras_pc;
+	__Reply__task_zone_info_t Reply_task_zone_info;
+	__Reply__task_assign_t Reply_task_assign;
+	__Reply__task_assign_default_t Reply_task_assign_default;
+	__Reply__task_get_assignment_t Reply_task_get_assignment;
+	__Reply__task_set_policy_t Reply_task_set_policy;
+	__Reply__task_get_state_t Reply_task_get_state;
+	__Reply__task_set_state_t Reply_task_set_state;
+};
+#endif /* !__RequestUnion__task_subsystem__defined */
+
+#ifndef subsystem_to_name_map_task
+#define subsystem_to_name_map_task \
+    { "task_create", 3400 },\
+    { "task_terminate", 3401 },\
+    { "task_threads", 3402 },\
+    { "mach_ports_register", 3403 },\
+    { "mach_ports_lookup", 3404 },\
+    { "task_info", 3405 },\
+    { "task_set_info", 3406 },\
+    { "task_suspend", 3407 },\
+    { "task_resume", 3408 },\
+    { "task_get_special_port", 3409 },\
+    { "task_set_special_port", 3410 },\
+    { "thread_create", 3411 },\
+    { "thread_create_running", 3412 },\
+    { "task_set_exception_ports", 3413 },\
+    { "task_get_exception_ports", 3414 },\
+    { "task_swap_exception_ports", 3415 },\
+    { "lock_set_create", 3416 },\
+    { "lock_set_destroy", 3417 },\
+    { "semaphore_create", 3418 },\
+    { "semaphore_destroy", 3419 },\
+    { "task_policy_set", 3420 },\
+    { "task_policy_get", 3421 },\
+    { "task_sample", 3422 },\
+    { "task_policy", 3423 },\
+    { "task_set_emulation", 3424 },\
+    { "task_get_emulation_vector", 3425 },\
+    { "task_set_emulation_vector", 3426 },\
+    { "task_set_ras_pc", 3427 },\
+    { "task_zone_info", 3428 },\
+    { "task_assign", 3429 },\
+    { "task_assign_default", 3430 },\
+    { "task_get_assignment", 3431 },\
+    { "task_set_policy", 3432 },\
+    { "task_get_state", 3433 },\
+    { "task_set_state", 3434 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _task_user_ */
diff -urN cctools-806-old/include/mach/i386/thread_act.h cctools-806/include/mach/i386/thread_act.h
--- cctools-806-old/include/mach/i386/thread_act.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/thread_act.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1155 @@
+#ifndef	_thread_act_user_
+#define	_thread_act_user_
+
+/* Module thread_act */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	thread_act_MSG_COUNT
+#define	thread_act_MSG_COUNT	25
+#endif	/* thread_act_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine thread_terminate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_terminate
+(
+	thread_act_t target_act
+);
+
+/* Routine act_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t act_get_state
+(
+	thread_act_t target_act,
+	int flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine act_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t act_set_state
+(
+	thread_act_t target_act,
+	int flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+/* Routine thread_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_state
+(
+	thread_act_t target_act,
+	thread_state_flavor_t flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine thread_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_state
+(
+	thread_act_t target_act,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+/* Routine thread_suspend */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_suspend
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_resume */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_resume
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_abort */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_abort
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_abort_safely */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_abort_safely
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_depress_abort */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_depress_abort
+(
+	thread_act_t thread
+);
+
+/* Routine thread_get_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_special_port
+(
+	thread_act_t thr_act,
+	int which_port,
+	mach_port_t *special_port
+);
+
+/* Routine thread_set_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_special_port
+(
+	thread_act_t thr_act,
+	int which_port,
+	mach_port_t special_port
+);
+
+/* Routine thread_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_info
+(
+	thread_act_t target_act,
+	thread_flavor_t flavor,
+	thread_info_t thread_info_out,
+	mach_msg_type_number_t *thread_info_outCnt
+);
+
+/* Routine thread_set_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor
+);
+
+/* Routine thread_get_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine thread_swap_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_swap_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine thread_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy
+(
+	thread_act_t thr_act,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	boolean_t set_limit
+);
+
+/* Routine thread_policy_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy_set
+(
+	thread_act_t thread,
+	thread_policy_flavor_t flavor,
+	thread_policy_t policy_info,
+	mach_msg_type_number_t policy_infoCnt
+);
+
+/* Routine thread_policy_get */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy_get
+(
+	thread_act_t thread,
+	thread_policy_flavor_t flavor,
+	thread_policy_t policy_info,
+	mach_msg_type_number_t *policy_infoCnt,
+	boolean_t *get_default
+);
+
+/* Routine thread_sample */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_sample
+(
+	thread_act_t thread,
+	mach_port_t reply
+);
+
+/* Routine etap_trace_thread */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t etap_trace_thread
+(
+	thread_act_t target_act,
+	boolean_t trace_status
+);
+
+/* Routine thread_assign */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_assign
+(
+	thread_act_t thread,
+	processor_set_t new_set
+);
+
+/* Routine thread_assign_default */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_assign_default
+(
+	thread_act_t thread
+);
+
+/* Routine thread_get_assignment */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_assignment
+(
+	thread_act_t thread,
+	processor_set_name_t *assigned_set
+);
+
+/* Routine thread_set_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_policy
+(
+	thread_act_t thr_act,
+	processor_set_t pset,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	policy_limit_t limit,
+	mach_msg_type_number_t limitCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__thread_act_subsystem__defined
+#define __Request__thread_act_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__act_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__act_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__thread_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__thread_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_abort_safely_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_depress_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__thread_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__thread_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_flavor_t flavor;
+		mach_msg_type_number_t thread_info_outCnt;
+	} __Request__thread_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__thread_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+	} __Request__thread_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__thread_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		boolean_t set_limit;
+	} __Request__thread_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+	} __Request__thread_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		boolean_t get_default;
+	} __Request__thread_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t reply;
+		/* end of the kernel processed data */
+	} __Request__thread_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		boolean_t trace_status;
+	} __Request__etap_trace_thread_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		/* end of the kernel processed data */
+	} __Request__thread_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pset;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		mach_msg_type_number_t limitCnt;
+		integer_t limit[1];
+	} __Request__thread_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__thread_act_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__thread_act_subsystem__defined
+#define __RequestUnion__thread_act_subsystem__defined
+union __RequestUnion__thread_act_subsystem {
+	__Request__thread_terminate_t Request_thread_terminate;
+	__Request__act_get_state_t Request_act_get_state;
+	__Request__act_set_state_t Request_act_set_state;
+	__Request__thread_get_state_t Request_thread_get_state;
+	__Request__thread_set_state_t Request_thread_set_state;
+	__Request__thread_suspend_t Request_thread_suspend;
+	__Request__thread_resume_t Request_thread_resume;
+	__Request__thread_abort_t Request_thread_abort;
+	__Request__thread_abort_safely_t Request_thread_abort_safely;
+	__Request__thread_depress_abort_t Request_thread_depress_abort;
+	__Request__thread_get_special_port_t Request_thread_get_special_port;
+	__Request__thread_set_special_port_t Request_thread_set_special_port;
+	__Request__thread_info_t Request_thread_info;
+	__Request__thread_set_exception_ports_t Request_thread_set_exception_ports;
+	__Request__thread_get_exception_ports_t Request_thread_get_exception_ports;
+	__Request__thread_swap_exception_ports_t Request_thread_swap_exception_ports;
+	__Request__thread_policy_t Request_thread_policy;
+	__Request__thread_policy_set_t Request_thread_policy_set;
+	__Request__thread_policy_get_t Request_thread_policy_get;
+	__Request__thread_sample_t Request_thread_sample;
+	__Request__etap_trace_thread_t Request_etap_trace_thread;
+	__Request__thread_assign_t Request_thread_assign;
+	__Request__thread_assign_default_t Request_thread_assign_default;
+	__Request__thread_get_assignment_t Request_thread_get_assignment;
+	__Request__thread_set_policy_t Request_thread_set_policy;
+};
+#endif /* !__RequestUnion__thread_act_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__thread_act_subsystem__defined
+#define __Reply__thread_act_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[144];
+	} __Reply__act_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__act_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[144];
+	} __Reply__thread_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_abort_safely_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_depress_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+	} __Reply__thread_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t thread_info_outCnt;
+		integer_t thread_info_out[12];
+	} __Reply__thread_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__thread_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__thread_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+		boolean_t get_default;
+	} __Reply__thread_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__etap_trace_thread_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t assigned_set;
+		/* end of the kernel processed data */
+	} __Reply__thread_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__thread_act_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__thread_act_subsystem__defined
+#define __ReplyUnion__thread_act_subsystem__defined
+union __ReplyUnion__thread_act_subsystem {
+	__Reply__thread_terminate_t Reply_thread_terminate;
+	__Reply__act_get_state_t Reply_act_get_state;
+	__Reply__act_set_state_t Reply_act_set_state;
+	__Reply__thread_get_state_t Reply_thread_get_state;
+	__Reply__thread_set_state_t Reply_thread_set_state;
+	__Reply__thread_suspend_t Reply_thread_suspend;
+	__Reply__thread_resume_t Reply_thread_resume;
+	__Reply__thread_abort_t Reply_thread_abort;
+	__Reply__thread_abort_safely_t Reply_thread_abort_safely;
+	__Reply__thread_depress_abort_t Reply_thread_depress_abort;
+	__Reply__thread_get_special_port_t Reply_thread_get_special_port;
+	__Reply__thread_set_special_port_t Reply_thread_set_special_port;
+	__Reply__thread_info_t Reply_thread_info;
+	__Reply__thread_set_exception_ports_t Reply_thread_set_exception_ports;
+	__Reply__thread_get_exception_ports_t Reply_thread_get_exception_ports;
+	__Reply__thread_swap_exception_ports_t Reply_thread_swap_exception_ports;
+	__Reply__thread_policy_t Reply_thread_policy;
+	__Reply__thread_policy_set_t Reply_thread_policy_set;
+	__Reply__thread_policy_get_t Reply_thread_policy_get;
+	__Reply__thread_sample_t Reply_thread_sample;
+	__Reply__etap_trace_thread_t Reply_etap_trace_thread;
+	__Reply__thread_assign_t Reply_thread_assign;
+	__Reply__thread_assign_default_t Reply_thread_assign_default;
+	__Reply__thread_get_assignment_t Reply_thread_get_assignment;
+	__Reply__thread_set_policy_t Reply_thread_set_policy;
+};
+#endif /* !__RequestUnion__thread_act_subsystem__defined */
+
+#ifndef subsystem_to_name_map_thread_act
+#define subsystem_to_name_map_thread_act \
+    { "thread_terminate", 3600 },\
+    { "act_get_state", 3601 },\
+    { "act_set_state", 3602 },\
+    { "thread_get_state", 3603 },\
+    { "thread_set_state", 3604 },\
+    { "thread_suspend", 3605 },\
+    { "thread_resume", 3606 },\
+    { "thread_abort", 3607 },\
+    { "thread_abort_safely", 3608 },\
+    { "thread_depress_abort", 3609 },\
+    { "thread_get_special_port", 3610 },\
+    { "thread_set_special_port", 3611 },\
+    { "thread_info", 3612 },\
+    { "thread_set_exception_ports", 3613 },\
+    { "thread_get_exception_ports", 3614 },\
+    { "thread_swap_exception_ports", 3615 },\
+    { "thread_policy", 3616 },\
+    { "thread_policy_set", 3617 },\
+    { "thread_policy_get", 3618 },\
+    { "thread_sample", 3619 },\
+    { "etap_trace_thread", 3620 },\
+    { "thread_assign", 3621 },\
+    { "thread_assign_default", 3622 },\
+    { "thread_get_assignment", 3623 },\
+    { "thread_set_policy", 3624 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _thread_act_user_ */
diff -urN cctools-806-old/include/mach/i386/thread_state.h cctools-806/include/mach/i386/thread_state.h
--- cctools-806-old/include/mach/i386/thread_state.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/thread_state.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,42 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef _MACH_I386_THREAD_STATE_H_
+#define _MACH_I386_THREAD_STATE_H_
+
+/* Size of maximum exported thread state in words */
+#define I386_THREAD_STATE_MAX	(144)    /* Size of biggest state possible */
+
+#if defined (__i386__) || defined(__x86_64__)
+#define THREAD_STATE_MAX	I386_THREAD_STATE_MAX
+#endif
+
+#endif	/* _MACH_I386_THREAD_STATE_H_ */
diff -urN cctools-806-old/include/mach/i386/thread_status.h cctools-806/include/mach/i386/thread_status.h
--- cctools-806-old/include/mach/i386/thread_status.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/thread_status.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,312 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	thread_status.h
+ *	Author:	Avadis Tevanian, Jr.
+ *	Date:	1985
+ *
+ *	This file contains the structure definitions for the thread
+ *	state as applied to I386 processors.
+ */
+
+#ifndef	_MACH_I386_THREAD_STATUS_H_
+#define _MACH_I386_THREAD_STATUS_H_
+
+#include <mach/i386/_structs.h>
+#include <mach/message.h>
+#include <mach/i386/fp_reg.h>
+#include <mach/i386/thread_state.h>
+#include <i386/eflags.h>
+
+/*
+ * the i386_xxxx form is kept for legacy purposes since these types
+ * are externally known... eventually they should be deprecated.
+ * our internal implementation has moved to the following naming convention
+ *
+ *   x86_xxxx32 names are used to deal with 32 bit states
+ *   x86_xxxx64 names are used to deal with 64 bit states
+ *   x86_xxxx   names are used to deal with either 32 or 64 bit states
+ *	via a self-describing mechanism
+ */
+
+/*
+ * these are the legacy names which should be deprecated in the future
+ * they are externally known which is the only reason we don't just get
+ * rid of them
+ */
+#define i386_THREAD_STATE		1
+#define i386_FLOAT_STATE		2
+#define i386_EXCEPTION_STATE		3
+
+/*
+ * THREAD_STATE_FLAVOR_LIST 0
+ * 	these are the supported flavors
+ */
+#define x86_THREAD_STATE32		1
+#define x86_FLOAT_STATE32		2
+#define x86_EXCEPTION_STATE32		3
+#define x86_THREAD_STATE64		4
+#define x86_FLOAT_STATE64		5
+#define x86_EXCEPTION_STATE64		6
+#define x86_THREAD_STATE		7
+#define x86_FLOAT_STATE			8
+#define x86_EXCEPTION_STATE		9
+#define x86_DEBUG_STATE32		10
+#define x86_DEBUG_STATE64		11
+#define x86_DEBUG_STATE			12
+#define THREAD_STATE_NONE		13
+/* 15 and 16 are used for the internal x86_SAVED_STATE flavours */
+#define x86_AVX_STATE32			16
+#define x86_AVX_STATE64			17
+
+
+/*
+ * Largest state on this machine:
+ * (be sure mach/machine/thread_state.h matches!)
+ */
+#define THREAD_MACHINE_STATE_MAX	THREAD_STATE_MAX
+
+/*
+ * VALID_THREAD_STATE_FLAVOR is a platform specific macro that when passed
+ * an exception flavor will return if that is a defined flavor for that
+ * platform. The macro must be manually updated to include all of the valid
+ * exception flavors as defined above.
+ */
+#define VALID_THREAD_STATE_FLAVOR(x)       \
+	 ((x == x86_THREAD_STATE32)	|| \
+	  (x == x86_FLOAT_STATE32)	|| \
+	  (x == x86_EXCEPTION_STATE32)	|| \
+	  (x == x86_DEBUG_STATE32)	|| \
+	  (x == x86_THREAD_STATE64)	|| \
+	  (x == x86_FLOAT_STATE64)	|| \
+	  (x == x86_EXCEPTION_STATE64)	|| \
+	  (x == x86_DEBUG_STATE64)	|| \
+	  (x == x86_THREAD_STATE)	|| \
+	  (x == x86_FLOAT_STATE)	|| \
+	  (x == x86_EXCEPTION_STATE)	|| \
+	  (x == x86_DEBUG_STATE)	|| \
+	  (x == x86_AVX_STATE32)	|| \
+	  (x == x86_AVX_STATE64)	|| \
+	  (x == THREAD_STATE_NONE))
+
+struct x86_state_hdr {
+	int	flavor;
+	int	count;
+};
+typedef struct x86_state_hdr x86_state_hdr_t;
+
+/*
+ * Default segment register values.
+ */
+    
+#define USER_CODE_SELECTOR	0x0017
+#define USER_DATA_SELECTOR	0x001f
+#define KERN_CODE_SELECTOR	0x0008
+#define KERN_DATA_SELECTOR	0x0010
+
+/*
+ * to be deprecated in the future
+ */
+typedef _STRUCT_X86_THREAD_STATE32 i386_thread_state_t;
+#define i386_THREAD_STATE_COUNT	((mach_msg_type_number_t) \
+    ( sizeof (i386_thread_state_t) / sizeof (int) ))
+
+typedef _STRUCT_X86_THREAD_STATE32 x86_thread_state32_t;
+#define x86_THREAD_STATE32_COUNT	((mach_msg_type_number_t) \
+    ( sizeof (x86_thread_state32_t) / sizeof (int) ))
+
+/*
+ * to be deprecated in the future
+ */
+typedef _STRUCT_X86_FLOAT_STATE32 i386_float_state_t;
+#define i386_FLOAT_STATE_COUNT ((mach_msg_type_number_t) \
+		(sizeof(i386_float_state_t)/sizeof(unsigned int)))
+
+typedef _STRUCT_X86_FLOAT_STATE32 x86_float_state32_t;
+#define x86_FLOAT_STATE32_COUNT ((mach_msg_type_number_t) \
+		(sizeof(x86_float_state32_t)/sizeof(unsigned int)))
+
+typedef _STRUCT_X86_AVX_STATE32 x86_avx_state32_t;
+#define x86_AVX_STATE32_COUNT ((mach_msg_type_number_t) \
+		(sizeof(x86_avx_state32_t)/sizeof(unsigned int)))
+
+/*
+ * to be deprecated in the future
+ */
+typedef _STRUCT_X86_EXCEPTION_STATE32 i386_exception_state_t;
+#define i386_EXCEPTION_STATE_COUNT	((mach_msg_type_number_t) \
+    ( sizeof (i386_exception_state_t) / sizeof (int) ))
+
+typedef _STRUCT_X86_EXCEPTION_STATE32 x86_exception_state32_t;
+#define x86_EXCEPTION_STATE32_COUNT	((mach_msg_type_number_t) \
+    ( sizeof (x86_exception_state32_t) / sizeof (int) ))
+
+#define I386_EXCEPTION_STATE_COUNT i386_EXCEPTION_STATE_COUNT
+
+typedef _STRUCT_X86_DEBUG_STATE32 x86_debug_state32_t;
+#define x86_DEBUG_STATE32_COUNT       ((mach_msg_type_number_t) \
+	( sizeof (x86_debug_state32_t) / sizeof (int) ))
+
+#define X86_DEBUG_STATE32_COUNT x86_DEBUG_STATE32_COUNT
+
+typedef _STRUCT_X86_THREAD_STATE64 x86_thread_state64_t;
+#define x86_THREAD_STATE64_COUNT	((mach_msg_type_number_t) \
+    ( sizeof (x86_thread_state64_t) / sizeof (int) ))
+
+typedef _STRUCT_X86_FLOAT_STATE64 x86_float_state64_t;
+#define x86_FLOAT_STATE64_COUNT ((mach_msg_type_number_t) \
+		(sizeof(x86_float_state64_t)/sizeof(unsigned int)))
+
+typedef _STRUCT_X86_AVX_STATE64 x86_avx_state64_t;
+#define x86_AVX_STATE64_COUNT ((mach_msg_type_number_t) \
+		(sizeof(x86_avx_state64_t)/sizeof(unsigned int)))
+
+typedef _STRUCT_X86_EXCEPTION_STATE64 x86_exception_state64_t;
+#define x86_EXCEPTION_STATE64_COUNT	((mach_msg_type_number_t) \
+    ( sizeof (x86_exception_state64_t) / sizeof (int) ))
+
+#define X86_EXCEPTION_STATE64_COUNT x86_EXCEPTION_STATE64_COUNT
+
+typedef _STRUCT_X86_DEBUG_STATE64 x86_debug_state64_t;
+#define x86_DEBUG_STATE64_COUNT	((mach_msg_type_number_t) \
+    ( sizeof (x86_debug_state64_t) / sizeof (int) ))
+
+#define X86_DEBUG_STATE64_COUNT x86_DEBUG_STATE64_COUNT
+
+/*
+ * Combined thread, float and exception states
+ */
+struct x86_thread_state {
+	x86_state_hdr_t			tsh;
+	union {
+	    x86_thread_state32_t	ts32;
+	    x86_thread_state64_t	ts64;
+	} uts;
+};
+
+struct x86_float_state {
+	x86_state_hdr_t			fsh;
+	union {
+		x86_float_state32_t	fs32;
+		x86_float_state64_t	fs64;
+	} ufs;
+};
+
+struct x86_exception_state {
+	x86_state_hdr_t			esh;
+	union {
+		x86_exception_state32_t	es32;
+		x86_exception_state64_t	es64;
+	} ues;
+};
+
+struct x86_debug_state {
+	x86_state_hdr_t			dsh;
+	union {
+		x86_debug_state32_t	ds32;
+		x86_debug_state64_t	ds64;
+	} uds;
+};
+
+typedef struct x86_thread_state x86_thread_state_t;
+#define x86_THREAD_STATE_COUNT	((mach_msg_type_number_t) \
+		( sizeof (x86_thread_state_t) / sizeof (int) ))
+
+typedef struct x86_float_state x86_float_state_t;
+#define x86_FLOAT_STATE_COUNT ((mach_msg_type_number_t) \
+		(sizeof(x86_float_state_t)/sizeof(unsigned int)))
+
+typedef struct x86_exception_state x86_exception_state_t;
+#define x86_EXCEPTION_STATE_COUNT ((mach_msg_type_number_t) \
+		(sizeof(x86_exception_state_t)/sizeof(unsigned int)))
+
+typedef struct x86_debug_state x86_debug_state_t;
+#define x86_DEBUG_STATE_COUNT ((mach_msg_type_number_t) \
+		(sizeof(x86_debug_state_t)/sizeof(unsigned int)))
+
+/*
+ * Machine-independent way for servers and Mach's exception mechanism to
+ * choose the most efficient state flavor for exception RPC's:
+ */
+#define MACHINE_THREAD_STATE		x86_THREAD_STATE
+#define MACHINE_THREAD_STATE_COUNT	x86_THREAD_STATE_COUNT
+
+/*
+ * when reloading the segment registers on
+ * a return out of the kernel, we may take
+ * a GeneralProtection or SegmentNotPresent
+ * fault if one or more of the segment
+ * registers in the saved state was improperly
+ * specified via an x86_THREAD_STATE32 call
+ * the frame we push on top of the existing
+ * save area looks like this... we need to
+ * carry this as part of the save area
+ * in case we get hit so that we have a big
+ * enough stack
+ */
+struct x86_seg_load_fault32 {
+	uint16_t	trapno;
+	uint16_t	cpu;
+	uint32_t	err;
+	uint32_t	eip;
+	uint32_t	cs;
+	uint32_t	efl;
+};
+
+
+#endif	/* _MACH_I386_THREAD_STATUS_H_ */
diff -urN cctools-806-old/include/mach/i386/vm_param.h cctools-806/include/mach/i386/vm_param.h
--- cctools-806-old/include/mach/i386/vm_param.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/vm_param.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,157 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+
+/* 
+ * Copyright (c) 1994 The University of Utah and
+ * the Computer Systems Laboratory at the University of Utah (CSL).
+ * All rights reserved.
+ *
+ * Permission to use, copy, modify and distribute this software is hereby
+ * granted provided that (1) source code retains these copyright, permission,
+ * and disclaimer notices, and (2) redistributions including binaries
+ * reproduce the notices in supporting documentation, and (3) all advertising
+ * materials mentioning features or use of this software display the following
+ * acknowledgement: ``This product includes software developed by the
+ * Computer Systems Laboratory at the University of Utah.''
+ *
+ * THE UNIVERSITY OF UTAH AND CSL ALLOW FREE USE OF THIS SOFTWARE IN ITS "AS
+ * IS" CONDITION.  THE UNIVERSITY OF UTAH AND CSL DISCLAIM ANY LIABILITY OF
+ * ANY KIND FOR ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ *
+ * CSL requests users of this software to return to csl-dist@cs.utah.edu any
+ * improvements that they make and grant CSL redistribution rights.
+ *
+ */
+
+/*
+ *	File:	vm_param.h
+ *	Author:	Avadis Tevanian, Jr.
+ *	Date:	1985
+ *
+ *	I386 machine dependent virtual memory parameters.
+ *	Most of the declarations are preceeded by I386_ (or i386_)
+ *	which is OK because only I386 specific code will be using
+ *	them.
+ */
+
+#ifndef	_MACH_I386_VM_PARAM_H_
+#define _MACH_I386_VM_PARAM_H_
+
+#define BYTE_SIZE		8		/* byte size in bits */
+
+#define I386_PGBYTES		4096		/* bytes per 80386 page */
+#define I386_PGSHIFT		12		/* bitshift for pages */
+
+#define	PAGE_SIZE		I386_PGBYTES
+#define	PAGE_SHIFT		I386_PGSHIFT
+#define	PAGE_MASK		(PAGE_SIZE - 1)
+
+#define I386_LPGBYTES		2*1024*1024	/* bytes per large page */
+#define I386_LPGSHIFT		21		/* bitshift for large pages */
+#define I386_LPGMASK		(I386_LPGBYTES-1)
+
+/*
+ *	Convert bytes to pages and convert pages to bytes.
+ *	No rounding is used.
+ */
+
+#define i386_btop(x)		((ppnum_t)((x) >> I386_PGSHIFT))
+#define machine_btop(x)		i386_btop(x)
+#define i386_ptob(x)		(((pmap_paddr_t)(x)) << I386_PGSHIFT)
+
+/*
+ *	Round off or truncate to the nearest page.  These will work
+ *	for either addresses or counts.  (i.e. 1 byte rounds to 1 page
+ *	bytes.
+ */
+
+#define i386_round_page(x)	((((pmap_paddr_t)(x)) + I386_PGBYTES - 1) & \
+					~(I386_PGBYTES-1))
+#define i386_trunc_page(x)	(((pmap_paddr_t)(x)) & ~(I386_PGBYTES-1))
+
+
+
+#define VM_MIN_ADDRESS64	((user_addr_t) 0x0000000000000000ULL)
+/*
+ * default top of user stack... it grows down from here
+ */
+#define VM_USRSTACK64		((user_addr_t) 0x00007FFF5FC00000ULL)
+#define VM_DYLD64		((user_addr_t) 0x00007FFF5FC00000ULL)
+#define VM_LIB64_SHR_DATA	((user_addr_t) 0x00007FFF60000000ULL)
+#define VM_LIB64_SHR_TEXT	((user_addr_t) 0x00007FFF80000000ULL)
+/*
+ * the end of the usable user address space , for now about 47 bits.
+ * the 64 bit commpage is past the end of this
+ */
+#define VM_MAX_PAGE_ADDRESS	((user_addr_t) 0x00007FFFFFE00000ULL)
+/*
+ * canonical end of user address space for limits checking
+ */
+#define VM_MAX_USER_PAGE_ADDRESS ((user_addr_t)0x00007FFFFFFFF000ULL)
+
+
+/* system-wide values */
+#define MACH_VM_MIN_ADDRESS		((mach_vm_offset_t) 0)
+#define MACH_VM_MAX_ADDRESS		((mach_vm_offset_t) VM_MAX_PAGE_ADDRESS)
+
+/* process-relative values (all 32-bit legacy only for now) */
+#define VM_MIN_ADDRESS		((vm_offset_t) 0)
+#define VM_USRSTACK32		((vm_offset_t) 0xC0000000)
+#define VM_MAX_ADDRESS		((vm_offset_t) 0xFFE00000)
+
+
+
+#endif	/* _MACH_I386_VM_PARAM_H_ */
diff -urN cctools-806-old/include/mach/i386/vm_types.h cctools-806/include/mach/i386/vm_types.h
--- cctools-806-old/include/mach/i386/vm_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/i386/vm_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,140 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	vm_types.h
+ *	Author:	Avadis Tevanian, Jr.
+ *	Date: 1985
+ *
+ *	Header file for VM data types.  I386 version.
+ */
+
+#ifndef	_MACH_I386_VM_TYPES_H_
+#define _MACH_I386_VM_TYPES_H_
+
+#ifndef	ASSEMBLER
+
+#include <i386/_types.h>
+#include <mach/i386/vm_param.h>
+#include <stdint.h>
+
+/*
+ * natural_t and integer_t are Mach's legacy types for machine-
+ * independent integer types (unsigned, and signed, respectively).
+ * Their original purpose was to define other types in a machine/
+ * compiler independent way.
+ *
+ * They also had an implicit "same size as pointer" characteristic
+ * to them (i.e. Mach's traditional types are very ILP32 or ILP64
+ * centric).  We support x86 ABIs that do not follow either of
+ * these models (specifically LP64).  Therefore, we had to make a
+ * choice between making these types scale with pointers or stay
+ * tied to integers.  Because their use is predominantly tied to
+ * to the size of an integer, we are keeping that association and
+ * breaking free from pointer size guarantees.
+ *
+ * New use of these types is discouraged.
+ */
+typedef __darwin_natural_t	natural_t;
+typedef int			integer_t;
+
+/*
+ * A vm_offset_t is a type-neutral pointer,
+ * e.g. an offset into a virtual memory space.
+ */
+#ifdef __LP64__
+typedef uintptr_t		vm_offset_t;
+#else	/* __LP64__ */
+typedef	natural_t		vm_offset_t;
+#endif	/* __LP64__ */
+
+/*
+ * A vm_size_t is the proper type for e.g.
+ * expressing the difference between two
+ * vm_offset_t entities.
+ */
+#ifdef __LP64__
+typedef uintptr_t		vm_size_t;
+#else	/* __LP64__ */
+typedef	natural_t		vm_size_t;
+#endif	/* __LP64__ */
+
+/*
+ * This new type is independent of a particular vm map's
+ * implementation size - and represents appropriate types
+ * for all possible maps.  This is used for interfaces
+ * where the size of the map is not known - or we don't
+ * want to have to distinguish.
+ */
+typedef uint64_t		mach_vm_address_t;
+typedef uint64_t		mach_vm_offset_t;
+typedef uint64_t		mach_vm_size_t;
+
+typedef uint64_t		vm_map_offset_t;
+typedef uint64_t		vm_map_address_t;
+typedef uint64_t		vm_map_size_t;
+
+
+#endif	/* ASSEMBLER */
+
+/*
+ * If composing messages by hand (please do not)
+ */
+#define	MACH_MSG_TYPE_INTEGER_T	MACH_MSG_TYPE_INTEGER_32
+
+#endif	/* _MACH_I386_VM_TYPES_H_ */
diff -urN cctools-806-old/include/mach/kern_return.h cctools-806/include/mach/kern_return.h
--- cctools-806-old/include/mach/kern_return.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/kern_return.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,322 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	h/kern_return.h
+ *	Author:	Avadis Tevanian, Jr.
+ *	Date:	1985
+ *
+ *	Kernel return codes.
+ *
+ */
+
+#ifndef	_MACH_KERN_RETURN_H_
+#define _MACH_KERN_RETURN_H_
+
+#include <mach/machine/kern_return.h>
+
+#define KERN_SUCCESS			0
+
+#define KERN_INVALID_ADDRESS		1
+		/* Specified address is not currently valid.
+		 */
+
+#define KERN_PROTECTION_FAILURE		2
+		/* Specified memory is valid, but does not permit the
+		 * required forms of access.
+		 */
+
+#define KERN_NO_SPACE			3
+		/* The address range specified is already in use, or
+		 * no address range of the size specified could be
+		 * found.
+		 */
+
+#define KERN_INVALID_ARGUMENT		4
+		/* The function requested was not applicable to this
+		 * type of argument, or an argument is invalid
+		 */
+
+#define KERN_FAILURE			5
+		/* The function could not be performed.  A catch-all.
+		 */
+
+#define KERN_RESOURCE_SHORTAGE		6
+		/* A system resource could not be allocated to fulfill
+		 * this request.  This failure may not be permanent.
+		 */
+
+#define KERN_NOT_RECEIVER		7
+		/* The task in question does not hold receive rights
+		 * for the port argument.
+		 */
+
+#define KERN_NO_ACCESS			8
+		/* Bogus access restriction.
+		 */
+
+#define KERN_MEMORY_FAILURE		9
+		/* During a page fault, the target address refers to a
+		 * memory object that has been destroyed.  This
+		 * failure is permanent.
+		 */
+
+#define KERN_MEMORY_ERROR		10
+		/* During a page fault, the memory object indicated
+		 * that the data could not be returned.  This failure
+		 * may be temporary; future attempts to access this
+		 * same data may succeed, as defined by the memory
+		 * object.
+		 */
+
+#define	KERN_ALREADY_IN_SET		11
+		/* The receive right is already a member of the portset.
+		 */
+
+#define KERN_NOT_IN_SET			12
+		/* The receive right is not a member of a port set.
+		 */
+
+#define KERN_NAME_EXISTS		13
+		/* The name already denotes a right in the task.
+		 */
+
+#define KERN_ABORTED			14
+		/* The operation was aborted.  Ipc code will
+		 * catch this and reflect it as a message error.
+		 */
+
+#define KERN_INVALID_NAME		15
+		/* The name doesn't denote a right in the task.
+		 */
+
+#define	KERN_INVALID_TASK		16
+		/* Target task isn't an active task.
+		 */
+
+#define KERN_INVALID_RIGHT		17
+		/* The name denotes a right, but not an appropriate right.
+		 */
+
+#define KERN_INVALID_VALUE		18
+		/* A blatant range error.
+		 */
+
+#define	KERN_UREFS_OVERFLOW		19
+		/* Operation would overflow limit on user-references.
+		 */
+
+#define	KERN_INVALID_CAPABILITY		20
+		/* The supplied (port) capability is improper.
+		 */
+
+#define KERN_RIGHT_EXISTS		21
+		/* The task already has send or receive rights
+		 * for the port under another name.
+		 */
+
+#define	KERN_INVALID_HOST		22
+		/* Target host isn't actually a host.
+		 */
+
+#define KERN_MEMORY_PRESENT		23
+		/* An attempt was made to supply "precious" data
+		 * for memory that is already present in a
+		 * memory object.
+		 */
+
+#define KERN_MEMORY_DATA_MOVED		24
+		/* A page was requested of a memory manager via
+		 * memory_object_data_request for an object using
+		 * a MEMORY_OBJECT_COPY_CALL strategy, with the
+		 * VM_PROT_WANTS_COPY flag being used to specify
+		 * that the page desired is for a copy of the
+		 * object, and the memory manager has detected
+		 * the page was pushed into a copy of the object
+		 * while the kernel was walking the shadow chain
+		 * from the copy to the object. This error code
+		 * is delivered via memory_object_data_error
+		 * and is handled by the kernel (it forces the
+		 * kernel to restart the fault). It will not be
+		 * seen by users.
+		 */
+
+#define KERN_MEMORY_RESTART_COPY	25
+		/* A strategic copy was attempted of an object
+		 * upon which a quicker copy is now possible.
+		 * The caller should retry the copy using
+		 * vm_object_copy_quickly. This error code
+		 * is seen only by the kernel.
+		 */
+
+#define KERN_INVALID_PROCESSOR_SET	26
+		/* An argument applied to assert processor set privilege
+		 * was not a processor set control port.
+		 */
+
+#define KERN_POLICY_LIMIT		27
+		/* The specified scheduling attributes exceed the thread's
+		 * limits.
+		 */
+
+#define KERN_INVALID_POLICY		28
+		/* The specified scheduling policy is not currently
+		 * enabled for the processor set.
+		 */
+
+#define KERN_INVALID_OBJECT		29
+		/* The external memory manager failed to initialize the
+		 * memory object.
+		 */
+
+#define KERN_ALREADY_WAITING		30
+		/* A thread is attempting to wait for an event for which 
+		 * there is already a waiting thread.
+		 */
+
+#define KERN_DEFAULT_SET		31
+		/* An attempt was made to destroy the default processor
+		 * set.
+		 */
+
+#define KERN_EXCEPTION_PROTECTED	32
+		/* An attempt was made to fetch an exception port that is
+		 * protected, or to abort a thread while processing a
+		 * protected exception.
+		 */
+
+#define KERN_INVALID_LEDGER		33
+		/* A ledger was required but not supplied.
+		 */
+
+#define KERN_INVALID_MEMORY_CONTROL	34
+		/* The port was not a memory cache control port.
+		 */
+
+#define KERN_INVALID_SECURITY		35
+		/* An argument supplied to assert security privilege 	
+		 * was not a host security port.
+		 */
+		
+#define KERN_NOT_DEPRESSED		36
+		/* thread_depress_abort was called on a thread which
+		 * was not currently depressed.
+		 */
+		
+#define KERN_TERMINATED			37
+		/* Object has been terminated and is no longer available
+		 */
+
+#define KERN_LOCK_SET_DESTROYED		38
+		/* Lock set has been destroyed and is no longer available.
+		 */
+
+#define KERN_LOCK_UNSTABLE		39
+		/* The thread holding the lock terminated before releasing
+		 * the lock
+		 */
+
+#define KERN_LOCK_OWNED			40
+		/* The lock is already owned by another thread
+		 */
+
+#define KERN_LOCK_OWNED_SELF		41
+		/* The lock is already owned by the calling thread
+		 */
+
+#define KERN_SEMAPHORE_DESTROYED	42
+		/* Semaphore has been destroyed and is no longer available.
+		 */
+
+#define KERN_RPC_SERVER_TERMINATED	43
+		/* Return from RPC indicating the target server was 
+		 * terminated before it successfully replied 
+		 */
+
+#define KERN_RPC_TERMINATE_ORPHAN	44
+		/* Terminate an orphaned activation.
+		 */
+
+#define KERN_RPC_CONTINUE_ORPHAN	45
+		/* Allow an orphaned activation to continue executing.
+		 */
+
+#define	KERN_NOT_SUPPORTED		46
+		/* Empty thread activation (No thread linked to it)
+		 */
+
+#define	KERN_NODE_DOWN			47
+		/* Remote node down or inaccessible.
+		 */
+
+#define KERN_NOT_WAITING		48
+		/* A signalled thread was not actually waiting. */
+
+#define	KERN_OPERATION_TIMED_OUT        49
+		/* Some thread-oriented operation (semaphore_wait) timed out
+		 */
+
+#define KERN_CODESIGN_ERROR		50
+		/* During a page fault, indicates that the page was rejected
+		 * as a result of a signature check.
+		 */
+
+#define	KERN_RETURN_MAX			0x100
+		/* Maximum return value allowable
+		 */
+
+#endif	/* _MACH_KERN_RETURN_H_ */
diff -urN cctools-806-old/include/mach/kmod.h cctools-806/include/mach/kmod.h
--- cctools-806-old/include/mach/kmod.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/kmod.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,180 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+
+#ifndef    _MACH_KMOD_H_
+#define    _MACH_KMOD_H_
+
+#include <mach/kern_return.h>
+#include <mach/mach_types.h>
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+
+#if PRAGMA_MARK
+#pragma mark Basic macros & typedefs
+#endif
+/***********************************************************************
+* Basic macros & typedefs
+***********************************************************************/
+#define KMOD_MAX_NAME    64
+
+#define KMOD_RETURN_SUCCESS    KERN_SUCCESS
+#define KMOD_RETURN_FAILURE    KERN_FAILURE
+
+typedef int kmod_t;
+
+struct  kmod_info;
+typedef kern_return_t kmod_start_func_t(struct kmod_info * ki, void * data);
+typedef kern_return_t kmod_stop_func_t(struct kmod_info * ki, void * data);
+
+#if PRAGMA_MARK
+#pragma mark Structure definitions
+#endif
+/***********************************************************************
+* Structure definitions
+*
+* All structures must be #pragma pack(4).
+***********************************************************************/
+#pragma pack(4)
+
+/* Run-time struct only; never saved to a file */
+typedef struct kmod_reference {
+    struct kmod_reference * next;
+    struct kmod_info      * info;
+} kmod_reference_t;
+
+/***********************************************************************
+* Warning: Any changes to the kmod_info structure affect the
+* KMOD_..._DECL macros below.
+***********************************************************************/
+
+/* The kmod_info_t structure is only safe to use inside the running
+ * kernel.  If you need to work with a kmod_info_t structure outside
+ * the kernel, please use the compatibility definitions below.
+ */
+typedef struct kmod_info {
+    struct kmod_info  * next;
+    int32_t             info_version;           // version of this structure
+    uint32_t            id;
+    char                name[KMOD_MAX_NAME];
+    char                version[KMOD_MAX_NAME];
+    int32_t             reference_count;        // # linkage refs to this 
+    kmod_reference_t  * reference_list;         // who this refs (links on)
+    vm_address_t        address;                // starting address
+    vm_size_t           size;                   // total size
+    vm_size_t           hdr_size;               // unwired hdr size
+    kmod_start_func_t * start;
+    kmod_stop_func_t  * stop;
+} kmod_info_t;
+
+/* A compatibility definition of kmod_info_t for 32-bit kexts.
+ */
+typedef struct kmod_info_32_v1 {
+    uint32_t            next_addr;
+    int32_t             info_version;
+    uint32_t            id;
+    uint8_t             name[KMOD_MAX_NAME];
+    uint8_t             version[KMOD_MAX_NAME];
+    int32_t             reference_count;
+    uint32_t            reference_list_addr;
+    uint32_t            address;
+    uint32_t            size;
+    uint32_t            hdr_size;
+    uint32_t            start_addr;
+    uint32_t            stop_addr;
+} kmod_info_32_v1_t;
+
+/* A compatibility definition of kmod_info_t for 64-bit kexts.
+ */
+typedef struct kmod_info_64_v1 {
+    uint64_t            next_addr;
+    int32_t             info_version;
+    uint32_t            id;
+    uint8_t             name[KMOD_MAX_NAME];
+    uint8_t             version[KMOD_MAX_NAME];
+    int32_t             reference_count;
+    uint64_t            reference_list_addr;
+    uint64_t            address;
+    uint64_t            size;
+    uint64_t            hdr_size;
+    uint64_t            start_addr;
+    uint64_t            stop_addr;
+} kmod_info_64_v1_t;
+
+#pragma pack()
+
+#if PRAGMA_MARK
+#pragma mark Kmod structure declaration macros
+#endif
+/***********************************************************************
+* Kmod structure declaration macros
+***********************************************************************/
+#define KMOD_INFO_NAME       kmod_info
+#define KMOD_INFO_VERSION    1
+
+#define KMOD_DECL(name, version)                                  \
+    static kmod_start_func_t name ## _module_start;               \
+    static kmod_stop_func_t  name ## _module_stop;                \
+    kmod_info_t KMOD_INFO_NAME = { 0, KMOD_INFO_VERSION, -1U,      \
+                       { #name }, { version }, -1, 0, 0, 0, 0,    \
+                           name ## _module_start,                 \
+                           name ## _module_stop };
+
+#define KMOD_EXPLICIT_DECL(name, version, start, stop)            \
+    kmod_info_t KMOD_INFO_NAME = { 0, KMOD_INFO_VERSION, -1U,      \
+                       { #name }, { version }, -1, 0, 0, 0, 0,    \
+                           start, stop };
+
+#if PRAGMA_MARK
+#pragma mark Kernel private declarations
+#endif
+/***********************************************************************
+* Kernel private declarations.
+***********************************************************************/
+
+
+#if PRAGMA_MARK
+#pragma mark Obsolete kmod stuff
+#endif
+/***********************************************************************
+* These 3 should be dropped but they're referenced by MIG declarations.
+***********************************************************************/
+typedef void * kmod_args_t;
+typedef int kmod_control_flavor_t;
+typedef kmod_info_t * kmod_info_array_t;
+
+__END_DECLS
+
+#endif    /* _MACH_KMOD_H_ */
diff -urN cctools-806-old/include/mach/ledger.defs cctools-806/include/mach/ledger.defs
--- cctools-806-old/include/mach/ledger.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ledger.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,79 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+subsystem
+#if	KERNEL_USER
+	  KernelUser
+#endif	/* KERNEL_USER */
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		       ledger 5000;
+
+#ifdef	KERNEL_USER
+userprefix r_;
+#endif	/* KERNEL_USER */
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+/*
+ *	Create a subordinate ledger
+ */
+routine ledger_create(
+		parent_ledger		: ledger_t;
+		ledger_ledger		: ledger_t;
+	out	new_ledger		: ledger_t;
+		transfer		: ledger_item_t);
+
+/*
+ *	Destroy a ledger
+ */
+routine ledger_terminate(
+		ledger			: ledger_t);
+
+/*
+ *	Transfer resources from a parent ledger to a child
+ */
+routine ledger_transfer(
+		parent_ledger		: ledger_t;
+		child_ledger		: ledger_t;
+		transfer		: ledger_item_t);
+
+/*
+ *	Return the ledger limit and balance
+ */
+routine ledger_read(
+		ledger			: ledger_t;
+	out	balance			: ledger_item_t;
+	out	limit			: ledger_item_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/ledger.h cctools-806/include/mach/ledger.h
--- cctools-806-old/include/mach/ledger.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ledger.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,260 @@
+#ifndef	_ledger_user_
+#define	_ledger_user_
+
+/* Module ledger */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	ledger_MSG_COUNT
+#define	ledger_MSG_COUNT	4
+#endif	/* ledger_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine ledger_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t ledger_create
+(
+	ledger_t parent_ledger,
+	ledger_t ledger_ledger,
+	ledger_t *new_ledger,
+	ledger_item_t transfer
+);
+
+/* Routine ledger_terminate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t ledger_terminate
+(
+	ledger_t ledger
+);
+
+/* Routine ledger_transfer */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t ledger_transfer
+(
+	ledger_t parent_ledger,
+	ledger_t child_ledger,
+	ledger_item_t transfer
+);
+
+/* Routine ledger_read */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t ledger_read
+(
+	ledger_t ledger,
+	ledger_item_t *balance,
+	ledger_item_t *limit
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__ledger_subsystem__defined
+#define __Request__ledger_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t ledger_ledger;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		ledger_item_t transfer;
+	} __Request__ledger_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__ledger_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_ledger;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		ledger_item_t transfer;
+	} __Request__ledger_transfer_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__ledger_read_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__ledger_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__ledger_subsystem__defined
+#define __RequestUnion__ledger_subsystem__defined
+union __RequestUnion__ledger_subsystem {
+	__Request__ledger_create_t Request_ledger_create;
+	__Request__ledger_terminate_t Request_ledger_terminate;
+	__Request__ledger_transfer_t Request_ledger_transfer;
+	__Request__ledger_read_t Request_ledger_read;
+};
+#endif /* !__RequestUnion__ledger_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__ledger_subsystem__defined
+#define __Reply__ledger_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_ledger;
+		/* end of the kernel processed data */
+	} __Reply__ledger_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__ledger_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__ledger_transfer_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		ledger_item_t balance;
+		ledger_item_t limit;
+	} __Reply__ledger_read_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__ledger_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__ledger_subsystem__defined
+#define __ReplyUnion__ledger_subsystem__defined
+union __ReplyUnion__ledger_subsystem {
+	__Reply__ledger_create_t Reply_ledger_create;
+	__Reply__ledger_terminate_t Reply_ledger_terminate;
+	__Reply__ledger_transfer_t Reply_ledger_transfer;
+	__Reply__ledger_read_t Reply_ledger_read;
+};
+#endif /* !__RequestUnion__ledger_subsystem__defined */
+
+#ifndef subsystem_to_name_map_ledger
+#define subsystem_to_name_map_ledger \
+    { "ledger_create", 5000 },\
+    { "ledger_terminate", 5001 },\
+    { "ledger_transfer", 5002 },\
+    { "ledger_read", 5003 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _ledger_user_ */
diff -urN cctools-806-old/include/mach/lock_set.defs cctools-806/include/mach/lock_set.defs
--- cctools-806-old/include/mach/lock_set.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/lock_set.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,79 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ * 
+ */
+/*
+ *	File: mach/lock_set.defs
+ *	Author: Joseph CaraDonna
+ *
+ *	Exported kernel calls	
+ *
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	KernelServer
+#endif	/* KERNEL_SERVER */
+			lock_set 617000;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+/*
+ * a lock_set_t is created and destroyed through the task object.
+ *      lock_set_create(task,&lock_set_t,...);
+ *      lock_set_destroy(task,lock_set_t);
+ */
+
+routine lock_acquire(
+		lock_set	: lock_set_t;
+		lock_id		: int);
+
+routine lock_release(
+		lock_set	: lock_set_t;
+		lock_id		: int);
+
+routine lock_try(
+		lock_set	: lock_set_t;
+		lock_id		: int);
+
+routine lock_make_stable(
+		lock_set	: lock_set_t;
+		lock_id		: int);
+
+routine lock_handoff(
+		lock_set	: lock_set_t;
+		lock_id		: int);
+
+routine lock_handoff_accept(
+		lock_set	: lock_set_t;
+		lock_id		: int);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/lock_set.h cctools-806/include/mach/lock_set.h
--- cctools-806-old/include/mach/lock_set.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/lock_set.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,327 @@
+#ifndef	_lock_set_user_
+#define	_lock_set_user_
+
+/* Module lock_set */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	lock_set_MSG_COUNT
+#define	lock_set_MSG_COUNT	6
+#endif	/* lock_set_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine lock_acquire */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_acquire
+(
+	lock_set_t lock_set,
+	int lock_id
+);
+
+/* Routine lock_release */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_release
+(
+	lock_set_t lock_set,
+	int lock_id
+);
+
+/* Routine lock_try */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_try
+(
+	lock_set_t lock_set,
+	int lock_id
+);
+
+/* Routine lock_make_stable */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_make_stable
+(
+	lock_set_t lock_set,
+	int lock_id
+);
+
+/* Routine lock_handoff */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_handoff
+(
+	lock_set_t lock_set,
+	int lock_id
+);
+
+/* Routine lock_handoff_accept */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_handoff_accept
+(
+	lock_set_t lock_set,
+	int lock_id
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__lock_set_subsystem__defined
+#define __Request__lock_set_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int lock_id;
+	} __Request__lock_acquire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int lock_id;
+	} __Request__lock_release_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int lock_id;
+	} __Request__lock_try_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int lock_id;
+	} __Request__lock_make_stable_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int lock_id;
+	} __Request__lock_handoff_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int lock_id;
+	} __Request__lock_handoff_accept_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__lock_set_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__lock_set_subsystem__defined
+#define __RequestUnion__lock_set_subsystem__defined
+union __RequestUnion__lock_set_subsystem {
+	__Request__lock_acquire_t Request_lock_acquire;
+	__Request__lock_release_t Request_lock_release;
+	__Request__lock_try_t Request_lock_try;
+	__Request__lock_make_stable_t Request_lock_make_stable;
+	__Request__lock_handoff_t Request_lock_handoff;
+	__Request__lock_handoff_accept_t Request_lock_handoff_accept;
+};
+#endif /* !__RequestUnion__lock_set_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__lock_set_subsystem__defined
+#define __Reply__lock_set_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_acquire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_release_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_try_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_make_stable_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_handoff_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_handoff_accept_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__lock_set_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__lock_set_subsystem__defined
+#define __ReplyUnion__lock_set_subsystem__defined
+union __ReplyUnion__lock_set_subsystem {
+	__Reply__lock_acquire_t Reply_lock_acquire;
+	__Reply__lock_release_t Reply_lock_release;
+	__Reply__lock_try_t Reply_lock_try;
+	__Reply__lock_make_stable_t Reply_lock_make_stable;
+	__Reply__lock_handoff_t Reply_lock_handoff;
+	__Reply__lock_handoff_accept_t Reply_lock_handoff_accept;
+};
+#endif /* !__RequestUnion__lock_set_subsystem__defined */
+
+#ifndef subsystem_to_name_map_lock_set
+#define subsystem_to_name_map_lock_set \
+    { "lock_acquire", 617000 },\
+    { "lock_release", 617001 },\
+    { "lock_try", 617002 },\
+    { "lock_make_stable", 617003 },\
+    { "lock_handoff", 617004 },\
+    { "lock_handoff_accept", 617005 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _lock_set_user_ */
diff -urN cctools-806-old/include/mach/mach_error.h cctools-806/include/mach/mach_error.h
--- cctools-806-old/include/mach/mach_error.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_error.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,93 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS 
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie the
+ * rights to redistribute these changes.
+ */
+
+/*
+ *	File:	mach_error.h
+ *	Author:	Douglas Orr, Carnegie Mellon University
+ *	Date:	Mar. 1988
+ *
+ *	Definitions of routines in mach_error.c
+ */
+
+#ifndef	_MACH_ERROR_
+#define	_MACH_ERROR_	1
+
+#include <mach/error.h>
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+char		*mach_error_string(
+/*
+ *	Returns a string appropriate to the error argument given
+ */
+	mach_error_t error_value
+				);
+
+void		mach_error(
+/*
+ *	Prints an appropriate message on the standard error stream
+ */
+	const char	*str,
+	mach_error_t	error_value
+				);
+
+char		*mach_error_type(
+/*
+ *	Returns a string with the error system, subsystem and code
+ */
+	mach_error_t	error_value
+				);
+__END_DECLS
+
+#endif	/* _MACH_ERROR_ */
diff -urN cctools-806-old/include/mach/mach_exc.defs cctools-806/include/mach/mach_exc.defs
--- cctools-806-old/include/mach/mach_exc.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_exc.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,119 @@
+/*
+ * Copyright (c) 2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ * Abstract:
+ *	MiG definitions file for Mach exception interface.
+ */
+
+subsystem
+#if	KERNEL_USER
+	  KernelUser
+#endif
+		     mach_exc 2405;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+ServerPrefix catch_;
+
+type mach_exception_data_t	= array[*:2] of int64_t;
+type exception_type_t		= int;
+
+routine		mach_exception_raise(
+#if	KERNEL_USER
+			exception_port	: mach_port_move_send_t;
+			thread		: mach_port_move_send_t;
+			task		: mach_port_move_send_t;
+#else	/* KERNEL_USER */
+			exception_port	: mach_port_t;
+			thread		: mach_port_t;
+			task		: mach_port_t;
+#endif	/* KERNEL_USER */
+			exception	: exception_type_t;
+			code		: mach_exception_data_t
+			);
+
+routine		mach_exception_raise_state(
+#if	KERNEL_USER
+			exception_port	: mach_port_move_send_t;
+#else	/* KERNEL_USER */
+			exception_port	: mach_port_t;
+#endif	/* KERNEL_USER */
+			exception	: exception_type_t;
+			code		: mach_exception_data_t, const;
+		  inout flavor		: int;
+			old_state	: thread_state_t, const;
+		    out new_state	: thread_state_t);
+
+routine		mach_exception_raise_state_identity(
+#if	KERNEL_USER
+			exception_port  : mach_port_move_send_t;
+			thread		: mach_port_move_send_t;
+			task		: mach_port_move_send_t;
+#else	/* KERNEL_USER */
+			exception_port  : mach_port_t;
+			thread          : mach_port_t;
+			task            : mach_port_t;
+#endif	/* KERNEL_USER */
+			exception       : exception_type_t;
+			code            : mach_exception_data_t;
+		  inout flavor          : int;
+			old_state       : thread_state_t;
+		    out new_state       : thread_state_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/mach.h cctools-806/include/mach/mach.h
--- cctools-806-old/include/mach/mach.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,133 @@
+/*
+ * Copyright (c) 1999-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+
+/* 
+ *  Includes all the types that a normal user
+ *  of Mach programs should need
+ */
+
+#ifndef	_MACH_H_
+#define	_MACH_H_
+
+#define __MACH30__
+#define MACH_IPC_FLAVOR UNTYPED
+
+#include <mach/std_types.h>
+#include <mach/mach_types.h>
+#include <mach/mach_interface.h>
+#include <mach/mach_port.h>
+#include <mach/mach_init.h>
+#include <mach/mach_host.h>
+#include <mach/thread_switch.h>
+
+#include <mach/rpc.h>  		/* for compatibility only */
+#include <mach/mig.h>
+
+#include <mach/mig_errors.h>
+#include <mach/mach_error.h>
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+/*
+ * Standard prototypes
+ */
+extern void			panic_init(mach_port_t);
+extern void			panic(const char *, ...);
+
+extern void			safe_gets(char *,
+					  char *,
+					  int);
+
+extern void			slot_name(cpu_type_t,
+					  cpu_subtype_t,
+					  char **,
+					  char **);
+
+extern void			mig_reply_setup(mach_msg_header_t *,
+						mach_msg_header_t *);
+
+extern void			mach_msg_destroy(mach_msg_header_t *);
+
+extern mach_msg_return_t	mach_msg_receive(mach_msg_header_t *);
+
+extern mach_msg_return_t	mach_msg_send(mach_msg_header_t *);
+
+extern mach_msg_return_t	mach_msg_server_once(boolean_t (*)
+						     (mach_msg_header_t *,
+						      mach_msg_header_t *),
+						     mach_msg_size_t,
+						     mach_port_t,
+						     mach_msg_options_t);
+extern mach_msg_return_t	mach_msg_server(boolean_t (*)
+						(mach_msg_header_t *,
+						 mach_msg_header_t *),
+						mach_msg_size_t,
+						mach_port_t,
+						mach_msg_options_t);
+
+/*
+ * Prototypes for compatibility
+ */
+extern kern_return_t	clock_get_res(mach_port_t,
+				      clock_res_t *);
+extern kern_return_t	clock_set_res(mach_port_t,
+				      clock_res_t);
+
+extern kern_return_t	clock_sleep(mach_port_t,
+				    int,
+				    mach_timespec_t,
+				    mach_timespec_t *);
+__END_DECLS
+
+#endif	/* _MACH_H_ */
diff -urN cctools-806-old/include/mach/mach_host.defs cctools-806/include/mach/mach_host.defs
--- cctools-806-old/include/mach/mach_host.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_host.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,271 @@
+/*
+ * Copyright (c) 2000-2009 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ * File:	mach/mach_host.defs
+ *
+ * Abstract:
+ *	Mach host operations support.  Includes processor allocation and
+ *	control.  
+ */
+
+#ifdef	MACH_KERNEL
+#include <advisory_pageout.h>
+#endif	/* MACH_KERNEL */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+		       mach_host 200;
+
+/*
+ *	Basic types
+ */
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach/clock_types.defs>
+#include <mach_debug/mach_debug_types.defs>
+
+/*
+ * References to host objects are returned by:
+ *	mach_host_self() - trap
+ */
+
+/*
+ *	Return information about this host.
+ */
+routine host_info(
+		host		: host_t;
+		flavor		: host_flavor_t;
+	out	host_info_out	: host_info_t, CountInOut);
+
+/*
+ *	Get string describing current kernel version.
+ */
+routine	host_kernel_version(
+		host		: host_t;
+	out	kernel_version	: kernel_version_t);
+
+/*
+ *      Get host page size
+ *	(compatibility for running old libraries on new kernels -
+ *	host_page_size() is now a library routine based on constants)
+ */
+routine _host_page_size(
+		host		: host_t;
+	out	out_page_size	: vm_size_t);
+
+/*
+ *	Allow pagers to create named entries that point to un-mapped
+ *	abstract memory object.  The named entries are generally mappable
+ *	and can be subsetted through the mach_make_memory_entry call
+ */
+routine mach_memory_object_memory_entry(
+		host		:host_t;
+		internal	:boolean_t;
+		size		:vm_size_t;
+		permission	:vm_prot_t;
+		pager		:memory_object_t;
+	out	entry_handle	:mach_port_move_send_t);
+
+
+/*
+ *      Get processor info for all the processors on this host.
+ *	The returned data is an OOL array of processor info.
+ */
+routine host_processor_info(
+		host			: host_t;
+                flavor          	: processor_flavor_t;
+	out	out_processor_count 	: natural_t;
+        out     out_processor_info  	: processor_info_array_t);
+
+/*
+ * 	Return host IO master access port
+ */
+routine host_get_io_master(
+                host            : host_t;
+        out     io_master       : io_master_t);
+
+/*
+ *	Get service port for a processor set.
+ *	Available to all.
+ */
+routine host_get_clock_service(
+		host		: host_t;
+		clock_id	: clock_id_t;
+	out	clock_serv	: clock_serv_t);
+
+/*
+ * kernel module interface (obsolete as of SnowLeopard)
+ * see mach/kmod.h
+ */
+/* kmod_ MIG calls now return KERN_NOT_SUPPORTED on PPC/i386/x86_64. */
+routine	kmod_get_info(
+		host		: host_t;
+	out	modules		: kmod_args_t);
+
+/*
+ *	Returns information about the memory allocation zones.
+ *      Supported in all kernels..
+ *
+ *	DEPRECATED!  Use mach_zone_info() instead.
+ */
+routine host_zone_info(
+		host		: host_t;
+	out	names		: zone_name_array_t,
+					Dealloc;
+	out	info		: zone_info_array_t,
+					Dealloc);
+
+/*
+ *	Returns information about the global VP table.
+ *      Only supported in MACH_VM_DEBUG kernels,
+ *      otherwise returns KERN_FAILURE.
+ */
+routine host_virtual_physical_table_info(
+		host		: host_t;
+	out	info		: hash_info_bucket_array_t,
+					Dealloc);
+
+/*
+ *	Returns information about the global reverse hash table.
+ *      This call is only valid on MACH_IPC_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ */
+routine host_ipc_hash_info(
+		host		: host_t;
+	out	info		: hash_info_bucket_array_t,
+					Dealloc);
+
+skip; /* was enable_bluebox */
+skip; /* was disable_bluebox */
+
+/*
+ * JMM - Keep processor_set related items at the end for easy
+ * removal.
+ */
+/*
+ *	Get default processor set for host.
+ */
+routine processor_set_default(
+		host		: host_t;
+	out	default_set	: processor_set_name_t);
+
+/*
+ *	Create new processor set.  Returns real port for manipulations,
+ *	and name port for obtaining information.
+ */
+routine processor_set_create(
+		host		: host_t;
+	out	new_set		: processor_set_t;
+	out	new_name	: processor_set_name_t);
+
+/*
+ * 	Temporary interfaces for conversion to 64 bit data path 
+ */
+
+routine mach_memory_object_memory_entry_64(
+		host		:host_t;
+		internal	:boolean_t;
+		size		:memory_object_size_t;
+		permission	:vm_prot_t;
+		pager		:memory_object_t;
+	out	entry_handle	:mach_port_move_send_t);
+
+/*
+ *	Return statistics from this host.
+ */
+routine host_statistics(
+		host_priv	: host_t;
+		flavor		: host_flavor_t;
+	out	host_info_out	: host_info_t, CountInOut);
+
+routine host_request_notification(
+		host		: host_t;
+		notify_type	: host_flavor_t;
+		notify_port	: mach_port_make_send_once_t);
+
+routine host_lockgroup_info(
+		host		: host_t;
+	out	lockgroup_info	: lockgroup_info_array_t,
+					Dealloc);
+
+/*
+ *	Return 64-bit statistics from this host.
+ */
+routine host_statistics64(
+		host_priv	: host_t;
+		flavor		: host_flavor_t;
+	out	host_info64_out	: host_info64_t, CountInOut);
+
+/*
+ *	Returns information about the memory allocation zones.
+ *      Data returned is compatible with various caller and kernel
+ *	address space sizes (unlike host_zone_info()).
+ */
+routine mach_zone_info(
+		host		: host_t;
+	out	names		: mach_zone_name_array_t,
+					Dealloc;
+	out	info		: mach_zone_info_array_t,
+					Dealloc);
+
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/mach_host.h cctools-806/include/mach/mach_host.h
--- cctools-806-old/include/mach/mach_host.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_host.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,921 @@
+#ifndef	_mach_host_user_
+#define	_mach_host_user_
+
+/* Module mach_host */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	mach_host_MSG_COUNT
+#define	mach_host_MSG_COUNT	21
+#endif	/* mach_host_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+#include <mach/mach_init.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine host_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_info
+(
+	host_t host,
+	host_flavor_t flavor,
+	host_info_t host_info_out,
+	mach_msg_type_number_t *host_info_outCnt
+);
+
+/* Routine host_kernel_version */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_kernel_version
+(
+	host_t host,
+	kernel_version_t kernel_version
+);
+
+/* Routine _host_page_size */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t _host_page_size
+(
+	host_t host,
+	vm_size_t *out_page_size
+);
+
+/* Routine mach_memory_object_memory_entry */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_memory_object_memory_entry
+(
+	host_t host,
+	boolean_t internal,
+	vm_size_t size,
+	vm_prot_t permission,
+	memory_object_t pager,
+	mach_port_t *entry_handle
+);
+
+/* Routine host_processor_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_processor_info
+(
+	host_t host,
+	processor_flavor_t flavor,
+	natural_t *out_processor_count,
+	processor_info_array_t *out_processor_info,
+	mach_msg_type_number_t *out_processor_infoCnt
+);
+
+/* Routine host_get_io_master */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_io_master
+(
+	host_t host,
+	io_master_t *io_master
+);
+
+/* Routine host_get_clock_service */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_get_clock_service
+(
+	host_t host,
+	clock_id_t clock_id,
+	clock_serv_t *clock_serv
+);
+
+/* Routine kmod_get_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t kmod_get_info
+(
+	host_t host,
+	kmod_args_t *modules,
+	mach_msg_type_number_t *modulesCnt
+);
+
+/* Routine host_zone_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_zone_info
+(
+	host_t host,
+	zone_name_array_t *names,
+	mach_msg_type_number_t *namesCnt,
+	zone_info_array_t *info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine host_virtual_physical_table_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_virtual_physical_table_info
+(
+	host_t host,
+	hash_info_bucket_array_t *info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine host_ipc_hash_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_ipc_hash_info
+(
+	host_t host,
+	hash_info_bucket_array_t *info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine processor_set_default */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_default
+(
+	host_t host,
+	processor_set_name_t *default_set
+);
+
+/* Routine processor_set_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_create
+(
+	host_t host,
+	processor_set_t *new_set,
+	processor_set_name_t *new_name
+);
+
+/* Routine mach_memory_object_memory_entry_64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_memory_object_memory_entry_64
+(
+	host_t host,
+	boolean_t internal,
+	memory_object_size_t size,
+	vm_prot_t permission,
+	memory_object_t pager,
+	mach_port_t *entry_handle
+);
+
+/* Routine host_statistics */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_statistics
+(
+	host_t host_priv,
+	host_flavor_t flavor,
+	host_info_t host_info_out,
+	mach_msg_type_number_t *host_info_outCnt
+);
+
+/* Routine host_request_notification */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_request_notification
+(
+	host_t host,
+	host_flavor_t notify_type,
+	mach_port_t notify_port
+);
+
+/* Routine host_lockgroup_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_lockgroup_info
+(
+	host_t host,
+	lockgroup_info_array_t *lockgroup_info,
+	mach_msg_type_number_t *lockgroup_infoCnt
+);
+
+/* Routine host_statistics64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t host_statistics64
+(
+	host_t host_priv,
+	host_flavor_t flavor,
+	host_info64_t host_info64_out,
+	mach_msg_type_number_t *host_info64_outCnt
+);
+
+/* Routine task_zone_info */
+/*#ifdef	mig_external
+mig_external
+#else
+extern
+#endif*/	/* mig_external */
+/* NOTE: These are defined in mach_debug directory in Kernel.framework */
+/*kern_return_t task_zone_info
+(
+	task_t target_task,
+	mach_zone_name_array_t *names,
+	mach_msg_type_number_t *namesCnt,
+	task_zone_info_array_t *info,
+	mach_msg_type_number_t *infoCnt
+);*/
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__mach_host_subsystem__defined
+#define __Request__mach_host_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		host_flavor_t flavor;
+		mach_msg_type_number_t host_info_outCnt;
+	} __Request__host_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_kernel_version_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request___host_page_size_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pager;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t internal;
+		vm_size_t size;
+		vm_prot_t permission;
+	} __Request__mach_memory_object_memory_entry_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		processor_flavor_t flavor;
+	} __Request__host_processor_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_get_io_master_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		clock_id_t clock_id;
+	} __Request__host_get_clock_service_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__kmod_get_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_virtual_physical_table_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_ipc_hash_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_set_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pager;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t internal;
+		memory_object_size_t size;
+		vm_prot_t permission;
+	} __Request__mach_memory_object_memory_entry_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		host_flavor_t flavor;
+		mach_msg_type_number_t host_info_outCnt;
+	} __Request__host_statistics_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t notify_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		host_flavor_t notify_type;
+	} __Request__host_request_notification_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__host_lockgroup_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		host_flavor_t flavor;
+		mach_msg_type_number_t host_info64_outCnt;
+	} __Request__host_statistics64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__mach_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__mach_host_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__mach_host_subsystem__defined
+#define __RequestUnion__mach_host_subsystem__defined
+union __RequestUnion__mach_host_subsystem {
+	__Request__host_info_t Request_host_info;
+	__Request__host_kernel_version_t Request_host_kernel_version;
+	__Request___host_page_size_t Request__host_page_size;
+	__Request__mach_memory_object_memory_entry_t Request_mach_memory_object_memory_entry;
+	__Request__host_processor_info_t Request_host_processor_info;
+	__Request__host_get_io_master_t Request_host_get_io_master;
+	__Request__host_get_clock_service_t Request_host_get_clock_service;
+	__Request__kmod_get_info_t Request_kmod_get_info;
+	__Request__host_zone_info_t Request_host_zone_info;
+	__Request__host_virtual_physical_table_info_t Request_host_virtual_physical_table_info;
+	__Request__host_ipc_hash_info_t Request_host_ipc_hash_info;
+	__Request__processor_set_default_t Request_processor_set_default;
+	__Request__processor_set_create_t Request_processor_set_create;
+	__Request__mach_memory_object_memory_entry_64_t Request_mach_memory_object_memory_entry_64;
+	__Request__host_statistics_t Request_host_statistics;
+	__Request__host_request_notification_t Request_host_request_notification;
+	__Request__host_lockgroup_info_t Request_host_lockgroup_info;
+	__Request__host_statistics64_t Request_host_statistics64;
+	__Request__mach_zone_info_t Request_mach_zone_info;
+};
+#endif /* !__RequestUnion__mach_host_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__mach_host_subsystem__defined
+#define __Reply__mach_host_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t host_info_outCnt;
+		integer_t host_info_out[15];
+	} __Reply__host_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t kernel_versionOffset; /* MiG doesn't use it */
+		mach_msg_type_number_t kernel_versionCnt;
+		char kernel_version[512];
+	} __Reply__host_kernel_version_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_size_t out_page_size;
+	} __Reply___host_page_size_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t entry_handle;
+		/* end of the kernel processed data */
+	} __Reply__mach_memory_object_memory_entry_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t out_processor_info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		natural_t out_processor_count;
+		mach_msg_type_number_t out_processor_infoCnt;
+	} __Reply__host_processor_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t io_master;
+		/* end of the kernel processed data */
+	} __Reply__host_get_io_master_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t clock_serv;
+		/* end of the kernel processed data */
+	} __Reply__host_get_clock_service_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t modules;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t modulesCnt;
+	} __Reply__kmod_get_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t names;
+		mach_msg_ool_descriptor_t info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t namesCnt;
+		mach_msg_type_number_t infoCnt;
+	} __Reply__host_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t infoCnt;
+	} __Reply__host_virtual_physical_table_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t infoCnt;
+	} __Reply__host_ipc_hash_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t default_set;
+		/* end of the kernel processed data */
+	} __Reply__processor_set_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		mach_msg_port_descriptor_t new_name;
+		/* end of the kernel processed data */
+	} __Reply__processor_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t entry_handle;
+		/* end of the kernel processed data */
+	} __Reply__mach_memory_object_memory_entry_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t host_info_outCnt;
+		integer_t host_info_out[15];
+	} __Reply__host_statistics_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__host_request_notification_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t lockgroup_info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t lockgroup_infoCnt;
+	} __Reply__host_lockgroup_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t host_info64_outCnt;
+		integer_t host_info64_out[256];
+	} __Reply__host_statistics64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t names;
+		mach_msg_ool_descriptor_t info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t namesCnt;
+		mach_msg_type_number_t infoCnt;
+	} __Reply__mach_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__mach_host_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__mach_host_subsystem__defined
+#define __ReplyUnion__mach_host_subsystem__defined
+union __ReplyUnion__mach_host_subsystem {
+	__Reply__host_info_t Reply_host_info;
+	__Reply__host_kernel_version_t Reply_host_kernel_version;
+	__Reply___host_page_size_t Reply__host_page_size;
+	__Reply__mach_memory_object_memory_entry_t Reply_mach_memory_object_memory_entry;
+	__Reply__host_processor_info_t Reply_host_processor_info;
+	__Reply__host_get_io_master_t Reply_host_get_io_master;
+	__Reply__host_get_clock_service_t Reply_host_get_clock_service;
+	__Reply__kmod_get_info_t Reply_kmod_get_info;
+	__Reply__host_zone_info_t Reply_host_zone_info;
+	__Reply__host_virtual_physical_table_info_t Reply_host_virtual_physical_table_info;
+	__Reply__host_ipc_hash_info_t Reply_host_ipc_hash_info;
+	__Reply__processor_set_default_t Reply_processor_set_default;
+	__Reply__processor_set_create_t Reply_processor_set_create;
+	__Reply__mach_memory_object_memory_entry_64_t Reply_mach_memory_object_memory_entry_64;
+	__Reply__host_statistics_t Reply_host_statistics;
+	__Reply__host_request_notification_t Reply_host_request_notification;
+	__Reply__host_lockgroup_info_t Reply_host_lockgroup_info;
+	__Reply__host_statistics64_t Reply_host_statistics64;
+	__Reply__mach_zone_info_t Reply_mach_zone_info;
+};
+#endif /* !__RequestUnion__mach_host_subsystem__defined */
+
+#ifndef subsystem_to_name_map_mach_host
+#define subsystem_to_name_map_mach_host \
+    { "host_info", 200 },\
+    { "host_kernel_version", 201 },\
+    { "_host_page_size", 202 },\
+    { "mach_memory_object_memory_entry", 203 },\
+    { "host_processor_info", 204 },\
+    { "host_get_io_master", 205 },\
+    { "host_get_clock_service", 206 },\
+    { "kmod_get_info", 207 },\
+    { "host_zone_info", 208 },\
+    { "host_virtual_physical_table_info", 209 },\
+    { "host_ipc_hash_info", 210 },\
+    { "processor_set_default", 213 },\
+    { "processor_set_create", 214 },\
+    { "mach_memory_object_memory_entry_64", 215 },\
+    { "host_statistics", 216 },\
+    { "host_request_notification", 217 },\
+    { "host_lockgroup_info", 218 },\
+    { "host_statistics64", 219 },\
+    { "mach_zone_info", 220 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _mach_host_user_ */
diff -urN cctools-806-old/include/mach/machine/asm.h cctools-806/include/mach/machine/asm.h
--- cctools-806-old/include/mach/machine/asm.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/asm.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_ASM_H
+#define _MACH_MACHINE_ASM_H
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/asm.h"
+#elif defined (__arm__)
+#include "mach/arm/asm.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_ASM_H */
diff -urN cctools-806-old/include/mach/machine/boolean.h cctools-806/include/mach/machine/boolean.h
--- cctools-806-old/include/mach/machine/boolean.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/boolean.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_BOOLEAN_H_
+#define _MACH_MACHINE_BOOLEAN_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/boolean.h"
+#elif defined (__arm__)
+#include "mach/arm/boolean.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_BOOLEAN_H_ */
diff -urN cctools-806-old/include/mach/machine/exception.h cctools-806/include/mach/machine/exception.h
--- cctools-806-old/include/mach/machine/exception.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/exception.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_EXCEPTION_H_
+#define _MACH_MACHINE_EXCEPTION_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/exception.h"
+#elif defined (__arm__)
+#include "mach/arm/exception.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_EXCEPTION_H_ */
diff -urN cctools-806-old/include/mach/machine/kern_return.h cctools-806/include/mach/machine/kern_return.h
--- cctools-806-old/include/mach/machine/kern_return.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/kern_return.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_KERN_RETURN_H_
+#define _MACH_MACHINE_KERN_RETURN_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/kern_return.h"
+#elif defined (__arm__)
+#include "mach/arm/kern_return.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_KERN_RETURN_H_ */
diff -urN cctools-806-old/include/mach/machine/machine_types.defs cctools-806/include/mach/machine/machine_types.defs
--- cctools-806-old/include/mach/machine/machine_types.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/machine_types.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,42 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_MACHINE_TYPES_DEFS
+#define _MACH_MACHINE_MACHINE_TYPES_DEFS
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/machine_types.defs"
+#elif defined (__arm__)
+#include "mach/arm/machine_types.defs"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_THREAD_STATUS_H_ */
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/machine/ndr_def.h cctools-806/include/mach/machine/ndr_def.h
--- cctools-806-old/include/mach/machine/ndr_def.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/ndr_def.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_NDR_DEF_H
+#define _MACH_MACHINE_NDR_DEF_H
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/ndr_def.h"
+#elif defined (__arm__)
+#include "mach/arm/ndr_def.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_NDR_DEF_H */
diff -urN cctools-806-old/include/mach/machine/processor_info.h cctools-806/include/mach/machine/processor_info.h
--- cctools-806-old/include/mach/machine/processor_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/processor_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_PROCESSOR_INFO_H_
+#define _MACH_MACHINE_PROCESSOR_INFO_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/processor_info.h"
+#elif defined (__arm__)
+#include "mach/arm/processor_info.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_PROCESSOR_INFO_H_ */
diff -urN cctools-806-old/include/mach/machine/rpc.h cctools-806/include/mach/machine/rpc.h
--- cctools-806-old/include/mach/machine/rpc.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/rpc.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_RPC_H_
+#define _MACH_MACHINE_RPC_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/rpc.h"
+#elif defined (__arm__)
+#include "mach/arm/rpc.h"
+#else
+#error architecture not supported
+#endif
+
+#endif	/* _MACH_MACHINE_RPC_H_ */
diff -urN cctools-806-old/include/mach/machine/sdt.h cctools-806/include/mach/machine/sdt.h
--- cctools-806-old/include/mach/machine/sdt.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/sdt.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,36 @@
+/*
+ * Copyright (c) 2007 Apple Inc. All rights reserved.
+ */
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License, Version 1.0 only
+ * (the "License").  You may not use this file except in compliance
+ * with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+/*
+ * Copyright 2004 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef _MACH_MACHINE_SYS_SDT_H
+#define	_MACH_MACHINE_SYS_SDT_H
+
+#include <mach/machine/sdt_isa.h>
+
+
+#endif	/* _MACH_MACHINE_SYS_SDT_H */
diff -urN cctools-806-old/include/mach/machine/sdt_isa.h cctools-806/include/mach/machine/sdt_isa.h
--- cctools-806-old/include/mach/machine/sdt_isa.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/sdt_isa.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,39 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#ifndef _MACH_MACHINE_SDT_ISA_H_
+#define _MACH_MACHINE_SDT_ISA_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include <mach/i386/sdt_isa.h>
+#elif defined (__arm__)
+#include <mach/arm/sdt_isa.h>
+#else
+#error architecture not supported
+#endif
+
+#endif /* _BSD_MACHINE_SDT_ISA_H_ */
diff -urN cctools-806-old/include/mach/machine/thread_state.h cctools-806/include/mach/machine/thread_state.h
--- cctools-806-old/include/mach/machine/thread_state.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/thread_state.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_THREAD_STATE_H_
+#define _MACH_MACHINE_THREAD_STATE_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/thread_state.h"
+#elif defined (__arm__)
+#include "mach/arm/thread_state.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_THREAD_STATE_H_ */
diff -urN cctools-806-old/include/mach/machine/thread_status.h cctools-806/include/mach/machine/thread_status.h
--- cctools-806-old/include/mach/machine/thread_status.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/thread_status.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_THREAD_STATUS_H_
+#define _MACH_MACHINE_THREAD_STATUS_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/thread_status.h"
+#elif defined (__arm__)
+#include "mach/arm/thread_status.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_THREAD_STATUS_H_ */
diff -urN cctools-806-old/include/mach/machine/vm_param.h cctools-806/include/mach/machine/vm_param.h
--- cctools-806-old/include/mach/machine/vm_param.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/vm_param.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_VM_PARAM_H_
+#define _MACH_MACHINE_VM_PARAM_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/vm_param.h"
+#elif defined (__arm__)
+#include "mach/arm/vm_param.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_VM_PARAM_H_ */
diff -urN cctools-806-old/include/mach/machine/vm_types.h cctools-806/include/mach/machine/vm_types.h
--- cctools-806-old/include/mach/machine/vm_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/machine/vm_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,40 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_MACHINE_VM_TYPES_H_
+#define _MACH_MACHINE_VM_TYPES_H_
+
+#if defined (__i386__) || defined(__x86_64__)
+#include "mach/i386/vm_types.h"
+#elif defined (__arm__)
+#include "mach/arm/vm_types.h"
+#else
+#error architecture not supported
+#endif
+
+#endif /* _MACH_MACHINE_VM_TYPES_H_ */
diff -urN cctools-806-old/include/mach/mach_init.h cctools-806/include/mach/mach_init.h
--- cctools-806-old/include/mach/mach_init.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_init.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,127 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987,1986 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+
+/*
+ *	Items provided by the Mach environment initialization.
+ */
+
+#ifndef	_MACH_INIT_
+#define	_MACH_INIT_	1
+
+#include <mach/mach_types.h>
+#include <stdarg.h>
+
+#include <sys/cdefs.h>
+
+/*
+ *	Kernel-related ports; how a task/thread controls itself
+ */
+
+__BEGIN_DECLS
+extern mach_port_t mach_host_self(void);
+extern mach_port_t mach_thread_self(void);
+extern kern_return_t host_page_size(host_t, vm_size_t *);
+
+extern mach_port_t	mach_task_self_;
+#define	mach_task_self() mach_task_self_
+#define	current_task()	mach_task_self()
+
+__END_DECLS
+#include <mach/mach_traps.h>
+__BEGIN_DECLS
+
+/*
+ *	Other important ports in the Mach user environment
+ */
+
+extern	mach_port_t	bootstrap_port;
+
+/*
+ *	Where these ports occur in the "mach_ports_register"
+ *	collection... only servers or the runtime library need know.
+ */
+
+#define	NAME_SERVER_SLOT	0
+#define	ENVIRONMENT_SLOT	1
+#define SERVICE_SLOT		2
+
+#define	MACH_PORTS_SLOTS_USED	3
+
+/*
+ *	Globally interesting numbers.
+ *	These macros assume vm_page_size is a power-of-2.
+ */
+
+extern	vm_size_t	vm_page_size;
+extern	vm_size_t	vm_page_mask;
+extern	int		vm_page_shift;
+
+#define trunc_page(x)	((x) & (~(vm_page_size - 1)))
+#define round_page(x)	trunc_page((x) + (vm_page_size - 1))
+
+/*
+ *	Page-size rounding macros for the fixed-width VM types.
+ */
+#define mach_vm_trunc_page(x) ((mach_vm_offset_t)(x) & ~((signed)PAGE_MASK))
+#define mach_vm_round_page(x) (((mach_vm_offset_t)(x) + PAGE_MASK) & ~((signed)PAGE_MASK))
+
+/*
+ *	fprintf_stderr uses vprintf_stderr_func to produce
+ *	error messages, this can be overridden by a user
+ *	application to point to a user-specified output function
+ */
+extern int (*vprintf_stderr_func)(const char *format, va_list ap);
+
+__END_DECLS
+
+#endif	/* _MACH_INIT_ */
diff -urN cctools-806-old/include/mach/mach_interface.h cctools-806/include/mach/mach_interface.h
--- cctools-806-old/include/mach/mach_interface.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_interface.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,54 @@
+/*
+ * Copyright (c) 2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * Copyright (C) Apple Computer 1998
+ * ALL Rights Reserved
+ */
+/*
+ * This file represents the interfaces that used to come
+ * from creating the user headers from the mach.defs file.
+ * Because mach.defs was decomposed, this file now just
+ * wraps up all the new interface headers generated from
+ * each of the new .defs resulting from that decomposition.
+ */
+#ifndef	_MACH_INTERFACE_H_
+#define _MACH_INTERFACE_H_
+
+#include <mach/clock_priv.h>
+#include <mach/host_priv.h>
+#include <mach/host_security.h>
+#include <mach/ledger.h>
+#include <mach/lock_set.h>
+#include <mach/processor.h>
+#include <mach/processor_set.h>
+#include <mach/semaphore.h>
+#include <mach/task.h>
+#include <mach/thread_act.h>
+#include <mach/vm_map.h>
+
+#endif /* _MACH_INTERFACE_H_ */
diff -urN cctools-806-old/include/mach/mach_param.h cctools-806/include/mach/mach_param.h
--- cctools-806-old/include/mach/mach_param.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_param.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,73 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_param.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *	Date:	1986
+ *
+ *	Mach system sizing parameters
+ */
+
+#ifndef	_MACH_MACH_PARAM_H_
+#define _MACH_MACH_PARAM_H_
+
+/* Number of "registered" ports */
+
+#define TASK_PORT_REGISTER_MAX	3
+
+#endif	/* _MACH_MACH_PARAM_H_ */
diff -urN cctools-806-old/include/mach/mach_port.defs cctools-806/include/mach/mach_port.defs
--- cctools-806-old/include/mach/mach_port.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_port.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,503 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_port.defs
+ *	Author:	Rich Draves
+ *
+ *	Exported kernel calls.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  mach_port 3200;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach_debug/mach_debug_types.defs>
+
+/*
+ *	Returns the set of port and port set names
+ *	to which the target task has access, along with
+ *	the type (set or port) for each name.
+ */
+
+routine mach_port_names(
+		task		: ipc_space_t;
+	out	names		: mach_port_name_array_t;
+	out	types		: mach_port_type_array_t);
+
+/*
+ *	Returns the type (set or port) for the port name
+ *	within the target task.  Also indicates whether
+ *	there is a dead-name request for the name.
+ */
+
+routine mach_port_type(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out	ptype		: mach_port_type_t);
+
+/*
+ *	Changes the name by which a port (or port set) is known to
+ *	the target task.  The new name can't be in use.  The
+ *	old name becomes available for recycling.
+ */
+
+routine mach_port_rename(
+		task		: ipc_space_t;
+		old_name	: mach_port_name_t;
+		new_name	: mach_port_name_t);
+
+/*
+ *	Allocates the specified kind of object, with the given name.
+ *	The right must be one of
+ *		MACH_PORT_RIGHT_RECEIVE
+ *		MACH_PORT_RIGHT_PORT_SET
+ *		MACH_PORT_RIGHT_DEAD_NAME
+ *	New port sets are empty.  New ports don't have any
+ *	send/send-once rights or queued messages.  The make-send
+ *	count is zero and their queue limit is MACH_PORT_QLIMIT_DEFAULT.
+ *	New sets, ports, and dead names have one user reference.
+ */
+
+routine mach_port_allocate_name(
+		task		: ipc_space_t;
+		right		: mach_port_right_t;
+		name		: mach_port_name_t);
+
+/*
+ *	Allocates the specified kind of object.
+ *	The right must be one of
+ *		MACH_PORT_RIGHT_RECEIVE
+ *		MACH_PORT_RIGHT_PORT_SET
+ *		MACH_PORT_RIGHT_DEAD_NAME
+ *	Like port_allocate_name, but the kernel picks a name.
+ *	It can use any name not associated with a right.
+ */
+
+routine mach_port_allocate(
+		task		: ipc_space_t;
+		right		: mach_port_right_t;
+	out	name		: mach_port_name_t);
+
+/*
+ *	Destroys all rights associated with the name and makes it
+ *	available for recycling immediately.  The name can be a
+ *	port (possibly with multiple user refs), a port set, or
+ *	a dead name (again, with multiple user refs).
+ */
+
+routine mach_port_destroy(
+		task		: ipc_space_t;
+		name		: mach_port_name_t);
+
+/*
+ *	Releases one send/send-once/dead-name user ref.
+ *	Just like mach_port_mod_refs -1, but deduces the
+ *	correct type of right.  This allows a user task
+ *	to release a ref for a port without worrying
+ *	about whether the port has died or not.
+ */
+
+routine mach_port_deallocate(
+		task		: ipc_space_t;
+		name		: mach_port_name_t);
+
+/*
+ *	A port set always has one user ref.
+ *	A send-once right always has one user ref.
+ *	A dead name always has one or more user refs.
+ *	A send right always has one or more user refs.
+ *	A receive right always has one user ref.
+ *	The right must be one of
+ *		MACH_PORT_RIGHT_RECEIVE
+ *		MACH_PORT_RIGHT_PORT_SET
+ *		MACH_PORT_RIGHT_DEAD_NAME
+ *		MACH_PORT_RIGHT_SEND
+ *		MACH_PORT_RIGHT_SEND_ONCE
+ */
+
+routine mach_port_get_refs(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		right		: mach_port_right_t;
+	out	refs		: mach_port_urefs_t);
+
+/*
+ *	The delta is a signed change to the task's
+ *	user ref count for the right.  Only dead names
+ *	and send rights can have a positive delta.
+ *	The resulting user ref count can't be negative.
+ *	If it is zero, the right is deallocated.
+ *	If the name isn't a composite right, it becomes
+ *	available for recycling.  The right must be one of
+ *		MACH_PORT_RIGHT_RECEIVE
+ *		MACH_PORT_RIGHT_PORT_SET
+ *		MACH_PORT_RIGHT_DEAD_NAME
+ *		MACH_PORT_RIGHT_SEND
+ *		MACH_PORT_RIGHT_SEND_ONCE
+ */
+
+routine mach_port_mod_refs(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		right		: mach_port_right_t;
+		delta		: mach_port_delta_t);
+
+skip;
+
+/*
+ *	Only valid for receive rights.
+ *	Sets the make-send count for the port.
+ */
+routine mach_port_set_mscount(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		mscount		: mach_port_mscount_t);
+
+/*
+ *	Only valid for port sets.  Returns a list of
+ *	the members.
+ */
+
+routine mach_port_get_set_status(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out	members		: mach_port_name_array_t);
+
+/*
+ *	Puts the member port (the task must have receive rights)
+ *	into the after port set.  If the port is already a member
+ *	of any set(s), it is atomically removed from those sets as
+ *	part of this operation.  (If after is MACH_PORT_NULL, the
+ *	port is still removed from all current sets).
+ */
+
+routine mach_port_move_member(
+		task		: ipc_space_t;
+		member		: mach_port_name_t;
+		after		: mach_port_name_t);
+
+/*
+ *	Requests a notification from the kernel.  The request
+ *	must supply the send-once right which is used for
+ *	the notification.  If a send-once right was previously
+ *	registered, it is returned.  The msgid must be one of:
+ *		MACH_NOTIFY_PORT_DESTROYED (receive rights)
+ *		MACH_NOTIFY_DEAD_NAME (send/receive/send-once rights)
+ *		MACH_NOTIFY_SEND_POSSIBLE (send/receive/send-once rights)
+ *		MACH_NOTIFY_NO_SENDERS (receive rights)
+ *
+ *	The sync value specifies whether a notification should
+ *	get sent immediately, if appropriate.  The exact meaning
+ *	depends on the notification:
+ *		MACH_NOTIFY_PORT_DESTROYED: must be zero.
+ *		MACH_NOTIFY_DEAD_NAME: if non-zero, then name can be dead,
+ *			and the notification gets sent immediately.
+ *			If zero, then name can't be dead.
+ *		MACH_NOTIFY_SEND_POSSIBLE: if non-zero, will generate a	send-
+ *			possible notification as soon as it is possible to send
+ *			to the port. If zero, will generate a send-possible
+ *			notification only after a subsequent failed send
+ *			(with MACH_SEND_NOTIFY option to mach_msg call).  Can
+ *			generate a dead-name notification if name is already dead
+ *			or becomes dead before a send-possible notification fires.
+ *		MACH_NOTIFY_NO_SENDERS: the notification gets sent
+ *			immediately if the current mscount is greater
+ *			than or equal to the sync value and there are no
+ *			extant send rights.
+ *
+ * If the name is deleted before a successfully registered notification
+ * is delivered, it is replaced with a port-deleted notification.
+ */
+
+routine mach_port_request_notification(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		msgid		: mach_msg_id_t;
+		sync		: mach_port_mscount_t;
+		notify		: mach_port_send_once_t;
+	out	previous	: mach_port_move_send_once_t);
+
+/*
+ *	Inserts the specified rights into the target task,
+ *	using the specified name.  If inserting send/receive
+ *	rights and the task already has send/receive rights
+ *	for the port, then the names must agree.  In any case,
+ *	the task gains a user ref for the port.
+ */
+
+routine mach_port_insert_right(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		poly		: mach_port_poly_t);
+
+/*
+ *	Returns the specified right for the named port
+ *	in the target task, extracting that right from
+ *	the target task.  The target task loses a user
+ *	ref and the name may be available for recycling.
+ *	msgt_name must be one of
+ *		MACH_MSG_TYPE_MOVE_RECEIVE
+ *		MACH_MSG_TYPE_COPY_SEND
+ *		MACH_MSG_TYPE_MAKE_SEND
+ *		MACH_MSG_TYPE_MOVE_SEND
+ *		MACH_MSG_TYPE_MAKE_SEND_ONCE
+ *		MACH_MSG_TYPE_MOVE_SEND_ONCE
+ */
+
+routine mach_port_extract_right(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		msgt_name	: mach_msg_type_name_t;
+	out	poly		: mach_port_poly_t);
+
+/*
+ *	Only valid for receive rights.
+ *	Sets the sequence number for the port.
+ */
+
+routine mach_port_set_seqno(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		seqno		: mach_port_seqno_t);
+
+/*
+ *      Returns information about a port.
+ */
+
+routine mach_port_get_attributes(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		flavor		: mach_port_flavor_t;
+	out	port_info_out	: mach_port_info_t, CountInOut);
+
+/*
+ *      Set attributes of a port
+ */
+
+routine mach_port_set_attributes(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		flavor		: mach_port_flavor_t;
+		port_info	: mach_port_info_t);
+
+
+/*
+ *	Allocates the specified kind of object, qos version.
+ *	The right must be
+ *		MACH_PORT_RIGHT_RECEIVE
+ *	Like port_allocate_name, but the kernel picks a name.
+ *	It can use any name not associated with a right.
+ */
+
+routine mach_port_allocate_qos(
+		task		: ipc_space_t;
+		right		: mach_port_right_t;
+	inout	qos		: mach_port_qos_t;
+	out	name		: mach_port_name_t);
+
+
+/*
+ *	Generic interface to allocation various kinds of ports.
+ *	Should never be called directly by users (at least not
+ *	unless they are exceedingly masochistic).
+ */
+
+routine mach_port_allocate_full(
+		task		: ipc_space_t;
+		right		: mach_port_right_t;
+		proto		: mach_port_t;
+	inout	qos		: mach_port_qos_t;
+	inout	name		: mach_port_name_t);
+
+
+/*
+ *	Pre-expand task port name space.
+ */
+routine task_set_port_space(
+		task		: ipc_space_t;
+		table_entries	: int);
+
+
+/*
+ *	Returns the exact number of extant send rights
+ *	for the given receive right.
+ *      This call is only valid on MACH_IPC_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ */
+routine	mach_port_get_srights(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out	srights		: mach_port_rights_t);
+
+
+/*
+ *	Returns information about an IPC space.
+ *      This call is only valid on MACH_IPC_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ */
+routine mach_port_space_info(
+		task		: ipc_space_t;
+	out	space_info	: ipc_info_space_t;
+	out	table_info	: ipc_info_name_array_t;
+	out	tree_info	: ipc_info_tree_name_array_t);
+
+/*
+ *	Returns information about the dead-name requests
+ *	registered with the named receive right.
+ *      This call is only valid on MACH_IPC_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ */
+routine mach_port_dnrequest_info(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out	dnr_total	: unsigned;	/* total size of table */
+	out	dnr_used	: unsigned);	/* amount used */
+
+/*
+ *	Return the type and address of the kernel object
+ *	that the given send/receive right represents.
+ *      This call is only valid on MACH_IPC_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ *
+ *	This interface is DEPRECATED in favor of the new
+ *	mach_port_kernel_object64() call (see below).
+ */
+routine	mach_port_kernel_object(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out	object_type	: unsigned;
+	out	object_addr	: unsigned);
+
+
+/*
+ *	Inserts the specified rights into the portset identified
+ *	by the <task, pset> pair.  The results of passing in the
+ *	Poly argument via the supplied disposition must yield a
+ *	receive right.
+ *
+ *	If the <task,pset> pair does not represent a valid portset
+ *	KERN_INVALID_RIGHT is returned.
+ *	
+ *	If the passed in name argument does not represent a receive
+ *	right, KERN_INVALID_CAPABILITY will be returned.
+ *
+ *	If the port represented by the receive right is already in
+ *	the portset, KERN_ALREADY_IN_SET is returned.
+ */
+routine mach_port_insert_member(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		pset		: mach_port_name_t);
+
+/*
+ *	Extracts the specified right from the named portset
+ *	in the target task.  
+ *	the target task.  The target task loses a user
+ *	ref and the name may be available for recycling.
+ *	msgt_name must be one of
+ *		MACH_MSG_TYPE_MOVE_RECEIVE
+ *		MACH_MSG_TYPE_COPY_SEND
+ *		MACH_MSG_TYPE_MAKE_SEND
+ *		MACH_MSG_TYPE_MOVE_SEND
+ *		MACH_MSG_TYPE_MAKE_SEND_ONCE
+ *		MACH_MSG_TYPE_MOVE_SEND_ONCE
+ */
+
+routine mach_port_extract_member(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		pset		: mach_port_name_t);
+
+/*
+ * Only valid for receive rights.
+ * Gets the context pointer for the port.
+ */
+
+routine mach_port_get_context(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out context		: mach_vm_address_t);
+
+/*
+ * Only valid for receive rights.
+ * Sets the context pointer for the port.
+ */
+
+routine mach_port_set_context(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+		context		: mach_vm_address_t);
+
+/*
+ *	Return the type and address of the kernel object
+ *	that the given send/receive right represents.
+ *      This call is only valid on MACH_IPC_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ */
+routine	mach_port_kobject(
+		task		: ipc_space_t;
+		name		: mach_port_name_t;
+	out	object_type	: natural_t;
+	out	object_addr	: mach_vm_address_t);
+
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/mach_port.h cctools-806/include/mach/mach_port.h
--- cctools-806-old/include/mach/mach_port.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_port.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1384 @@
+#ifndef	_mach_port_user_
+#define	_mach_port_user_
+
+/* Module mach_port */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	mach_port_MSG_COUNT
+#define	mach_port_MSG_COUNT	31
+#endif	/* mach_port_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine mach_port_names */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_names
+(
+	ipc_space_t task,
+	mach_port_name_array_t *names,
+	mach_msg_type_number_t *namesCnt,
+	mach_port_type_array_t *types,
+	mach_msg_type_number_t *typesCnt
+);
+
+/* Routine mach_port_type */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_type
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_type_t *ptype
+);
+
+/* Routine mach_port_rename */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_rename
+(
+	ipc_space_t task,
+	mach_port_name_t old_name,
+	mach_port_name_t new_name
+);
+
+/* Routine mach_port_allocate_name */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_allocate_name
+(
+	ipc_space_t task,
+	mach_port_right_t right,
+	mach_port_name_t name
+);
+
+/* Routine mach_port_allocate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_allocate
+(
+	ipc_space_t task,
+	mach_port_right_t right,
+	mach_port_name_t *name
+);
+
+/* Routine mach_port_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_destroy
+(
+	ipc_space_t task,
+	mach_port_name_t name
+);
+
+/* Routine mach_port_deallocate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_deallocate
+(
+	ipc_space_t task,
+	mach_port_name_t name
+);
+
+/* Routine mach_port_get_refs */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_get_refs
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_right_t right,
+	mach_port_urefs_t *refs
+);
+
+/* Routine mach_port_mod_refs */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_mod_refs
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_right_t right,
+	mach_port_delta_t delta
+);
+
+/* Routine mach_port_set_mscount */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_set_mscount
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_mscount_t mscount
+);
+
+/* Routine mach_port_get_set_status */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_get_set_status
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_name_array_t *members,
+	mach_msg_type_number_t *membersCnt
+);
+
+/* Routine mach_port_move_member */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_move_member
+(
+	ipc_space_t task,
+	mach_port_name_t member,
+	mach_port_name_t after
+);
+
+/* Routine mach_port_request_notification */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_request_notification
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_msg_id_t msgid,
+	mach_port_mscount_t sync,
+	mach_port_t notify,
+	mach_msg_type_name_t notifyPoly,
+	mach_port_t *previous
+);
+
+/* Routine mach_port_insert_right */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_insert_right
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_t poly,
+	mach_msg_type_name_t polyPoly
+);
+
+/* Routine mach_port_extract_right */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_extract_right
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_msg_type_name_t msgt_name,
+	mach_port_t *poly,
+	mach_msg_type_name_t *polyPoly
+);
+
+/* Routine mach_port_set_seqno */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_set_seqno
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_seqno_t seqno
+);
+
+/* Routine mach_port_get_attributes */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_get_attributes
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_flavor_t flavor,
+	mach_port_info_t port_info_out,
+	mach_msg_type_number_t *port_info_outCnt
+);
+
+/* Routine mach_port_set_attributes */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_set_attributes
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_flavor_t flavor,
+	mach_port_info_t port_info,
+	mach_msg_type_number_t port_infoCnt
+);
+
+/* Routine mach_port_allocate_qos */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_allocate_qos
+(
+	ipc_space_t task,
+	mach_port_right_t right,
+	mach_port_qos_t *qos,
+	mach_port_name_t *name
+);
+
+/* Routine mach_port_allocate_full */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_allocate_full
+(
+	ipc_space_t task,
+	mach_port_right_t right,
+	mach_port_t proto,
+	mach_port_qos_t *qos,
+	mach_port_name_t *name
+);
+
+/* Routine task_set_port_space */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_port_space
+(
+	ipc_space_t task,
+	int table_entries
+);
+
+/* Routine mach_port_get_srights */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_get_srights
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_rights_t *srights
+);
+
+/* Routine mach_port_space_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_space_info
+(
+	ipc_space_t task,
+	ipc_info_space_t *space_info,
+	ipc_info_name_array_t *table_info,
+	mach_msg_type_number_t *table_infoCnt,
+	ipc_info_tree_name_array_t *tree_info,
+	mach_msg_type_number_t *tree_infoCnt
+);
+
+/* Routine mach_port_dnrequest_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_dnrequest_info
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	unsigned *dnr_total,
+	unsigned *dnr_used
+);
+
+/* Routine mach_port_kernel_object */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_kernel_object
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	unsigned *object_type,
+	unsigned *object_addr
+);
+
+/* Routine mach_port_insert_member */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_insert_member
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_name_t pset
+);
+
+/* Routine mach_port_extract_member */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_extract_member
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_port_name_t pset
+);
+
+/* Routine mach_port_get_context */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_get_context
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_vm_address_t *context
+);
+
+/* Routine mach_port_set_context */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_set_context
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	mach_vm_address_t context
+);
+
+/* Routine mach_port_kobject */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_port_kobject
+(
+	ipc_space_t task,
+	mach_port_name_t name,
+	natural_t *object_type,
+	mach_vm_address_t *object_addr
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__mach_port_subsystem__defined
+#define __Request__mach_port_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__mach_port_names_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_type_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t old_name;
+		mach_port_name_t new_name;
+	} __Request__mach_port_rename_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_right_t right;
+		mach_port_name_t name;
+	} __Request__mach_port_allocate_name_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_right_t right;
+	} __Request__mach_port_allocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_deallocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_right_t right;
+	} __Request__mach_port_get_refs_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_right_t right;
+		mach_port_delta_t delta;
+	} __Request__mach_port_mod_refs_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_mscount_t mscount;
+	} __Request__mach_port_set_mscount_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_get_set_status_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t member;
+		mach_port_name_t after;
+	} __Request__mach_port_move_member_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t notify;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_msg_id_t msgid;
+		mach_port_mscount_t sync;
+	} __Request__mach_port_request_notification_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t poly;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_insert_right_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_msg_type_name_t msgt_name;
+	} __Request__mach_port_extract_right_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_seqno_t seqno;
+	} __Request__mach_port_set_seqno_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_flavor_t flavor;
+		mach_msg_type_number_t port_info_outCnt;
+	} __Request__mach_port_get_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_flavor_t flavor;
+		mach_msg_type_number_t port_infoCnt;
+		integer_t port_info[10];
+	} __Request__mach_port_set_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_right_t right;
+		mach_port_qos_t qos;
+	} __Request__mach_port_allocate_qos_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t proto;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_port_right_t right;
+		mach_port_qos_t qos;
+		mach_port_name_t name;
+	} __Request__mach_port_allocate_full_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int table_entries;
+	} __Request__task_set_port_space_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_get_srights_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__mach_port_space_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_dnrequest_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_kernel_object_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_name_t pset;
+	} __Request__mach_port_insert_member_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_port_name_t pset;
+	} __Request__mach_port_extract_member_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_get_context_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+		mach_vm_address_t context;
+	} __Request__mach_port_set_context_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_port_name_t name;
+	} __Request__mach_port_kobject_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__mach_port_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__mach_port_subsystem__defined
+#define __RequestUnion__mach_port_subsystem__defined
+union __RequestUnion__mach_port_subsystem {
+	__Request__mach_port_names_t Request_mach_port_names;
+	__Request__mach_port_type_t Request_mach_port_type;
+	__Request__mach_port_rename_t Request_mach_port_rename;
+	__Request__mach_port_allocate_name_t Request_mach_port_allocate_name;
+	__Request__mach_port_allocate_t Request_mach_port_allocate;
+	__Request__mach_port_destroy_t Request_mach_port_destroy;
+	__Request__mach_port_deallocate_t Request_mach_port_deallocate;
+	__Request__mach_port_get_refs_t Request_mach_port_get_refs;
+	__Request__mach_port_mod_refs_t Request_mach_port_mod_refs;
+	__Request__mach_port_set_mscount_t Request_mach_port_set_mscount;
+	__Request__mach_port_get_set_status_t Request_mach_port_get_set_status;
+	__Request__mach_port_move_member_t Request_mach_port_move_member;
+	__Request__mach_port_request_notification_t Request_mach_port_request_notification;
+	__Request__mach_port_insert_right_t Request_mach_port_insert_right;
+	__Request__mach_port_extract_right_t Request_mach_port_extract_right;
+	__Request__mach_port_set_seqno_t Request_mach_port_set_seqno;
+	__Request__mach_port_get_attributes_t Request_mach_port_get_attributes;
+	__Request__mach_port_set_attributes_t Request_mach_port_set_attributes;
+	__Request__mach_port_allocate_qos_t Request_mach_port_allocate_qos;
+	__Request__mach_port_allocate_full_t Request_mach_port_allocate_full;
+	__Request__task_set_port_space_t Request_task_set_port_space;
+	__Request__mach_port_get_srights_t Request_mach_port_get_srights;
+	__Request__mach_port_space_info_t Request_mach_port_space_info;
+	__Request__mach_port_dnrequest_info_t Request_mach_port_dnrequest_info;
+	__Request__mach_port_kernel_object_t Request_mach_port_kernel_object;
+	__Request__mach_port_insert_member_t Request_mach_port_insert_member;
+	__Request__mach_port_extract_member_t Request_mach_port_extract_member;
+	__Request__mach_port_get_context_t Request_mach_port_get_context;
+	__Request__mach_port_set_context_t Request_mach_port_set_context;
+	__Request__mach_port_kobject_t Request_mach_port_kobject;
+};
+#endif /* !__RequestUnion__mach_port_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__mach_port_subsystem__defined
+#define __Reply__mach_port_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t names;
+		mach_msg_ool_descriptor_t types;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t namesCnt;
+		mach_msg_type_number_t typesCnt;
+	} __Reply__mach_port_names_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_type_t ptype;
+	} __Reply__mach_port_type_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_rename_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_allocate_name_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_name_t name;
+	} __Reply__mach_port_allocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_deallocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_urefs_t refs;
+	} __Reply__mach_port_get_refs_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_mod_refs_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_set_mscount_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t members;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t membersCnt;
+	} __Reply__mach_port_get_set_status_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_move_member_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t previous;
+		/* end of the kernel processed data */
+	} __Reply__mach_port_request_notification_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_insert_right_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t poly;
+		/* end of the kernel processed data */
+	} __Reply__mach_port_extract_right_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_set_seqno_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t port_info_outCnt;
+		integer_t port_info_out[10];
+	} __Reply__mach_port_get_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_set_attributes_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_qos_t qos;
+		mach_port_name_t name;
+	} __Reply__mach_port_allocate_qos_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_qos_t qos;
+		mach_port_name_t name;
+	} __Reply__mach_port_allocate_full_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_port_space_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_port_rights_t srights;
+	} __Reply__mach_port_get_srights_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t table_info;
+		mach_msg_ool_descriptor_t tree_info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		ipc_info_space_t space_info;
+		mach_msg_type_number_t table_infoCnt;
+		mach_msg_type_number_t tree_infoCnt;
+	} __Reply__mach_port_space_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		unsigned dnr_total;
+		unsigned dnr_used;
+	} __Reply__mach_port_dnrequest_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		unsigned object_type;
+		unsigned object_addr;
+	} __Reply__mach_port_kernel_object_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_insert_member_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_extract_member_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_address_t context;
+	} __Reply__mach_port_get_context_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_port_set_context_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		natural_t object_type;
+		mach_vm_address_t object_addr;
+	} __Reply__mach_port_kobject_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__mach_port_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__mach_port_subsystem__defined
+#define __ReplyUnion__mach_port_subsystem__defined
+union __ReplyUnion__mach_port_subsystem {
+	__Reply__mach_port_names_t Reply_mach_port_names;
+	__Reply__mach_port_type_t Reply_mach_port_type;
+	__Reply__mach_port_rename_t Reply_mach_port_rename;
+	__Reply__mach_port_allocate_name_t Reply_mach_port_allocate_name;
+	__Reply__mach_port_allocate_t Reply_mach_port_allocate;
+	__Reply__mach_port_destroy_t Reply_mach_port_destroy;
+	__Reply__mach_port_deallocate_t Reply_mach_port_deallocate;
+	__Reply__mach_port_get_refs_t Reply_mach_port_get_refs;
+	__Reply__mach_port_mod_refs_t Reply_mach_port_mod_refs;
+	__Reply__mach_port_set_mscount_t Reply_mach_port_set_mscount;
+	__Reply__mach_port_get_set_status_t Reply_mach_port_get_set_status;
+	__Reply__mach_port_move_member_t Reply_mach_port_move_member;
+	__Reply__mach_port_request_notification_t Reply_mach_port_request_notification;
+	__Reply__mach_port_insert_right_t Reply_mach_port_insert_right;
+	__Reply__mach_port_extract_right_t Reply_mach_port_extract_right;
+	__Reply__mach_port_set_seqno_t Reply_mach_port_set_seqno;
+	__Reply__mach_port_get_attributes_t Reply_mach_port_get_attributes;
+	__Reply__mach_port_set_attributes_t Reply_mach_port_set_attributes;
+	__Reply__mach_port_allocate_qos_t Reply_mach_port_allocate_qos;
+	__Reply__mach_port_allocate_full_t Reply_mach_port_allocate_full;
+	__Reply__task_set_port_space_t Reply_task_set_port_space;
+	__Reply__mach_port_get_srights_t Reply_mach_port_get_srights;
+	__Reply__mach_port_space_info_t Reply_mach_port_space_info;
+	__Reply__mach_port_dnrequest_info_t Reply_mach_port_dnrequest_info;
+	__Reply__mach_port_kernel_object_t Reply_mach_port_kernel_object;
+	__Reply__mach_port_insert_member_t Reply_mach_port_insert_member;
+	__Reply__mach_port_extract_member_t Reply_mach_port_extract_member;
+	__Reply__mach_port_get_context_t Reply_mach_port_get_context;
+	__Reply__mach_port_set_context_t Reply_mach_port_set_context;
+	__Reply__mach_port_kobject_t Reply_mach_port_kobject;
+};
+#endif /* !__RequestUnion__mach_port_subsystem__defined */
+
+#ifndef subsystem_to_name_map_mach_port
+#define subsystem_to_name_map_mach_port \
+    { "mach_port_names", 3200 },\
+    { "mach_port_type", 3201 },\
+    { "mach_port_rename", 3202 },\
+    { "mach_port_allocate_name", 3203 },\
+    { "mach_port_allocate", 3204 },\
+    { "mach_port_destroy", 3205 },\
+    { "mach_port_deallocate", 3206 },\
+    { "mach_port_get_refs", 3207 },\
+    { "mach_port_mod_refs", 3208 },\
+    { "mach_port_set_mscount", 3210 },\
+    { "mach_port_get_set_status", 3211 },\
+    { "mach_port_move_member", 3212 },\
+    { "mach_port_request_notification", 3213 },\
+    { "mach_port_insert_right", 3214 },\
+    { "mach_port_extract_right", 3215 },\
+    { "mach_port_set_seqno", 3216 },\
+    { "mach_port_get_attributes", 3217 },\
+    { "mach_port_set_attributes", 3218 },\
+    { "mach_port_allocate_qos", 3219 },\
+    { "mach_port_allocate_full", 3220 },\
+    { "task_set_port_space", 3221 },\
+    { "mach_port_get_srights", 3222 },\
+    { "mach_port_space_info", 3223 },\
+    { "mach_port_dnrequest_info", 3224 },\
+    { "mach_port_kernel_object", 3225 },\
+    { "mach_port_insert_member", 3226 },\
+    { "mach_port_extract_member", 3227 },\
+    { "mach_port_get_context", 3228 },\
+    { "mach_port_set_context", 3229 },\
+    { "mach_port_kobject", 3230 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _mach_port_user_ */
diff -urN cctools-806-old/include/mach/mach_syscalls.h cctools-806/include/mach/mach_syscalls.h
--- cctools-806-old/include/mach/mach_syscalls.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_syscalls.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef _MACH_MACH_SYSCALLS_H_
+#define	_MACH_MACH_SYSCALLS_H_
+
+#include <mach/mach_traps.h>
+
+#endif	/* _MACH_MACH_SYSCALLS_H_ */
diff -urN cctools-806-old/include/mach/mach_time.h cctools-806/include/mach/mach_time.h
--- cctools-806-old/include/mach/mach_time.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_time.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,56 @@
+/*
+ * Copyright (c) 2001-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef	_MACH_MACH_TIME_H_
+#define	_MACH_MACH_TIME_H_
+
+#include <mach/mach_types.h>
+
+#include <sys/cdefs.h>
+
+struct mach_timebase_info {
+	uint32_t	numer;
+	uint32_t	denom;
+};
+
+typedef struct mach_timebase_info	*mach_timebase_info_t;
+typedef struct mach_timebase_info	mach_timebase_info_data_t;
+
+__BEGIN_DECLS
+
+kern_return_t		mach_timebase_info(
+						mach_timebase_info_t	info);
+
+kern_return_t		mach_wait_until(
+						uint64_t		deadline);
+
+
+uint64_t			mach_absolute_time(void);
+__END_DECLS
+
+#endif /* _MACH_MACH_TIME_H_ */
diff -urN cctools-806-old/include/mach/mach_traps.h cctools-806/include/mach/mach_traps.h
--- cctools-806-old/include/mach/mach_traps.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_traps.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,152 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	Definitions of general Mach system traps.
+ *
+ *	These are the definitions as seen from user-space.
+ *	The kernel definitions are in <mach/syscall_sw.h>.
+ *	Kernel RPC functions are defined in <mach/mach_interface.h>.
+ */
+
+#ifndef	_MACH_MACH_TRAPS_H_
+#define _MACH_MACH_TRAPS_H_
+
+#include <stdint.h>
+
+#include <mach/std_types.h>
+#include <mach/mach_types.h>
+#include <mach/kern_return.h>
+#include <mach/port.h>
+#include <mach/vm_types.h>
+#include <mach/clock_types.h>
+
+#include <machine/endian.h>
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+
+
+
+extern kern_return_t macx_swapon(
+				uint64_t filename,
+				int flags,
+				int size,
+				int priority);
+
+extern kern_return_t macx_swapoff(
+				uint64_t filename,
+				int flags);
+
+extern kern_return_t macx_triggers(
+				int hi_water,
+				int low_water,
+				int flags,
+				mach_port_t alert_port);
+
+extern kern_return_t macx_backing_store_suspend(
+				boolean_t suspend);
+
+extern kern_return_t macx_backing_store_recovery(
+				int pid);
+
+extern boolean_t swtch_pri(int pri);
+
+extern boolean_t swtch(void);
+
+extern kern_return_t thread_switch(
+				mach_port_name_t thread_name,
+				int option,
+				mach_msg_timeout_t option_time);
+
+extern mach_port_name_t task_self_trap(void);
+
+/*
+ *	Obsolete interfaces.
+ */
+
+extern kern_return_t task_for_pid(
+				mach_port_name_t target_tport,
+				int pid,
+				mach_port_name_t *t);
+
+extern kern_return_t task_name_for_pid(
+				mach_port_name_t target_tport,
+				int pid,
+				mach_port_name_t *tn);
+
+extern kern_return_t pid_for_task(
+				mach_port_name_t t,
+				int *x);
+
+#if		!defined(__LP64__) && !defined(__arm__)
+/* these should go away altogether - so no 64 legacy please */
+
+extern kern_return_t map_fd(
+				int fd,
+				vm_offset_t offset,
+				vm_offset_t *va,
+				boolean_t findspace,
+				vm_size_t size);
+
+#endif	/* !defined(__LP64__) && !defined(__arm__) */
+
+
+__END_DECLS
+
+#endif	/* _MACH_MACH_TRAPS_H_ */
diff -urN cctools-806-old/include/mach/mach_types.defs cctools-806/include/mach/mach_types.defs
--- cctools-806-old/include/mach/mach_types.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_types.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,477 @@
+/*
+ * Copyright (c) 2000-2009 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ * NOTICE: This file was modified by McAfee Research in 2004 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+/*
+ */
+/*
+ *	Mach kernel interface type declarations
+ */
+
+#ifndef	_MACH_MACH_TYPES_DEFS_
+#define _MACH_MACH_TYPES_DEFS_
+
+
+#include <mach/std_types.defs>
+
+type memory_object_offset_t 	= uint64_t;
+type memory_object_size_t 	= uint64_t;
+type memory_object_cluster_size_t = uint32_t;
+type memory_object_fault_info_t = array[16] of integer_t;
+
+
+type mach_port_status_t = struct[10] of integer_t;	/* obsolete */
+
+		/* mach_port_info_t: can hold either a
+		 * mach_port_status_t (9 ints) or a
+		 * mach_port_limits_t (1 int). If new flavors of
+		 * mach_port_{get,set}_attributes are added, the size of
+		 * this array may have to be increased. (See mach/port.h)
+		 */
+type mach_port_flavor_t 	= int;
+type mach_port_info_t		= array[*:10] of integer_t;
+
+type task_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: task_t convert_port_to_task(mach_port_t)
+		outtran: mach_port_t convert_task_to_port(task_t)
+		destructor: task_deallocate(task_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type task_name_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: task_name_t convert_port_to_task_name(mach_port_t)
+		outtran: mach_port_t convert_task_name_to_port(task_name_t)
+		destructor: task_name_deallocate(task_name_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type thread_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: thread_t convert_port_to_thread(mach_port_t)
+		outtran: mach_port_t convert_thread_to_port(thread_t)
+		destructor: thread_deallocate(thread_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type thread_act_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: thread_act_t convert_port_to_thread(mach_port_t)
+		outtran: mach_port_t convert_thread_to_port(thread_act_t)
+		destructor: thread_deallocate(thread_act_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type thread_act_consume_ref_t = mach_port_move_send_t
+		cusertype: thread_act_t
+#if	KERNEL_SERVER
+		intran: thread_act_t convert_port_to_thread(mach_port_t)
+		destructor: thread_deallocate(thread_act_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+		/* thread_state_t: This inline array can hold
+		 * a machine-dependent amount of data, defined in
+		 * mach/machine/???? (currently THREAD_STATE_MAX,
+		 * in mach/thread_state.h)
+		 */
+#include <mach/machine/thread_state.h>
+type thread_state_flavor_t	= int;
+type thread_state_t		= array[*:THREAD_STATE_MAX] of natural_t;
+
+type task_array_t = ^array[] of task_t;
+type thread_array_t = ^array[] of thread_t;
+type thread_act_array_t = ^array[] of thread_act_t;
+type act_params_t = array[6] of int;
+
+type vm_map_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: vm_map_t convert_port_to_map(mach_port_t)
+		destructor: vm_map_deallocate(vm_map_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type vm_task_entry_t = mach_port_t
+		cusertype: vm_map_t
+#if	KERNEL_SERVER
+		intran: vm_map_t convert_port_entry_to_map(mach_port_t)
+		destructor: vm_map_deallocate(vm_map_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type ipc_space_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: ipc_space_t convert_port_to_space(mach_port_t)
+		destructor: space_deallocate(ipc_space_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type vm_prot_t = int;
+type vm_inherit_t = int;
+type vm_purgable_t = int;
+type xxx_vm_statistics_data_t = struct[13] of integer_t;
+type vm_behavior_t = int;
+type vm_statistics_data_t = struct[15] of integer_t;
+type vm_machine_attribute_t = int;
+type vm_machine_attribute_val_t = int;
+type vm_sync_t = int;
+
+		/* thread_info_t: this inline array can hold any of:
+		 * thread_basic_info_t (10 ints)
+		 * policy_timeshare_info_t (5 ints)
+		 * policy_fifo_info_t (4 ints)
+		 * policy_rr_info_t (5 ints)
+		 * if other thread_info flavors are added, this
+		 * definition may need to be changed. (See
+		 * mach/thread_info.h and mach/policy.h) */
+type thread_flavor_t		= int;
+type thread_info_t		= array[*:12] of integer_t;
+
+type thread_policy_flavor_t	= natural_t;
+type thread_policy_t		= array[*:16] of integer_t;
+
+		/* task_info_t: this inline array can hold any of:
+		 * task_basic_info_32_t (8 ints)
+		 * task_basic_info_64_t (10 ints)
+		 * task_events_info_t (8 ints)
+		 * task_thread_times_info_t (4 ints)
+		 * policy_timeshare_info_t (5 ints)
+		 * policy_fifo_info_t (4 ints)
+		 * policy_rr_info_t (5 ints)
+		 * task security token (2 ints)
+		 * task audit token (8 ints)
+		 * dyld info (2 64-bit ints and 1 int)
+		 * task_extmod_info_t (8 64-bit ints)
+		 * If other task_info flavors are added, this
+		 * definition may need to be changed. (See
+		 * mach/task_info.h and mach/policy.h) */
+type task_flavor_t		= int;
+type task_info_t		= array[*:32] of integer_t;
+
+type task_policy_flavor_t	= natural_t;
+type task_policy_t		= array[*:16] of integer_t;
+
+type mem_entry_name_port_t = mach_port_t
+#if     KERNEL_SERVER
+		intran: mem_entry_name_port_t null_conversion(mach_port_t)
+		outtran: mach_port_t null_conversion(mem_entry_name_port_t)
+#endif  /* KERNEL_SERVER */
+		;
+
+type mem_entry_name_port_move_send_t = mach_port_move_send_t
+	cusertype: mem_entry_name_port_t
+#if     KERNEL_SERVER
+		intran: mem_entry_name_port_t null_conversion(mach_port_t)
+		outtran: mach_port_t null_conversion(mem_entry_name_port_t)
+#endif  /* KERNEL_SERVER */
+		;
+
+type memory_object_default_t = mach_port_t
+		;
+ 
+type memory_object_t = mach_port_t
+		;
+
+
+type memory_object_control_t = mach_port_t
+		;
+
+type memory_object_name_t = mach_port_t
+		ctype: mach_port_t
+		;
+
+
+type memory_object_copy_strategy_t = int;
+type memory_object_return_t = int;
+
+type machine_info_data_t = struct[5] of integer_t;
+type machine_slot_data_t = struct[8] of integer_t;
+
+type host_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: host_t convert_port_to_host(mach_port_t)
+		outtran: mach_port_t convert_host_to_port(host_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type host_priv_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: host_priv_t convert_port_to_host_priv(mach_port_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type host_security_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: host_security_t convert_port_to_host_security(mach_port_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+		/* 
+		 * host_info_t: variable-sized inline array that can contain:
+		 * 
+		 * 	host_basic_info_old_t (5 ints)
+		 * 	host_basic_info_t (12 ints)
+		 * 	host_sched_info_t (2 ints)
+		 * 	kernel_resource_sizes_t (5 ints)
+		 * 	host_load_info_t (6 ints)
+		 * 	vm_statistics32_t (15 ints)
+		 * 
+		 * If other host_info flavors are added, this definition may
+		 * need to be changed. (See mach/{host_info,vm_statistics}.h)
+		 */
+type host_flavor_t		= int;
+type host_info_t 		= array[*:15] of integer_t;
+
+
+		/* 
+		 * host_info64_t: variable-sized inline array that can contain:
+		 * 
+		 *	vm_statistics_t (6 ints and 9 longs)
+		 *	vm_extmod_statistics_t (6 64-bit ints)
+		 */
+type host_info64_t		= array[*:256] of integer_t;
+
+type processor_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: processor_t convert_port_to_processor(mach_port_t)
+		outtran: mach_port_t convert_processor_to_port(processor_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type processor_array_t 	= ^array[] of processor_t;
+
+		/* processor_info_t: variable-sized inline array that can
+		 * contain:
+		 * processor_basic_info_t:   (5 ints)
+		 * processor_cpu_load_info_t:(4 ints)
+		 * processor_machine_info_t :(12 ints)
+		 * If other processor_info flavors are added, this definition
+		 * may need to be changed. (See mach/processor_info.h) */
+type processor_flavor_t		= int;
+type processor_info_t		= array[*:12] of integer_t;
+type processor_info_array_t	= ^array[] of integer_t;
+
+type processor_set_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: processor_set_t convert_port_to_pset(mach_port_t)
+		outtran: mach_port_t convert_pset_to_port(processor_set_t)
+		destructor: pset_deallocate(processor_set_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type processor_set_array_t = ^array[] of processor_set_t;
+
+type processor_set_name_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: processor_set_name_t convert_port_to_pset_name(mach_port_t)
+		outtran: mach_port_t convert_pset_name_to_port(processor_set_name_t)
+		destructor: pset_deallocate(processor_set_name_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type processor_set_name_array_t = ^array[] of processor_set_name_t;
+
+		/* processor_set_info_t: variable-size inline array
+		 * that can hold:
+		 * processor_set_basic_info (5 ints)
+		 * processor_set_load_info (4 ints)
+		 * policy_timeshare_base_t (1 int)
+		 * policy_fifo_base_t (1 int)
+		 * policy_rr_base_t (1 int)
+		 * policy_timeshare_base_t (1 int)
+		 * policy_fifo_base_t (1 int)
+		 * policy_rr_base_t (1 int)
+		 * policy_t (1 int)
+		 * If other flavors are added, this definition may
+		 * need to be changed. (see mach/processor.h) */
+type processor_set_flavor_t	= int;
+type processor_set_info_t	= array[*:5] of integer_t;	
+
+type bootstrap_t = mach_port_t;
+
+type kernel_version_t           = c_string[*:512];
+type kernel_boot_info_t         = c_string[*:4096];
+
+type time_value_t = struct[2] of integer_t;
+
+type mach_port_qos_t = struct[2] of integer_t;
+
+type emulation_vector_t		= ^array[] of vm_offset_t;
+
+type inline_existence_map_t	= array[*:512] of char;
+
+type policy_t			= int;
+		/* policy_info_t: variable-size inline array. Can hold:
+		 * policy_timeshare_info_t (5 ints)
+		 * policy_fifo_info_t (4 ints)
+		 * policy_rr_info_t (5 ints) */
+type policy_base_t		= array[*:5] of integer_t;
+type policy_info_t		= array[*:2] of integer_t;
+type policy_limit_t		= array[*:1] of integer_t;
+
+type ledger_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: ledger_t convert_port_to_ledger(mach_port_t)
+		outtran: mach_port_t convert_ledger_to_port(ledger_t)
+#endif	/* KERNEL_SERVER */
+                ;
+
+type ledger_array_t	 	= ^array[] of ledger_t;
+type ledger_item_t		= integer_t;
+
+type security_token_t		= struct[2] of uint32_t;
+type audit_token_t		= struct[8] of uint32_t;
+
+type msg_labels_t = mach_port_t;
+
+		/* memory_object_info_t: variable-size inline array:
+		 * memory_object_attr_info_t (5 ints)
+		 * XXX actually it's 6 ints temporarily (object_ready!)
+		 * memory_object_behave_info_t (4 ints)
+		 * memory_object_perf_info_t (2 ints)
+		 * old_memory_object_attr_info_t (3 ints)
+		 * memory_object_norma_info_t (5 ints)
+		 * If other flavors are added, this definition may
+		 * need to be changed. (see mach/memory_object.h) */
+type memory_object_flavor_t	= int;
+type memory_object_info_t	= array[*:6] of int;
+
+		/* vm_region_info_t: variable-size inline array that can hold:
+		 * vm_region_basic_info_t (8 ints)
+		 * If other flavors are added, this definition may
+		 * need to be changed. (see mach/vm_region.h) */
+type vm_region_flavor_t		= int;
+type vm_region_info_t		= array[*:10] of int;
+type vm_region_recurse_info_t	= array[*:19] of int;
+
+type vm_page_info_flavor_t	= int;
+type vm_page_info_t		= array[*:32] of int;
+
+type mach_vm_read_entry_t = array[512] of mach_vm_offset_t;
+type vm_read_entry_t = array[512] of vm_offset_t;
+#if VM32_SUPPORT
+type vm32_read_entry_t = array[512] of vm32_offset_t;
+#endif
+
+type exception_mask_t		= int;
+type exception_behavior_t	= int;
+
+type    exception_handler_t = mach_port_t;
+
+type	exception_handler_array_t	=
+			array[*:32] of exception_handler_t;
+
+type	exception_behavior_array_t	=
+			array[*:32] of exception_behavior_t;
+
+type	exception_flavor_array_t	=
+			array[*:32] of thread_state_flavor_t;
+
+type	exception_mask_array_t	=
+			array[*:32] of exception_mask_t;
+
+type semaphore_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: semaphore_t convert_port_to_semaphore(mach_port_t)
+		outtran: mach_port_t convert_semaphore_to_port(semaphore_t)
+		destructor: semaphore_dereference(semaphore_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type semaphore_consume_ref_t = mach_port_move_send_t
+		cusertype: semaphore_t
+#if	KERNEL_SERVER
+		intran: semaphore_t convert_port_to_semaphore(mach_port_t)
+		outtran: mach_port_t convert_semaphore_to_port(semaphore_t)
+		destructor: semaphore_dereference(semaphore_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+type lock_set_t = mach_port_t
+#if	KERNEL_SERVER
+		intran: lock_set_t convert_port_to_lock_set(mach_port_t)
+		outtran: mach_port_t convert_lock_set_to_port(lock_set_t)
+		destructor: lock_set_dereference(lock_set_t)
+#endif	/* KERNEL_SERVER */
+		;
+
+/* kernel module loader */
+type kmod_t = int;
+type kmod_control_flavor_t = int;
+
+type kmod_args_t = ^array[] of MACH_MSG_TYPE_BYTE
+	ctype: kmod_args_t;
+
+type io_master_t = mach_port_t;
+type UNDServerRef = mach_port_t;
+
+#if KERNEL_SERVER
+
+simport <kern/ipc_mig.h>;	/* pick up kernel-specific MIG things */
+
+#endif /* KERNEL_SERVER */
+
+import <mach/mig.h>;
+import <mach/mach_types.h>;
+
+#endif	/* _MACH_MACH_TYPES_DEFS_ */
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/mach_types.h cctools-806/include/mach/mach_types.h
--- cctools-806-old/include/mach/mach_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,231 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ * NOTICE: This file was modified by SPARTA, Inc. in 2005 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+/*
+ *	File:	mach/mach_types.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *	Date:	1986
+ *
+ *	Mach external interface definitions.
+ *
+ */
+
+#ifndef	_MACH_MACH_TYPES_H_
+#define _MACH_MACH_TYPES_H_
+
+#include <stdint.h>
+
+#include <sys/cdefs.h>
+
+#include <mach/host_info.h>
+#include <mach/host_notify.h>
+#include <mach/host_special_ports.h>
+#include <mach/machine.h>
+#include <mach/machine/vm_types.h>
+#include <mach/memory_object_types.h>
+#include <mach/message.h>
+#include <mach/exception_types.h>
+#include <mach/port.h>
+#include <mach/processor_info.h>
+#include <mach/task_info.h>
+#include <mach/task_policy.h>
+#include <mach/task_special_ports.h>
+#include <mach/thread_info.h>
+#include <mach/thread_policy.h>
+#include <mach/thread_special_ports.h>
+#include <mach/thread_status.h>
+#include <mach/time_value.h>
+#include <mach/clock_types.h>
+#include <mach/vm_attributes.h>
+#include <mach/vm_inherit.h>
+#include <mach/vm_purgable.h>
+#include <mach/vm_behavior.h>
+#include <mach/vm_prot.h>
+#include <mach/vm_statistics.h>
+#include <mach/vm_sync.h>
+#include <mach/vm_types.h>
+#include <mach/vm_region.h>
+#include <mach/kmod.h>
+
+
+/*
+ * If we are not in the kernel, then these will all be represented by
+ * ports at user-space.
+ */
+typedef mach_port_t		task_t;
+typedef mach_port_t		task_name_t;
+typedef mach_port_t		thread_t;
+typedef	mach_port_t		thread_act_t;
+typedef mach_port_t		ipc_space_t;
+typedef mach_port_t		host_t;
+typedef mach_port_t		host_priv_t;
+typedef mach_port_t		host_security_t;
+typedef mach_port_t		processor_t;
+typedef mach_port_t		processor_set_t;
+typedef mach_port_t		processor_set_control_t;
+typedef mach_port_t		semaphore_t;
+typedef mach_port_t		lock_set_t;
+typedef mach_port_t		ledger_t;
+typedef mach_port_t		alarm_t;
+typedef mach_port_t		clock_serv_t;
+typedef mach_port_t		clock_ctrl_t;
+
+
+/*
+ * These aren't really unique types.  They are just called
+ * out as unique types at one point in history.  So we list
+ * them here for compatibility.
+ */
+typedef processor_set_t		processor_set_name_t;
+
+/*
+ * These types are just hard-coded as ports
+ */
+typedef mach_port_t		clock_reply_t;
+typedef mach_port_t		bootstrap_t;
+typedef	mach_port_t		mem_entry_name_port_t;
+typedef mach_port_t		exception_handler_t;
+typedef exception_handler_t	*exception_handler_array_t;
+typedef mach_port_t		vm_task_entry_t;
+typedef mach_port_t		io_master_t;
+typedef mach_port_t		UNDServerRef;
+
+/*
+ * Mig doesn't translate the components of an array.
+ * For example, Mig won't use the thread_t translations
+ * to translate a thread_array_t argument.  So, these definitions
+ * are not completely accurate at the moment for other kernel
+ * components.
+ */
+typedef task_t			*task_array_t;
+typedef thread_t		*thread_array_t;
+typedef processor_set_t		*processor_set_array_t;
+typedef processor_set_t		*processor_set_name_array_t;
+typedef processor_t		*processor_array_t;
+typedef	thread_act_t		*thread_act_array_t;
+typedef ledger_t		*ledger_array_t;
+
+/*
+ * However the real mach_types got declared, we also have to declare
+ * types with "port" in the name for compatability with the way OSF
+ * had declared the user interfaces at one point.  Someday these should
+ * go away.
+ */
+typedef task_t			task_port_t;
+typedef	task_array_t		task_port_array_t;
+typedef thread_t		thread_port_t;
+typedef	thread_array_t		thread_port_array_t;
+typedef ipc_space_t		ipc_space_port_t;
+typedef host_t			host_name_t;
+typedef host_t			host_name_port_t;
+typedef processor_set_t		processor_set_port_t;
+typedef processor_set_t		processor_set_name_port_t;
+typedef processor_set_array_t	processor_set_name_port_array_t;
+typedef processor_set_t		processor_set_control_port_t;
+typedef processor_t		processor_port_t;
+typedef processor_array_t	processor_port_array_t;
+typedef thread_act_t		thread_act_port_t;
+typedef	thread_act_array_t	thread_act_port_array_t;
+typedef semaphore_t		semaphore_port_t;
+typedef lock_set_t		lock_set_port_t;
+typedef ledger_t		ledger_port_t;
+typedef ledger_array_t		ledger_port_array_t;
+typedef alarm_t			alarm_port_t;
+typedef clock_serv_t		clock_serv_port_t;
+typedef clock_ctrl_t		clock_ctrl_port_t;
+typedef exception_handler_t	exception_port_t;
+typedef exception_handler_array_t exception_port_arrary_t;
+
+
+#define TASK_NULL		((task_t) 0)
+#define TASK_NAME_NULL		((task_name_t) 0)
+#define THREAD_NULL		((thread_t) 0)
+#define TID_NULL		((uint64_t) 0)
+#define THR_ACT_NULL 		((thread_act_t) 0)
+#define IPC_SPACE_NULL		((ipc_space_t) 0)
+#define HOST_NULL		((host_t) 0)
+#define HOST_PRIV_NULL		((host_priv_t)0)
+#define HOST_SECURITY_NULL	((host_security_t)0)
+#define PROCESSOR_SET_NULL	((processor_set_t) 0)
+#define PROCESSOR_NULL		((processor_t) 0)
+#define SEMAPHORE_NULL		((semaphore_t) 0)
+#define LOCK_SET_NULL		((lock_set_t) 0)
+#define LEDGER_NULL 		((ledger_t) 0)
+#define ALARM_NULL		((alarm_t) 0)
+#define CLOCK_NULL		((clock_t) 0)
+#define UND_SERVER_NULL		((UNDServerRef) 0)
+
+typedef natural_t 		ledger_item_t;
+#define LEDGER_ITEM_INFINITY ((ledger_item_t) (~0))
+
+typedef mach_vm_offset_t	*emulation_vector_t;
+typedef char			*user_subsystem_t;
+
+typedef char			*labelstr_t;
+/*
+ *	Backwards compatibility, for those programs written
+ *	before mach/{std,mach}_types.{defs,h} were set up.
+ */
+#include <mach/std_types.h>
+
+#endif	/* _MACH_MACH_TYPES_H_ */
diff -urN cctools-806-old/include/mach/mach_vm.defs cctools-806/include/mach/mach_vm.defs
--- cctools-806-old/include/mach/mach_vm.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_vm.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,484 @@
+/*
+ * Copyright (c) 2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_vm.defs
+ *
+ *	Exported kernel VM calls (for any task on the platform).
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+	  mach_vm
+#else
+	  vm_map_lp64_local
+#endif
+	  4800;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach_debug/mach_debug_types.defs>
+
+/*
+ *	Allocate zero-filled memory in the address space
+ *	of the target task, either at the specified address,
+ *	or wherever space can be found (controlled by flags),
+ *	of the specified size.  The address at which the
+ *	allocation actually took place is returned.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_allocate(
+#else
+routine vm_allocate(
+#endif
+		target		: vm_task_entry_t;
+	inout	address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		flags		: int);
+
+/*
+ *	Deallocate the specified range from the virtual
+ *	address space of the target virtual memory map.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_deallocate(
+#else
+routine vm_deallocate(
+#endif
+		target		: vm_task_entry_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t);
+
+/*
+ *	Set the current or maximum protection attribute
+ *	for the specified range of the virtual address
+ *	space of the target virtual memory map.  The current
+ *	protection limits the memory access rights of threads
+ *	within the map; the maximum protection limits the accesses
+ *	that may be given in the current protection.
+ *	Protections are specified as a set of {read, write, execute}
+ *	*permissions*.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_protect(
+#else
+routine vm_protect(
+#endif
+		target_task	: vm_task_entry_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		set_maximum	: boolean_t;
+		new_protection	: vm_prot_t);
+
+/*
+ *	Set the inheritance attribute for the specified range
+ *	of the virtual address space of the target address space.
+ *	The inheritance value is one of {none, copy, share}, and
+ *	specifies how the child address space should acquire
+ *	this memory at the time of a task_create call.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_inherit(
+#else
+routine vm_inherit(
+#endif
+		target_task	: vm_task_entry_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		new_inheritance	: vm_inherit_t);
+
+/*
+ *	Returns the contents of the specified range of the
+ *	virtual address space of the target task.  [The
+ *	range must be aligned on a virtual page boundary,
+ *	and must be a multiple of pages in extent.  The
+ *	protection on the specified range must permit reading.]
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_read(
+#else
+routine vm_read(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+	out	data		: pointer_t);
+
+/* 
+ * List corrollary to vm_read, returns mapped contents of specified
+ * ranges within target address space.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_read_list(
+#else
+routine vm_read_list(
+#endif
+		target_task 	: vm_map_t;
+	inout	data_list   	: mach_vm_read_entry_t;
+		count		: natural_t);
+
+/*
+ *	Writes the contents of the specified range of the
+ *	virtual address space of the target task.  [The
+ *	range must be aligned on a virtual page boundary,
+ *	and must be a multiple of pages in extent.  The
+ *	protection on the specified range must permit writing.]
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_write(
+#else
+routine vm_write(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		data		: pointer_t);
+
+/*
+ *	Copy the contents of the source range of the virtual
+ *	address space of the target task to the destination
+ *	range in that same address space.  [Both of the
+ *	ranges must be aligned on a virtual page boundary,
+ *	and must be multiples of pages in extent.  The
+ *	protection on the source range must permit reading,
+ *	and the protection on the destination range must
+ *	permit writing.]
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_copy(
+#else
+routine vm_copy(
+#endif
+		target_task	: vm_map_t;
+		source_address	: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		dest_address	: mach_vm_address_t);
+
+/*
+ *	Returns the contents of the specified range of the
+ *	virtual address space of the target task.  [There
+ *	are no alignment restrictions, and the results will
+ *      overwrite the area pointed to by data - which must
+ *      already exist. The protection on the specified range
+ *	must permit reading.]
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_read_overwrite(
+#else
+routine vm_read_overwrite(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		data		: mach_vm_address_t;
+	out	outsize		: mach_vm_size_t);
+
+
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_msync(
+#else
+routine vm_msync(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		sync_flags	: vm_sync_t );
+
+/*
+ *	Set the paging behavior attribute for the specified range
+ *	of the virtual address space of the target task.
+ *	The behavior value is one of {default, random, forward 
+ *	sequential, reverse sequential} and indicates the expected
+ *	page reference pattern for the specified range.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_behavior_set(
+#else
+routine vm_behavior_set(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		new_behavior	: vm_behavior_t);
+
+
+/*
+ *	Map a user-supplie memory object into the virtual address
+ *	space of the target task.  If desired (anywhere is TRUE),
+ *	the kernel will find a suitable address range of the
+ *	specified size; else, the specific address will be allocated.
+ *
+ *	The beginning address of the range will be aligned on a virtual
+ *	page boundary, be at or beyond the address specified, and
+ *	meet the mask requirements (bits turned on in the mask must not
+ *	be turned on in the result); the size of the range, in bytes,
+ *	will be rounded	up to an integral number of virtual pages.
+ *
+ *	The memory in the resulting range will be associated with the
+ *	specified memory object, with the beginning of the memory range
+ *	referring to the specified offset into the memory object.
+ *
+ *	The mapping will take the current and maximum protections and
+ *	the inheritance attributes specified; see the vm_protect and
+ *	vm_inherit calls for a description of these attributes.
+ *
+ *	If desired (copy is TRUE), the memory range will be filled
+ *	with a copy of the data from the memory object; this copy will
+ *	be private to this mapping in this target task.  Otherwise,
+ *	the memory in this mapping will be shared with other mappings
+ *	of the same memory object at the same offset (in this task or
+ *	in other tasks).  [The Mach kernel only enforces shared memory
+ *	consistency among mappings on one host with similar page alignments.
+ *	The user-defined memory manager for this object is responsible
+ *	for further consistency.]
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_map(
+#else
+#if defined(__arm__) && !LIBSYSCALL_INTERFACE
+routine _vm_map_arm(
+#else
+routine vm_map(
+#endif
+#endif
+		target_task	: vm_task_entry_t;
+	inout	address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		mask		: mach_vm_offset_t;
+		flags		: int;
+		object		: mem_entry_name_port_t;
+		offset		: memory_object_offset_t;
+		copy		: boolean_t;
+		cur_protection	: vm_prot_t;
+		max_protection	: vm_prot_t;
+		inheritance	: vm_inherit_t);
+
+/*
+ *	Set/Get special properties of memory associated
+ *	to some virtual address range, such as cachability, 
+ *	migrability, replicability.  Machine-dependent.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_machine_attribute(
+#else
+routine vm_machine_attribute(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		attribute	: vm_machine_attribute_t;
+	inout	value		: vm_machine_attribute_val_t);
+
+/*
+ *      Map portion of a task's address space.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_remap(
+#else
+routine vm_remap(
+#endif
+		target_task	: vm_map_t;
+	inout	target_address	: mach_vm_address_t;
+		size		: mach_vm_size_t;
+		mask		: mach_vm_offset_t;
+		flags		: int;
+		src_task	: vm_map_t;
+		src_address	: mach_vm_address_t;
+		copy		: boolean_t;
+	out	cur_protection	: vm_prot_t;
+	out	max_protection	: vm_prot_t;
+		inheritance	: vm_inherit_t);
+
+/*
+ *      Give the caller information on the given location in a virtual
+ *      address space.  If a page is mapped return ref and dirty info.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_page_query(
+#else
+routine vm_map_page_query(
+#endif
+                target_map      :vm_map_t;
+                offset          :mach_vm_offset_t;
+        out     disposition     :integer_t;
+        out     ref_count       :integer_t);
+
+
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_region_recurse(
+#else
+routine vm_region_recurse_64(
+#endif
+                target_task     : vm_map_t;
+	inout	address		: mach_vm_address_t;
+        out     size            : mach_vm_size_t;
+	inout	nesting_depth	: natural_t;
+	out	info		: vm_region_recurse_info_t,CountInOut);
+
+/*
+ *      Returns information about the contents of the virtual
+ *      address space of the target task at the specified
+ *      address.  The returned protection, inheritance, sharing
+ *      and memory object values apply to the entire range described
+ *      by the address range returned; the memory object offset
+ *      corresponds to the beginning of the address range.
+ *      [If the specified address is not allocated, the next
+ *      highest address range is described.  If no addresses beyond
+ *      the one specified are allocated, the call returns KERN_NO_SPACE.]
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_region(
+#else
+routine vm_region_64(
+#endif
+                target_task     : vm_map_t;
+	inout	address		: mach_vm_address_t;
+        out     size            : mach_vm_size_t;
+		flavor		: vm_region_flavor_t;
+	out	info		: vm_region_info_t, CountInOut;
+        out     object_name     : memory_object_name_t =
+                                        MACH_MSG_TYPE_MOVE_SEND
+                                        ctype: mach_port_t);
+
+/*
+ *	Allow application level processes to create named entries which
+ *	correspond to mapped portions of their address space.  These named
+ *	entries can then be manipulated, shared with other processes in
+ *	other address spaces and ultimately mapped in ohter address spaces
+ *
+ *	THIS INTERFACE IS STILL EVOLVING.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+#if !defined(__LP64__) || KERNEL_SERVER || XNU_KERNEL_PRIVATE || LIBSYSCALL_INTERFACE
+routine _mach_make_memory_entry(
+#else
+routine mach_make_memory_entry(
+#endif
+#else
+routine mach_make_memory_entry_64(
+#endif
+		target_task	:vm_map_t;
+	inout	size		:memory_object_size_t;
+		offset		:memory_object_offset_t;
+		permission	:vm_prot_t;
+	out	object_handle	:mem_entry_name_port_move_send_t;
+		parent_handle	:mem_entry_name_port_t);
+
+/*
+ *	Control behavior and investigate state of a "purgable" object in
+ *	the virtual address space of the target task.  A purgable object is
+ *	created via a call to mach_vm_allocate() with VM_FLAGS_PURGABLE
+ *	specified.  See the routine implementation for a complete
+ *	definition of the routine.
+ */
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_purgable_control(
+#else
+routine vm_purgable_control(
+#endif
+		target_task	: vm_map_t;
+		address		: mach_vm_address_t;
+		control		: vm_purgable_t;
+	inout	state		: int);
+
+
+#if !defined(_MACH_VM_PUBLISH_AS_LOCAL_)
+routine mach_vm_page_info(
+			target_task		: vm_map_t;
+			address			: mach_vm_address_t;
+			flavor			: vm_page_info_flavor_t;
+	out		info			: vm_page_info_t, CountInOut);
+#else
+skip;
+#endif
+
+/****************************** Legacy section ***************************/
+/*  The following definitions are exist to provide compatibility with    */
+/*  the legacy APIs.  They are no different.  We just need to produce    */
+/*  the user-level stub interface for them.                              */
+/****************************** Legacy section ***************************/
+
+
+/*
+ * These interfaces just aren't supported in the new (wide) model:
+ *
+ *	mach_vm_region_info() -
+ *	vm_map_pages_info() -
+ *		no user-level replacement for these MACH_DEBUG interfaces
+ *	vm_map_get_upl() -
+ *		no user-level replacement at the moment
+ *	vm_region_info() -
+ *		use mach_vm_region_info() or vm_region_info_64()
+ *	vm_region_recurse() -
+ *		use mach_vm_region_recurse() or vm_region_recurse_64()
+ */
+
+/*
+ * The following legacy interfaces are provides as macro wrappers to the new
+ * interfaces.  You should strive to use the new ones instead:
+ *
+ *	vm_map() -
+ *		use mach_vm_map() or vm_map_64()
+ *	vm_region() -
+ *		use mach_vm_region() or vm_region_64()
+ *	mach_make_memory_entry() -
+ *		use mach_vm_make_memory_entry() or mach_make_memory_entry_64()
+ */
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/mach_vm.h cctools-806/include/mach/mach_vm.h
--- cctools-806-old/include/mach/mach_vm.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mach_vm.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1033 @@
+#ifndef	_mach_vm_user_
+#define	_mach_vm_user_
+
+/* Module mach_vm */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	mach_vm_MSG_COUNT
+#define	mach_vm_MSG_COUNT	20
+#endif	/* mach_vm_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine mach_vm_allocate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_allocate
+(
+	vm_map_t target,
+	mach_vm_address_t *address,
+	mach_vm_size_t size,
+	int flags
+);
+
+/* Routine mach_vm_deallocate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_deallocate
+(
+	vm_map_t target,
+	mach_vm_address_t address,
+	mach_vm_size_t size
+);
+
+/* Routine mach_vm_protect */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_protect
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	boolean_t set_maximum,
+	vm_prot_t new_protection
+);
+
+/* Routine mach_vm_inherit */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_inherit
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	vm_inherit_t new_inheritance
+);
+
+/* Routine mach_vm_read */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_read
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	vm_offset_t *data,
+	mach_msg_type_number_t *dataCnt
+);
+
+/* Routine mach_vm_read_list */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_read_list
+(
+	vm_map_t target_task,
+	mach_vm_read_entry_t data_list,
+	natural_t count
+);
+
+/* Routine mach_vm_write */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_write
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	vm_offset_t data,
+	mach_msg_type_number_t dataCnt
+);
+
+/* Routine mach_vm_copy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_copy
+(
+	vm_map_t target_task,
+	mach_vm_address_t source_address,
+	mach_vm_size_t size,
+	mach_vm_address_t dest_address
+);
+
+/* Routine mach_vm_read_overwrite */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_read_overwrite
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	mach_vm_address_t data,
+	mach_vm_size_t *outsize
+);
+
+/* Routine mach_vm_msync */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_msync
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	vm_sync_t sync_flags
+);
+
+/* Routine mach_vm_behavior_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_behavior_set
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	vm_behavior_t new_behavior
+);
+
+/* Routine mach_vm_map */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_map
+(
+	vm_map_t target_task,
+	mach_vm_address_t *address,
+	mach_vm_size_t size,
+	mach_vm_offset_t mask,
+	int flags,
+	mem_entry_name_port_t object,
+	memory_object_offset_t offset,
+	boolean_t copy,
+	vm_prot_t cur_protection,
+	vm_prot_t max_protection,
+	vm_inherit_t inheritance
+);
+
+/* Routine mach_vm_machine_attribute */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_machine_attribute
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	mach_vm_size_t size,
+	vm_machine_attribute_t attribute,
+	vm_machine_attribute_val_t *value
+);
+
+/* Routine mach_vm_remap */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_remap
+(
+	vm_map_t target_task,
+	mach_vm_address_t *target_address,
+	mach_vm_size_t size,
+	mach_vm_offset_t mask,
+	int flags,
+	vm_map_t src_task,
+	mach_vm_address_t src_address,
+	boolean_t copy,
+	vm_prot_t *cur_protection,
+	vm_prot_t *max_protection,
+	vm_inherit_t inheritance
+);
+
+/* Routine mach_vm_page_query */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_page_query
+(
+	vm_map_t target_map,
+	mach_vm_offset_t offset,
+	integer_t *disposition,
+	integer_t *ref_count
+);
+
+/* Routine mach_vm_region_recurse */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_region_recurse
+(
+	vm_map_t target_task,
+	mach_vm_address_t *address,
+	mach_vm_size_t *size,
+	natural_t *nesting_depth,
+	vm_region_recurse_info_t info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine mach_vm_region */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_region
+(
+	vm_map_t target_task,
+	mach_vm_address_t *address,
+	mach_vm_size_t *size,
+	vm_region_flavor_t flavor,
+	vm_region_info_t info,
+	mach_msg_type_number_t *infoCnt,
+	mach_port_t *object_name
+);
+
+/* Routine _mach_make_memory_entry */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t _mach_make_memory_entry
+(
+	vm_map_t target_task,
+	memory_object_size_t *size,
+	memory_object_offset_t offset,
+	vm_prot_t permission,
+	mem_entry_name_port_t *object_handle,
+	mem_entry_name_port_t parent_handle
+);
+
+/* Routine mach_vm_purgable_control */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_purgable_control
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	vm_purgable_t control,
+	int *state
+);
+
+/* Routine mach_vm_page_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_page_info
+(
+	vm_map_t target_task,
+	mach_vm_address_t address,
+	vm_page_info_flavor_t flavor,
+	vm_page_info_t info,
+	mach_msg_type_number_t *infoCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__mach_vm_subsystem__defined
+#define __Request__mach_vm_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		int flags;
+	} __Request__mach_vm_allocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+	} __Request__mach_vm_deallocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		boolean_t set_maximum;
+		vm_prot_t new_protection;
+	} __Request__mach_vm_protect_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		vm_inherit_t new_inheritance;
+	} __Request__mach_vm_inherit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+	} __Request__mach_vm_read_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_read_entry_t data_list;
+		natural_t count;
+	} __Request__mach_vm_read_list_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_msg_type_number_t dataCnt;
+	} __Request__mach_vm_write_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t source_address;
+		mach_vm_size_t size;
+		mach_vm_address_t dest_address;
+	} __Request__mach_vm_copy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		mach_vm_address_t data;
+	} __Request__mach_vm_read_overwrite_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		vm_sync_t sync_flags;
+	} __Request__mach_vm_msync_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		vm_behavior_t new_behavior;
+	} __Request__mach_vm_behavior_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		mach_vm_offset_t mask;
+		int flags;
+		memory_object_offset_t offset;
+		boolean_t copy;
+		vm_prot_t cur_protection;
+		vm_prot_t max_protection;
+		vm_inherit_t inheritance;
+	} __Request__mach_vm_map_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		vm_machine_attribute_t attribute;
+		vm_machine_attribute_val_t value;
+	} __Request__mach_vm_machine_attribute_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t src_task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_vm_address_t target_address;
+		mach_vm_size_t size;
+		mach_vm_offset_t mask;
+		int flags;
+		mach_vm_address_t src_address;
+		boolean_t copy;
+		vm_inherit_t inheritance;
+	} __Request__mach_vm_remap_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_offset_t offset;
+	} __Request__mach_vm_page_query_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		natural_t nesting_depth;
+		mach_msg_type_number_t infoCnt;
+	} __Request__mach_vm_region_recurse_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		vm_region_flavor_t flavor;
+		mach_msg_type_number_t infoCnt;
+	} __Request__mach_vm_region_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t parent_handle;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		memory_object_size_t size;
+		memory_object_offset_t offset;
+		vm_prot_t permission;
+	} __Request___mach_make_memory_entry_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		vm_purgable_t control;
+		int state;
+	} __Request__mach_vm_purgable_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		vm_page_info_flavor_t flavor;
+		mach_msg_type_number_t infoCnt;
+	} __Request__mach_vm_page_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__mach_vm_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__mach_vm_subsystem__defined
+#define __RequestUnion__mach_vm_subsystem__defined
+union __RequestUnion__mach_vm_subsystem {
+	__Request__mach_vm_allocate_t Request_mach_vm_allocate;
+	__Request__mach_vm_deallocate_t Request_mach_vm_deallocate;
+	__Request__mach_vm_protect_t Request_mach_vm_protect;
+	__Request__mach_vm_inherit_t Request_mach_vm_inherit;
+	__Request__mach_vm_read_t Request_mach_vm_read;
+	__Request__mach_vm_read_list_t Request_mach_vm_read_list;
+	__Request__mach_vm_write_t Request_mach_vm_write;
+	__Request__mach_vm_copy_t Request_mach_vm_copy;
+	__Request__mach_vm_read_overwrite_t Request_mach_vm_read_overwrite;
+	__Request__mach_vm_msync_t Request_mach_vm_msync;
+	__Request__mach_vm_behavior_set_t Request_mach_vm_behavior_set;
+	__Request__mach_vm_map_t Request_mach_vm_map;
+	__Request__mach_vm_machine_attribute_t Request_mach_vm_machine_attribute;
+	__Request__mach_vm_remap_t Request_mach_vm_remap;
+	__Request__mach_vm_page_query_t Request_mach_vm_page_query;
+	__Request__mach_vm_region_recurse_t Request_mach_vm_region_recurse;
+	__Request__mach_vm_region_t Request_mach_vm_region;
+	__Request___mach_make_memory_entry_t Request__mach_make_memory_entry;
+	__Request__mach_vm_purgable_control_t Request_mach_vm_purgable_control;
+	__Request__mach_vm_page_info_t Request_mach_vm_page_info;
+};
+#endif /* !__RequestUnion__mach_vm_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__mach_vm_subsystem__defined
+#define __Reply__mach_vm_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_address_t address;
+	} __Reply__mach_vm_allocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_deallocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_protect_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_inherit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t dataCnt;
+	} __Reply__mach_vm_read_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_read_entry_t data_list;
+	} __Reply__mach_vm_read_list_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_write_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_copy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_size_t outsize;
+	} __Reply__mach_vm_read_overwrite_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_msync_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_vm_behavior_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_address_t address;
+	} __Reply__mach_vm_map_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_machine_attribute_val_t value;
+	} __Reply__mach_vm_machine_attribute_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_address_t target_address;
+		vm_prot_t cur_protection;
+		vm_prot_t max_protection;
+	} __Reply__mach_vm_remap_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		integer_t disposition;
+		integer_t ref_count;
+	} __Reply__mach_vm_page_query_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		natural_t nesting_depth;
+		mach_msg_type_number_t infoCnt;
+		int info[19];
+	} __Reply__mach_vm_region_recurse_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object_name;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_vm_address_t address;
+		mach_vm_size_t size;
+		mach_msg_type_number_t infoCnt;
+		int info[10];
+	} __Reply__mach_vm_region_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object_handle;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		memory_object_size_t size;
+	} __Reply___mach_make_memory_entry_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		int state;
+	} __Reply__mach_vm_purgable_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t infoCnt;
+		int info[32];
+	} __Reply__mach_vm_page_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__mach_vm_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__mach_vm_subsystem__defined
+#define __ReplyUnion__mach_vm_subsystem__defined
+union __ReplyUnion__mach_vm_subsystem {
+	__Reply__mach_vm_allocate_t Reply_mach_vm_allocate;
+	__Reply__mach_vm_deallocate_t Reply_mach_vm_deallocate;
+	__Reply__mach_vm_protect_t Reply_mach_vm_protect;
+	__Reply__mach_vm_inherit_t Reply_mach_vm_inherit;
+	__Reply__mach_vm_read_t Reply_mach_vm_read;
+	__Reply__mach_vm_read_list_t Reply_mach_vm_read_list;
+	__Reply__mach_vm_write_t Reply_mach_vm_write;
+	__Reply__mach_vm_copy_t Reply_mach_vm_copy;
+	__Reply__mach_vm_read_overwrite_t Reply_mach_vm_read_overwrite;
+	__Reply__mach_vm_msync_t Reply_mach_vm_msync;
+	__Reply__mach_vm_behavior_set_t Reply_mach_vm_behavior_set;
+	__Reply__mach_vm_map_t Reply_mach_vm_map;
+	__Reply__mach_vm_machine_attribute_t Reply_mach_vm_machine_attribute;
+	__Reply__mach_vm_remap_t Reply_mach_vm_remap;
+	__Reply__mach_vm_page_query_t Reply_mach_vm_page_query;
+	__Reply__mach_vm_region_recurse_t Reply_mach_vm_region_recurse;
+	__Reply__mach_vm_region_t Reply_mach_vm_region;
+	__Reply___mach_make_memory_entry_t Reply__mach_make_memory_entry;
+	__Reply__mach_vm_purgable_control_t Reply_mach_vm_purgable_control;
+	__Reply__mach_vm_page_info_t Reply_mach_vm_page_info;
+};
+#endif /* !__RequestUnion__mach_vm_subsystem__defined */
+
+#ifndef subsystem_to_name_map_mach_vm
+#define subsystem_to_name_map_mach_vm \
+    { "mach_vm_allocate", 4800 },\
+    { "mach_vm_deallocate", 4801 },\
+    { "mach_vm_protect", 4802 },\
+    { "mach_vm_inherit", 4803 },\
+    { "mach_vm_read", 4804 },\
+    { "mach_vm_read_list", 4805 },\
+    { "mach_vm_write", 4806 },\
+    { "mach_vm_copy", 4807 },\
+    { "mach_vm_read_overwrite", 4808 },\
+    { "mach_vm_msync", 4809 },\
+    { "mach_vm_behavior_set", 4810 },\
+    { "mach_vm_map", 4811 },\
+    { "mach_vm_machine_attribute", 4812 },\
+    { "mach_vm_remap", 4813 },\
+    { "mach_vm_page_query", 4814 },\
+    { "mach_vm_region_recurse", 4815 },\
+    { "mach_vm_region", 4816 },\
+    { "_mach_make_memory_entry", 4817 },\
+    { "mach_vm_purgable_control", 4818 },\
+    { "mach_vm_page_info", 4819 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _mach_vm_user_ */
diff -urN cctools-806-old/include/mach/memory_object_types.h cctools-806/include/mach/memory_object_types.h
--- cctools-806-old/include/mach/memory_object_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/memory_object_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,271 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	memory_object.h
+ *	Author:	Michael Wayne Young
+ *
+ *	External memory management interface definition.
+ */
+
+#ifndef	_MACH_MEMORY_OBJECT_TYPES_H_
+#define _MACH_MEMORY_OBJECT_TYPES_H_
+
+/*
+ *	User-visible types used in the external memory
+ *	management interface:
+ */
+
+#include <mach/port.h>
+#include <mach/message.h>
+#include <mach/vm_prot.h>
+#include <mach/vm_sync.h>
+#include <mach/vm_types.h>
+#include <mach/machine/vm_types.h>
+
+#include <sys/cdefs.h>
+
+#define VM_64_BIT_DATA_OBJECTS
+
+typedef unsigned long long	memory_object_offset_t;
+typedef unsigned long long	memory_object_size_t;
+typedef natural_t		memory_object_cluster_size_t;
+typedef natural_t *		memory_object_fault_info_t;
+
+typedef unsigned long long 	vm_object_id_t;
+
+
+/*
+ * Temporary until real EMMI version gets re-implemented
+ */
+
+
+typedef mach_port_t	memory_object_t;
+typedef mach_port_t	memory_object_control_t;
+
+
+typedef memory_object_t *memory_object_array_t;
+					/* A memory object ... */
+					/*  Used by the kernel to retrieve */
+					/*  or store data */
+
+typedef	mach_port_t	memory_object_name_t;
+					/* Used to describe the memory ... */
+					/*  object in vm_regions() calls */
+
+typedef mach_port_t	memory_object_default_t;
+					/* Registered with the host ... */
+					/*  for creating new internal objects */
+
+#define MEMORY_OBJECT_NULL		((memory_object_t) 0)
+#define MEMORY_OBJECT_CONTROL_NULL	((memory_object_control_t) 0)
+#define MEMORY_OBJECT_NAME_NULL		((memory_object_name_t) 0)
+#define MEMORY_OBJECT_DEFAULT_NULL	((memory_object_default_t) 0)
+
+
+typedef	int		memory_object_copy_strategy_t;
+					/* How memory manager handles copy: */
+#define		MEMORY_OBJECT_COPY_NONE		0
+					/* ... No special support */
+#define		MEMORY_OBJECT_COPY_CALL		1
+					/* ... Make call on memory manager */
+#define		MEMORY_OBJECT_COPY_DELAY 	2
+					/* ... Memory manager doesn't
+					 *     change data externally.
+					 */
+#define		MEMORY_OBJECT_COPY_TEMPORARY 	3
+					/* ... Memory manager doesn't
+					 *     change data externally, and
+					 *     doesn't need to see changes.
+					 */
+#define		MEMORY_OBJECT_COPY_SYMMETRIC 	4
+					/* ... Memory manager doesn't
+					 *     change data externally,
+					 *     doesn't need to see changes,
+					 *     and object will not be
+					 *     multiply mapped.
+					 *
+					 *     XXX
+					 *     Not yet safe for non-kernel use.
+					 */
+
+#define		MEMORY_OBJECT_COPY_INVALID	5
+					/* ...	An invalid copy strategy,
+					 *	for external objects which
+					 *	have not been initialized.
+					 *	Allows copy_strategy to be
+					 *	examined without also
+					 *	examining pager_ready and
+					 *	internal.
+					 */
+
+typedef	int		memory_object_return_t;
+					/* Which pages to return to manager
+					   this time (lock_request) */
+#define		MEMORY_OBJECT_RETURN_NONE	0
+					/* ... don't return any. */
+#define		MEMORY_OBJECT_RETURN_DIRTY	1
+					/* ... only dirty pages. */
+#define		MEMORY_OBJECT_RETURN_ALL	2
+					/* ... dirty and precious pages. */
+#define		MEMORY_OBJECT_RETURN_ANYTHING	3
+					/* ... any resident page. */
+
+/* 
+ *	Data lock request flags
+ */
+
+#define		MEMORY_OBJECT_DATA_FLUSH 	0x1
+#define		MEMORY_OBJECT_DATA_NO_CHANGE	0x2
+#define		MEMORY_OBJECT_DATA_PURGE	0x4
+#define		MEMORY_OBJECT_COPY_SYNC		0x8
+#define		MEMORY_OBJECT_DATA_SYNC		0x10
+#define         MEMORY_OBJECT_IO_SYNC           0x20
+#define		MEMORY_OBJECT_DATA_FLUSH_ALL	0x40
+
+/*
+ *	Types for the memory object flavor interfaces
+ */
+
+#define MEMORY_OBJECT_INFO_MAX      (1024) 
+typedef int     *memory_object_info_t;      
+typedef int	 memory_object_flavor_t;
+typedef int      memory_object_info_data_t[MEMORY_OBJECT_INFO_MAX];
+
+
+#define MEMORY_OBJECT_PERFORMANCE_INFO	11
+#define MEMORY_OBJECT_ATTRIBUTE_INFO	14
+#define MEMORY_OBJECT_BEHAVIOR_INFO 	15	
+
+
+struct memory_object_perf_info {
+	memory_object_cluster_size_t	cluster_size;
+	boolean_t			may_cache;
+};
+
+struct memory_object_attr_info {
+	memory_object_copy_strategy_t	copy_strategy;
+	memory_object_cluster_size_t	cluster_size;
+	boolean_t			may_cache_object;
+	boolean_t			temporary;
+};
+
+struct memory_object_behave_info {
+	memory_object_copy_strategy_t	copy_strategy;	
+	boolean_t			temporary;
+	boolean_t			invalidate;
+	boolean_t			silent_overwrite;
+	boolean_t			advisory_pageout;
+};
+
+
+typedef struct memory_object_behave_info *memory_object_behave_info_t;
+typedef struct memory_object_behave_info memory_object_behave_info_data_t;
+
+typedef struct memory_object_perf_info 	*memory_object_perf_info_t;
+typedef struct memory_object_perf_info	memory_object_perf_info_data_t;
+
+typedef struct memory_object_attr_info	*memory_object_attr_info_t;
+typedef struct memory_object_attr_info	memory_object_attr_info_data_t;
+
+#define MEMORY_OBJECT_BEHAVE_INFO_COUNT ((mach_msg_type_number_t)	\
+                (sizeof(memory_object_behave_info_data_t)/sizeof(int)))
+#define MEMORY_OBJECT_PERF_INFO_COUNT	((mach_msg_type_number_t)	\
+		(sizeof(memory_object_perf_info_data_t)/sizeof(int)))
+#define MEMORY_OBJECT_ATTR_INFO_COUNT	((mach_msg_type_number_t)	\
+		(sizeof(memory_object_attr_info_data_t)/sizeof(int)))
+
+#define invalid_memory_object_flavor(f)					\
+	(f != MEMORY_OBJECT_ATTRIBUTE_INFO && 				\
+	 f != MEMORY_OBJECT_PERFORMANCE_INFO && 			\
+	 f != OLD_MEMORY_OBJECT_BEHAVIOR_INFO &&			\
+	 f != MEMORY_OBJECT_BEHAVIOR_INFO &&				\
+	 f != OLD_MEMORY_OBJECT_ATTRIBUTE_INFO)
+
+
+/*
+ * Used to support options on memory_object_release_name call
+ */
+#define MEMORY_OBJECT_TERMINATE_IDLE	0x1
+#define MEMORY_OBJECT_RESPECT_CACHE	0x2
+#define MEMORY_OBJECT_RELEASE_NO_OP	0x4
+
+
+/* named entry processor mapping options */
+/* enumerated */
+#define MAP_MEM_NOOP		0
+#define MAP_MEM_COPYBACK	1
+#define MAP_MEM_IO		2
+#define MAP_MEM_WTHRU		3
+#define MAP_MEM_WCOMB		4	/* Write combining mode */
+					/* aka store gather     */
+
+#define GET_MAP_MEM(flags)	\
+	((((unsigned int)(flags)) >> 24) & 0xFF)
+
+#define SET_MAP_MEM(caching, flags)	\
+	((flags) = ((((unsigned int)(caching)) << 24) \
+			& 0xFF000000) | ((flags) & 0xFFFFFF));
+
+/* leave room for vm_prot bits */
+#define MAP_MEM_ONLY		0x010000 /* change processor caching  */
+#define MAP_MEM_NAMED_CREATE	0x020000 /* create extant object      */
+#define MAP_MEM_PURGABLE	0x040000 /* create a purgable VM object */
+#define MAP_MEM_NAMED_REUSE	0x080000 /* reuse provided entry if identical */
+
+
+#endif	/* _MACH_MEMORY_OBJECT_TYPES_H_ */
diff -urN cctools-806-old/include/mach/message.h cctools-806/include/mach/message.h
--- cctools-806-old/include/mach/message.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/message.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,783 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ * NOTICE: This file was modified by McAfee Research in 2004 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ * Copyright (c) 2005 SPARTA, Inc.
+ */
+/*
+ */
+/*
+ *	File:	mach/message.h
+ *
+ *	Mach IPC message and primitive function definitions.
+ */
+
+#ifndef	_MACH_MESSAGE_H_
+#define _MACH_MESSAGE_H_
+
+#include <stdint.h>
+#include <mach/port.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/machine/vm_types.h>
+
+#include <sys/cdefs.h>
+
+/*
+ *  The timeout mechanism uses mach_msg_timeout_t values,
+ *  passed by value.  The timeout units are milliseconds.
+ *  It is controlled with the MACH_SEND_TIMEOUT
+ *  and MACH_RCV_TIMEOUT options.
+ */
+
+typedef natural_t mach_msg_timeout_t;
+
+/*
+ *  The value to be used when there is no timeout.
+ *  (No MACH_SEND_TIMEOUT/MACH_RCV_TIMEOUT option.)
+ */
+
+#define MACH_MSG_TIMEOUT_NONE		((mach_msg_timeout_t) 0)
+
+/*
+ *  The kernel uses MACH_MSGH_BITS_COMPLEX as a hint.  If it isn't on, it
+ *  assumes the body of the message doesn't contain port rights or OOL
+ *  data.  The field is set in received messages.  A user task must
+ *  use caution in interpreting the body of a message if the bit isn't
+ *  on, because the mach_msg_type's in the body might "lie" about the
+ *  contents.  If the bit isn't on, but the mach_msg_types
+ *  in the body specify rights or OOL data, the behavior is undefined.
+ *  (Ie, an error may or may not be produced.)
+ *
+ *  The value of MACH_MSGH_BITS_REMOTE determines the interpretation
+ *  of the msgh_remote_port field.  It is handled like a msgt_name.
+ *
+ *  The value of MACH_MSGH_BITS_LOCAL determines the interpretation
+ *  of the msgh_local_port field.  It is handled like a msgt_name.
+ *
+ *  MACH_MSGH_BITS() combines two MACH_MSG_TYPE_* values, for the remote
+ *  and local fields, into a single value suitable for msgh_bits.
+ *
+ *  MACH_MSGH_BITS_CIRCULAR should be zero; is is used internally.
+ *
+ *  The unused bits should be zero and are reserved for the kernel
+ *  or for future interface expansion.
+ */
+
+#define MACH_MSGH_BITS_ZERO		0x00000000
+#define MACH_MSGH_BITS_REMOTE_MASK	0x000000ff
+#define MACH_MSGH_BITS_LOCAL_MASK	0x0000ff00
+#define MACH_MSGH_BITS_COMPLEX		0x80000000U
+#define MACH_MSGH_BITS_USER             0x8000ffffU
+
+#define	MACH_MSGH_BITS_CIRCULAR		0x40000000	/* internal use only */
+#define	MACH_MSGH_BITS_USED		0xc000ffffU
+
+#define	MACH_MSGH_BITS_PORTS_MASK				\
+		(MACH_MSGH_BITS_REMOTE_MASK|MACH_MSGH_BITS_LOCAL_MASK)
+
+#define MACH_MSGH_BITS(remote, local)				\
+		((remote) | ((local) << 8))
+#define	MACH_MSGH_BITS_REMOTE(bits)				\
+		((bits) & MACH_MSGH_BITS_REMOTE_MASK)
+#define	MACH_MSGH_BITS_LOCAL(bits)				\
+		(((bits) & MACH_MSGH_BITS_LOCAL_MASK) >> 8)
+#define	MACH_MSGH_BITS_PORTS(bits)				\
+		((bits) & MACH_MSGH_BITS_PORTS_MASK)
+#define	MACH_MSGH_BITS_OTHER(bits)				\
+		((bits) &~ MACH_MSGH_BITS_PORTS_MASK)
+
+/*
+ *  Every message starts with a message header.
+ *  Following the message header, if the message is complex, are a count
+ *  of type descriptors and the type descriptors themselves 
+ *  (mach_msg_descriptor_t). The size of the message must be specified in 
+ *  bytes, and includes the message header, descriptor count, descriptors, 
+ *  and inline data.
+ *
+ *  The msgh_remote_port field specifies the destination of the message.
+ *  It must specify a valid send or send-once right for a port.
+ *
+ *  The msgh_local_port field specifies a "reply port".  Normally,
+ *  This field carries a send-once right that the receiver will use
+ *  to reply to the message.  It may carry the values MACH_PORT_NULL,
+ *  MACH_PORT_DEAD, a send-once right, or a send right.
+ *
+ *  The msgh_seqno field carries a sequence number associated with the
+ *  received-from port.  A port's sequence number is incremented every
+ *  time a message is received from it.  In sent messages, the field's
+ *  value is ignored.
+ *
+ *  The msgh_id field is uninterpreted by the message primitives.
+ *  It normally carries information specifying the format
+ *  or meaning of the message.
+ */
+
+typedef unsigned int mach_msg_bits_t;
+typedef	natural_t mach_msg_size_t;
+typedef integer_t mach_msg_id_t;
+
+
+#define MACH_MSG_SIZE_NULL (mach_msg_size_t *) 0
+
+typedef unsigned int mach_msg_type_name_t;
+
+#define MACH_MSG_TYPE_MOVE_RECEIVE	16	/* Must hold receive rights */
+#define MACH_MSG_TYPE_MOVE_SEND		17	/* Must hold send rights */
+#define MACH_MSG_TYPE_MOVE_SEND_ONCE	18	/* Must hold sendonce rights */
+#define MACH_MSG_TYPE_COPY_SEND		19	/* Must hold send rights */
+#define MACH_MSG_TYPE_MAKE_SEND		20	/* Must hold receive rights */
+#define MACH_MSG_TYPE_MAKE_SEND_ONCE	21	/* Must hold receive rights */
+#define MACH_MSG_TYPE_COPY_RECEIVE	22	/* Must hold receive rights */
+
+typedef unsigned int mach_msg_copy_options_t;
+
+#define MACH_MSG_PHYSICAL_COPY		0
+#define MACH_MSG_VIRTUAL_COPY   	1
+#define MACH_MSG_ALLOCATE		2
+#define MACH_MSG_OVERWRITE		3
+#ifdef  MACH_KERNEL
+#define MACH_MSG_KALLOC_COPY_T		4
+#endif  /* MACH_KERNEL */
+
+/*
+ * In a complex mach message, the mach_msg_header_t is followed by 
+ * a descriptor count, then an array of that number of descriptors 
+ * (mach_msg_*_descriptor_t). The type field of mach_msg_type_descriptor_t
+ * (which any descriptor can be cast to) indicates the flavor of the
+ * descriptor.
+ *
+ * Note that in LP64, the various types of descriptors are no longer all
+ * the same size as mach_msg_descriptor_t, so the array cannot be indexed 
+ * as expected.
+ */
+
+typedef unsigned int mach_msg_descriptor_type_t;
+
+#define MACH_MSG_PORT_DESCRIPTOR 		0
+#define MACH_MSG_OOL_DESCRIPTOR  		1
+#define MACH_MSG_OOL_PORTS_DESCRIPTOR 		2
+#define MACH_MSG_OOL_VOLATILE_DESCRIPTOR  	3
+
+#pragma pack(4)
+
+typedef struct
+{
+  natural_t			pad1;
+  mach_msg_size_t		pad2;
+  unsigned int			pad3 : 24;
+  mach_msg_descriptor_type_t	type : 8;
+} mach_msg_type_descriptor_t;
+
+typedef struct
+{
+  mach_port_t			name;
+#if !(defined(KERNEL) && defined(__LP64__))
+// Pad to 8 bytes everywhere except the K64 kernel where mach_port_t is 8 bytes
+  mach_msg_size_t		pad1;
+#endif
+  unsigned int			pad2 : 16;
+  mach_msg_type_name_t		disposition : 8;
+  mach_msg_descriptor_type_t	type : 8;
+} mach_msg_port_descriptor_t;
+
+typedef struct
+{
+  uint32_t			address;
+  mach_msg_size_t       	size;
+  boolean_t     		deallocate: 8;
+  mach_msg_copy_options_t       copy: 8;
+  unsigned int     		pad1: 8;
+  mach_msg_descriptor_type_t    type: 8;
+} mach_msg_ool_descriptor32_t;
+
+typedef struct
+{
+  uint64_t			address;
+  boolean_t     		deallocate: 8;
+  mach_msg_copy_options_t       copy: 8;
+  unsigned int     		pad1: 8;
+  mach_msg_descriptor_type_t    type: 8;
+  mach_msg_size_t       	size;
+} mach_msg_ool_descriptor64_t;
+
+typedef struct
+{
+  void*				address;
+#if !defined(__LP64__)
+  mach_msg_size_t       	size;
+#endif
+  boolean_t     		deallocate: 8;
+  mach_msg_copy_options_t       copy: 8;
+  unsigned int     		pad1: 8;
+  mach_msg_descriptor_type_t    type: 8;
+#if defined(__LP64__)
+  mach_msg_size_t       	size;
+#endif
+#if defined(KERNEL) && !defined(__LP64__)
+  uint32_t          pad_end;
+#endif
+} mach_msg_ool_descriptor_t;
+
+typedef struct
+{
+  uint32_t			address;
+  mach_msg_size_t		count;
+  boolean_t     		deallocate: 8;
+  mach_msg_copy_options_t       copy: 8;
+  mach_msg_type_name_t		disposition : 8;
+  mach_msg_descriptor_type_t	type : 8;
+} mach_msg_ool_ports_descriptor32_t;
+
+typedef struct
+{
+  uint64_t			address;
+  boolean_t     		deallocate: 8;
+  mach_msg_copy_options_t       copy: 8;
+  mach_msg_type_name_t		disposition : 8;
+  mach_msg_descriptor_type_t	type : 8;
+  mach_msg_size_t		count;
+} mach_msg_ool_ports_descriptor64_t;
+
+typedef struct
+{
+  void*				address;
+#if !defined(__LP64__)
+  mach_msg_size_t		count;
+#endif
+  boolean_t     		deallocate: 8;
+  mach_msg_copy_options_t       copy: 8;
+  mach_msg_type_name_t		disposition : 8;
+  mach_msg_descriptor_type_t	type : 8;
+#if defined(__LP64__)
+  mach_msg_size_t		count;
+#endif
+#if defined(KERNEL) && !defined(__LP64__)
+  uint32_t          pad_end;
+#endif
+} mach_msg_ool_ports_descriptor_t;
+
+/*
+ * LP64support - This union definition is not really
+ * appropriate in LP64 mode because not all descriptors
+ * are of the same size in that environment.
+ */
+#if defined(__LP64__) && defined(KERNEL)
+typedef union
+{
+  mach_msg_port_descriptor_t		port;
+  mach_msg_ool_descriptor32_t		out_of_line;
+  mach_msg_ool_ports_descriptor32_t	ool_ports;
+  mach_msg_type_descriptor_t		type;
+} mach_msg_descriptor_t;
+#else
+typedef union
+{
+  mach_msg_port_descriptor_t		port;
+  mach_msg_ool_descriptor_t		out_of_line;
+  mach_msg_ool_ports_descriptor_t	ool_ports;
+  mach_msg_type_descriptor_t		type;
+} mach_msg_descriptor_t;
+#endif
+
+typedef struct
+{
+        mach_msg_size_t msgh_descriptor_count;
+} mach_msg_body_t;
+
+#define MACH_MSG_BODY_NULL (mach_msg_body_t *) 0
+#define MACH_MSG_DESCRIPTOR_NULL (mach_msg_descriptor_t *) 0
+
+typedef	struct 
+{
+  mach_msg_bits_t	msgh_bits;
+  mach_msg_size_t	msgh_size;
+  mach_port_t		msgh_remote_port;
+  mach_port_t		msgh_local_port;
+  mach_msg_size_t 	msgh_reserved;
+  mach_msg_id_t		msgh_id;
+} mach_msg_header_t;
+
+#define MACH_MSG_NULL (mach_msg_header_t *) 0
+
+typedef struct
+{
+        mach_msg_header_t       header;
+        mach_msg_body_t         body;
+} mach_msg_base_t;
+
+typedef	unsigned int mach_msg_trailer_type_t;
+
+#define	MACH_MSG_TRAILER_FORMAT_0	0
+
+typedef	unsigned int mach_msg_trailer_size_t;
+
+typedef struct 
+{
+  mach_msg_trailer_type_t	msgh_trailer_type;
+  mach_msg_trailer_size_t	msgh_trailer_size;
+} mach_msg_trailer_t;
+
+typedef struct
+{
+  mach_msg_trailer_type_t       msgh_trailer_type;
+  mach_msg_trailer_size_t       msgh_trailer_size;
+  mach_port_seqno_t             msgh_seqno;
+} mach_msg_seqno_trailer_t;
+
+typedef struct
+{
+  unsigned int			val[2];
+} security_token_t;
+
+typedef struct 
+{
+  mach_msg_trailer_type_t	msgh_trailer_type;
+  mach_msg_trailer_size_t	msgh_trailer_size;
+  mach_port_seqno_t		msgh_seqno;
+  security_token_t		msgh_sender;
+} mach_msg_security_trailer_t;
+
+/*
+ * The audit token is an opaque token which identifies
+ * Mach tasks and senders of Mach messages as subjects
+ * to the BSM audit system.  Only the appropriate BSM
+ * library routines should be used to interpret the
+ * contents of the audit token as the representation
+ * of the subject identity within the token may change
+ * over time.
+ */
+typedef struct
+{
+  unsigned int			val[8];
+} audit_token_t;
+
+typedef struct 
+{
+  mach_msg_trailer_type_t	msgh_trailer_type;
+  mach_msg_trailer_size_t	msgh_trailer_size;
+  mach_port_seqno_t		msgh_seqno;
+  security_token_t		msgh_sender;
+  audit_token_t			msgh_audit;
+} mach_msg_audit_trailer_t;
+
+typedef struct 
+{
+  mach_msg_trailer_type_t	msgh_trailer_type;
+  mach_msg_trailer_size_t	msgh_trailer_size;
+  mach_port_seqno_t		msgh_seqno;
+  security_token_t		msgh_sender;
+  audit_token_t			msgh_audit;
+  mach_vm_address_t		msgh_context;
+} mach_msg_context_trailer_t;
+
+
+typedef struct
+{
+  mach_port_name_t sender;
+} msg_labels_t;
+
+/* 
+   Trailer type to pass MAC policy label info as a mach message trailer.
+   
+*/
+
+typedef struct
+{
+  mach_msg_trailer_type_t       msgh_trailer_type;
+  mach_msg_trailer_size_t       msgh_trailer_size;
+  mach_port_seqno_t             msgh_seqno;
+  security_token_t              msgh_sender;
+  audit_token_t                 msgh_audit;
+  mach_vm_address_t             msgh_context;
+  int				msgh_ad;
+  msg_labels_t                  msgh_labels;
+} mach_msg_mac_trailer_t;
+
+#define MACH_MSG_TRAILER_MINIMUM_SIZE  sizeof(mach_msg_trailer_t)
+
+/*
+ * These values can change from release to release - but clearly
+ * code cannot request additional trailer elements one was not
+ * compiled to understand.  Therefore, it is safe to use this
+ * constant when the same module specified the receive options.
+ * Otherwise, you run the risk that the options requested by
+ * another module may exceed the local modules notion of
+ * MAX_TRAILER_SIZE.
+ */
+typedef mach_msg_mac_trailer_t mach_msg_max_trailer_t;
+#define MAX_TRAILER_SIZE ((mach_msg_size_t)sizeof(mach_msg_max_trailer_t))
+
+/*
+ * Legacy requirements keep us from ever updating these defines (even
+ * when the format_0 trailers gain new option data fields in the future).
+ * Therefore, they shouldn't be used going forward.  Instead, the sizes
+ * should be compared against the specific element size requested using
+ * REQUESTED_TRAILER_SIZE.
+ */
+typedef mach_msg_security_trailer_t mach_msg_format_0_trailer_t;
+
+/*typedef mach_msg_mac_trailer_t mach_msg_format_0_trailer_t;
+*/
+
+#define MACH_MSG_TRAILER_FORMAT_0_SIZE sizeof(mach_msg_format_0_trailer_t)
+
+#define   KERNEL_SECURITY_TOKEN_VALUE  { {0, 1} }
+extern security_token_t KERNEL_SECURITY_TOKEN;
+
+#define   KERNEL_AUDIT_TOKEN_VALUE  { {0, 0, 0, 0, 0, 0, 0, 0} }
+extern audit_token_t KERNEL_AUDIT_TOKEN;
+
+typedef	integer_t mach_msg_options_t;
+
+typedef struct
+{
+  mach_msg_header_t	header;
+} mach_msg_empty_send_t;
+
+typedef struct
+{
+  mach_msg_header_t	header;
+  mach_msg_trailer_t	trailer;
+} mach_msg_empty_rcv_t;
+
+typedef union
+{
+  mach_msg_empty_send_t	send;
+  mach_msg_empty_rcv_t	rcv;
+} mach_msg_empty_t;
+
+#pragma pack()
+
+/* utility to round the message size - will become machine dependent */
+#define round_msg(x)	(((mach_msg_size_t)(x) + sizeof (natural_t) - 1) & \
+				~(sizeof (natural_t) - 1))
+
+/*
+ *  There is no fixed upper bound to the size of Mach messages.
+ */
+
+#define	MACH_MSG_SIZE_MAX	((mach_msg_size_t) ~0)
+
+/*
+ *  Compatibility definitions, for code written
+ *  when there was a msgh_kind instead of msgh_seqno.
+ */
+#define MACH_MSGH_KIND_NORMAL		0x00000000
+#define MACH_MSGH_KIND_NOTIFICATION	0x00000001
+#define	msgh_kind			msgh_seqno
+#define mach_msg_kind_t			mach_port_seqno_t
+
+typedef natural_t mach_msg_type_size_t;
+typedef natural_t mach_msg_type_number_t;
+
+/*
+ *  Values received/carried in messages.  Tells the receiver what
+ *  sort of port right he now has.
+ *
+ *  MACH_MSG_TYPE_PORT_NAME is used to transfer a port name
+ *  which should remain uninterpreted by the kernel.  (Port rights
+ *  are not transferred, just the port name.)
+ */
+
+#define MACH_MSG_TYPE_PORT_NONE		0
+
+#define MACH_MSG_TYPE_PORT_NAME		15
+#define MACH_MSG_TYPE_PORT_RECEIVE	MACH_MSG_TYPE_MOVE_RECEIVE
+#define MACH_MSG_TYPE_PORT_SEND		MACH_MSG_TYPE_MOVE_SEND
+#define MACH_MSG_TYPE_PORT_SEND_ONCE	MACH_MSG_TYPE_MOVE_SEND_ONCE
+
+#define MACH_MSG_TYPE_LAST		22		/* Last assigned */
+
+/*
+ *  A dummy value.  Mostly used to indicate that the actual value
+ *  will be filled in later, dynamically.
+ */
+
+#define MACH_MSG_TYPE_POLYMORPHIC	((mach_msg_type_name_t) -1)
+
+/*
+ *	Is a given item a port type?
+ */
+
+#define MACH_MSG_TYPE_PORT_ANY(x)			\
+	(((x) >= MACH_MSG_TYPE_MOVE_RECEIVE) &&		\
+	 ((x) <= MACH_MSG_TYPE_MAKE_SEND_ONCE))
+
+#define	MACH_MSG_TYPE_PORT_ANY_SEND(x)			\
+	(((x) >= MACH_MSG_TYPE_MOVE_SEND) &&		\
+	 ((x) <= MACH_MSG_TYPE_MAKE_SEND_ONCE))
+
+#define	MACH_MSG_TYPE_PORT_ANY_RIGHT(x)			\
+	(((x) >= MACH_MSG_TYPE_MOVE_RECEIVE) &&		\
+	 ((x) <= MACH_MSG_TYPE_MOVE_SEND_ONCE))
+
+typedef integer_t mach_msg_option_t;
+
+#define MACH_MSG_OPTION_NONE	0x00000000
+
+#define	MACH_SEND_MSG		0x00000001
+#define	MACH_RCV_MSG		0x00000002
+#define MACH_RCV_LARGE		0x00000004
+
+#define MACH_SEND_TIMEOUT	0x00000010
+#define MACH_SEND_INTERRUPT	0x00000040	/* libmach implements */
+#define MACH_SEND_NOTIFY	0x00000080	/* arm send-possible notify */
+#define MACH_SEND_ALWAYS	0x00010000	/* internal use only */
+#define MACH_SEND_TRAILER	0x00020000	
+
+#define MACH_RCV_TIMEOUT	0x00000100
+#define MACH_RCV_NOTIFY		0x00000200	/* reserved - legacy */
+#define MACH_RCV_INTERRUPT	0x00000400	/* libmach implements */
+#define MACH_RCV_OVERWRITE	0x00001000
+
+/* 
+ * NOTE: a 0x00------ RCV mask implies to ask for
+ * a MACH_MSG_TRAILER_FORMAT_0 with 0 Elements, 
+ * which is equivalent to a mach_msg_trailer_t.
+ *
+ * XXXMAC: unlike the rest of the MACH_RCV_* flags, MACH_RCV_TRAILER_LABELS
+ * needs its own private bit since we only calculate its fields when absolutely 
+ * required.
+ */
+#define MACH_RCV_TRAILER_NULL   0
+#define MACH_RCV_TRAILER_SEQNO  1
+#define MACH_RCV_TRAILER_SENDER 2
+#define MACH_RCV_TRAILER_AUDIT  3
+#define MACH_RCV_TRAILER_CTX    4
+#define MACH_RCV_TRAILER_AV     7
+#define MACH_RCV_TRAILER_LABELS 8
+
+#define MACH_RCV_TRAILER_TYPE(x)     (((x) & 0xf) << 28) 
+#define MACH_RCV_TRAILER_ELEMENTS(x) (((x) & 0xf) << 24)  
+#define MACH_RCV_TRAILER_MASK 	     ((0xff << 24))
+
+#define GET_RCV_ELEMENTS(y) (((y) >> 24) & 0xf)
+
+/* 
+ * XXXMAC: note that in the case of MACH_RCV_TRAILER_LABELS, 
+ * we just fall through to mach_msg_max_trailer_t.
+ * This is correct behavior since mach_msg_max_trailer_t is defined as
+ * mac_msg_mac_trailer_t which is used for the LABELS trailer.
+ * It also makes things work properly if MACH_RCV_TRAILER_LABELS is ORed 
+ * with one of the other options.
+ */
+#define REQUESTED_TRAILER_SIZE(y) 				\
+	((mach_msg_trailer_size_t)				\
+	 ((GET_RCV_ELEMENTS(y) == MACH_RCV_TRAILER_NULL) ?	\
+	  sizeof(mach_msg_trailer_t) :				\
+	  ((GET_RCV_ELEMENTS(y) == MACH_RCV_TRAILER_SEQNO) ?	\
+	   sizeof(mach_msg_seqno_trailer_t) :			\
+	  ((GET_RCV_ELEMENTS(y) == MACH_RCV_TRAILER_SENDER) ?	\
+	   sizeof(mach_msg_security_trailer_t) :		\
+	   ((GET_RCV_ELEMENTS(y) == MACH_RCV_TRAILER_AUDIT) ?	\
+	    sizeof(mach_msg_audit_trailer_t) :      		\
+	    ((GET_RCV_ELEMENTS(y) == MACH_RCV_TRAILER_CTX) ?	\
+	     sizeof(mach_msg_context_trailer_t) :      		\
+	     ((GET_RCV_ELEMENTS(y) == MACH_RCV_TRAILER_AV) ?	\
+	      sizeof(mach_msg_mac_trailer_t) :      		\
+	     sizeof(mach_msg_max_trailer_t))))))))
+
+/*
+ *  Much code assumes that mach_msg_return_t == kern_return_t.
+ *  This definition is useful for descriptive purposes.
+ *
+ *  See <mach/error.h> for the format of error codes.
+ *  IPC errors are system 4.  Send errors are subsystem 0;
+ *  receive errors are subsystem 1.  The code field is always non-zero.
+ *  The high bits of the code field communicate extra information
+ *  for some error codes.  MACH_MSG_MASK masks off these special bits.
+ */
+
+typedef kern_return_t mach_msg_return_t;
+
+#define MACH_MSG_SUCCESS		0x00000000
+
+
+#define	MACH_MSG_MASK			0x00003e00
+		/* All special error code bits defined below. */
+#define	MACH_MSG_IPC_SPACE		0x00002000
+		/* No room in IPC name space for another capability name. */
+#define	MACH_MSG_VM_SPACE		0x00001000
+		/* No room in VM address space for out-of-line memory. */
+#define	MACH_MSG_IPC_KERNEL		0x00000800
+		/* Kernel resource shortage handling an IPC capability. */
+#define	MACH_MSG_VM_KERNEL		0x00000400
+		/* Kernel resource shortage handling out-of-line memory. */
+
+#define MACH_SEND_IN_PROGRESS		0x10000001
+		/* Thread is waiting to send.  (Internal use only.) */
+#define MACH_SEND_INVALID_DATA		0x10000002
+		/* Bogus in-line data. */
+#define MACH_SEND_INVALID_DEST		0x10000003
+		/* Bogus destination port. */
+#define MACH_SEND_TIMED_OUT		0x10000004
+		/* Message not sent before timeout expired. */
+#define MACH_SEND_INTERRUPTED		0x10000007
+		/* Software interrupt. */
+#define MACH_SEND_MSG_TOO_SMALL		0x10000008
+		/* Data doesn't contain a complete message. */
+#define MACH_SEND_INVALID_REPLY		0x10000009
+		/* Bogus reply port. */
+#define MACH_SEND_INVALID_RIGHT		0x1000000a
+		/* Bogus port rights in the message body. */
+#define MACH_SEND_INVALID_NOTIFY	0x1000000b
+		/* Bogus notify port argument. */
+#define MACH_SEND_INVALID_MEMORY	0x1000000c
+		/* Invalid out-of-line memory pointer. */
+#define MACH_SEND_NO_BUFFER		0x1000000d
+		/* No message buffer is available. */
+#define MACH_SEND_TOO_LARGE		0x1000000e
+		/* Send is too large for port */
+#define MACH_SEND_INVALID_TYPE		0x1000000f
+		/* Invalid msg-type specification. */
+#define MACH_SEND_INVALID_HEADER	0x10000010
+		/* A field in the header had a bad value. */
+#define MACH_SEND_INVALID_TRAILER	0x10000011
+		/* The trailer to be sent does not match kernel format. */
+#define MACH_SEND_INVALID_RT_OOL_SIZE	0x10000015
+		/* compatibility: no longer a returned error */
+
+#define MACH_RCV_IN_PROGRESS		0x10004001
+		/* Thread is waiting for receive.  (Internal use only.) */
+#define MACH_RCV_INVALID_NAME		0x10004002
+		/* Bogus name for receive port/port-set. */
+#define MACH_RCV_TIMED_OUT		0x10004003
+		/* Didn't get a message within the timeout value. */
+#define MACH_RCV_TOO_LARGE		0x10004004
+		/* Message buffer is not large enough for inline data. */
+#define MACH_RCV_INTERRUPTED		0x10004005
+		/* Software interrupt. */
+#define MACH_RCV_PORT_CHANGED		0x10004006
+		/* compatibility: no longer a returned error */
+#define MACH_RCV_INVALID_NOTIFY		0x10004007
+		/* Bogus notify port argument. */
+#define MACH_RCV_INVALID_DATA		0x10004008
+		/* Bogus message buffer for inline data. */
+#define MACH_RCV_PORT_DIED		0x10004009
+		/* Port/set was sent away/died during receive. */
+#define	MACH_RCV_IN_SET			0x1000400a
+		/* compatibility: no longer a returned error */
+#define	MACH_RCV_HEADER_ERROR		0x1000400b
+		/* Error receiving message header.  See special bits. */
+#define	MACH_RCV_BODY_ERROR		0x1000400c
+		/* Error receiving message body.  See special bits. */
+#define	MACH_RCV_INVALID_TYPE		0x1000400d
+		/* Invalid msg-type specification in scatter list. */
+#define	MACH_RCV_SCATTER_SMALL		0x1000400e
+		/* Out-of-line overwrite region is not large enough */
+#define MACH_RCV_INVALID_TRAILER	0x1000400f
+		/* trailer type or number of trailer elements not supported */
+#define MACH_RCV_IN_PROGRESS_TIMED      0x10004011
+                /* Waiting for receive with timeout. (Internal use only.) */
+
+
+__BEGIN_DECLS
+
+/*
+ *	Routine:	mach_msg_overwrite
+ *	Purpose:
+ *		Send and/or receive a message.  If the message operation
+ *		is interrupted, and the user did not request an indication
+ *		of that fact, then restart the appropriate parts of the
+ *		operation silently (trap version does not restart).
+ *
+ *		Distinct send and receive buffers may be specified.  If
+ *		no separate receive buffer is specified, the msg parameter
+ *		will be used for both send and receive operations.
+ *
+ *		In addition to a distinct receive buffer, that buffer may
+ *		already contain scatter control information to direct the
+ *		receiving of the message.
+ */
+
+extern mach_msg_return_t	mach_msg_overwrite(
+					mach_msg_header_t *msg,
+					mach_msg_option_t option,
+					mach_msg_size_t send_size,
+					mach_msg_size_t rcv_size,
+					mach_port_name_t rcv_name,
+					mach_msg_timeout_t timeout,
+					mach_port_name_t notify,
+					mach_msg_header_t *rcv_msg,
+					mach_msg_size_t rcv_limit);
+
+
+/*
+ *	Routine:	mach_msg
+ *	Purpose:
+ *		Send and/or receive a message.  If the message operation
+ *		is interrupted, and the user did not request an indication
+ *		of that fact, then restart the appropriate parts of the
+ *		operation silently (trap version does not restart).
+ */
+extern mach_msg_return_t	mach_msg(
+					mach_msg_header_t *msg,
+					mach_msg_option_t option,
+					mach_msg_size_t send_size,
+					mach_msg_size_t rcv_size,
+					mach_port_name_t rcv_name,
+					mach_msg_timeout_t timeout,
+					mach_port_name_t notify);
+
+
+__END_DECLS
+
+#endif	/* _MACH_MESSAGE_H_ */
+
diff -urN cctools-806-old/include/mach/mig_errors.h cctools-806/include/mach/mig_errors.h
--- cctools-806-old/include/mach/mig_errors.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mig_errors.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,124 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ * Mach Interface Generator errors
+ *
+ */
+
+#ifndef	_MACH_MIG_ERRORS_H_
+#define _MACH_MIG_ERRORS_H_
+
+#include <mach/mig.h>
+#include <mach/ndr.h>
+#include <mach/message.h>
+#include <mach/kern_return.h>
+
+#include <sys/cdefs.h>
+
+/*
+ *	These error codes should be specified as system 4, subsytem 2.
+ *	But alas backwards compatibility makes that impossible.
+ *	The problem is old clients of new servers (eg, the kernel)
+ *	which get strange large error codes when there is a Mig problem
+ *	in the server.  Unfortunately, the IPC system doesn't have
+ *	the knowledge to convert the codes in this situation.
+ */
+
+#define MIG_TYPE_ERROR		-300	/* client type check failure */
+#define MIG_REPLY_MISMATCH	-301	/* wrong reply message ID */
+#define MIG_REMOTE_ERROR	-302	/* server detected error */
+#define MIG_BAD_ID		-303	/* bad request message ID */
+#define MIG_BAD_ARGUMENTS	-304	/* server type check failure */
+#define MIG_NO_REPLY		-305	/* no reply should be send */
+#define MIG_EXCEPTION		-306	/* server raised exception */
+#define MIG_ARRAY_TOO_LARGE	-307	/* array not large enough */
+#define MIG_SERVER_DIED		-308	/* server died */
+#define MIG_TRAILER_ERROR       -309    /* trailer has an unknown format */
+
+/*
+ *	Whenever MIG detects an error, it sends back a generic
+ *	mig_reply_error_t format message.  Clients must accept
+ *	these in addition to the expected reply message format.
+ */
+#pragma pack(4)
+typedef struct {
+	mach_msg_header_t	Head;
+	NDR_record_t		NDR;
+	kern_return_t		RetCode;
+} mig_reply_error_t;
+#pragma pack()
+
+
+__BEGIN_DECLS
+
+#if !defined(__NDR_convert__mig_reply_error_t__defined)
+#define __NDR_convert__mig_reply_error_t__defined
+
+static __inline__ void
+__NDR_convert__mig_reply_error_t(mig_reply_error_t *x)
+{
+#if defined(__NDR_convert__int_rep__kern_return_t__defined)
+	if (x->NDR.int_rep != NDR_record.int_rep)
+		__NDR_convert__int_rep__kern_return_t(&x->RetCode, x->NDR.int_rep);
+#endif /* __NDR_convert__int_rep__kern_return_t__defined */
+}
+#endif /* !defined(__NDR_convert__mig_reply_error_t__defined) */
+
+__END_DECLS
+
+#endif	/* _MACH_MIG_ERRORS_H_ */
diff -urN cctools-806-old/include/mach/mig.h cctools-806/include/mach/mig.h
--- cctools-806-old/include/mach/mig.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/mig.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,174 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+/*
+ * Mach MIG Subsystem Interfaces
+ */
+
+#ifndef	_MACH_MIG_H_
+#define _MACH_MIG_H_
+
+#include <stdint.h>
+#include <mach/port.h>
+#include <mach/message.h>
+#include <mach/vm_types.h>
+
+#include <sys/cdefs.h>
+
+#if defined(MACH_KERNEL)
+
+#if defined(BSMALL_LATER)
+/* Really small configurations don't need type checking */
+#define __MigTypeCheck 0
+#else
+/* Turn MIG type checking on by default for kernel */
+#define __MigTypeCheck 1
+#endif
+#define __MigKernelSpecificCode 1
+#define _MIG_KERNEL_SPECIFIC_CODE_ 1
+
+/* Otherwise check legacy setting (temporary) */
+#elif defined(TypeCheck)  
+
+#define __MigTypeCheck TypeCheck
+
+#elif !defined(__MigTypeCheck)
+
+/* otherwise, default MIG type checking on - except in small configurations */
+#if defined(BSMALL)
+#define __MigTypeCheck 0
+#else
+#define __MigTypeCheck 1
+#endif
+
+#endif /* !defined(__MigTypeCheck) */
+
+/*
+ * Pack MIG message structs.
+ * This is an indicator of the need to view shared structs in a
+ * binary-compatible format - and MIG message structs are no different.
+ */
+#define __MigPackStructs 1
+
+/*
+ * Definition for MIG-generated server stub routines.  These routines
+ * unpack the request message, call the server procedure, and pack the
+ * reply message.
+ */
+typedef void	(*mig_stub_routine_t) (mach_msg_header_t *InHeadP,
+				       mach_msg_header_t *OutHeadP);
+
+typedef mig_stub_routine_t mig_routine_t;
+
+/*
+ * Definition for MIG-generated server routine.  This routine takes a
+ * message, and returns the appropriate stub function for handling that
+ * message.
+ */
+typedef mig_routine_t (*mig_server_routine_t) (mach_msg_header_t *InHeadP);
+
+/*
+ * Generic definition for implementation routines.  These routines do
+ * the real work associated with this request.  This generic type is
+ * used for keeping the pointers in the subsystem array.
+ */
+typedef kern_return_t   (*mig_impl_routine_t)(void);
+
+typedef mach_msg_type_descriptor_t routine_arg_descriptor;
+typedef mach_msg_type_descriptor_t *routine_arg_descriptor_t;
+typedef mach_msg_type_descriptor_t *mig_routine_arg_descriptor_t;
+
+#define MIG_ROUTINE_ARG_DESCRIPTOR_NULL ((mig_routine_arg_descriptor_t)0)
+
+struct routine_descriptor {
+	mig_impl_routine_t	impl_routine;	/* Server work func pointer   */
+	mig_stub_routine_t	stub_routine;	/* Unmarshalling func pointer */
+	unsigned int		argc;			/* Number of argument words   */
+	unsigned int		descr_count;	/* Number complex descriptors */
+	routine_arg_descriptor_t
+						arg_descr;		/* pointer to descriptor array*/
+	unsigned int		max_reply_msg;	/* Max size for reply msg     */
+};
+typedef struct routine_descriptor *routine_descriptor_t;
+
+typedef struct routine_descriptor mig_routine_descriptor;
+typedef mig_routine_descriptor *mig_routine_descriptor_t;
+
+#define MIG_ROUTINE_DESCRIPTOR_NULL ((mig_routine_descriptor_t)0)
+
+typedef struct mig_subsystem {
+	mig_server_routine_t server;		/* pointer to demux routine	*/
+	mach_msg_id_t		 start;			/* Min routine number	    */
+	mach_msg_id_t		 end;			/* Max routine number + 1   */
+	mach_msg_size_t		 maxsize;		/* Max reply message size   */
+	vm_address_t		 reserved;		/* reserved for MIG use	    */
+	mig_routine_descriptor
+						 routine[1];	/* Routine descriptor array */
+} *mig_subsystem_t;
+
+#define MIG_SUBSYSTEM_NULL		((mig_subsystem_t)0)
+
+typedef struct mig_symtab {
+	char				*ms_routine_name;
+	int					ms_routine_number;
+	void    			(*ms_routine)(void);	/* Since the functions in the
+					 							 * symbol table have unknown
+												 * signatures, this is the best
+					 							 * we can do...
+					 							 */
+} mig_symtab_t;
+
+
+__BEGIN_DECLS
+
+/* Client side reply port allocate */
+extern mach_port_t mig_get_reply_port(void);
+
+/* Client side reply port deallocate */
+extern void mig_dealloc_reply_port(mach_port_t reply_port);
+
+/* Client side reply port "deallocation" */
+extern void mig_put_reply_port(mach_port_t reply_port);
+
+/* Bounded string copy */
+extern int mig_strncpy(char	*dest, const char *src,	int	len);
+
+
+/* Allocate memory for out-of-line mig structures */
+extern void mig_allocate(vm_address_t *, vm_size_t);
+
+/* Deallocate memory used for out-of-line mig structures */
+extern void mig_deallocate(vm_address_t, vm_size_t);
+
+
+__END_DECLS
+
+#endif	/* _MACH_MIG_H_ */
diff -urN cctools-806-old/include/mach/ndr.h cctools-806/include/mach/ndr.h
--- cctools-806-old/include/mach/ndr.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ndr.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,207 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef _MACH_NDR_H_
+#define _MACH_NDR_H_
+
+#include <stdint.h>
+#include <sys/cdefs.h>
+
+typedef struct {
+    unsigned char       mig_vers;
+    unsigned char       if_vers;
+    unsigned char       reserved1;
+    unsigned char       mig_encoding;
+    unsigned char       int_rep;
+    unsigned char       char_rep;
+    unsigned char       float_rep;
+    unsigned char       reserved2;
+} NDR_record_t;
+
+/*
+ * MIG supported protocols for Network Data Representation
+ */
+#define  NDR_PROTOCOL_2_0      0
+
+/*
+ * NDR 2.0 format flag type definition and values.
+ */
+#define  NDR_INT_BIG_ENDIAN    0
+#define  NDR_INT_LITTLE_ENDIAN 1
+#define  NDR_FLOAT_IEEE        0
+#define  NDR_FLOAT_VAX         1
+#define  NDR_FLOAT_CRAY        2
+#define  NDR_FLOAT_IBM         3
+#define  NDR_CHAR_ASCII        0
+#define  NDR_CHAR_EBCDIC       1
+
+extern NDR_record_t NDR_record;
+
+#if defined(BSMALL)
+#define __NDR_convert__ 0
+#define __NDR_convert__int_rep__ 0
+#else
+#ifndef __NDR_convert__
+#define __NDR_convert__ 1
+#endif /* __NDR_convert__ */
+
+#ifndef __NDR_convert__int_rep__
+#define __NDR_convert__int_rep__ 1
+#endif /* __NDR_convert__int_rep__ */
+
+#endif /* defined(BSMALL) */
+
+#ifndef __NDR_convert__char_rep__
+#define __NDR_convert__char_rep__ 0
+#endif /* __NDR_convert__char_rep__ */
+
+#ifndef __NDR_convert__float_rep__
+#define __NDR_convert__float_rep__ 0
+#endif /* __NDR_convert__float_rep__ */
+
+#if __NDR_convert__
+
+#define __NDR_convert__NOOP		do ; while (0)
+#define __NDR_convert__UNKNOWN(s)	__NDR_convert__NOOP
+#define __NDR_convert__SINGLE(a, f, r)	do { r((a), (f)); } while (0)
+#define __NDR_convert__ARRAY(a, f, c, r) \
+	do { int __i__, __C__ = (c); \
+	for (__i__ = 0; __i__ < __C__; __i__++) \
+	r(&(a)[__i__], f); } while (0)
+#define __NDR_convert__2DARRAY(a, f, s, c, r) \
+	do { int __i__, __C__ = (c), __S__ = (s); \
+	for (__i__ = 0; __i__ < __C__; __i__++) \
+	r(&(a)[__i__ * __S__], f, __S__); } while (0)
+
+#if __NDR_convert__int_rep__
+
+#include <libkern/OSByteOrder.h>
+
+#define __NDR_READSWAP_assign(a, rs)	do { *(a) = rs(a); } while (0)
+
+#define __NDR_READSWAP__uint16_t(a) 	OSReadSwapInt16((void *)a, 0)
+#define __NDR_READSWAP__int16_t(a)	(int16_t)OSReadSwapInt16((void *)a, 0)
+#define __NDR_READSWAP__uint32_t(a) 	OSReadSwapInt32((void *)a, 0)
+#define __NDR_READSWAP__int32_t(a)	(int32_t)OSReadSwapInt32((void *)a, 0)
+#define __NDR_READSWAP__uint64_t(a)	OSReadSwapInt64((void *)a, 0)
+#define __NDR_READSWAP__int64_t(a)	(int64_t)OSReadSwapInt64((void *)a, 0)
+
+__BEGIN_DECLS
+
+static __inline__ float __NDR_READSWAP__float(float *argp) {
+	union {
+		float sv;
+		uint32_t ull;
+	} result;
+	result.ull = __NDR_READSWAP__uint32_t((uint32_t *)argp);
+	return result.sv;
+}
+
+static __inline__ double __NDR_READSWAP__double(double *argp) {
+	union {
+		double sv;
+		uint64_t ull;
+	} result;
+	result.ull = __NDR_READSWAP__uint64_t((uint64_t *)argp);
+	return result.sv;
+}
+
+__END_DECLS
+
+#define __NDR_convert__int_rep__int16_t__defined
+#define __NDR_convert__int_rep__int16_t(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__int16_t)
+
+#define __NDR_convert__int_rep__uint16_t__defined
+#define __NDR_convert__int_rep__uint16_t(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__uint16_t)
+
+#define __NDR_convert__int_rep__int32_t__defined
+#define __NDR_convert__int_rep__int32_t(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__int32_t)
+
+#define __NDR_convert__int_rep__uint32_t__defined
+#define __NDR_convert__int_rep__uint32_t(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__uint32_t)
+
+#define __NDR_convert__int_rep__int64_t__defined
+#define __NDR_convert__int_rep__int64_t(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__int64_t)
+
+#define __NDR_convert__int_rep__uint64_t__defined
+#define __NDR_convert__int_rep__uint64_t(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__uint64_t)
+
+#define __NDR_convert__int_rep__float__defined
+#define __NDR_convert__int_rep__float(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__float)
+
+#define __NDR_convert__int_rep__double__defined
+#define __NDR_convert__int_rep__double(v,f)		\
+	__NDR_READSWAP_assign(v, __NDR_READSWAP__double)
+
+#define __NDR_convert__int_rep__boolean_t__defined
+#define __NDR_convert__int_rep__boolean_t(v, f)		\
+	__NDR_convert__int_rep__int32_t(v,f)
+
+#define __NDR_convert__int_rep__kern_return_t__defined
+#define __NDR_convert__int_rep__kern_return_t(v,f)	\
+	__NDR_convert__int_rep__int32_t(v,f)
+
+#define __NDR_convert__int_rep__mach_port_name_t__defined
+#define __NDR_convert__int_rep__mach_port_name_t(v,f)	\
+	__NDR_convert__int_rep__uint32_t(v,f)
+
+#define __NDR_convert__int_rep__mach_msg_type_number_t__defined
+#define __NDR_convert__int_rep__mach_msg_type_number_t(v,f) \
+	__NDR_convert__int_rep__uint32_t(v,f)
+
+#endif /* __NDR_convert__int_rep__ */
+
+#if __NDR_convert__char_rep__
+
+#warning  NDR character representation conversions not implemented yet!
+#define __NDR_convert__char_rep__char(v,f)	__NDR_convert__NOOP
+#define __NDR_convert__char_rep__string(v,f,l)	__NDR_convert__NOOP
+
+#endif /* __NDR_convert__char_rep__ */
+
+#if __NDR_convert__float_rep__
+
+#warning  NDR floating point representation conversions not implemented yet!
+#define __NDR_convert__float_rep__float(v,f)	__NDR_convert__NOOP
+#define __NDR_convert__float_rep__double(v,f)	__NDR_convert__NOOP
+
+#endif /* __NDR_convert__float_rep__ */
+
+#endif /* __NDR_convert__ */
+
+#endif /* _MACH_NDR_H_ */
diff -urN cctools-806-old/include/mach/notify.defs cctools-806/include/mach/notify.defs
--- cctools-806-old/include/mach/notify.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/notify.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,134 @@
+/*
+ * Copyright (c) 2000-2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+subsystem 
+#if	KERNEL_USER
+	KernelUser
+#endif
+	notify 64;
+
+#include <mach/std_types.defs>
+
+#if	SEQNOS
+serverprefix do_seqnos_;
+serverdemux seqnos_notify_server;
+#else	/* !SEQNOS */
+serverprefix do_;
+serverdemux notify_server;
+#endif	/* SEQNOS */
+
+/* MACH_NOTIFY_FIRST: 0100 */
+skip;
+
+/* MACH_NOTIFY_PORT_DELETED: 0101 */
+simpleroutine mach_notify_port_deleted(
+		notify	: mach_port_move_send_once_t;
+#if	SEQNOS
+	msgseqno seqno	: mach_port_seqno_t;
+#endif	/* SEQNOS */
+		name	: mach_port_name_t);
+
+#if (KERNEL_USER | MACH_NOTIFY_SEND_POSSIBLE_EXPECTED)
+/* MACH_NOTIFY_SEND_POSSIBLE: 0102 */
+simpleroutine mach_notify_send_possible(
+		notify	: mach_port_move_send_once_t;
+#if	SEQNOS
+	msgseqno seqno	: mach_port_seqno_t;
+#endif	/* SEQNOS */
+		name	: mach_port_name_t);
+#else
+skip;
+#endif
+
+skip;	/* was NOTIFY_OWNERSHIP_RIGHTS: 0103 */
+
+skip;	/* was NOTIFY_RECEIVE_RIGHTS: 0104 */
+
+/* MACH_NOTIFY_PORT_DESTROYED: 0105 */
+simpleroutine mach_notify_port_destroyed(
+		notify	: mach_port_move_send_once_t;
+#if	SEQNOS
+	msgseqno seqno	: mach_port_seqno_t;
+#endif	/* SEQNOS */
+		rights	: mach_port_move_receive_t);
+
+/* MACH_NOTIFY_NO_SENDERS: 0106 */
+simpleroutine mach_notify_no_senders(
+		notify	: mach_port_move_send_once_t;
+#if	SEQNOS
+	msgseqno seqno	: mach_port_seqno_t;
+#endif	/* SEQNOS */
+		mscount	: mach_port_mscount_t);
+
+/* MACH_NOTIFY_SEND_ONCE: 0107 */
+simpleroutine mach_notify_send_once(
+		notify	: mach_port_move_send_once_t
+#if	SEQNOS
+;	msgseqno seqno	: mach_port_seqno_t
+#endif	/* SEQNOS */
+		);
+
+/* MACH_NOTIFY_DEAD_NAME: 0110 */
+simpleroutine mach_notify_dead_name(
+		notify	: mach_port_move_send_once_t;
+#if	SEQNOS
+	msgseqno seqno	: mach_port_seqno_t;
+#endif	/* SEQNOS */
+		name	: mach_port_name_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/notify.h cctools-806/include/mach/notify.h
--- cctools-806-old/include/mach/notify.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/notify.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,141 @@
+/*
+ * Copyright (c) 2000-2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/notify.h
+ *
+ *	Kernel notification message definitions.
+ */
+
+#ifndef	_MACH_NOTIFY_H_
+#define _MACH_NOTIFY_H_
+
+#include <mach/port.h>
+#include <mach/message.h>
+#include <mach/ndr.h>
+
+/*
+ *  An alternative specification of the notification interface
+ *  may be found in mach/notify.defs.
+ */
+
+#define MACH_NOTIFY_FIRST		0100
+#define MACH_NOTIFY_PORT_DELETED	(MACH_NOTIFY_FIRST + 001)
+			/* A send or send-once right was deleted. */
+#define MACH_NOTIFY_SEND_POSSIBLE	(MACH_NOTIFY_FIRST + 002)
+			/* Now possible to send using specified right */
+#define MACH_NOTIFY_PORT_DESTROYED	(MACH_NOTIFY_FIRST + 005)
+			/* A receive right was (would have been) deallocated */
+#define MACH_NOTIFY_NO_SENDERS		(MACH_NOTIFY_FIRST + 006)
+			/* Receive right has no extant send rights */
+#define MACH_NOTIFY_SEND_ONCE		(MACH_NOTIFY_FIRST + 007)
+			/* An extant send-once right died */
+#define MACH_NOTIFY_DEAD_NAME		(MACH_NOTIFY_FIRST + 010)
+			/* Send or send-once right died, leaving a dead-name */
+#define MACH_NOTIFY_LAST		(MACH_NOTIFY_FIRST + 015)
+
+typedef mach_port_t notify_port_t;
+
+/*
+ * Hard-coded message structures for receiving Mach port notification
+ * messages.  However, they are not actual large enough to receive 
+ * the largest trailers current exported by Mach IPC (so they cannot
+ * be used for space allocations in situations using these new larger
+ * trailers).  Instead, the MIG-generated server routines (and
+ * related prototypes should be used).
+ */
+typedef struct {
+    mach_msg_header_t	not_header;
+    NDR_record_t	NDR;
+    mach_port_name_t not_port;/* MACH_MSG_TYPE_PORT_NAME */
+    mach_msg_format_0_trailer_t trailer;
+} mach_port_deleted_notification_t;
+
+typedef struct {
+    mach_msg_header_t	not_header;
+    NDR_record_t	NDR;
+    mach_port_name_t not_port;/* MACH_MSG_TYPE_PORT_NAME */
+    mach_msg_format_0_trailer_t trailer;
+} mach_send_possible_notification_t;
+
+typedef struct {
+    mach_msg_header_t	not_header;
+    mach_msg_body_t	not_body;
+    mach_msg_port_descriptor_t not_port;/* MACH_MSG_TYPE_PORT_RECEIVE */
+    mach_msg_format_0_trailer_t trailer;
+} mach_port_destroyed_notification_t;
+
+typedef struct {
+    mach_msg_header_t	not_header;
+    NDR_record_t	NDR;
+    mach_msg_type_number_t not_count;
+    mach_msg_format_0_trailer_t trailer;
+} mach_no_senders_notification_t;
+
+typedef struct {
+    mach_msg_header_t	not_header;
+    mach_msg_format_0_trailer_t trailer;
+} mach_send_once_notification_t;
+
+typedef struct {
+    mach_msg_header_t	not_header;
+    NDR_record_t	NDR;
+    mach_port_name_t not_port;/* MACH_MSG_TYPE_PORT_NAME */
+    mach_msg_format_0_trailer_t trailer;
+} mach_dead_name_notification_t;
+
+#endif	/* _MACH_NOTIFY_H_ */
diff -urN cctools-806-old/include/mach/policy.h cctools-806/include/mach/policy.h
--- cctools-806-old/include/mach/policy.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/policy.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,235 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_MACH_POLICY_H_
+#define _MACH_POLICY_H_
+
+/*
+ *	mach/policy.h
+ *
+ *	Definitions for scheduing policy.
+ */
+
+/*
+ *  All interfaces defined here are obsolete.
+ */
+
+#include <mach/boolean.h>
+#include <mach/message.h>
+#include <mach/vm_types.h>
+
+/*
+ *	Old scheduling control interface
+ */
+typedef int 				policy_t;
+typedef integer_t			*policy_info_t;
+typedef integer_t			*policy_base_t;
+typedef integer_t			*policy_limit_t;
+
+/*
+ *	Policy definitions.  Policies should be powers of 2,
+ *	but cannot be or'd together other than to test for a
+ *	policy 'class'.
+ */
+#define	POLICY_NULL		0	/* none			*/
+#define	POLICY_TIMESHARE	1	/* timesharing		*/
+#define	POLICY_RR		2	/* fixed round robin	*/
+#define POLICY_FIFO		4	/* fixed fifo		*/
+
+#define __NEW_SCHEDULING_FRAMEWORK__
+
+/*
+ *	Check if policy is of 'class' fixed-priority.
+ */
+#define	POLICYCLASS_FIXEDPRI	(POLICY_RR | POLICY_FIFO)
+
+/*
+ *	Check if policy is valid.
+ */
+#define invalid_policy(policy)			\
+	((policy) != POLICY_TIMESHARE &&	\
+	 (policy) != POLICY_RR &&		\
+	 (policy) != POLICY_FIFO)
+
+
+/*
+ * 	Types for TIMESHARE policy
+ */
+struct policy_timeshare_base {			
+	integer_t		base_priority;
+};
+struct policy_timeshare_limit {
+	integer_t		max_priority;
+};
+struct policy_timeshare_info {
+	integer_t		max_priority;
+	integer_t		base_priority;
+	integer_t		cur_priority;
+	boolean_t		depressed;
+	integer_t		depress_priority;
+};
+
+typedef struct policy_timeshare_base	*policy_timeshare_base_t; 
+typedef struct policy_timeshare_limit	*policy_timeshare_limit_t;
+typedef struct policy_timeshare_info	*policy_timeshare_info_t;
+
+typedef struct policy_timeshare_base	policy_timeshare_base_data_t; 
+typedef struct policy_timeshare_limit	policy_timeshare_limit_data_t;
+typedef struct policy_timeshare_info	policy_timeshare_info_data_t;
+
+
+#define POLICY_TIMESHARE_BASE_COUNT	((mach_msg_type_number_t) \
+	(sizeof(struct policy_timeshare_base)/sizeof(integer_t)))
+#define POLICY_TIMESHARE_LIMIT_COUNT	((mach_msg_type_number_t) \
+	(sizeof(struct policy_timeshare_limit)/sizeof(integer_t)))
+#define POLICY_TIMESHARE_INFO_COUNT	((mach_msg_type_number_t) \
+	(sizeof(struct policy_timeshare_info)/sizeof(integer_t)))
+
+
+/*
+ *	Types for the ROUND ROBIN (RR) policy
+ */
+struct policy_rr_base {				
+	integer_t		base_priority;
+	integer_t		quantum;
+};
+struct policy_rr_limit {
+	integer_t		max_priority;
+};
+struct policy_rr_info {
+	integer_t		max_priority;
+	integer_t		base_priority;
+	integer_t		quantum;
+	boolean_t		depressed;
+	integer_t		depress_priority;
+};
+
+typedef struct policy_rr_base		*policy_rr_base_t;
+typedef struct policy_rr_limit		*policy_rr_limit_t;
+typedef struct policy_rr_info		*policy_rr_info_t;
+
+typedef struct policy_rr_base		policy_rr_base_data_t;
+typedef struct policy_rr_limit		policy_rr_limit_data_t;
+typedef struct policy_rr_info		policy_rr_info_data_t;
+
+#define POLICY_RR_BASE_COUNT	((mach_msg_type_number_t)	\
+	(sizeof(struct policy_rr_base)/sizeof(integer_t)))
+#define POLICY_RR_LIMIT_COUNT	((mach_msg_type_number_t)	\
+	(sizeof(struct policy_rr_limit)/sizeof(integer_t)))
+#define POLICY_RR_INFO_COUNT	((mach_msg_type_number_t)	\
+	(sizeof(struct policy_rr_info)/sizeof(integer_t)))
+
+
+/*
+ * 	Types for the FIRST-IN-FIRST-OUT (FIFO) policy
+ */
+struct policy_fifo_base {		
+	integer_t		base_priority;
+};
+struct policy_fifo_limit {
+	integer_t		max_priority;
+};
+struct policy_fifo_info {
+	integer_t		max_priority;
+	integer_t		base_priority;
+	boolean_t		depressed;
+	integer_t		depress_priority;
+};
+
+typedef struct policy_fifo_base		*policy_fifo_base_t;
+typedef struct policy_fifo_limit	*policy_fifo_limit_t;
+typedef struct policy_fifo_info		*policy_fifo_info_t;
+
+typedef struct policy_fifo_base		policy_fifo_base_data_t;
+typedef struct policy_fifo_limit	policy_fifo_limit_data_t;
+typedef struct policy_fifo_info		policy_fifo_info_data_t;
+
+#define POLICY_FIFO_BASE_COUNT	((mach_msg_type_number_t)	\
+	(sizeof(struct policy_fifo_base)/sizeof(integer_t)))
+#define POLICY_FIFO_LIMIT_COUNT	((mach_msg_type_number_t)	\
+	(sizeof(struct policy_fifo_limit)/sizeof(integer_t)))
+#define POLICY_FIFO_INFO_COUNT	((mach_msg_type_number_t)	\
+	(sizeof(struct policy_fifo_info)/sizeof(integer_t)))
+
+/*
+ * 	Aggregate policy types
+ */
+
+struct policy_bases {
+	policy_timeshare_base_data_t	ts;
+	policy_rr_base_data_t		rr;
+	policy_fifo_base_data_t		fifo;
+};
+
+struct policy_limits {
+	policy_timeshare_limit_data_t	ts;
+	policy_rr_limit_data_t		rr;
+	policy_fifo_limit_data_t	fifo;
+};
+
+struct policy_infos {
+	policy_timeshare_info_data_t	ts;
+	policy_rr_info_data_t		rr;
+	policy_fifo_info_data_t		fifo;
+};
+
+typedef struct policy_bases		policy_base_data_t;
+typedef struct policy_limits		policy_limit_data_t;
+typedef struct policy_infos		policy_info_data_t;
+
+#endif	/* _MACH_POLICY_H_ */
diff -urN cctools-806-old/include/mach/port.h cctools-806/include/mach/port.h
--- cctools-806-old/include/mach/port.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/port.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,321 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ * NOTICE: This file was modified by McAfee Research in 2004 to introduce
+ * support for mandatory and extensible security protections.  This notice
+ * is included in support of clause 2.2 (b) of the Apple Public License,
+ * Version 2.0.
+ */
+/*
+ */
+/*
+ *	File:	mach/port.h
+ *
+ *	Definition of a Mach port
+ *
+ *	Mach ports are the endpoints to Mach-implemented communications
+ *	channels (usually uni-directional message queues, but other types
+ *	also exist).
+ *
+ *	Unique collections of these endpoints are maintained for each
+ *	Mach task.  Each Mach port in the task's collection is given a 
+ *	[task-local] name to identify it - and the the various "rights"
+ *	held by the task for that specific endpoint.
+ *
+ *	This header defines the types used to identify these Mach ports
+ *	and the various rights associated with them.  For more info see:
+ *
+ *	<mach/mach_port.h> - manipulation of port rights in a given space
+ *	<mach/message.h> - message queue [and port right passing] mechanism
+ *
+ */
+
+#ifndef	_MACH_PORT_H_
+#define _MACH_PORT_H_
+
+#include <sys/cdefs.h>
+#include <stdint.h>
+#include <mach/boolean.h>
+#include <mach/machine/vm_types.h>
+
+/*
+ *	mach_port_name_t - the local identity for a Mach port
+ *
+ *	The name is Mach port namespace specific.  It is used to
+ *	identify the rights held for that port by the task whose
+ *	namespace is implied [or specifically provided].
+ *
+ *	Use of this type usually implies just a name - no rights.
+ *	See mach_port_t for a type that implies a "named right."
+ *
+ */
+ 
+typedef natural_t mach_port_name_t;
+typedef mach_port_name_t *mach_port_name_array_t;
+
+
+/* 
+ *	mach_port_t - a named port right
+ *
+ *	In user-space, "rights" are represented by the name of the
+ *	right in the Mach port namespace.  Even so, this type is
+ *	presented as a unique one to more clearly denote the presence
+ *	of a right coming along with the name. 
+ *
+ *	Often, various rights for a port held in a single name space
+ *	will coalesce and are, therefore, be identified by a single name
+ *	[this is the case for send and receive rights].  But not
+ *	always [send-once rights currently get a unique name for
+ *	each right].      
+ *
+ */
+
+#ifndef _MACH_PORT_T
+#define _MACH_PORT_T
+typedef mach_port_name_t 		mach_port_t;
+#endif
+
+
+typedef mach_port_t			*mach_port_array_t;
+
+/*
+ *  MACH_PORT_NULL is a legal value that can be carried in messages.
+ *  It indicates the absence of any port or port rights.  (A port
+ *  argument keeps the message from being "simple", even if the
+ *  value is MACH_PORT_NULL.)  The value MACH_PORT_DEAD is also a legal
+ *  value that can be carried in messages.  It indicates
+ *  that a port right was present, but it died.
+ */
+
+#define MACH_PORT_NULL		0  /* intentional loose typing */
+#define MACH_PORT_DEAD		((mach_port_name_t) ~0)
+#define MACH_PORT_VALID(name)				\
+		(((name) != MACH_PORT_NULL) && 		\
+		 ((name) != MACH_PORT_DEAD))
+
+
+/*
+ *	For kernel-selected [assigned] port names, the name is
+ *	comprised of two parts: a generation number and an index.
+ *	This approach keeps the exact same name from being generated
+ *	and reused too quickly [to catch right/reference counting bugs].
+ *	The dividing line between the constituent parts is exposed so
+ *	that efficient "mach_port_name_t to data structure pointer"
+ *	conversion implementation can be made.  But it is possible
+ *	for user-level code to assign their own names to Mach ports.
+ *	These are not required to participate in this algorithm.  So
+ *	care should be taken before "assuming" this model.
+ *
+ */
+
+#ifndef	NO_PORT_GEN
+
+#define	MACH_PORT_INDEX(name)		((name) >> 8)
+#define	MACH_PORT_GEN(name)		(((name) & 0xff) << 24)
+#define	MACH_PORT_MAKE(index, gen)	\
+		(((index) << 8) | (gen) >> 24)
+
+#else	/* NO_PORT_GEN */
+
+#define	MACH_PORT_INDEX(name)		(name)
+#define	MACH_PORT_GEN(name)		(0)
+#define	MACH_PORT_MAKE(index, gen)	(index)
+
+#endif	/* NO_PORT_GEN */
+
+
+/*
+ *  These are the different rights a task may have for a port.
+ *  The MACH_PORT_RIGHT_* definitions are used as arguments
+ *  to mach_port_allocate, mach_port_get_refs, etc, to specify
+ *  a particular right to act upon.  The mach_port_names and
+ *  mach_port_type calls return bitmasks using the MACH_PORT_TYPE_*
+ *  definitions.  This is because a single name may denote
+ *  multiple rights.
+ */
+
+typedef natural_t mach_port_right_t;
+
+#define MACH_PORT_RIGHT_SEND		((mach_port_right_t) 0)
+#define MACH_PORT_RIGHT_RECEIVE		((mach_port_right_t) 1)
+#define MACH_PORT_RIGHT_SEND_ONCE	((mach_port_right_t) 2)
+#define MACH_PORT_RIGHT_PORT_SET	((mach_port_right_t) 3)
+#define MACH_PORT_RIGHT_DEAD_NAME	((mach_port_right_t) 4)
+#define MACH_PORT_RIGHT_LABELH	        ((mach_port_right_t) 5)
+#define MACH_PORT_RIGHT_NUMBER		((mach_port_right_t) 6)
+
+typedef natural_t mach_port_type_t;
+typedef mach_port_type_t *mach_port_type_array_t;
+
+#define MACH_PORT_TYPE(right)						\
+		((mach_port_type_t)(((mach_port_type_t) 1)  		\
+		<< ((right) + ((mach_port_right_t) 16))))	
+#define MACH_PORT_TYPE_NONE	    ((mach_port_type_t) 0L)
+#define MACH_PORT_TYPE_SEND	    MACH_PORT_TYPE(MACH_PORT_RIGHT_SEND)
+#define MACH_PORT_TYPE_RECEIVE	    MACH_PORT_TYPE(MACH_PORT_RIGHT_RECEIVE)
+#define MACH_PORT_TYPE_SEND_ONCE    MACH_PORT_TYPE(MACH_PORT_RIGHT_SEND_ONCE)
+#define MACH_PORT_TYPE_PORT_SET	    MACH_PORT_TYPE(MACH_PORT_RIGHT_PORT_SET)
+#define MACH_PORT_TYPE_DEAD_NAME    MACH_PORT_TYPE(MACH_PORT_RIGHT_DEAD_NAME)
+#define MACH_PORT_TYPE_LABELH       MACH_PORT_TYPE(MACH_PORT_RIGHT_LABELH)
+
+/* Convenient combinations. */
+
+#define MACH_PORT_TYPE_SEND_RECEIVE					\
+		(MACH_PORT_TYPE_SEND|MACH_PORT_TYPE_RECEIVE)
+#define	MACH_PORT_TYPE_SEND_RIGHTS					\
+		(MACH_PORT_TYPE_SEND|MACH_PORT_TYPE_SEND_ONCE)
+#define	MACH_PORT_TYPE_PORT_RIGHTS					\
+		(MACH_PORT_TYPE_SEND_RIGHTS|MACH_PORT_TYPE_RECEIVE)
+#define	MACH_PORT_TYPE_PORT_OR_DEAD					\
+		(MACH_PORT_TYPE_PORT_RIGHTS|MACH_PORT_TYPE_DEAD_NAME)
+#define MACH_PORT_TYPE_ALL_RIGHTS					\
+		(MACH_PORT_TYPE_PORT_OR_DEAD|MACH_PORT_TYPE_PORT_SET)
+
+/* Dummy type bits that mach_port_type/mach_port_names can return. */
+
+#define MACH_PORT_TYPE_DNREQUEST		0x80000000
+#define MACH_PORT_TYPE_SPREQUEST		0x40000000
+#define MACH_PORT_TYPE_SPREQUEST_DELAYED	0x20000000
+
+/* User-references for capabilities. */
+
+typedef natural_t mach_port_urefs_t;
+typedef integer_t mach_port_delta_t;			/* change in urefs */
+
+/* Attributes of ports.  (See mach_port_get_receive_status.) */
+
+typedef natural_t mach_port_seqno_t;		/* sequence number */
+typedef natural_t mach_port_mscount_t;		/* make-send count */
+typedef natural_t mach_port_msgcount_t;		/* number of msgs */
+typedef natural_t mach_port_rights_t;		/* number of rights */
+
+/*
+ *	Are there outstanding send rights for a given port?
+ */
+#define	MACH_PORT_SRIGHTS_NONE		0		/* no srights */
+#define	MACH_PORT_SRIGHTS_PRESENT	1		/* srights */
+typedef unsigned int mach_port_srights_t;	/* status of send rights */
+
+typedef struct mach_port_status {
+	mach_port_rights_t	mps_pset;	/* count of containing port sets */
+	mach_port_seqno_t	mps_seqno;	/* sequence number */
+	mach_port_mscount_t	mps_mscount;	/* make-send count */
+	mach_port_msgcount_t	mps_qlimit;	/* queue limit */
+	mach_port_msgcount_t	mps_msgcount;	/* number in the queue */
+	mach_port_rights_t	mps_sorights;	/* how many send-once rights */
+	boolean_t		mps_srights;	/* do send rights exist? */
+	boolean_t		mps_pdrequest;	/* port-deleted requested? */
+	boolean_t		mps_nsrequest;	/* no-senders requested? */
+	natural_t		mps_flags;		/* port flags */
+} mach_port_status_t;
+
+/* System-wide values for setting queue limits on a port */
+#define MACH_PORT_QLIMIT_ZERO		((mach_port_msgcount_t) 0)
+#define MACH_PORT_QLIMIT_BASIC		((mach_port_msgcount_t) 5)
+#define MACH_PORT_QLIMIT_SMALL		((mach_port_msgcount_t) 16)
+#define MACH_PORT_QLIMIT_LARGE		((mach_port_msgcount_t) 1024)
+#define MACH_PORT_QLIMIT_KERNEL		((mach_port_msgcount_t) 65536)
+#define MACH_PORT_QLIMIT_MIN		MACH_PORT_QLIMIT_ZERO
+#define MACH_PORT_QLIMIT_DEFAULT	MACH_PORT_QLIMIT_BASIC
+#define MACH_PORT_QLIMIT_MAX		MACH_PORT_QLIMIT_LARGE
+
+typedef struct mach_port_limits {
+	mach_port_msgcount_t	mpl_qlimit;	/* number of msgs */
+} mach_port_limits_t;
+
+typedef integer_t *mach_port_info_t;		/* varying array of natural_t */
+
+/* Flavors for mach_port_get/set_attributes() */
+typedef int	mach_port_flavor_t;
+#define MACH_PORT_LIMITS_INFO		1	/* uses mach_port_status_t */
+#define MACH_PORT_RECEIVE_STATUS	2	/* uses mach_port_limits_t */
+#define MACH_PORT_DNREQUESTS_SIZE	3	/* info is int */
+
+#define MACH_PORT_LIMITS_INFO_COUNT	((natural_t) \
+	(sizeof(mach_port_limits_t)/sizeof(natural_t)))
+#define MACH_PORT_RECEIVE_STATUS_COUNT	((natural_t) \
+	(sizeof(mach_port_status_t)/sizeof(natural_t)))
+#define MACH_PORT_DNREQUESTS_SIZE_COUNT 1
+
+/*
+ * Structure used to pass information about port allocation requests.
+ * Must be padded to 64-bits total length.
+ */
+typedef struct mach_port_qos {
+	unsigned int		name:1;		/* name given */
+	unsigned int 		prealloc:1;	/* prealloced message */
+	boolean_t		pad1:30;
+	natural_t		len;
+} mach_port_qos_t;
+
+#if	!__DARWIN_UNIX03 && !defined(_NO_PORT_T_FROM_MACH)
+/*
+ *  Mach 3.0 renamed everything to have mach_ in front of it.
+ *  These types and macros are provided for backward compatibility
+ *	but are deprecated.
+ */
+typedef mach_port_t		port_t;
+typedef mach_port_name_t	port_name_t;
+typedef mach_port_name_t	*port_name_array_t;
+
+#define PORT_NULL		((port_t) 0)
+#define PORT_DEAD		((port_t) ~0)
+#define PORT_VALID(name) \
+		((port_t)(name) != PORT_NULL && (port_t)(name) != PORT_DEAD)
+
+#endif	/* !__DARWIN_UNIX03 && !_NO_PORT_T_FROM_MACH */
+
+#endif	/* _MACH_PORT_H_ */
diff -urN cctools-806-old/include/mach/port_obj.h cctools-806/include/mach/port_obj.h
--- cctools-806-old/include/mach/port_obj.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/port_obj.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,103 @@
+/*
+ * Copyright (c) 2003 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+/*
+ * Define a service to map from a kernel-generated port name
+ * to server-defined "type" and "value" data to be associated
+ * with the port.
+ */
+
+#ifndef PORT_OBJ_H
+#define PORT_OBJ_H
+
+#include <mach/port.h>
+
+struct port_obj_tentry {
+	void *pos_value;
+	int pos_type;
+};
+
+#include <sys/cdefs.h>
+
+__BEGIN_DECLS
+extern void port_obj_init(int);
+__END_DECLS
+
+extern struct port_obj_tentry *port_obj_table;
+extern int port_obj_table_size;
+
+#ifndef PORT_OBJ_ASSERT
+
+#define port_set_obj_value_type(pname, value, type)	\
+do {							\
+	int ndx;					\
+							\
+	if (!port_obj_table)				\
+		port_obj_init(port_obj_table_size);	\
+	ndx = MACH_PORT_INDEX(pname);			\
+	port_obj_table[ndx].pos_value = (value);	\
+	port_obj_table[ndx].pos_type = (type);		\
+} while (0)
+
+#define port_get_obj_value(pname)			\
+	(port_obj_table[MACH_PORT_INDEX(pname)].pos_value)
+
+#define port_get_obj_type(pname)			\
+	(port_obj_table[MACH_PORT_INDEX(pname)].pos_type)
+
+#else	/* PORT_OBJ_ASSERT */
+
+#define port_set_obj_value_type(pname, value, type)	\
+do {							\
+	int ndx;					\
+							\
+	if (!port_obj_table)				\
+		port_obj_init(port_obj_table_size);	\
+	ndx = MACH_PORT_INDEX(pname);			\
+	assert(ndx > 0);				\
+	assert(ndx < port_obj_table_size);		\
+	port_obj_table[ndx].pos_value = (value);	\
+	port_obj_table[ndx].pos_type = (type);		\
+} while (0)
+
+#define port_get_obj_value(pname)				\
+	((MACH_PORT_INDEX(pname) < (unsigned)port_obj_table_size) ?	\
+	port_obj_table[MACH_PORT_INDEX(pname)].pos_value :	\
+	(panic("port_get_obj_value: index too big"), (void *)-1))
+
+#define port_get_obj_type(pname)				\
+	((MACH_PORT_INDEX(pname) < (unsigned)port_obj_table_size) ?	\
+	port_obj_table[MACH_PORT_INDEX(pname)].pos_type :	\
+	(panic("port_get_obj_type: index too big"), -1))
+
+#endif	/* PORT_OBJ_ASSERT */
+
+#endif	/* PORT_OBJ_H */
diff -urN cctools-806-old/include/mach/ppc/asm.h cctools-806/include/mach/ppc/asm.h
--- cctools-806-old/include/mach/ppc/asm.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/asm.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,763 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+#ifndef	_PPC_ASM_H_
+#define	_PPC_ASM_H_
+
+#define	__ASMNL__	@
+#define STRINGD .ascii
+
+#ifdef ASSEMBLER
+
+
+#define br0 0
+
+#define ARG0 r3
+#define ARG1 r4
+#define ARG2 r5
+#define ARG3 r6
+#define ARG4 r7
+#define ARG5 r8
+#define ARG6 r9
+#define ARG7 r10
+
+#define tmp0	r0	/* Temporary GPR remapping (603e specific) */
+#define tmp1	r1
+#define tmp2	r2
+#define tmp3	r3
+
+/* SPR registers */
+
+#define mq		0		/* MQ register for 601 emulation */
+#define rtcu	4		/* RTCU - upper word of RTC for 601 emulation */
+#define rtcl	5		/* RTCL - lower word of RTC for 601 emulation */
+#define dsisr	18
+#define ppcDAR	19
+#define ppcdar	19
+#define dar		19
+#define SDR1	25
+#define sdr1	25
+#define srr0	26
+#define srr1	27
+#define vrsave	256		/* Vector Register save */
+#define sprg0	272
+#define sprg1	273
+#define sprg2	274
+#define sprg3	275
+#define scomc	276
+#define scomd	277
+#define pvr		287
+
+#define IBAT0U	528
+#define IBAT0L	529
+#define IBAT1U	530
+#define IBAT1L	531
+#define IBAT2U	532
+#define IBAT2L	533
+#define IBAT3U	534
+#define IBAT3L	535
+#define ibat0u	528
+#define ibat0l	529
+#define ibat1u	530
+#define ibat1l	531
+#define ibat2u	532
+#define ibat2l	533
+#define ibat3u	534
+#define ibat3l	535
+
+#define DBAT0U	536
+#define DBAT0L	537
+#define DBAT1U	538
+#define DBAT1L	539
+#define DBAT2U	540
+#define DBAT2L	541
+#define DBAT3U	542
+#define DBAT3L	543
+#define dbat0u	536
+#define dbat0l	537
+#define dbat1u	538
+#define dbat1l	539
+#define dbat2u	540
+#define dbat2l	541
+#define dbat3u	542
+#define dbat3l	543
+
+#define ummcr2	928		/* Performance monitor control */
+#define upmc5   929     /* Performance monitor counter */
+#define upmc6   930     /* Performance monitor counter */
+#define ubamr	935		/* Performance monitor mask */
+#define ummcr0	936		/* Performance monitor control */
+#define upmc1	937		/* Performance monitor counter */
+#define upmc2	938		/* Performance monitor counter */
+#define usia	939		/* User sampled instruction address */
+#define ummcr1	940		/* Performance monitor control */
+#define upmc3	941		/* Performance monitor counter */
+#define upmc4	942		/* Performance monitor counter */
+#define usda	943		/* User sampled data address */
+#define mmcr2	944		/* Performance monitor control */
+#define pmc5    945     /* Performance monitor counter */
+#define pmc6    946     /* Performance monitor counter */
+#define bamr	951		/* Performance monitor mask */
+#define mmcr0	952
+#define pmc1	953
+#define	pmc2	954
+#define	sia		955
+#define	mmcr1	956
+#define	pmc3	957
+#define	pmc4	958
+#define	sda		959		/* Sampled data address */
+#define dmiss	976		/* ea that missed */
+#define trig0	976		
+#define dcmp	977		/* compare value for the va that missed */
+#define trig1	977		
+#define hash1	978		/* pointer to first hash pteg */
+#define trig2	978		
+#define	hash2	979		/* pointer to second hash pteg */
+#define imiss	980		/* ea that missed */
+#define tlbmiss	980		/* ea that missed */
+#define icmp	981		/* compare value for the va that missed */
+#define ptehi	981		/* compare value for the va that missed */
+#define rpa		982		/* required physical address register */
+#define ptelo	982		/* required physical address register */
+#define l3pdet	984		/* l3pdet */
+
+#define HID0	1008	/* Checkstop and misc enables */
+#define hid0	1008	/* Checkstop and misc enables */
+#define HID1	1009	/* Clock configuration */
+#define hid1	1009	/* Clock configuration */
+#define HID2	1016	/* Other processor controls */
+#define hid2	1016	/* Other processor controls */
+#define iabr	1010	/* Instruction address breakpoint register */
+#define ictrl	1011	/* Instruction Cache Control */
+#define ldstdb	1012	/* Load/Store Debug */
+#define hid4	1012	/* Misc stuff */
+#define dabr	1013	/* Data address breakpoint register */
+#define msscr0	1014	/* Memory subsystem control */
+#define hid5	1014	/* Misc stuff */
+#define msscr1	1015	/* Memory subsystem debug */
+#define msssr0	1015	/* Memory Subsystem Status */
+#define ldstcr	1016	/* Load/Store Status/Control */
+#define l2cr2	1016	/* L2 Cache control 2 */
+#define l2cr	1017	/* L2 Cache control */
+#define l3cr	1018	/* L3 Cache control */
+#define ictc	1019	/* I-cache throttling control */
+#define thrm1	1020	/* Thermal management 1 */
+#define thrm2	1021	/* Thermal management 2 */
+#define thrm3	1022	/* Thermal management 3 */
+#define pir		1023	/* Processor ID Register */
+
+
+/* SPR registers (64-bit, PPC970 specific) */
+
+#define scomc_gp	276
+#define scomd_gp	277
+
+#define hsprg0		304
+#define hsprg1		305
+#define hdec		310
+#define hior		311
+#define rmor		312
+#define hrmor		313
+#define hsrr0		314
+#define hsrr1		315
+#define lpcr		318
+#define lpidr		319
+
+#define ummcra_gp	770
+#define upmc1_gp	771
+#define upmc2_gp	772
+#define upmc3_gp	773
+#define upmc4_gp	774
+#define upmc5_gp	775
+#define upmc6_gp	776
+#define upmc7_gp	777
+#define upmc8_gp	778
+#define ummcr0_gp	779
+#define usiar_gp	780
+#define usdar_gp	781
+#define ummcr1_gp	782
+#define uimc_gp		783
+
+#define mmcra_gp	786
+#define pmc1_gp		787
+#define pmc2_gp		788
+#define pmc3_gp		789
+#define pmc4_gp		790
+#define pmc5_gp		791
+#define pmc6_gp		792
+#define pmc7_gp		793
+#define pmc8_gp		794
+#define mmcr0_gp	795
+#define siar_gp		796
+#define sdar_gp		797
+#define mmcr1_gp	798
+#define imc_gp		799
+
+#define trig0_gp	976		
+#define trig1_gp	977		
+#define trig2_gp	978		
+
+#define dabrx		1015
+
+;	hid0 bits
+#define emcp	0
+#define emcpm	0x80000000
+#define dbp		1
+#define dbpm	0x40000000
+#define eba		2
+#define ebam	0x20000000
+#define ebd		3
+#define ebdm	0x10000000
+#define sbclk	4
+#define sbclkm	0x08000000
+#define eclk	6
+#define eclkm	0x02000000
+#define par		7
+#define parm	0x01000000
+#define sten	7
+#define stenm	0x01000000
+#define dnap	7
+#define dnapm	0x01000000
+#define doze	8
+#define dozem	0x00800000
+#define nap		9
+#define napm	0x00400000
+#define sleep	10
+#define sleepm	0x00200000
+#define dpm		11
+#define dpmm	0x00100000
+#define riseg	12
+#define risegm	0x00080000
+#define eiec	13
+#define eiecm	0x00040000
+#define mum		14
+#define mumm	0x00020000
+#define nhr		15
+#define nhrm	0x00010000
+#define ice		16
+#define icem	0x00008000
+#define dce		17
+#define dcem	0x00004000
+#define ilock	18
+#define ilockm	0x00002000
+#define dlock	19
+#define dlockm	0x00001000
+#define exttben	19
+#define icfi	20
+#define icfim	0x00000800
+#define dcfi	21
+#define dcfim	0x00000400
+#define spd		22
+#define spdm	0x00000200
+#define hdice	23
+#define hdicem	0x00000100
+#define sge		24
+#define sgem	0x00000080
+#define dcfa	25
+#define dcfam	0x00000040
+#define btic	26
+#define bticm	0x00000020
+#define lrstk	27
+#define lrstkm	0x00000010
+#define abe		28
+#define abem	0x00000008
+#define fold	28
+#define foldm	0x00000008
+#define bht		29
+#define bhtm	0x00000004
+#define nopdst	30
+#define nopdstm	0x00000002
+#define nopti	31
+#define noptim	0x00000001
+
+;	hid1 bits
+#define hid1pcem	0xF8000000
+#define hid1prem	0x06000000
+#define hid1dfs0	8
+#define hid1dfs0m	0x00800000
+#define hid1dfs1	9
+#define hid1dfs1m	0x00400000
+#define hid1pi0		14
+#define hid1pi0m	0x00020000
+#define hid1FCPErr	14
+#define hid1ps		15
+#define hid1FCD0PErr	15
+#define hid1psm		0x00010000
+#define hid1pc0		0x0000F800
+#define hid1pr0		0x00000600
+#define hid1pc1		0x000000F8
+#define hid1pc0		0x0000F800
+#define hid1pr1		0x00000006
+#define hid1FCD1PErr	16
+#define hid1FIERATErr	17
+
+;	hid2 bits
+#define hid2vmin	18
+#define hid2vminm	0x00002000
+
+;	msscr0 bits
+#define shden	0
+#define shdenm	0x80000000
+#define shden3	1
+#define shdenm3	0x40000000
+#define l1intvs	2	
+#define l1intve	4	
+#define l1intvb	0x38000000	
+#define l2intvs	5	
+#define l2intve	7	
+#define l2intvb	0x07000000	
+#define dl1hwf	8
+#define dl1hwfm	0x00800000
+#define dbsiz	9
+#define dbsizm	0x00400000
+#define emode	10
+#define emodem	0x00200000
+#define abgd	11
+#define abgdm	0x00100000
+#define tfsts	24
+#define tfste	25
+#define tfstm	0x000000C0
+#define	l2pfes	30
+#define	l2pfee	31
+#define	l2pfem	0x00000003
+
+;	msscr1 bits
+#define cqd		15
+#define cqdm	0x00010000
+#define csqs	1
+#define csqe	2
+#define csqm	0x60000000
+
+;	msssr1 bits - 7450
+#define vgL2PARA	0
+#define vgL3PARA	1
+#define vgL2COQEL	2
+#define vgL3COQEL	3
+#define vgL2CTR		4
+#define vgL3CTR		5
+#define vgL2COQR	6
+#define vgL3COQR	7
+#define vgLMQ		8
+#define vgSMC		9
+#define vgSNP		10
+#define vgBIU		11
+#define vgSMCE		12
+#define vgL2TAG		13
+#define vgL2DAT		14
+#define vgL3TAG		15
+#define vgL3DAT		16
+#define vgAPE		17
+#define vgDPE		18
+#define vgTEA		19
+
+;	srr1 bits
+#define icmck	1
+#define icmckm	0x40000000
+#define dcmck	2
+#define dcmckm	0x20000000
+#define l2mck	3
+#define l2mckm	0x10000000
+#define tlbmck	4
+#define tlbmckm	0x08000000
+#define brmck	5
+#define brmckm	0x04000000
+#define othmck	10
+#define othmckm	0x00200000
+#define l2dpmck	11
+#define l2dpmckm	0x00100000
+#define mcpmck	12
+#define mcpmckm	0x00080000
+#define teamck	13
+#define teamckm	0x00040000
+#define dpmck	14
+#define dpmckm	0x00020000
+#define apmck	15
+#define apmckm	0x00010000
+
+#define mckIFUE	42
+#define mckLDST	43
+#define mckXCs	44
+#define mckXCe	45
+#define mckNoErr	0
+#define mckIFSLBPE	1
+#define mckIFTLBPE	2
+#define mckIFTLBUE	3
+
+;	dsisr bits
+#define mckUEdfr	16
+#define mckUETwDfr	17
+#define mckL1DCPE	18
+#define	mckL1DTPE	19
+#define	mckDEPE		20
+#define mckTLBPE	21
+#define mckSLBPE	23
+
+;	Async MCK source
+#define AsyMCKSrc 0x0226
+#define AsyMCKRSrc 0x0227
+#define AsyMCKext 0
+#define AsyMCKfir 1
+#define AsyMCKhri 2
+#define AsyMCKdbg 3
+#define AsyMCKncstp 4
+
+;	Core FIR
+#define cFIR 0x0300
+#define cFIRrst 0x0310
+#define cFIRICachePE 0
+#define cFIRITagPE0 1
+#define cFIRITagPE1 2
+#define cFIRIEratPE 3
+#define cFIRIFUL2UE 4
+#define cFIRIFUCS 5
+#define cFIRDCachePE 6
+#define cFIRDTagPE 7
+#define cFIRDEratPE 8
+#define cFIRTLBPE 9
+#define cFIRSLBPE 10
+#define cFIRSL2UE 11
+
+;	Core Error Inject
+#define CoreErrI 0x0350
+#define CoreIFU 0
+#define CoreLSU 1
+#define CoreRate0 2
+#define CoreRate1 3
+#define CoreOnce 0
+#define CoreSolid 2
+#define CorePulse 3
+
+;	L2 FIR
+#define l2FIR 0x0400
+#define l2FIRrst 0x0410
+
+;	Bus FIR
+#define busFIR 0x0A00
+#define busFIRrst 0x0A10
+
+;	HID4
+#define hid4RMCI 23
+#define hid4FAlgn 24
+#define hid4DisPF 25
+#define hid4ResPF 26
+#define hid4EnSPTW 27
+#define hid4L1DCFI 28
+#define hid4DisDERpg 31
+#define hid4DisDCTpg 36
+#define hid4DisDCpg 41
+#define hid4DisTLBpg 48
+#define hid4DisSLBpg 54
+#define hid4MckEIEna 55
+
+;	L2 cache control
+#define l2e		0
+#define l2em	0x80000000
+#define l2pe	1
+#define l2pem	0x40000000
+#define l2siz	2
+#define l2sizf	3
+#define l2sizm	0x30000000
+#define l2clk	4
+#define l2clkf	6
+#define l2clkm	0x0E000000
+#define l2ram	7
+#define l2ramf	8
+#define l2ramm	0x01800000
+#define l2do	9
+#define l2dom	0x00400000
+#define l2i		10
+#define l2im	0x00200000
+#define l2ctl	11
+#define l2ctlm	0x00100000
+#define l2ionly	11
+#define l2ionlym	0x00100000
+#define l2wt	12
+#define l2wtm	0x00080000
+#define l2ts	13
+#define l2tsm	0x00040000
+#define l2oh	14
+#define l2ohf	15
+#define l2ohm	0x00030000
+#define l2donly	15
+#define l2donlym	0x00010000
+#define l2sl	16
+#define l2slm	0x00008000
+#define l2df	17
+#define l2dfm	0x00004000
+#define l2byp	18
+#define l2bypm	0x00002000
+#define l2fa	19
+#define l2fam	0x00001000
+#define l2hwf	20
+#define l2hwfm	0x00000800
+#define l2io	21
+#define l2iom	0x00000400
+#define l2clkstp	22
+#define	l2clkstpm	0x00000200
+#define l2dro	23
+#define l2drom	0x00000100 
+#define l2ctr	24
+#define l2ctrf	30
+#define l2ctrm	0x000000FE
+#define	l2ip	31
+#define l2ipm	0x00000001
+
+;	L3 cache control
+#define l3e		0
+#define l3em	0x80000000
+#define l3pe	1
+#define l3pem	0x40000000
+#define l3siz	3
+#define l3sizm	0x10000000
+#define l3clken	4
+#define l3clkenm	0x08000000
+#define l3dx	5
+#define l3dxm	0x04000000
+#define l3clk	6
+#define l3clkf	8
+#define l3clkm	0x03800000
+#define l3io	9
+#define l3iom	0x00400000
+#define l3spo	13
+#define l3spom	0x00040000
+#define l3cksp	14
+#define l3ckspf	15
+#define l3ckspm	0x00030000
+#define l3psp	16
+#define l3pspf	18
+#define l3pspm	0x0000E000
+#define l3rep	19
+#define l3repm	0x00001000
+#define l3hwf	20
+#define l3hwfm	0x00000800
+#define l3i		21
+#define l3im	0x00000400
+#define l3rt	22
+#define l3rtf	23
+#define	l3rtm	0x00000300
+#define l3dro	23
+#define l3drom	0x00000100 
+#define l3cya	24
+#define l3cyam	0x00000080
+#define l3donly	25
+#define l3donlym	0x00000040
+#define l3dmem	29
+#define l3dmemm	0x00000004
+#define l3dmsiz	31
+#define l3dmsizm	0x00000001
+
+#define	thrmtin		0
+#define	thrmtinm	0x80000000
+#define	thrmtiv		1
+#define thrmtivm	0x40000000
+#define thrmthrs	2
+#define thrmthre	8
+#define thrmthrm	0x3F800000
+#define thrmtid		29
+#define thrmtidm	0x00000004
+#define thrmtie		30
+#define thrmtiem	0x00000002
+#define thrmv		31
+#define thrmvm		0x00000001
+
+#define thrmsitvs	15
+#define thrmsitve	30
+#define thrmsitvm	0x0001FFFE
+#define thrme		31
+#define thrmem		0x00000001
+
+#define ictcfib		23
+#define ictcfie		30
+#define ictcfim		0x000001FE
+#define ictce		31
+#define ictcem		0x00000001
+
+#define cr0_lt	0
+#define cr0_gt	1
+#define cr0_eq	2
+#define cr0_so	3
+#define cr0_un	3
+#define cr1_lt	4
+#define cr1_gt	5
+#define cr1_eq	6
+#define cr1_so	7
+#define cr1_un	7
+#define cr2_lt	8
+#define cr2_gt	9
+#define cr2_eq	10
+#define cr2_so	11
+#define cr2_un	11
+#define cr3_lt	12
+#define cr3_gt	13
+#define cr3_eq	14
+#define cr3_so	15
+#define cr3_un	15
+#define cr4_lt	16
+#define cr4_gt	17
+#define cr4_eq	18
+#define cr4_so	19
+#define cr4_un	19
+#define cr5_lt	20
+#define cr5_gt	21
+#define cr5_eq	22
+#define cr5_so	23
+#define cr5_un	23
+#define cr6_lt	24
+#define cr6_gt	25
+#define cr6_eq	26
+#define cr6_so	27
+#define cr6_un	27
+#define cr7_lt	28
+#define cr7_gt	29
+#define cr7_eq	30
+#define cr7_so	31
+#define cr7_un	31
+
+#define slbESID	36
+#define slbKey	52
+#define slbIndex 52
+#define slbV	36
+#define slbVm	0x08000000
+#define slbCnt	64
+
+/*
+ * Macros to access high and low word values of an address
+ */
+
+#define	HIGH_CADDR(x)	ha16(x)
+#define	HIGH_ADDR(x)	hi16(x)
+#define	LOW_ADDR(x)	lo16(x)
+
+#endif	/* ASSEMBLER */
+
+/*	GUS Mode Register */
+#define GUSModeReg 0x0430
+#define GUSMdmapen 0x00008000
+#define GUSMstgtdis 0x00000080
+#define GUSMstgttim 0x00000038
+#define GUSMstgttoff 0x00000004
+
+/* PowerTune */
+#define PowerTuneControlReg	0x0AA001
+#define PowerTuneStatusReg	0x408001
+
+/* Tags are placed before Immediately Following Code (IFC) for the debugger
+ * to be able to deduce where to find various registers when backtracing
+ * 
+ * We only define the values as we use them, see SVR4 ABI PowerPc Supplement
+ * for more details (defined in ELF spec).
+ */
+
+#define TAG_NO_FRAME_USED 0x00000000
+
+/* (should use genassym to get these offsets) */
+
+#define FM_BACKPTR 0
+#define	FM_CR_SAVE 4
+#define FM_LR_SAVE 8 /* MacOSX is NOT following the ABI at the moment.. */
+#define FM_SIZE    64   /* minimum frame contents, backptr and LR save. Make sure it is quadaligned */
+#define FM_ARG0	   56
+#define FM_ALIGN(l) ((l+15)&-16)
+#define	PK_SYSCALL_BEGIN	0x7000
+
+
+/* redzone is the area under the stack pointer which must be preserved
+ * when taking a trap, interrupt etc.
+ */
+#define FM_REDZONE 224				/* is ((32-14+1)*4) */
+
+#define COPYIN_ARG0_OFFSET FM_ARG0
+
+#ifdef	MACH_KERNEL
+#include <mach_kdb.h>
+#else	/* MACH_KERNEL */
+#define MACH_KDB 0
+#endif	/* MACH_KERNEL */
+
+#define BREAKPOINT_TRAP tw	4,r4,r4
+
+/* There is another definition of ALIGN for .c sources */
+#ifndef __LANGUAGE_ASSEMBLY
+#define ALIGN 4
+#endif /* __LANGUAGE_ASSEMBLY */
+
+#ifndef FALIGN
+#define FALIGN 4 /* Align functions on words for now. Cachelines is better */
+#endif
+
+#define LB(x,n) n
+#if	__STDC__
+#define	LCL(x)	L ## x
+#define EXT(x) _ ## x
+#define LEXT(x) _ ## x ## :
+#define LBc(x,n) n ## :
+#define LBb(x,n) n ## b
+#define LBf(x,n) n ## f
+#else /* __STDC__ */
+#define LCL(x) L/**/x
+#define EXT(x) _/**/x
+#define LEXT(x) _/**/x/**/:
+#define LBc(x,n) n/**/:
+#define LBb(x,n) n/**/b
+#define LBf(x,n) n/**/f
+#endif /* __STDC__ */
+
+#define String	.asciz
+#define Value	.word
+#define Times(a,b) (a*b)
+#define Divide(a,b) (a/b)
+
+#define data16	.byte 0x66
+#define addr16	.byte 0x67
+
+#define MCOUNT
+
+#define ELF_FUNC(x)
+#define ELF_DATA(x)
+#define ELF_SIZE(x,s)
+
+#define	Entry(x,tag)	.text@.align FALIGN@ .globl EXT(x)@ LEXT(x)
+#define	ENTRY(x,tag)	Entry(x,tag)@MCOUNT
+#define	ENTRY2(x,y,tag)	.text@ .align FALIGN@ .globl EXT(x)@ .globl EXT(y)@ \
+			LEXT(x)@ LEXT(y) @\
+			MCOUNT
+#if __STDC__
+#define	ASENTRY(x) 	.globl x @ .align FALIGN; x ## @ MCOUNT
+#else
+#define	ASENTRY(x) 	.globl x @ .align FALIGN; x @ MCOUNT
+#endif /* __STDC__ */
+#define	DATA(x)		.globl EXT(x) @ .align ALIGN @ LEXT(x)
+
+
+#define End(x)		ELF_SIZE(x,.-x)
+#define END(x)		End(EXT(x))
+#define ENDDATA(x)	END(x)
+#define Enddata(x)	End(x)
+
+/* These defines are here for .c files that wish to reference global symbols
+ * within __asm__ statements. 
+ */
+#define CC_SYM_PREFIX "_"
+
+#endif /* _PPC_ASM_H_ */
diff -urN cctools-806-old/include/mach/ppc/boolean.h cctools-806/include/mach/ppc/boolean.h
--- cctools-806-old/include/mach/ppc/boolean.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/boolean.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,68 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	boolean.h
+ *
+ *	Boolean type, for ppc.
+ */
+
+#ifndef	_MACH_PPC_BOOLEAN_H_
+#define _MACH_PPC_BOOLEAN_H_
+
+#if defined(__ppc64__)
+typedef unsigned int	boolean_t;
+#else
+typedef int		boolean_t;
+#endif
+
+#endif	/* _MACH_PPC_BOOLEAN_H_ */
diff -urN cctools-806-old/include/mach/ppc/exception.h cctools-806/include/mach/ppc/exception.h
--- cctools-806-old/include/mach/ppc/exception.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/exception.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,113 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Copyright (c) 1990, 1991, 1992, The University of Utah and
+ * the Center for Software Science at the University of Utah (CSS).
+ * All rights reserved.
+ *
+ * Permission to use, copy, modify and distribute this software is hereby
+ * granted provided that (1) source code retains these copyright, permission,
+ * and disclaimer notices, and (2) redistributions including binaries
+ * reproduce the notices in supporting documentation, and (3) all advertising
+ * materials mentioning features or use of this software display the following
+ * acknowledgement: ``This product includes software developed by the Center
+ * for Software Science at the University of Utah.''
+ *
+ * THE UNIVERSITY OF UTAH AND CSS ALLOW FREE USE OF THIS SOFTWARE IN ITS "AS
+ * IS" CONDITION.  THE UNIVERSITY OF UTAH AND CSS DISCLAIM ANY LIABILITY OF
+ * ANY KIND FOR ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ *
+ * CSS requests users of this software to return to css-dist@cs.utah.edu any
+ * improvements that they make and grant CSS redistribution rights.
+ *
+ * 	Utah $Hdr: $
+ */
+
+#ifndef	_MACH_PPC_EXCEPTION_H_
+#define _MACH_PPC_EXCEPTION_H_
+
+#define	EXC_TYPES_COUNT	10	/* incl. illegal exception 0 */
+
+#define EXCEPTION_CODE_MAX 2    /* elements in vector (code+subcode) */
+/*
+ *	EXC_BAD_INSTRUCTION
+ */
+
+#define EXC_PPC_INVALID_SYSCALL	1    /* invalid syscall number */
+#define EXC_PPC_UNIPL_INST	2    /* unimplemented instruction */
+#define EXC_PPC_PRIVINST	3    /* priviledged instruction */
+#define EXC_PPC_PRIVREG		4    /* priviledged register */
+#define EXC_PPC_TRACE		5    /* trace/single-step */
+#define EXC_PPC_PERFMON     6    /* performance monitor */ 
+
+/*
+ *	EXC_BAD_ACCESS
+ *	Note: do not conflict with kern_return_t values returned by vm_fault
+ */
+
+#define EXC_PPC_VM_PROT_READ		0x101 /* error reading syscall args */
+#define EXC_PPC_BADSPACE		0x102 /* bad space referenced */
+#define EXC_PPC_UNALIGNED		0x103 /* unaligned data reference */
+
+/*
+ *	EXC_ARITHMETIC
+ */
+
+#define EXC_PPC_OVERFLOW		1    /* integer overflow */
+#define EXC_PPC_ZERO_DIVIDE		2    /* integer divide by zero */
+#define EXC_PPC_FLT_INEXACT		3    /* IEEE inexact exception */
+#define EXC_PPC_FLT_ZERO_DIVIDE		4    /* IEEE zero divide */
+#define EXC_PPC_FLT_UNDERFLOW		5    /* IEEE floating underflow */
+#define EXC_PPC_FLT_OVERFLOW		6    /* IEEE floating overflow */
+#define EXC_PPC_FLT_NOT_A_NUMBER	7    /* IEEE not a number */
+
+/*
+ * EXC_PPC_NOEMULATION should go away when we add software emulation
+ * for floating point. Right now we don't support this.
+ */
+
+#define EXC_PPC_NOEMULATION		8	/* no floating point emulation */
+#define EXC_PPC_ALTIVECASSIST	9	/* Altivec Denorm Assist */
+
+/*
+ *	EXC_SOFTWARE
+ * 	Note: 0x10000-0x10003 in use for unix signal 
+ */
+#define EXC_PPC_TRAP		1		/* Program trap */
+#define EXC_PPC_MIGRATE		0x10100		/* Time to bolt */
+
+
+/*
+ *	EXC_BREAKPOINT
+ */
+
+#define EXC_PPC_BREAKPOINT		EXC_PPC_TRAP    /* breakpoint trap */
+
+/*
+ *	machine dependent exception masks
+ */
+#define	EXC_MASK_MACHINE	0
+
+#endif	/* _MACH_PPC_EXCEPTION_H_ */
diff -urN cctools-806-old/include/mach/ppc/kern_return.h cctools-806/include/mach/ppc/kern_return.h
--- cctools-806-old/include/mach/ppc/kern_return.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/kern_return.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,68 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	kern_return.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *	Date:	1985
+ *
+ *	Machine-dependent kernel return definitions.
+ */
+
+#ifndef	_MACH_PPC_KERN_RETURN_H_
+#define _MACH_PPC_KERN_RETURN_H_
+
+#ifndef	ASSEMBLER
+typedef	int		kern_return_t;
+#endif	/* ASSEMBLER */
+
+#endif	/* _MACH_PPC_KERN_RETURN_H_ */
diff -urN cctools-806-old/include/mach/ppc/machine_types.defs cctools-806/include/mach/ppc/machine_types.defs
--- cctools-806-old/include/mach/ppc/machine_types.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/machine_types.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,108 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+/*
+ *	Header file for basic, machine-dependent data types.
+ */
+
+#ifndef	_PPC_VM_TYPES_DEFS_
+#define	_PPC_VM_TYPES_DEFS_
+
+type short = int16_t;
+type int = int32_t;
+type unsigned = uint32_t;
+
+type float = MACH_MSG_TYPE_REAL_32;
+type double = MACH_MSG_TYPE_REAL_64;
+
+/* from ISO/IEC 988:1999 spec */
+/* 7.18.1.4 Integer types capable of holding object pointers */
+/*
+ * The [u]intptr_t types for the native
+ * integer type, e.g. 32 or 64 or.. whatever
+ * register size the machine has.  They are
+ * used for entities that might be either
+ * [unsigned] integers or pointers, and for
+ * type-casting between the two.
+ *
+ * For instance, the IPC system represents
+ * a port in user space as an integer and
+ * in kernel space as a pointer.
+ */
+#if defined(__ppc64__)
+type uintptr_t = uint64_t;
+type intptr_t = int64_t;
+#else
+type uintptr_t = uint32_t;
+type intptr_t = int32_t;
+#endif
+
+/*
+ * These are the legacy Mach types that are
+ * the [rough] equivalents of the standards above.
+ * They were defined in terms of int, not
+ * long int, so they remain separate.
+ */
+#if defined(__ppc64__)
+type register_t = int64_t;
+#else
+type register_t = int32_t;
+#endif
+type integer_t = int32_t;
+type natural_t = uint32_t;
+
+/*
+ * These are the VM types that scale with the address
+ * space size of a given process.
+ */
+
+#if defined(__ppc64__)
+type vm_address_t = uint64_t;
+type vm_offset_t = uint64_t;
+type vm_size_t = uint64_t;
+#else
+type vm_address_t = natural_t;
+type vm_offset_t = natural_t;
+type vm_size_t = natural_t;
+#endif
+
+/*
+ * The mach_vm_xxx_t types are sized to hold the
+ * maximum pointer, offset, etc... supported on the
+ * platform.
+ */
+type mach_vm_address_t = uint64_t;
+type mach_vm_offset_t = uint64_t;
+type mach_vm_size_t = uint64_t;
+
+#if	MACH_IPC_COMPAT
+/*
+ * For the old IPC interface
+ */
+#define	MSG_TYPE_PORT_NAME	uint32_t
+
+#endif	/* MACH_IPC_COMPAT */
+
+#endif	/* _PPC_VM_TYPES_DEFS_ */
diff -urN cctools-806-old/include/mach/ppc/ndr_def.h cctools-806/include/mach/ppc/ndr_def.h
--- cctools-806-old/include/mach/ppc/ndr_def.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/ndr_def.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,37 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#include <mach/ndr.h>
+
+NDR_record_t NDR_record = {
+	0,			/* mig_reserved */
+	0,			/* mig_reserved */
+	0,			/* mig_reserved */
+	NDR_PROTOCOL_2_0,		
+	NDR_INT_BIG_ENDIAN,
+	NDR_CHAR_ASCII,
+	NDR_FLOAT_IEEE,
+	0,
+};
diff -urN cctools-806-old/include/mach/ppc/processor_info.h cctools-806/include/mach/ppc/processor_info.h
--- cctools-806-old/include/mach/ppc/processor_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/processor_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,36 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+/*
+ *	File:	mach/ppc/processor_info.h
+ *
+ *	Data structure definitions for ppc specific processor control
+ */
+
+#ifndef	_MACH_PPC_PROCESSOR_INFO_H_
+#define _MACH_PPC_PROCESSOR_INFO_H_
+
+#include <mach/machine.h>
+#include <mach/message.h>
+
+
+#endif	/* _MACH_PPC_PROCESSOR_INFO_H_ */
diff -urN cctools-806-old/include/mach/ppc/rpc.h cctools-806/include/mach/ppc/rpc.h
--- cctools-806-old/include/mach/ppc/rpc.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/rpc.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,29 @@
+/*
+ * Copyright (c) 2002,2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef	_MACH_PPC_RPC_H_
+#define	_MACH_PPC_RPC_H_
+
+#endif	/* _MACH_PPC_RPC_H_ */
diff -urN cctools-806-old/include/mach/ppc/_structs.h cctools-806/include/mach/ppc/_structs.h
--- cctools-806-old/include/mach/ppc/_structs.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/_structs.h	2011-09-07 01:45:04.000000000 -0500
@@ -136,7 +136,7 @@
 };
 #endif /* __DARWIN_UNIX03 */
 
-#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
+#ifdef _POSIX_C_SOURCE
 
 #pragma pack(4)			/* Make sure the structure stays as we defined it */
 
@@ -187,7 +187,8 @@
 	unsigned int __vrsave;		/* Vector Save Register */
 };
 #else /* !__DARWIN_UNIX03 */
-#define _STRUCT_PPC_THREAD_STATE64	struct ppc_thread_state64
+/* #define _STRUCT_PPC_THREAD_STATE64	struct ppc_thread_state64 */
+#define _STRUCT_PPC_THREAD_STATE64 struct __darwin_ppc_thread_state64
 _STRUCT_PPC_THREAD_STATE64
 {
 	unsigned long long srr0;	/* Instruction address register (PC) */
@@ -236,7 +237,7 @@
 
 #pragma pack()
 
-#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+#endif /* _POSIX_C_SOURCE */
 
 /* This structure should be double-word aligned for performance */
 
diff -urN cctools-806-old/include/mach/ppc/task.h cctools-806/include/mach/ppc/task.h
--- cctools-806-old/include/mach/ppc/task.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/task.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1491 @@
+#ifndef	_task_user_
+#define	_task_user_
+
+/* Module task */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry 	*function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	task_MSG_COUNT
+#define	task_MSG_COUNT	33
+#endif	/* task_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine task_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_create
+(
+	task_t target_task,
+	ledger_array_t ledgers,
+	mach_msg_type_number_t ledgersCnt,
+	boolean_t inherit_memory,
+	task_t *child_task
+);
+
+/* Routine task_terminate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_terminate
+(
+	task_t target_task
+);
+
+/* Routine task_threads */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_threads
+(
+	task_t target_task,
+	thread_act_array_t *act_list,
+	mach_msg_type_number_t *act_listCnt
+);
+
+/* Routine mach_ports_register */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_ports_register
+(
+	task_t target_task,
+	mach_port_array_t init_port_set,
+	mach_msg_type_number_t init_port_setCnt
+);
+
+/* Routine mach_ports_lookup */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_ports_lookup
+(
+	task_t target_task,
+	mach_port_array_t *init_port_set,
+	mach_msg_type_number_t *init_port_setCnt
+);
+
+/* Routine task_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_info
+(
+	task_name_t target_task,
+	task_flavor_t flavor,
+	task_info_t task_info_out,
+	mach_msg_type_number_t *task_info_outCnt
+);
+
+/* Routine task_set_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_info
+(
+	task_t target_task,
+	task_flavor_t flavor,
+	task_info_t task_info_in,
+	mach_msg_type_number_t task_info_inCnt
+);
+
+/* Routine task_suspend */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_suspend
+(
+	task_t target_task
+);
+
+/* Routine task_resume */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_resume
+(
+	task_t target_task
+);
+
+/* Routine task_get_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_special_port
+(
+	task_t task,
+	int which_port,
+	mach_port_t *special_port
+);
+
+/* Routine task_set_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_special_port
+(
+	task_t task,
+	int which_port,
+	mach_port_t special_port
+);
+
+/* Routine thread_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_create
+(
+	task_t parent_task,
+	thread_act_t *child_act
+);
+
+/* Routine thread_create_running */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_create_running
+(
+	task_t parent_task,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt,
+	thread_act_t *child_act
+);
+
+/* Routine task_set_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor
+);
+
+/* Routine task_get_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine task_swap_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_swap_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlerss,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine lock_set_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_set_create
+(
+	task_t task,
+	lock_set_t *new_lock_set,
+	int n_ulocks,
+	int policy
+);
+
+/* Routine lock_set_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_set_destroy
+(
+	task_t task,
+	lock_set_t lock_set
+);
+
+/* Routine semaphore_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t semaphore_create
+(
+	task_t task,
+	semaphore_t *semaphore,
+	int policy,
+	int value
+);
+
+/* Routine semaphore_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t semaphore_destroy
+(
+	task_t task,
+	semaphore_t semaphore
+);
+
+/* Routine task_policy_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy_set
+(
+	task_t task,
+	task_policy_flavor_t flavor,
+	task_policy_t policy_info,
+	mach_msg_type_number_t policy_infoCnt
+);
+
+/* Routine task_policy_get */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy_get
+(
+	task_t task,
+	task_policy_flavor_t flavor,
+	task_policy_t policy_info,
+	mach_msg_type_number_t *policy_infoCnt,
+	boolean_t *get_default
+);
+
+/* Routine task_sample */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_sample
+(
+	task_t task,
+	mach_port_t reply
+);
+
+/* Routine task_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy
+(
+	task_t task,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	boolean_t set_limit,
+	boolean_t change
+);
+
+/* Routine task_set_emulation */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_emulation
+(
+	task_t target_port,
+	vm_address_t routine_entry_pt,
+	int routine_number
+);
+
+/* Routine task_get_emulation_vector */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_emulation_vector
+(
+	task_t task,
+	int *vector_start,
+	emulation_vector_t *emulation_vector,
+	mach_msg_type_number_t *emulation_vectorCnt
+);
+
+/* Routine task_set_emulation_vector */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_emulation_vector
+(
+	task_t task,
+	int vector_start,
+	emulation_vector_t emulation_vector,
+	mach_msg_type_number_t emulation_vectorCnt
+);
+
+/* Routine task_set_ras_pc */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_ras_pc
+(
+	task_t target_task,
+	vm_address_t basepc,
+	vm_address_t boundspc
+);
+
+/* Routine task_assign */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_assign
+(
+	task_t task,
+	processor_set_t new_set,
+	boolean_t assign_threads
+);
+
+/* Routine task_assign_default */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_assign_default
+(
+	task_t task,
+	boolean_t assign_threads
+);
+
+/* Routine task_get_assignment */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_assignment
+(
+	task_t task,
+	processor_set_name_t *assigned_set
+);
+
+/* Routine task_set_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_policy
+(
+	task_t task,
+	processor_set_t pset,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	policy_limit_t limit,
+	mach_msg_type_number_t limitCnt,
+	boolean_t change
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__task_subsystem__defined
+#define __Request__task_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t ledgers;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t ledgersCnt;
+		boolean_t inherit_memory;
+	} __Request__task_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t init_port_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t init_port_setCnt;
+	} __Request__mach_ports_register_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__mach_ports_lookup_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_flavor_t flavor;
+		mach_msg_type_number_t task_info_outCnt;
+	} __Request__task_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_flavor_t flavor;
+		mach_msg_type_number_t task_info_inCnt;
+		integer_t task_info_in[10];
+	} __Request__task_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__task_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__task_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__thread_create_running_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__task_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+	} __Request__task_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__task_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int n_ulocks;
+		int policy;
+	} __Request__lock_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t lock_set;
+		/* end of the kernel processed data */
+	} __Request__lock_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int policy;
+		int value;
+	} __Request__semaphore_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t semaphore;
+		/* end of the kernel processed data */
+	} __Request__semaphore_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+	} __Request__task_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		boolean_t get_default;
+	} __Request__task_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t reply;
+		/* end of the kernel processed data */
+	} __Request__task_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		boolean_t set_limit;
+		boolean_t change;
+	} __Request__task_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t routine_entry_pt;
+		int routine_number;
+	} __Request__task_set_emulation_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_get_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t emulation_vector;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int vector_start;
+		mach_msg_type_number_t emulation_vectorCnt;
+	} __Request__task_set_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t basepc;
+		vm_address_t boundspc;
+	} __Request__task_set_ras_pc_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t assign_threads;
+	} __Request__task_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		boolean_t assign_threads;
+	} __Request__task_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pset;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		mach_msg_type_number_t limitCnt;
+		integer_t limit[1];
+		boolean_t change;
+	} __Request__task_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__task_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__task_subsystem__defined
+#define __RequestUnion__task_subsystem__defined
+union __RequestUnion__task_subsystem {
+	__Request__task_create_t Request_task_create;
+	__Request__task_terminate_t Request_task_terminate;
+	__Request__task_threads_t Request_task_threads;
+	__Request__mach_ports_register_t Request_mach_ports_register;
+	__Request__mach_ports_lookup_t Request_mach_ports_lookup;
+	__Request__task_info_t Request_task_info;
+	__Request__task_set_info_t Request_task_set_info;
+	__Request__task_suspend_t Request_task_suspend;
+	__Request__task_resume_t Request_task_resume;
+	__Request__task_get_special_port_t Request_task_get_special_port;
+	__Request__task_set_special_port_t Request_task_set_special_port;
+	__Request__thread_create_t Request_thread_create;
+	__Request__thread_create_running_t Request_thread_create_running;
+	__Request__task_set_exception_ports_t Request_task_set_exception_ports;
+	__Request__task_get_exception_ports_t Request_task_get_exception_ports;
+	__Request__task_swap_exception_ports_t Request_task_swap_exception_ports;
+	__Request__lock_set_create_t Request_lock_set_create;
+	__Request__lock_set_destroy_t Request_lock_set_destroy;
+	__Request__semaphore_create_t Request_semaphore_create;
+	__Request__semaphore_destroy_t Request_semaphore_destroy;
+	__Request__task_policy_set_t Request_task_policy_set;
+	__Request__task_policy_get_t Request_task_policy_get;
+	__Request__task_sample_t Request_task_sample;
+	__Request__task_policy_t Request_task_policy;
+	__Request__task_set_emulation_t Request_task_set_emulation;
+	__Request__task_get_emulation_vector_t Request_task_get_emulation_vector;
+	__Request__task_set_emulation_vector_t Request_task_set_emulation_vector;
+	__Request__task_set_ras_pc_t Request_task_set_ras_pc;
+	__Request__task_assign_t Request_task_assign;
+	__Request__task_assign_default_t Request_task_assign_default;
+	__Request__task_get_assignment_t Request_task_get_assignment;
+	__Request__task_set_policy_t Request_task_set_policy;
+};
+#endif /* !__RequestUnion__task_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__task_subsystem__defined
+#define __Reply__task_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_task;
+		/* end of the kernel processed data */
+	} __Reply__task_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t act_list;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t act_listCnt;
+	} __Reply__task_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_ports_register_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t init_port_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t init_port_setCnt;
+	} __Reply__mach_ports_lookup_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t task_info_outCnt;
+		integer_t task_info_out[10];
+	} __Reply__task_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+	} __Reply__task_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_act;
+		/* end of the kernel processed data */
+	} __Reply__thread_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_act;
+		/* end of the kernel processed data */
+	} __Reply__thread_create_running_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__task_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlerss[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__task_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_lock_set;
+		/* end of the kernel processed data */
+	} __Reply__lock_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t semaphore;
+		/* end of the kernel processed data */
+	} __Reply__semaphore_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__semaphore_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+		boolean_t get_default;
+	} __Reply__task_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_emulation_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t emulation_vector;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int vector_start;
+		mach_msg_type_number_t emulation_vectorCnt;
+	} __Reply__task_get_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_ras_pc_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t assigned_set;
+		/* end of the kernel processed data */
+	} __Reply__task_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__task_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__task_subsystem__defined
+#define __ReplyUnion__task_subsystem__defined
+union __ReplyUnion__task_subsystem {
+	__Reply__task_create_t Reply_task_create;
+	__Reply__task_terminate_t Reply_task_terminate;
+	__Reply__task_threads_t Reply_task_threads;
+	__Reply__mach_ports_register_t Reply_mach_ports_register;
+	__Reply__mach_ports_lookup_t Reply_mach_ports_lookup;
+	__Reply__task_info_t Reply_task_info;
+	__Reply__task_set_info_t Reply_task_set_info;
+	__Reply__task_suspend_t Reply_task_suspend;
+	__Reply__task_resume_t Reply_task_resume;
+	__Reply__task_get_special_port_t Reply_task_get_special_port;
+	__Reply__task_set_special_port_t Reply_task_set_special_port;
+	__Reply__thread_create_t Reply_thread_create;
+	__Reply__thread_create_running_t Reply_thread_create_running;
+	__Reply__task_set_exception_ports_t Reply_task_set_exception_ports;
+	__Reply__task_get_exception_ports_t Reply_task_get_exception_ports;
+	__Reply__task_swap_exception_ports_t Reply_task_swap_exception_ports;
+	__Reply__lock_set_create_t Reply_lock_set_create;
+	__Reply__lock_set_destroy_t Reply_lock_set_destroy;
+	__Reply__semaphore_create_t Reply_semaphore_create;
+	__Reply__semaphore_destroy_t Reply_semaphore_destroy;
+	__Reply__task_policy_set_t Reply_task_policy_set;
+	__Reply__task_policy_get_t Reply_task_policy_get;
+	__Reply__task_sample_t Reply_task_sample;
+	__Reply__task_policy_t Reply_task_policy;
+	__Reply__task_set_emulation_t Reply_task_set_emulation;
+	__Reply__task_get_emulation_vector_t Reply_task_get_emulation_vector;
+	__Reply__task_set_emulation_vector_t Reply_task_set_emulation_vector;
+	__Reply__task_set_ras_pc_t Reply_task_set_ras_pc;
+	__Reply__task_assign_t Reply_task_assign;
+	__Reply__task_assign_default_t Reply_task_assign_default;
+	__Reply__task_get_assignment_t Reply_task_get_assignment;
+	__Reply__task_set_policy_t Reply_task_set_policy;
+};
+#endif /* !__RequestUnion__task_subsystem__defined */
+
+#ifndef subsystem_to_name_map_task
+#define subsystem_to_name_map_task \
+    { "task_create", 3400 },\
+    { "task_terminate", 3401 },\
+    { "task_threads", 3402 },\
+    { "mach_ports_register", 3403 },\
+    { "mach_ports_lookup", 3404 },\
+    { "task_info", 3405 },\
+    { "task_set_info", 3406 },\
+    { "task_suspend", 3407 },\
+    { "task_resume", 3408 },\
+    { "task_get_special_port", 3409 },\
+    { "task_set_special_port", 3410 },\
+    { "thread_create", 3411 },\
+    { "thread_create_running", 3412 },\
+    { "task_set_exception_ports", 3413 },\
+    { "task_get_exception_ports", 3414 },\
+    { "task_swap_exception_ports", 3415 },\
+    { "lock_set_create", 3416 },\
+    { "lock_set_destroy", 3417 },\
+    { "semaphore_create", 3418 },\
+    { "semaphore_destroy", 3419 },\
+    { "task_policy_set", 3420 },\
+    { "task_policy_get", 3421 },\
+    { "task_sample", 3422 },\
+    { "task_policy", 3423 },\
+    { "task_set_emulation", 3424 },\
+    { "task_get_emulation_vector", 3425 },\
+    { "task_set_emulation_vector", 3426 },\
+    { "task_set_ras_pc", 3427 },\
+    { "task_assign", 3429 },\
+    { "task_assign_default", 3430 },\
+    { "task_get_assignment", 3431 },\
+    { "task_set_policy", 3432 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _task_user_ */
diff -urN cctools-806-old/include/mach/ppc/thread_act.h cctools-806/include/mach/ppc/thread_act.h
--- cctools-806-old/include/mach/ppc/thread_act.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/thread_act.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1155 @@
+#ifndef	_thread_act_user_
+#define	_thread_act_user_
+
+/* Module thread_act */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry 	*function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	thread_act_MSG_COUNT
+#define	thread_act_MSG_COUNT	25
+#endif	/* thread_act_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine thread_terminate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_terminate
+(
+	thread_act_t target_act
+);
+
+/* Routine act_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t act_get_state
+(
+	thread_act_t target_act,
+	int flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine act_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t act_set_state
+(
+	thread_act_t target_act,
+	int flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+/* Routine thread_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_state
+(
+	thread_act_t target_act,
+	thread_state_flavor_t flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine thread_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_state
+(
+	thread_act_t target_act,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+/* Routine thread_suspend */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_suspend
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_resume */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_resume
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_abort */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_abort
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_abort_safely */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_abort_safely
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_depress_abort */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_depress_abort
+(
+	thread_act_t thread
+);
+
+/* Routine thread_get_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_special_port
+(
+	thread_act_t thr_act,
+	int which_port,
+	mach_port_t *special_port
+);
+
+/* Routine thread_set_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_special_port
+(
+	thread_act_t thr_act,
+	int which_port,
+	mach_port_t special_port
+);
+
+/* Routine thread_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_info
+(
+	thread_act_t target_act,
+	thread_flavor_t flavor,
+	thread_info_t thread_info_out,
+	mach_msg_type_number_t *thread_info_outCnt
+);
+
+/* Routine thread_set_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor
+);
+
+/* Routine thread_get_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine thread_swap_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_swap_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine thread_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy
+(
+	thread_act_t thr_act,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	boolean_t set_limit
+);
+
+/* Routine thread_policy_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy_set
+(
+	thread_act_t thread,
+	thread_policy_flavor_t flavor,
+	thread_policy_t policy_info,
+	mach_msg_type_number_t policy_infoCnt
+);
+
+/* Routine thread_policy_get */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy_get
+(
+	thread_act_t thread,
+	thread_policy_flavor_t flavor,
+	thread_policy_t policy_info,
+	mach_msg_type_number_t *policy_infoCnt,
+	boolean_t *get_default
+);
+
+/* Routine thread_sample */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_sample
+(
+	thread_act_t thread,
+	mach_port_t reply
+);
+
+/* Routine etap_trace_thread */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t etap_trace_thread
+(
+	thread_act_t target_act,
+	boolean_t trace_status
+);
+
+/* Routine thread_assign */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_assign
+(
+	thread_act_t thread,
+	processor_set_t new_set
+);
+
+/* Routine thread_assign_default */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_assign_default
+(
+	thread_act_t thread
+);
+
+/* Routine thread_get_assignment */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_assignment
+(
+	thread_act_t thread,
+	processor_set_name_t *assigned_set
+);
+
+/* Routine thread_set_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_policy
+(
+	thread_act_t thr_act,
+	processor_set_t pset,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	policy_limit_t limit,
+	mach_msg_type_number_t limitCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__thread_act_subsystem__defined
+#define __Request__thread_act_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__act_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__act_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__thread_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__thread_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_abort_safely_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_depress_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__thread_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__thread_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_flavor_t flavor;
+		mach_msg_type_number_t thread_info_outCnt;
+	} __Request__thread_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__thread_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+	} __Request__thread_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__thread_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		boolean_t set_limit;
+	} __Request__thread_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+	} __Request__thread_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		boolean_t get_default;
+	} __Request__thread_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t reply;
+		/* end of the kernel processed data */
+	} __Request__thread_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		boolean_t trace_status;
+	} __Request__etap_trace_thread_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		/* end of the kernel processed data */
+	} __Request__thread_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pset;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		mach_msg_type_number_t limitCnt;
+		integer_t limit[1];
+	} __Request__thread_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__thread_act_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__thread_act_subsystem__defined
+#define __RequestUnion__thread_act_subsystem__defined
+union __RequestUnion__thread_act_subsystem {
+	__Request__thread_terminate_t Request_thread_terminate;
+	__Request__act_get_state_t Request_act_get_state;
+	__Request__act_set_state_t Request_act_set_state;
+	__Request__thread_get_state_t Request_thread_get_state;
+	__Request__thread_set_state_t Request_thread_set_state;
+	__Request__thread_suspend_t Request_thread_suspend;
+	__Request__thread_resume_t Request_thread_resume;
+	__Request__thread_abort_t Request_thread_abort;
+	__Request__thread_abort_safely_t Request_thread_abort_safely;
+	__Request__thread_depress_abort_t Request_thread_depress_abort;
+	__Request__thread_get_special_port_t Request_thread_get_special_port;
+	__Request__thread_set_special_port_t Request_thread_set_special_port;
+	__Request__thread_info_t Request_thread_info;
+	__Request__thread_set_exception_ports_t Request_thread_set_exception_ports;
+	__Request__thread_get_exception_ports_t Request_thread_get_exception_ports;
+	__Request__thread_swap_exception_ports_t Request_thread_swap_exception_ports;
+	__Request__thread_policy_t Request_thread_policy;
+	__Request__thread_policy_set_t Request_thread_policy_set;
+	__Request__thread_policy_get_t Request_thread_policy_get;
+	__Request__thread_sample_t Request_thread_sample;
+	__Request__etap_trace_thread_t Request_etap_trace_thread;
+	__Request__thread_assign_t Request_thread_assign;
+	__Request__thread_assign_default_t Request_thread_assign_default;
+	__Request__thread_get_assignment_t Request_thread_get_assignment;
+	__Request__thread_set_policy_t Request_thread_set_policy;
+};
+#endif /* !__RequestUnion__thread_act_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__thread_act_subsystem__defined
+#define __Reply__thread_act_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[144];
+	} __Reply__act_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__act_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[144];
+	} __Reply__thread_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_abort_safely_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_depress_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+	} __Reply__thread_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t thread_info_outCnt;
+		integer_t thread_info_out[12];
+	} __Reply__thread_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__thread_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__thread_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+		boolean_t get_default;
+	} __Reply__thread_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__etap_trace_thread_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t assigned_set;
+		/* end of the kernel processed data */
+	} __Reply__thread_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__thread_act_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__thread_act_subsystem__defined
+#define __ReplyUnion__thread_act_subsystem__defined
+union __ReplyUnion__thread_act_subsystem {
+	__Reply__thread_terminate_t Reply_thread_terminate;
+	__Reply__act_get_state_t Reply_act_get_state;
+	__Reply__act_set_state_t Reply_act_set_state;
+	__Reply__thread_get_state_t Reply_thread_get_state;
+	__Reply__thread_set_state_t Reply_thread_set_state;
+	__Reply__thread_suspend_t Reply_thread_suspend;
+	__Reply__thread_resume_t Reply_thread_resume;
+	__Reply__thread_abort_t Reply_thread_abort;
+	__Reply__thread_abort_safely_t Reply_thread_abort_safely;
+	__Reply__thread_depress_abort_t Reply_thread_depress_abort;
+	__Reply__thread_get_special_port_t Reply_thread_get_special_port;
+	__Reply__thread_set_special_port_t Reply_thread_set_special_port;
+	__Reply__thread_info_t Reply_thread_info;
+	__Reply__thread_set_exception_ports_t Reply_thread_set_exception_ports;
+	__Reply__thread_get_exception_ports_t Reply_thread_get_exception_ports;
+	__Reply__thread_swap_exception_ports_t Reply_thread_swap_exception_ports;
+	__Reply__thread_policy_t Reply_thread_policy;
+	__Reply__thread_policy_set_t Reply_thread_policy_set;
+	__Reply__thread_policy_get_t Reply_thread_policy_get;
+	__Reply__thread_sample_t Reply_thread_sample;
+	__Reply__etap_trace_thread_t Reply_etap_trace_thread;
+	__Reply__thread_assign_t Reply_thread_assign;
+	__Reply__thread_assign_default_t Reply_thread_assign_default;
+	__Reply__thread_get_assignment_t Reply_thread_get_assignment;
+	__Reply__thread_set_policy_t Reply_thread_set_policy;
+};
+#endif /* !__RequestUnion__thread_act_subsystem__defined */
+
+#ifndef subsystem_to_name_map_thread_act
+#define subsystem_to_name_map_thread_act \
+    { "thread_terminate", 3600 },\
+    { "act_get_state", 3601 },\
+    { "act_set_state", 3602 },\
+    { "thread_get_state", 3603 },\
+    { "thread_set_state", 3604 },\
+    { "thread_suspend", 3605 },\
+    { "thread_resume", 3606 },\
+    { "thread_abort", 3607 },\
+    { "thread_abort_safely", 3608 },\
+    { "thread_depress_abort", 3609 },\
+    { "thread_get_special_port", 3610 },\
+    { "thread_set_special_port", 3611 },\
+    { "thread_info", 3612 },\
+    { "thread_set_exception_ports", 3613 },\
+    { "thread_get_exception_ports", 3614 },\
+    { "thread_swap_exception_ports", 3615 },\
+    { "thread_policy", 3616 },\
+    { "thread_policy_set", 3617 },\
+    { "thread_policy_get", 3618 },\
+    { "thread_sample", 3619 },\
+    { "etap_trace_thread", 3620 },\
+    { "thread_assign", 3621 },\
+    { "thread_assign_default", 3622 },\
+    { "thread_get_assignment", 3623 },\
+    { "thread_set_policy", 3624 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _thread_act_user_ */
diff -urN cctools-806-old/include/mach/ppc/thread_state.h cctools-806/include/mach/ppc/thread_state.h
--- cctools-806-old/include/mach/ppc/thread_state.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/thread_state.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,36 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef _MACH_PPC_THREAD_STATE_H_
+#define _MACH_PPC_THREAD_STATE_H_
+
+/* Size of maximum exported thread state in words */
+#define PPC_THREAD_STATE_MAX	(144)    /* Size of biggest state possible */
+
+#if defined (__ppc__) || defined (__ppc64__)
+#define THREAD_STATE_MAX	PPC_THREAD_STATE_MAX
+#endif
+
+#endif	/* _MACH_PPC_THREAD_STATE_H_ */
diff -urN cctools-806-old/include/mach/ppc/thread_status.h cctools-806/include/mach/ppc/thread_status.h
--- cctools-806-old/include/mach/ppc/thread_status.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/thread_status.h	2011-09-07 01:45:04.000000000 -0500
@@ -70,9 +70,11 @@
 */
 
 typedef _STRUCT_PPC_THREAD_STATE	ppc_thread_state_t;
-#if !defined(_POSIX_C_SOURCE) || defined(_DARWIN_C_SOURCE)
-typedef _STRUCT_PPC_THREAD_STATE64	ppc_thread_state64_t;
-#endif /* (_POSIX_C_SOURCE && !_DARWIN_C_SOURCE) */
+#ifndef _POSIX_C_SOURCE
+typedef struct ppc_thread_state64		ppc_thread_state64_t;
+#else /* _POSIX_C_SOURCE */
+typedef struct __darwin_ppc_thread_state64  ppc_thread_state64_t;
+#endif /* _POSIX_C_SOURCE */
 typedef _STRUCT_PPC_FLOAT_STATE		ppc_float_state_t;
 typedef _STRUCT_PPC_VECTOR_STATE	ppc_vector_state_t;
 
diff -urN cctools-806-old/include/mach/ppc/_types.h cctools-806/include/mach/ppc/_types.h
--- cctools-806-old/include/mach/ppc/_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,232 @@
+/*
+ * Copyright (c) 2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef	_MACH_PPC__TYPES_H_
+#define	_MACH_PPC__TYPES_H_
+
+/*
+ * ppc_thread_state is the structure that is exported to user threads for 
+ * use in status/mutate calls.  This structure should never change.
+ *
+ */
+
+#ifndef _POSIX_C_SOURCE
+struct ppc_thread_state
+#else /* _POSIX_C_SOURCE */
+struct __darwin_ppc_thread_state
+#endif /* _POSIX_C_SOURCE */
+{
+	unsigned int srr0;      /* Instruction address register (PC) */
+	unsigned int srr1;	/* Machine state register (supervisor) */
+	unsigned int r0;
+	unsigned int r1;
+	unsigned int r2;
+	unsigned int r3;
+	unsigned int r4;
+	unsigned int r5;
+	unsigned int r6;
+	unsigned int r7;
+	unsigned int r8;
+	unsigned int r9;
+	unsigned int r10;
+	unsigned int r11;
+	unsigned int r12;
+	unsigned int r13;
+	unsigned int r14;
+	unsigned int r15;
+	unsigned int r16;
+	unsigned int r17;
+	unsigned int r18;
+	unsigned int r19;
+	unsigned int r20;
+	unsigned int r21;
+	unsigned int r22;
+	unsigned int r23;
+	unsigned int r24;
+	unsigned int r25;
+	unsigned int r26;
+	unsigned int r27;
+	unsigned int r28;
+	unsigned int r29;
+	unsigned int r30;
+	unsigned int r31;
+
+	unsigned int cr;        /* Condition register */
+	unsigned int xer;	/* User's integer exception register */
+	unsigned int lr;	/* Link register */
+	unsigned int ctr;	/* Count register */
+	unsigned int mq;	/* MQ register (601 only) */
+
+	unsigned int vrsave;	/* Vector Save Register */
+};
+
+#pragma pack(4)							/* Make sure the structure stays as we defined it */
+#ifndef _POSIX_C_SOURCE
+struct ppc_thread_state64
+#else /* _POSIX_C_SOURCE */
+struct __darwin_ppc_thread_state64
+#endif
+{
+	unsigned long long srr0;	/* Instruction address register (PC) */
+	unsigned long long srr1;	/* Machine state register (supervisor) */
+	unsigned long long r0;
+	unsigned long long r1;
+	unsigned long long r2;
+	unsigned long long r3;
+	unsigned long long r4;
+	unsigned long long r5;
+	unsigned long long r6;
+	unsigned long long r7;
+	unsigned long long r8;
+	unsigned long long r9;
+	unsigned long long r10;
+	unsigned long long r11;
+	unsigned long long r12;
+	unsigned long long r13;
+	unsigned long long r14;
+	unsigned long long r15;
+	unsigned long long r16;
+	unsigned long long r17;
+	unsigned long long r18;
+	unsigned long long r19;
+	unsigned long long r20;
+	unsigned long long r21;
+	unsigned long long r22;
+	unsigned long long r23;
+	unsigned long long r24;
+	unsigned long long r25;
+	unsigned long long r26;
+	unsigned long long r27;
+	unsigned long long r28;
+	unsigned long long r29;
+	unsigned long long r30;
+	unsigned long long r31;
+
+	unsigned int cr;			/* Condition register */
+	unsigned long long xer;		/* User's integer exception register */
+	unsigned long long lr;		/* Link register */
+	unsigned long long ctr;		/* Count register */
+
+	unsigned int vrsave;		/* Vector Save Register */
+};
+
+#pragma pack()
+
+/* This structure should be double-word aligned for performance */
+
+#ifndef _POSIX_C_SOURCE
+struct ppc_float_state
+#else /* _POSIX_C_SOURCE */
+struct __darwin_ppc_float_state
+#endif /* _POSIX_C_SOURCE */
+{
+	double  fpregs[32];
+
+	unsigned int fpscr_pad; /* fpscr is 64 bits, 32 bits of rubbish */
+	unsigned int fpscr;	/* floating point status register */
+};
+
+#pragma pack(4)		/* Make sure the structure stays as we defined it */
+
+#ifndef _POSIX_C_SOURCE
+struct ppc_vector_state
+#else /* _POSIX_C_SOURCE */
+struct __darwin_ppc_vector_state
+#endif /* _POSIX_C_SOURCE */
+{
+#if defined(__LP64__)
+	unsigned int	save_vr[32][4];
+	unsigned int	save_vscr[4];
+#else
+	unsigned long	save_vr[32][4];
+	unsigned long	save_vscr[4];
+#endif
+	unsigned int	save_pad5[4];
+	unsigned int	save_vrvalid;			/* VRs that have been saved */
+	unsigned int	save_pad6[7];
+};
+#pragma pack()
+
+/*
+ * ppc_exception_state
+ *
+ * This structure corresponds to some additional state of the user
+ * registers as saved in the PCB upon kernel entry. They are only
+ * available if an exception is passed out of the kernel, and even
+ * then not all are guaranteed to be updated.
+ *
+ * Some padding is included in this structure which allows space for
+ * servers to store temporary values if need be, to maintain binary
+ * compatiblity.
+ */
+
+/* Exception state for 32-bit thread (on 32-bit processor) */
+/* Still available on 64-bit processors, but may fall short */
+/* of covering the full potential state (hi half available). */
+
+#pragma pack(4)	/* Make sure the structure stays as we defined it */
+
+#ifndef _POSIX_C_SOURCE
+struct ppc_exception_state
+#else /* _POSIX_C_SOURCE */
+struct __darwin_ppc_exception_state
+#endif /* _POSIX_C_SOURCE */
+{
+#if defined(__LP64__)
+	unsigned int dar;			/* Fault registers for coredump */
+	unsigned int dsisr;
+	unsigned int exception;	/* number of powerpc exception taken */
+	unsigned int pad0;			/* align to 16 bytes */
+	unsigned int pad1[4];		/* space in PCB "just in case" */
+#else
+	unsigned long dar;			/* Fault registers for coredump */
+	unsigned long dsisr;
+	unsigned long exception;	/* number of powerpc exception taken */
+	unsigned long pad0;			/* align to 16 bytes */
+	unsigned long pad1[4];		/* space in PCB "just in case" */
+#endif
+};
+
+#ifndef _POSIX_C_SOURCE
+struct ppc_exception_state64
+#else /* _POSIX_C_SOURCE */
+struct __darwin_ppc_exception_state64
+#endif /* _POSIX_C_SOURCE */
+{
+	unsigned long long dar;		/* Fault registers for coredump */
+#if defined(__LP64__)
+	unsigned int  dsisr;
+	unsigned int  exception;	/* number of powerpc exception taken */
+	unsigned int  pad1[4];		/* space in PCB "just in case" */
+#else
+	unsigned long dsisr;
+	unsigned long exception;	/* number of powerpc exception taken */
+	unsigned long pad1[4];		/* space in PCB "just in case" */
+#endif
+};
+
+#pragma pack()
+
+#endif /* _MACH_PPC__TYPES_H_ */
diff -urN cctools-806-old/include/mach/ppc/vm_param.h cctools-806/include/mach/ppc/vm_param.h
--- cctools-806-old/include/mach/ppc/vm_param.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/vm_param.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,73 @@
+
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef	_MACH_PPC_VM_PARAM_H_
+#define _MACH_PPC_VM_PARAM_H_
+
+/*
+ * These are the global definitions
+ */
+
+#define BYTE_SIZE		8		/* byte size in bits */
+
+#define PPC_PGBYTES		4096	/* bytes per ppc page */
+#define PPC_PGSHIFT		12		/* number of bits to shift for pages */
+
+#define	PAGE_SIZE		PPC_PGBYTES
+#define	PAGE_SHIFT		PPC_PGSHIFT
+#define PAGE_MASK		(PAGE_SIZE - 1)
+
+#if 0
+#define VM_MAX_PAGE_ADDRESS 0xFFFFFFFFFFFFF000ULL
+#else
+/* 
+ * LP64todo - For now, we are limited to 51-bits of user addressing
+ */
+#define VM_MAX_PAGE_ADDRESS 0x0007FFFFFFFFF000ULL
+#endif
+
+#define MACH_VM_MIN_ADDRESS	((mach_vm_offset_t) 0)
+#define MACH_VM_MAX_ADDRESS	((mach_vm_offset_t) VM_MAX_PAGE_ADDRESS)
+
+/*
+ * These are the values relative to the local process.
+ */
+#if defined (__ppc64__)
+/*
+ * LP64todo - We don't have the 64-bit address space layout yet.
+ * Use the 32-bit stack layout for now.
+ */
+#define VM_MIN_ADDRESS	((vm_offset_t) MACH_VM_MIN_ADDRESS)
+#define VM_MAX_ADDRESS	((vm_offset_t) MACH_VM_MAX_ADDRESS)
+#define USER_STACK_END  	((vm_offset_t) 0x00000000ffff0000ULL)
+#else
+#define VM_MIN_ADDRESS	((vm_offset_t) 0)
+#define VM_MAX_ADDRESS	((vm_offset_t) (VM_MAX_PAGE_ADDRESS & 0xFFFFFFFF))
+#define USER_STACK_END  	((vm_offset_t) 0xffff0000U)
+#endif /* defined(__ppc64__) */
+
+
+#endif	/* _MACH_PPC_VM_PARAM_H_ */
diff -urN cctools-806-old/include/mach/ppc/vm_types.h cctools-806/include/mach/ppc/vm_types.h
--- cctools-806-old/include/mach/ppc/vm_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc/vm_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,143 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * The contents of this file constitute Original Code as defined in and
+ * are subject to the Apple Public Source License Version 1.1 (the
+ * "License").  You may not use this file except in compliance with the
+ * License.  Please obtain a copy of the License at
+ * http://www.apple.com/publicsource and read it before using this file.
+ * 
+ * This Original Code and all software distributed under the License are
+ * distributed on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE OR NON-INFRINGEMENT.  Please see the
+ * License for the specific language governing rights and limitations
+ * under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	vm_types.h
+ *	Author:	Avadis Tevanian, Jr.
+ *	Date: 1985
+ *
+ *	Header file for VM data types.  PPC version.
+ */
+
+#ifndef	_MACH_PPC_VM_TYPES_H_
+#define _MACH_PPC_VM_TYPES_H_
+
+#ifndef	ASSEMBLER
+
+#include <ppc/_types.h>
+#include <ppc/vmparam.h>
+#include <stdint.h>
+
+/*
+ * natural_t and integer_t are Mach's legacy types for machine-
+ * independent integer types (unsigned, and signed, respectively).
+ * Their original purpose was to define other types in a machine/
+ * compiler independent way.
+ *
+ * They also had an implicit "same size as pointer" characteristic
+ * to them (i.e. Mach's traditional types are very ILP32 or ILP64
+ * centric).  We support PowerPC ABIs that do not follow either of
+ * these models (specifically LP64).  Therefore, we had to make a
+ * choice between making these types scale with pointers or stay
+ * tied to integers.  Because their use is predominantly tied to
+ * to the size of an integer, we are keeping that association and
+ * breaking free from pointer size guarantees.
+ *
+ * New use of these types is discouraged.
+ */
+typedef __darwin_natural_t	natural_t;
+typedef int			integer_t;
+
+#if defined(__ppc__)
+
+/*
+ * For 32-bit PowerPC ABIs, the scalable types were
+ * always based upon natural_t (unsigned int). 
+ * Because of potential legacy issues with name mangling,
+ * we cannot use the stdint uintptr_t type.
+ */
+typedef	natural_t		vm_offset_t;
+typedef	natural_t		vm_size_t;
+
+#else /* __ppc64__ */
+
+/*
+ * For 64-bit PowerPC ABIs, we have no legacy name mangling
+ * issues, so we use the stdint types for scaling these
+ * types to the same size as a pointer.
+ */
+typedef	uintptr_t		vm_offset_t;
+typedef uintptr_t		vm_size_t;
+
+#endif 
+
+/*
+ * This new type is independent of a particular vm map's
+ * implementation size - and represents appropriate types
+ * for all possible maps.  This is used for interfaces
+ * where the size of the map is not known - or we don't
+ * want to have to distinguish.
+ */
+typedef uint64_t		mach_vm_address_t;
+typedef uint64_t		mach_vm_offset_t;
+typedef uint64_t		mach_vm_size_t;
+
+/* LP64todo - convert these over for good */
+#if 1 
+typedef uint64_t		vm_map_offset_t;
+typedef uint64_t		vm_map_address_t;
+typedef uint64_t		vm_map_size_t;
+#else
+typedef uint32_t		vm_map_offset_t;
+typedef uint32_t		vm_map_address_t;
+typedef uint32_t		vm_map_size_t;
+#endif
+
+
+#endif	/* ASSEMBLER */
+
+/*
+ * If composing messages by hand (please do not)
+ */
+#define	MACH_MSG_TYPE_INTEGER_T	MACH_MSG_TYPE_INTEGER_32
+
+#endif	/* _MACH_PPC_VM_TYPES_H_ */
diff -urN cctools-806-old/include/mach/ppc64/task.h cctools-806/include/mach/ppc64/task.h
--- cctools-806-old/include/mach/ppc64/task.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc64/task.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1491 @@
+#ifndef	_task_user_
+#define	_task_user_
+
+/* Module task */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry 	*function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	task_MSG_COUNT
+#define	task_MSG_COUNT	33
+#endif	/* task_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine task_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_create
+(
+	task_t target_task,
+	ledger_array_t ledgers,
+	mach_msg_type_number_t ledgersCnt,
+	boolean_t inherit_memory,
+	task_t *child_task
+);
+
+/* Routine task_terminate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_terminate
+(
+	task_t target_task
+);
+
+/* Routine task_threads */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_threads
+(
+	task_t target_task,
+	thread_act_array_t *act_list,
+	mach_msg_type_number_t *act_listCnt
+);
+
+/* Routine mach_ports_register */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_ports_register
+(
+	task_t target_task,
+	mach_port_array_t init_port_set,
+	mach_msg_type_number_t init_port_setCnt
+);
+
+/* Routine mach_ports_lookup */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_ports_lookup
+(
+	task_t target_task,
+	mach_port_array_t *init_port_set,
+	mach_msg_type_number_t *init_port_setCnt
+);
+
+/* Routine task_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_info
+(
+	task_name_t target_task,
+	task_flavor_t flavor,
+	task_info_t task_info_out,
+	mach_msg_type_number_t *task_info_outCnt
+);
+
+/* Routine task_set_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_info
+(
+	task_t target_task,
+	task_flavor_t flavor,
+	task_info_t task_info_in,
+	mach_msg_type_number_t task_info_inCnt
+);
+
+/* Routine task_suspend */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_suspend
+(
+	task_t target_task
+);
+
+/* Routine task_resume */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_resume
+(
+	task_t target_task
+);
+
+/* Routine task_get_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_special_port
+(
+	task_t task,
+	int which_port,
+	mach_port_t *special_port
+);
+
+/* Routine task_set_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_special_port
+(
+	task_t task,
+	int which_port,
+	mach_port_t special_port
+);
+
+/* Routine thread_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_create
+(
+	task_t parent_task,
+	thread_act_t *child_act
+);
+
+/* Routine thread_create_running */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_create_running
+(
+	task_t parent_task,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt,
+	thread_act_t *child_act
+);
+
+/* Routine task_set_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor
+);
+
+/* Routine task_get_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine task_swap_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_swap_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlerss,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine lock_set_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_set_create
+(
+	task_t task,
+	lock_set_t *new_lock_set,
+	int n_ulocks,
+	int policy
+);
+
+/* Routine lock_set_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_set_destroy
+(
+	task_t task,
+	lock_set_t lock_set
+);
+
+/* Routine semaphore_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t semaphore_create
+(
+	task_t task,
+	semaphore_t *semaphore,
+	int policy,
+	int value
+);
+
+/* Routine semaphore_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t semaphore_destroy
+(
+	task_t task,
+	semaphore_t semaphore
+);
+
+/* Routine task_policy_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy_set
+(
+	task_t task,
+	task_policy_flavor_t flavor,
+	task_policy_t policy_info,
+	mach_msg_type_number_t policy_infoCnt
+);
+
+/* Routine task_policy_get */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy_get
+(
+	task_t task,
+	task_policy_flavor_t flavor,
+	task_policy_t policy_info,
+	mach_msg_type_number_t *policy_infoCnt,
+	boolean_t *get_default
+);
+
+/* Routine task_sample */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_sample
+(
+	task_t task,
+	mach_port_t reply
+);
+
+/* Routine task_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy
+(
+	task_t task,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	boolean_t set_limit,
+	boolean_t change
+);
+
+/* Routine task_set_emulation */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_emulation
+(
+	task_t target_port,
+	vm_address_t routine_entry_pt,
+	int routine_number
+);
+
+/* Routine task_get_emulation_vector */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_emulation_vector
+(
+	task_t task,
+	int *vector_start,
+	emulation_vector_t *emulation_vector,
+	mach_msg_type_number_t *emulation_vectorCnt
+);
+
+/* Routine task_set_emulation_vector */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_emulation_vector
+(
+	task_t task,
+	int vector_start,
+	emulation_vector_t emulation_vector,
+	mach_msg_type_number_t emulation_vectorCnt
+);
+
+/* Routine task_set_ras_pc */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_ras_pc
+(
+	task_t target_task,
+	vm_address_t basepc,
+	vm_address_t boundspc
+);
+
+/* Routine task_assign */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_assign
+(
+	task_t task,
+	processor_set_t new_set,
+	boolean_t assign_threads
+);
+
+/* Routine task_assign_default */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_assign_default
+(
+	task_t task,
+	boolean_t assign_threads
+);
+
+/* Routine task_get_assignment */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_assignment
+(
+	task_t task,
+	processor_set_name_t *assigned_set
+);
+
+/* Routine task_set_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_policy
+(
+	task_t task,
+	processor_set_t pset,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	policy_limit_t limit,
+	mach_msg_type_number_t limitCnt,
+	boolean_t change
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__task_subsystem__defined
+#define __Request__task_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t ledgers;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t ledgersCnt;
+		boolean_t inherit_memory;
+	} __Request__task_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t init_port_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t init_port_setCnt;
+	} __Request__mach_ports_register_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__mach_ports_lookup_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_flavor_t flavor;
+		mach_msg_type_number_t task_info_outCnt;
+	} __Request__task_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_flavor_t flavor;
+		mach_msg_type_number_t task_info_inCnt;
+		integer_t task_info_in[10];
+	} __Request__task_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__task_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__task_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__thread_create_running_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__task_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+	} __Request__task_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__task_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int n_ulocks;
+		int policy;
+	} __Request__lock_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t lock_set;
+		/* end of the kernel processed data */
+	} __Request__lock_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int policy;
+		int value;
+	} __Request__semaphore_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t semaphore;
+		/* end of the kernel processed data */
+	} __Request__semaphore_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+	} __Request__task_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		boolean_t get_default;
+	} __Request__task_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t reply;
+		/* end of the kernel processed data */
+	} __Request__task_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		boolean_t set_limit;
+		boolean_t change;
+	} __Request__task_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t routine_entry_pt;
+		int routine_number;
+	} __Request__task_set_emulation_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_get_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t emulation_vector;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int vector_start;
+		mach_msg_type_number_t emulation_vectorCnt;
+	} __Request__task_set_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t basepc;
+		vm_address_t boundspc;
+	} __Request__task_set_ras_pc_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t assign_threads;
+	} __Request__task_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		boolean_t assign_threads;
+	} __Request__task_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pset;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		mach_msg_type_number_t limitCnt;
+		integer_t limit[1];
+		boolean_t change;
+	} __Request__task_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__task_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__task_subsystem__defined
+#define __RequestUnion__task_subsystem__defined
+union __RequestUnion__task_subsystem {
+	__Request__task_create_t Request_task_create;
+	__Request__task_terminate_t Request_task_terminate;
+	__Request__task_threads_t Request_task_threads;
+	__Request__mach_ports_register_t Request_mach_ports_register;
+	__Request__mach_ports_lookup_t Request_mach_ports_lookup;
+	__Request__task_info_t Request_task_info;
+	__Request__task_set_info_t Request_task_set_info;
+	__Request__task_suspend_t Request_task_suspend;
+	__Request__task_resume_t Request_task_resume;
+	__Request__task_get_special_port_t Request_task_get_special_port;
+	__Request__task_set_special_port_t Request_task_set_special_port;
+	__Request__thread_create_t Request_thread_create;
+	__Request__thread_create_running_t Request_thread_create_running;
+	__Request__task_set_exception_ports_t Request_task_set_exception_ports;
+	__Request__task_get_exception_ports_t Request_task_get_exception_ports;
+	__Request__task_swap_exception_ports_t Request_task_swap_exception_ports;
+	__Request__lock_set_create_t Request_lock_set_create;
+	__Request__lock_set_destroy_t Request_lock_set_destroy;
+	__Request__semaphore_create_t Request_semaphore_create;
+	__Request__semaphore_destroy_t Request_semaphore_destroy;
+	__Request__task_policy_set_t Request_task_policy_set;
+	__Request__task_policy_get_t Request_task_policy_get;
+	__Request__task_sample_t Request_task_sample;
+	__Request__task_policy_t Request_task_policy;
+	__Request__task_set_emulation_t Request_task_set_emulation;
+	__Request__task_get_emulation_vector_t Request_task_get_emulation_vector;
+	__Request__task_set_emulation_vector_t Request_task_set_emulation_vector;
+	__Request__task_set_ras_pc_t Request_task_set_ras_pc;
+	__Request__task_assign_t Request_task_assign;
+	__Request__task_assign_default_t Request_task_assign_default;
+	__Request__task_get_assignment_t Request_task_get_assignment;
+	__Request__task_set_policy_t Request_task_set_policy;
+};
+#endif /* !__RequestUnion__task_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__task_subsystem__defined
+#define __Reply__task_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_task;
+		/* end of the kernel processed data */
+	} __Reply__task_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t act_list;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t act_listCnt;
+	} __Reply__task_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_ports_register_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t init_port_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t init_port_setCnt;
+	} __Reply__mach_ports_lookup_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t task_info_outCnt;
+		integer_t task_info_out[10];
+	} __Reply__task_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+	} __Reply__task_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_act;
+		/* end of the kernel processed data */
+	} __Reply__thread_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_act;
+		/* end of the kernel processed data */
+	} __Reply__thread_create_running_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__task_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlerss[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__task_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_lock_set;
+		/* end of the kernel processed data */
+	} __Reply__lock_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t semaphore;
+		/* end of the kernel processed data */
+	} __Reply__semaphore_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__semaphore_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+		boolean_t get_default;
+	} __Reply__task_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_emulation_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t emulation_vector;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int vector_start;
+		mach_msg_type_number_t emulation_vectorCnt;
+	} __Reply__task_get_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_ras_pc_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t assigned_set;
+		/* end of the kernel processed data */
+	} __Reply__task_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__task_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__task_subsystem__defined
+#define __ReplyUnion__task_subsystem__defined
+union __ReplyUnion__task_subsystem {
+	__Reply__task_create_t Reply_task_create;
+	__Reply__task_terminate_t Reply_task_terminate;
+	__Reply__task_threads_t Reply_task_threads;
+	__Reply__mach_ports_register_t Reply_mach_ports_register;
+	__Reply__mach_ports_lookup_t Reply_mach_ports_lookup;
+	__Reply__task_info_t Reply_task_info;
+	__Reply__task_set_info_t Reply_task_set_info;
+	__Reply__task_suspend_t Reply_task_suspend;
+	__Reply__task_resume_t Reply_task_resume;
+	__Reply__task_get_special_port_t Reply_task_get_special_port;
+	__Reply__task_set_special_port_t Reply_task_set_special_port;
+	__Reply__thread_create_t Reply_thread_create;
+	__Reply__thread_create_running_t Reply_thread_create_running;
+	__Reply__task_set_exception_ports_t Reply_task_set_exception_ports;
+	__Reply__task_get_exception_ports_t Reply_task_get_exception_ports;
+	__Reply__task_swap_exception_ports_t Reply_task_swap_exception_ports;
+	__Reply__lock_set_create_t Reply_lock_set_create;
+	__Reply__lock_set_destroy_t Reply_lock_set_destroy;
+	__Reply__semaphore_create_t Reply_semaphore_create;
+	__Reply__semaphore_destroy_t Reply_semaphore_destroy;
+	__Reply__task_policy_set_t Reply_task_policy_set;
+	__Reply__task_policy_get_t Reply_task_policy_get;
+	__Reply__task_sample_t Reply_task_sample;
+	__Reply__task_policy_t Reply_task_policy;
+	__Reply__task_set_emulation_t Reply_task_set_emulation;
+	__Reply__task_get_emulation_vector_t Reply_task_get_emulation_vector;
+	__Reply__task_set_emulation_vector_t Reply_task_set_emulation_vector;
+	__Reply__task_set_ras_pc_t Reply_task_set_ras_pc;
+	__Reply__task_assign_t Reply_task_assign;
+	__Reply__task_assign_default_t Reply_task_assign_default;
+	__Reply__task_get_assignment_t Reply_task_get_assignment;
+	__Reply__task_set_policy_t Reply_task_set_policy;
+};
+#endif /* !__RequestUnion__task_subsystem__defined */
+
+#ifndef subsystem_to_name_map_task
+#define subsystem_to_name_map_task \
+    { "task_create", 3400 },\
+    { "task_terminate", 3401 },\
+    { "task_threads", 3402 },\
+    { "mach_ports_register", 3403 },\
+    { "mach_ports_lookup", 3404 },\
+    { "task_info", 3405 },\
+    { "task_set_info", 3406 },\
+    { "task_suspend", 3407 },\
+    { "task_resume", 3408 },\
+    { "task_get_special_port", 3409 },\
+    { "task_set_special_port", 3410 },\
+    { "thread_create", 3411 },\
+    { "thread_create_running", 3412 },\
+    { "task_set_exception_ports", 3413 },\
+    { "task_get_exception_ports", 3414 },\
+    { "task_swap_exception_ports", 3415 },\
+    { "lock_set_create", 3416 },\
+    { "lock_set_destroy", 3417 },\
+    { "semaphore_create", 3418 },\
+    { "semaphore_destroy", 3419 },\
+    { "task_policy_set", 3420 },\
+    { "task_policy_get", 3421 },\
+    { "task_sample", 3422 },\
+    { "task_policy", 3423 },\
+    { "task_set_emulation", 3424 },\
+    { "task_get_emulation_vector", 3425 },\
+    { "task_set_emulation_vector", 3426 },\
+    { "task_set_ras_pc", 3427 },\
+    { "task_assign", 3429 },\
+    { "task_assign_default", 3430 },\
+    { "task_get_assignment", 3431 },\
+    { "task_set_policy", 3432 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _task_user_ */
diff -urN cctools-806-old/include/mach/ppc64/thread_act.h cctools-806/include/mach/ppc64/thread_act.h
--- cctools-806-old/include/mach/ppc64/thread_act.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/ppc64/thread_act.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1155 @@
+#ifndef	_thread_act_user_
+#define	_thread_act_user_
+
+/* Module thread_act */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry 	*function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	thread_act_MSG_COUNT
+#define	thread_act_MSG_COUNT	25
+#endif	/* thread_act_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine thread_terminate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_terminate
+(
+	thread_act_t target_act
+);
+
+/* Routine act_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t act_get_state
+(
+	thread_act_t target_act,
+	int flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine act_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t act_set_state
+(
+	thread_act_t target_act,
+	int flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+/* Routine thread_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_state
+(
+	thread_act_t target_act,
+	thread_state_flavor_t flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine thread_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_state
+(
+	thread_act_t target_act,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+/* Routine thread_suspend */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_suspend
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_resume */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_resume
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_abort */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_abort
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_abort_safely */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_abort_safely
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_depress_abort */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_depress_abort
+(
+	thread_act_t thread
+);
+
+/* Routine thread_get_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_special_port
+(
+	thread_act_t thr_act,
+	int which_port,
+	mach_port_t *special_port
+);
+
+/* Routine thread_set_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_special_port
+(
+	thread_act_t thr_act,
+	int which_port,
+	mach_port_t special_port
+);
+
+/* Routine thread_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_info
+(
+	thread_act_t target_act,
+	thread_flavor_t flavor,
+	thread_info_t thread_info_out,
+	mach_msg_type_number_t *thread_info_outCnt
+);
+
+/* Routine thread_set_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor
+);
+
+/* Routine thread_get_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine thread_swap_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_swap_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine thread_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy
+(
+	thread_act_t thr_act,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	boolean_t set_limit
+);
+
+/* Routine thread_policy_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy_set
+(
+	thread_act_t thread,
+	thread_policy_flavor_t flavor,
+	thread_policy_t policy_info,
+	mach_msg_type_number_t policy_infoCnt
+);
+
+/* Routine thread_policy_get */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy_get
+(
+	thread_act_t thread,
+	thread_policy_flavor_t flavor,
+	thread_policy_t policy_info,
+	mach_msg_type_number_t *policy_infoCnt,
+	boolean_t *get_default
+);
+
+/* Routine thread_sample */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_sample
+(
+	thread_act_t thread,
+	mach_port_t reply
+);
+
+/* Routine etap_trace_thread */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t etap_trace_thread
+(
+	thread_act_t target_act,
+	boolean_t trace_status
+);
+
+/* Routine thread_assign */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_assign
+(
+	thread_act_t thread,
+	processor_set_t new_set
+);
+
+/* Routine thread_assign_default */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_assign_default
+(
+	thread_act_t thread
+);
+
+/* Routine thread_get_assignment */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_assignment
+(
+	thread_act_t thread,
+	processor_set_name_t *assigned_set
+);
+
+/* Routine thread_set_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_policy
+(
+	thread_act_t thr_act,
+	processor_set_t pset,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	policy_limit_t limit,
+	mach_msg_type_number_t limitCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__thread_act_subsystem__defined
+#define __Request__thread_act_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__act_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__act_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__thread_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__thread_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_abort_safely_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_depress_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__thread_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__thread_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_flavor_t flavor;
+		mach_msg_type_number_t thread_info_outCnt;
+	} __Request__thread_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__thread_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+	} __Request__thread_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__thread_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		boolean_t set_limit;
+	} __Request__thread_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+	} __Request__thread_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		boolean_t get_default;
+	} __Request__thread_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t reply;
+		/* end of the kernel processed data */
+	} __Request__thread_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		boolean_t trace_status;
+	} __Request__etap_trace_thread_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		/* end of the kernel processed data */
+	} __Request__thread_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pset;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		mach_msg_type_number_t limitCnt;
+		integer_t limit[1];
+	} __Request__thread_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__thread_act_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__thread_act_subsystem__defined
+#define __RequestUnion__thread_act_subsystem__defined
+union __RequestUnion__thread_act_subsystem {
+	__Request__thread_terminate_t Request_thread_terminate;
+	__Request__act_get_state_t Request_act_get_state;
+	__Request__act_set_state_t Request_act_set_state;
+	__Request__thread_get_state_t Request_thread_get_state;
+	__Request__thread_set_state_t Request_thread_set_state;
+	__Request__thread_suspend_t Request_thread_suspend;
+	__Request__thread_resume_t Request_thread_resume;
+	__Request__thread_abort_t Request_thread_abort;
+	__Request__thread_abort_safely_t Request_thread_abort_safely;
+	__Request__thread_depress_abort_t Request_thread_depress_abort;
+	__Request__thread_get_special_port_t Request_thread_get_special_port;
+	__Request__thread_set_special_port_t Request_thread_set_special_port;
+	__Request__thread_info_t Request_thread_info;
+	__Request__thread_set_exception_ports_t Request_thread_set_exception_ports;
+	__Request__thread_get_exception_ports_t Request_thread_get_exception_ports;
+	__Request__thread_swap_exception_ports_t Request_thread_swap_exception_ports;
+	__Request__thread_policy_t Request_thread_policy;
+	__Request__thread_policy_set_t Request_thread_policy_set;
+	__Request__thread_policy_get_t Request_thread_policy_get;
+	__Request__thread_sample_t Request_thread_sample;
+	__Request__etap_trace_thread_t Request_etap_trace_thread;
+	__Request__thread_assign_t Request_thread_assign;
+	__Request__thread_assign_default_t Request_thread_assign_default;
+	__Request__thread_get_assignment_t Request_thread_get_assignment;
+	__Request__thread_set_policy_t Request_thread_set_policy;
+};
+#endif /* !__RequestUnion__thread_act_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__thread_act_subsystem__defined
+#define __Reply__thread_act_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[144];
+	} __Reply__act_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__act_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[144];
+	} __Reply__thread_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_abort_safely_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_depress_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+	} __Reply__thread_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t thread_info_outCnt;
+		integer_t thread_info_out[12];
+	} __Reply__thread_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__thread_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__thread_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+		boolean_t get_default;
+	} __Reply__thread_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__etap_trace_thread_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t assigned_set;
+		/* end of the kernel processed data */
+	} __Reply__thread_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__thread_act_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__thread_act_subsystem__defined
+#define __ReplyUnion__thread_act_subsystem__defined
+union __ReplyUnion__thread_act_subsystem {
+	__Reply__thread_terminate_t Reply_thread_terminate;
+	__Reply__act_get_state_t Reply_act_get_state;
+	__Reply__act_set_state_t Reply_act_set_state;
+	__Reply__thread_get_state_t Reply_thread_get_state;
+	__Reply__thread_set_state_t Reply_thread_set_state;
+	__Reply__thread_suspend_t Reply_thread_suspend;
+	__Reply__thread_resume_t Reply_thread_resume;
+	__Reply__thread_abort_t Reply_thread_abort;
+	__Reply__thread_abort_safely_t Reply_thread_abort_safely;
+	__Reply__thread_depress_abort_t Reply_thread_depress_abort;
+	__Reply__thread_get_special_port_t Reply_thread_get_special_port;
+	__Reply__thread_set_special_port_t Reply_thread_set_special_port;
+	__Reply__thread_info_t Reply_thread_info;
+	__Reply__thread_set_exception_ports_t Reply_thread_set_exception_ports;
+	__Reply__thread_get_exception_ports_t Reply_thread_get_exception_ports;
+	__Reply__thread_swap_exception_ports_t Reply_thread_swap_exception_ports;
+	__Reply__thread_policy_t Reply_thread_policy;
+	__Reply__thread_policy_set_t Reply_thread_policy_set;
+	__Reply__thread_policy_get_t Reply_thread_policy_get;
+	__Reply__thread_sample_t Reply_thread_sample;
+	__Reply__etap_trace_thread_t Reply_etap_trace_thread;
+	__Reply__thread_assign_t Reply_thread_assign;
+	__Reply__thread_assign_default_t Reply_thread_assign_default;
+	__Reply__thread_get_assignment_t Reply_thread_get_assignment;
+	__Reply__thread_set_policy_t Reply_thread_set_policy;
+};
+#endif /* !__RequestUnion__thread_act_subsystem__defined */
+
+#ifndef subsystem_to_name_map_thread_act
+#define subsystem_to_name_map_thread_act \
+    { "thread_terminate", 3600 },\
+    { "act_get_state", 3601 },\
+    { "act_set_state", 3602 },\
+    { "thread_get_state", 3603 },\
+    { "thread_set_state", 3604 },\
+    { "thread_suspend", 3605 },\
+    { "thread_resume", 3606 },\
+    { "thread_abort", 3607 },\
+    { "thread_abort_safely", 3608 },\
+    { "thread_depress_abort", 3609 },\
+    { "thread_get_special_port", 3610 },\
+    { "thread_set_special_port", 3611 },\
+    { "thread_info", 3612 },\
+    { "thread_set_exception_ports", 3613 },\
+    { "thread_get_exception_ports", 3614 },\
+    { "thread_swap_exception_ports", 3615 },\
+    { "thread_policy", 3616 },\
+    { "thread_policy_set", 3617 },\
+    { "thread_policy_get", 3618 },\
+    { "thread_sample", 3619 },\
+    { "etap_trace_thread", 3620 },\
+    { "thread_assign", 3621 },\
+    { "thread_assign_default", 3622 },\
+    { "thread_get_assignment", 3623 },\
+    { "thread_set_policy", 3624 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _thread_act_user_ */
diff -urN cctools-806-old/include/mach/processor.defs cctools-806/include/mach/processor.defs
--- cctools-806-old/include/mach/processor.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/processor.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,128 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_port.defs
+ *	Author:	Rich Draves
+ *
+ *	Exported kernel calls.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  processor 3000;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+/*
+ * References to processor objects are returned by:
+ *	host_processors(host_priv_t,...);
+ */
+/*
+ *	Start processor.
+ */
+routine	processor_start(
+		processor	: processor_t);
+
+/*
+ *	Exit processor -- may not be restartable.
+ */
+
+routine	processor_exit(
+		processor	: processor_t);
+
+/*
+ *	Return information about this processor.
+ */
+routine processor_info(
+		processor	: processor_t;
+		flavor		: processor_flavor_t;
+	out	host		: host_t;
+	out	processor_info_out: processor_info_t, CountInOut);
+
+
+/*
+ *	Do something machine-dependent to processor.
+ */
+routine processor_control(
+		processor	: processor_t;
+		processor_cmd	: processor_info_t);
+
+/*
+ * JMM - Keep processor_set related stuff at the end because
+ * they likely will be removed.
+ */
+
+/*
+ *	Assign processor to processor set.
+ */
+routine processor_assign(
+		processor	: processor_t;
+		new_set		: processor_set_t;
+		wait		: boolean_t);
+
+/*
+ *	Get current assignment for processor.
+ */
+routine processor_get_assignment(
+		processor	: processor_t;
+	out	assigned_set	: processor_set_name_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/processor.h cctools-806/include/mach/processor.h
--- cctools-806-old/include/mach/processor.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/processor.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,337 @@
+#ifndef	_processor_user_
+#define	_processor_user_
+
+/* Module processor */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	processor_MSG_COUNT
+#define	processor_MSG_COUNT	6
+#endif	/* processor_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine processor_start */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_start
+(
+	processor_t processor
+);
+
+/* Routine processor_exit */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_exit
+(
+	processor_t processor
+);
+
+/* Routine processor_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_info
+(
+	processor_t processor,
+	processor_flavor_t flavor,
+	host_t *host,
+	processor_info_t processor_info_out,
+	mach_msg_type_number_t *processor_info_outCnt
+);
+
+/* Routine processor_control */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_control
+(
+	processor_t processor,
+	processor_info_t processor_cmd,
+	mach_msg_type_number_t processor_cmdCnt
+);
+
+/* Routine processor_assign */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_assign
+(
+	processor_t processor,
+	processor_set_t new_set,
+	boolean_t wait
+);
+
+/* Routine processor_get_assignment */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_get_assignment
+(
+	processor_t processor,
+	processor_set_name_t *assigned_set
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__processor_subsystem__defined
+#define __Request__processor_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_start_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_exit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		processor_flavor_t flavor;
+		mach_msg_type_number_t processor_info_outCnt;
+	} __Request__processor_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_msg_type_number_t processor_cmdCnt;
+		integer_t processor_cmd[12];
+	} __Request__processor_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t wait;
+	} __Request__processor_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__processor_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__processor_subsystem__defined
+#define __RequestUnion__processor_subsystem__defined
+union __RequestUnion__processor_subsystem {
+	__Request__processor_start_t Request_processor_start;
+	__Request__processor_exit_t Request_processor_exit;
+	__Request__processor_info_t Request_processor_info;
+	__Request__processor_control_t Request_processor_control;
+	__Request__processor_assign_t Request_processor_assign;
+	__Request__processor_get_assignment_t Request_processor_get_assignment;
+};
+#endif /* !__RequestUnion__processor_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__processor_subsystem__defined
+#define __Reply__processor_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_start_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_exit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t host;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t processor_info_outCnt;
+		integer_t processor_info_out[12];
+	} __Reply__processor_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t assigned_set;
+		/* end of the kernel processed data */
+	} __Reply__processor_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__processor_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__processor_subsystem__defined
+#define __ReplyUnion__processor_subsystem__defined
+union __ReplyUnion__processor_subsystem {
+	__Reply__processor_start_t Reply_processor_start;
+	__Reply__processor_exit_t Reply_processor_exit;
+	__Reply__processor_info_t Reply_processor_info;
+	__Reply__processor_control_t Reply_processor_control;
+	__Reply__processor_assign_t Reply_processor_assign;
+	__Reply__processor_get_assignment_t Reply_processor_get_assignment;
+};
+#endif /* !__RequestUnion__processor_subsystem__defined */
+
+#ifndef subsystem_to_name_map_processor
+#define subsystem_to_name_map_processor \
+    { "processor_start", 3000 },\
+    { "processor_exit", 3001 },\
+    { "processor_info", 3002 },\
+    { "processor_control", 3003 },\
+    { "processor_assign", 3004 },\
+    { "processor_get_assignment", 3005 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _processor_user_ */
diff -urN cctools-806-old/include/mach/processor_info.h cctools-806/include/mach/processor_info.h
--- cctools-806-old/include/mach/processor_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/processor_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,153 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+/*
+ *	File:	mach/processor_info.h
+ *	Author:	David L. Black
+ *	Date:	1988
+ *
+ *	Data structure definitions for processor_info, processor_set_info
+ */
+
+#ifndef	_MACH_PROCESSOR_INFO_H_
+#define _MACH_PROCESSOR_INFO_H_
+
+#include <mach/message.h>
+#include <mach/machine.h>
+#include <mach/machine/processor_info.h>
+
+/*
+ *	Generic information structure to allow for expansion.
+ */
+typedef integer_t	*processor_info_t;	/* varying array of int. */
+typedef integer_t	*processor_info_array_t;  /* varying array of int */
+
+#define PROCESSOR_INFO_MAX	(1024)	/* max array size */
+typedef integer_t	processor_info_data_t[PROCESSOR_INFO_MAX];
+
+
+typedef integer_t	*processor_set_info_t;	/* varying array of int. */
+
+#define PROCESSOR_SET_INFO_MAX	(1024)	/* max array size */
+typedef integer_t	processor_set_info_data_t[PROCESSOR_SET_INFO_MAX];
+
+/*
+ *	Currently defined information.
+ */
+typedef int	processor_flavor_t;
+#define	PROCESSOR_BASIC_INFO	1		/* basic information */
+#define	PROCESSOR_CPU_LOAD_INFO	2	/* cpu load information */
+#define	PROCESSOR_PM_REGS_INFO	0x10000001	/* performance monitor register info */
+#define	PROCESSOR_TEMPERATURE	0x10000002	/* Processor core temperature */
+
+struct processor_basic_info {
+	cpu_type_t	cpu_type;	/* type of cpu */
+	cpu_subtype_t	cpu_subtype;	/* subtype of cpu */
+	boolean_t	running;	/* is processor running */
+	int		slot_num;	/* slot number */
+	boolean_t	is_master;	/* is this the master processor */
+};
+
+typedef	struct processor_basic_info	processor_basic_info_data_t;
+typedef struct processor_basic_info	*processor_basic_info_t;
+#define PROCESSOR_BASIC_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof(processor_basic_info_data_t)/sizeof(natural_t)))
+
+struct processor_cpu_load_info {             /* number of ticks while running... */
+        unsigned int	cpu_ticks[CPU_STATE_MAX]; /* ... in the given mode */
+}; 
+
+typedef	struct processor_cpu_load_info	processor_cpu_load_info_data_t;
+typedef struct processor_cpu_load_info	*processor_cpu_load_info_t;
+#define PROCESSOR_CPU_LOAD_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof(processor_cpu_load_info_data_t)/sizeof(natural_t)))
+
+/*
+ *	Scaling factor for load_average, mach_factor.
+ */
+#define	LOAD_SCALE	1000		
+
+typedef	int	processor_set_flavor_t;
+#define	PROCESSOR_SET_BASIC_INFO	5	/* basic information */
+
+struct processor_set_basic_info {
+	int		processor_count;	/* How many processors */
+	int		default_policy;		/* When others not enabled */
+};
+
+typedef	struct processor_set_basic_info	processor_set_basic_info_data_t;
+typedef struct processor_set_basic_info	*processor_set_basic_info_t;
+#define PROCESSOR_SET_BASIC_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof(processor_set_basic_info_data_t)/sizeof(natural_t)))
+
+#define PROCESSOR_SET_LOAD_INFO		4	/* scheduling statistics */
+
+struct processor_set_load_info {
+        int             task_count;             /* How many tasks */
+        int             thread_count;           /* How many threads */
+        integer_t       load_average;           /* Scaled */
+        integer_t       mach_factor;            /* Scaled */
+};
+
+typedef struct processor_set_load_info processor_set_load_info_data_t;
+typedef struct processor_set_load_info *processor_set_load_info_t;
+#define PROCESSOR_SET_LOAD_INFO_COUNT	((mach_msg_type_number_t) \
+                (sizeof(processor_set_load_info_data_t)/sizeof(natural_t)))
+
+
+#endif	/* _MACH_PROCESSOR_INFO_H_ */
diff -urN cctools-806-old/include/mach/processor_set.defs cctools-806/include/mach/processor_set.defs
--- cctools-806-old/include/mach/processor_set.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/processor_set.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,161 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_port.defs
+ *	Author:	Rich Draves
+ *
+ *	Exported kernel calls.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  processor_set 4000;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+/*
+ *      Return scheduling statistics for a processor set.
+ */
+routine processor_set_statistics(
+        	pset                    : processor_set_name_t;
+        	flavor                  : processor_set_flavor_t;
+	out     info_out        	: processor_set_info_t, CountInOut);
+
+
+/*
+ *	Destroy processor set.
+ */
+routine processor_set_destroy(
+		set		: processor_set_t);
+
+
+/*
+ *	Set max priority for processor_set.
+ */
+routine processor_set_max_priority(
+		processor_set	: processor_set_t;
+		max_priority	: int;
+		change_threads	: boolean_t);
+
+/*
+ *	Enable policy for processor set
+ */
+routine processor_set_policy_enable(
+		processor_set	: processor_set_t;
+		policy		: int);
+
+/*
+ *	Disable policy for processor set
+ */
+routine processor_set_policy_disable(
+		processor_set	: processor_set_t;
+		policy		: int;
+		change_threads	: boolean_t);
+
+/*
+ *	List all tasks in processor set.
+ */
+routine processor_set_tasks(
+		processor_set	: processor_set_t;
+	out	task_list	: task_array_t);
+
+/*
+ *	List all threads in processor set.
+ */
+routine processor_set_threads(
+		processor_set	: processor_set_t;
+	out	thread_list	: thread_act_array_t);
+
+/*
+ *      Controls the scheduling attributes governing the processor set.
+ *      Allows control of enabled policies, and per-policy base and limit
+ *      priorities.
+ */
+routine processor_set_policy_control(
+	pset			: processor_set_t;
+	flavor			: processor_set_flavor_t;
+	policy_info		: processor_set_info_t;
+	change			: boolean_t);
+
+
+/*
+ *	Debug Info
+ *      This call is only valid on MACH_DEBUG kernels.
+ *      Otherwise, KERN_FAILURE is returned.
+ */
+routine processor_set_stack_usage(
+		pset		: processor_set_t;
+	out	ltotal		: unsigned;
+	out	space		: vm_size_t;
+	out	resident	: vm_size_t;
+	out	maxusage	: vm_size_t;
+	out	maxstack	: vm_offset_t);
+
+/*
+ *      Get information about processor set.
+ */
+routine processor_set_info(
+                set_name        : processor_set_name_t;
+                flavor          : int;
+        out     host            : host_t;
+        out     info_out        : processor_set_info_t, CountInOut);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/processor_set.h cctools-806/include/mach/processor_set.h
--- cctools-806-old/include/mach/processor_set.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/processor_set.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,517 @@
+#ifndef	_processor_set_user_
+#define	_processor_set_user_
+
+/* Module processor_set */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	processor_set_MSG_COUNT
+#define	processor_set_MSG_COUNT	10
+#endif	/* processor_set_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine processor_set_statistics */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_statistics
+(
+	processor_set_name_t pset,
+	processor_set_flavor_t flavor,
+	processor_set_info_t info_out,
+	mach_msg_type_number_t *info_outCnt
+);
+
+/* Routine processor_set_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_destroy
+(
+	processor_set_t set
+);
+
+/* Routine processor_set_max_priority */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_max_priority
+(
+	processor_set_t processor_set,
+	int max_priority,
+	boolean_t change_threads
+);
+
+/* Routine processor_set_policy_enable */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_policy_enable
+(
+	processor_set_t processor_set,
+	int policy
+);
+
+/* Routine processor_set_policy_disable */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_policy_disable
+(
+	processor_set_t processor_set,
+	int policy,
+	boolean_t change_threads
+);
+
+/* Routine processor_set_tasks */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_tasks
+(
+	processor_set_t processor_set,
+	task_array_t *task_list,
+	mach_msg_type_number_t *task_listCnt
+);
+
+/* Routine processor_set_threads */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_threads
+(
+	processor_set_t processor_set,
+	thread_act_array_t *thread_list,
+	mach_msg_type_number_t *thread_listCnt
+);
+
+/* Routine processor_set_policy_control */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_policy_control
+(
+	processor_set_t pset,
+	processor_set_flavor_t flavor,
+	processor_set_info_t policy_info,
+	mach_msg_type_number_t policy_infoCnt,
+	boolean_t change
+);
+
+/* Routine processor_set_stack_usage */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_stack_usage
+(
+	processor_set_t pset,
+	unsigned *ltotal,
+	vm_size_t *space,
+	vm_size_t *resident,
+	vm_size_t *maxusage,
+	vm_offset_t *maxstack
+);
+
+/* Routine processor_set_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t processor_set_info
+(
+	processor_set_name_t set_name,
+	int flavor,
+	host_t *host,
+	processor_set_info_t info_out,
+	mach_msg_type_number_t *info_outCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__processor_set_subsystem__defined
+#define __Request__processor_set_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		processor_set_flavor_t flavor;
+		mach_msg_type_number_t info_outCnt;
+	} __Request__processor_set_statistics_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int max_priority;
+		boolean_t change_threads;
+	} __Request__processor_set_max_priority_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int policy;
+	} __Request__processor_set_policy_enable_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int policy;
+		boolean_t change_threads;
+	} __Request__processor_set_policy_disable_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_set_tasks_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_set_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		processor_set_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[5];
+		boolean_t change;
+	} __Request__processor_set_policy_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__processor_set_stack_usage_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int flavor;
+		mach_msg_type_number_t info_outCnt;
+	} __Request__processor_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__processor_set_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__processor_set_subsystem__defined
+#define __RequestUnion__processor_set_subsystem__defined
+union __RequestUnion__processor_set_subsystem {
+	__Request__processor_set_statistics_t Request_processor_set_statistics;
+	__Request__processor_set_destroy_t Request_processor_set_destroy;
+	__Request__processor_set_max_priority_t Request_processor_set_max_priority;
+	__Request__processor_set_policy_enable_t Request_processor_set_policy_enable;
+	__Request__processor_set_policy_disable_t Request_processor_set_policy_disable;
+	__Request__processor_set_tasks_t Request_processor_set_tasks;
+	__Request__processor_set_threads_t Request_processor_set_threads;
+	__Request__processor_set_policy_control_t Request_processor_set_policy_control;
+	__Request__processor_set_stack_usage_t Request_processor_set_stack_usage;
+	__Request__processor_set_info_t Request_processor_set_info;
+};
+#endif /* !__RequestUnion__processor_set_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__processor_set_subsystem__defined
+#define __Reply__processor_set_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t info_outCnt;
+		integer_t info_out[5];
+	} __Reply__processor_set_statistics_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_set_max_priority_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_set_policy_enable_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_set_policy_disable_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t task_list;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t task_listCnt;
+	} __Reply__processor_set_tasks_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t thread_list;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t thread_listCnt;
+	} __Reply__processor_set_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__processor_set_policy_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		unsigned ltotal;
+		vm_size_t space;
+		vm_size_t resident;
+		vm_size_t maxusage;
+		vm_offset_t maxstack;
+	} __Reply__processor_set_stack_usage_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t host;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t info_outCnt;
+		integer_t info_out[5];
+	} __Reply__processor_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__processor_set_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__processor_set_subsystem__defined
+#define __ReplyUnion__processor_set_subsystem__defined
+union __ReplyUnion__processor_set_subsystem {
+	__Reply__processor_set_statistics_t Reply_processor_set_statistics;
+	__Reply__processor_set_destroy_t Reply_processor_set_destroy;
+	__Reply__processor_set_max_priority_t Reply_processor_set_max_priority;
+	__Reply__processor_set_policy_enable_t Reply_processor_set_policy_enable;
+	__Reply__processor_set_policy_disable_t Reply_processor_set_policy_disable;
+	__Reply__processor_set_tasks_t Reply_processor_set_tasks;
+	__Reply__processor_set_threads_t Reply_processor_set_threads;
+	__Reply__processor_set_policy_control_t Reply_processor_set_policy_control;
+	__Reply__processor_set_stack_usage_t Reply_processor_set_stack_usage;
+	__Reply__processor_set_info_t Reply_processor_set_info;
+};
+#endif /* !__RequestUnion__processor_set_subsystem__defined */
+
+#ifndef subsystem_to_name_map_processor_set
+#define subsystem_to_name_map_processor_set \
+    { "processor_set_statistics", 4000 },\
+    { "processor_set_destroy", 4001 },\
+    { "processor_set_max_priority", 4002 },\
+    { "processor_set_policy_enable", 4003 },\
+    { "processor_set_policy_disable", 4004 },\
+    { "processor_set_tasks", 4005 },\
+    { "processor_set_threads", 4006 },\
+    { "processor_set_policy_control", 4007 },\
+    { "processor_set_stack_usage", 4008 },\
+    { "processor_set_info", 4009 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _processor_set_user_ */
diff -urN cctools-806-old/include/mach/rpc.h cctools-806/include/mach/rpc.h
--- cctools-806-old/include/mach/rpc.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/rpc.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,135 @@
+/*
+ * Copyright (c) 2002,2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+/*
+ * Mach RPC Subsystem Interfaces
+ */
+
+#ifndef	_MACH_RPC_H_
+#define _MACH_RPC_H_
+
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/port.h>
+#include <mach/vm_types.h>
+
+#include <mach/mig.h>
+#include <mach/mig_errors.h>
+#include <mach/machine/rpc.h>
+#include <mach/thread_status.h>
+
+/*
+ * These are the types for RPC-specific variants of the MIG routine
+ * descriptor and subsystem data types.
+ *
+ * THIS IS ONLY FOR COMPATIBILITY.  WE WILL NOT BE IMPLEMENTING THIS.
+ */
+
+/*
+ * Basic mach rpc types.
+ */
+typedef unsigned int    routine_arg_type;
+typedef unsigned int	routine_arg_offset;
+typedef unsigned int	routine_arg_size;
+
+/*
+ * Definitions for a signature's argument and routine descriptor's.
+ */
+struct rpc_routine_arg_descriptor {
+	routine_arg_type	type;	   /* Port, Array, etc. */
+        routine_arg_size        size;      /* element size in bytes */
+        routine_arg_size        count;     /* number of elements */
+	routine_arg_offset	offset;	   /* Offset in list of routine args */
+};
+typedef struct rpc_routine_arg_descriptor *rpc_routine_arg_descriptor_t;
+
+struct rpc_routine_descriptor {
+	mig_impl_routine_t	impl_routine;	/* Server work func pointer   */
+	mig_stub_routine_t	stub_routine;	/* Unmarshalling func pointer */
+	unsigned int		argc;		/* Number of argument words   */
+	unsigned int		descr_count;	/* Number of complex argument */
+					        /* descriptors                */
+	rpc_routine_arg_descriptor_t
+				arg_descr;	/* Pointer to beginning of    */
+						/* the arg_descr array        */
+	unsigned int		max_reply_msg;	/* Max size for reply msg     */
+};
+typedef struct rpc_routine_descriptor *rpc_routine_descriptor_t;
+
+#define RPC_DESCR_SIZE(x) ((x)->descr_count * \
+				sizeof(struct rpc_routine_arg_descriptor))
+
+struct rpc_signature {
+    struct rpc_routine_descriptor rd;
+    struct rpc_routine_arg_descriptor rad[1];
+};
+
+#define RPC_SIGBUF_SIZE 8
+
+/*
+ *	A subsystem describes a set of server routines that can be invoked by
+ *	mach_rpc() on the ports that are registered with the subsystem.  For
+ *	each routine, the routine number is given, along with the
+ *	address of the implementation function in the server and a
+ *	description of the arguments of the routine (it's "signature").
+ *
+ *	This structure definition is only a template for what is really a
+ *	variable-length structure (generated by MIG for each subsystem).
+ *	The actual structures do not always have one entry in the routine
+ *	array, and also have a varying number of entries in the arg_descr
+ *	array.  Each routine has an array of zero or more arg descriptors
+ *	one for each complex arg.  These arrays are all catenated together
+ *	to form the arg_descr field of the subsystem struct.  The
+ *	arg_descr field of each routine entry points to a unique sub-sequence
+ *	within this catenated array.  The goal is to keep everything
+ *	contiguous.
+ */
+struct rpc_subsystem {
+	void		*reserved;	/* Reserved for system use */
+
+	mach_msg_id_t	start;		/* Min routine number */
+	mach_msg_id_t	end;		/* Max routine number + 1 */
+	unsigned int	maxsize;	/* Max mach_msg size */
+	vm_address_t	base_addr;	/* Address of this struct in user */
+
+	struct rpc_routine_descriptor	/* Array of routine descriptors */
+			routine[1       /* Actually, (start-end+1) */
+				 ];
+
+	struct rpc_routine_arg_descriptor
+			arg_descriptor[1   /* Actually, the sum of the descr_ */
+					]; /* count fields for all routines   */
+};
+typedef struct rpc_subsystem  *rpc_subsystem_t;
+
+#define RPC_SUBSYSTEM_NULL	((rpc_subsystem_t) 0)
+
+#endif	/* _MACH_RPC_H_ */
diff -urN cctools-806-old/include/mach/sdt.h cctools-806/include/mach/sdt.h
--- cctools-806-old/include/mach/sdt.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/sdt.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,32 @@
+/*
+ * CDDL HEADER START
+ *
+ * The contents of this file are subject to the terms of the
+ * Common Development and Distribution License, Version 1.0 only
+ * (the "License").  You may not use this file except in compliance
+ * with the License.
+ *
+ * You can obtain a copy of the license at usr/src/OPENSOLARIS.LICENSE
+ * or http://www.opensolaris.org/os/licensing.
+ * See the License for the specific language governing permissions
+ * and limitations under the License.
+ *
+ * When distributing Covered Code, include this CDDL HEADER in each
+ * file and include the License file at usr/src/OPENSOLARIS.LICENSE.
+ * If applicable, add the following below this CDDL HEADER, with the
+ * fields enclosed by brackets "[]" replaced with your own identifying
+ * information: Portions Copyright [yyyy] [name of copyright owner]
+ *
+ * CDDL HEADER END
+ */
+/*
+ * Copyright 2004 Sun Microsystems, Inc.  All rights reserved.
+ * Use is subject to license terms.
+ */
+
+#ifndef _MACH_SDT_H
+#define	_MACH_SDT_H
+
+#include <mach/machine/sdt.h>
+
+#endif	/* _MACH_SDT_H */
diff -urN cctools-806-old/include/mach/security.defs cctools-806/include/mach/security.defs
--- cctools-806-old/include/mach/security.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/security.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,208 @@
+
+/* -*- C++ -*- */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  security 5200;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+type labelstr_t = c_string[*:512];
+
+/**
+  @brief Retrieve a task label as a label handle
+  @param task Target's task port
+  @param label Returned label handle
+
+  This call retrieves the label handle of the specified task.
+
+  @return Standard MiG return values (0 for success)
+*/
+
+routine mach_get_task_label(task      : ipc_space_t;
+			    out label : mach_port_name_t);
+
+/**
+  @brief Retrieve a task label in textual form
+  @param task Target's task port
+  @param policies Comma-delimited list of policies to query
+  @param label Returned label text
+
+  This call retrieves an externalized task label for the
+  specified task, with respect to the specified policies.
+
+  @return Standard MiG return values (0 for success)
+*/
+
+routine mach_get_task_label_text(task      : ipc_space_t;
+				 policies  : labelstr_t;
+				 out label : labelstr_t);
+
+/**
+  @brief Retrieve a port label as a label handle
+  @param task Issuer's task port
+  @param port Port to query label from
+  @param label Returned label handle
+
+  This call retrieves a new label handle for the specified port.
+  If the port represents a label handle, KERN_INVALID_ARGUMENT is
+  returned.
+
+  @return Standard MiG return values (0 for success)
+*/
+
+routine mach_get_label(task      : ipc_space_t;
+		       port      : mach_port_name_t;
+		       out label : mach_port_name_t);
+
+/**
+  @brief Retrieve a port label in textual form
+  @param task Issuer's task port
+  @param name Port to query label from
+  @param policies Comma-delimited list of policies to query
+  @param label Returned label text
+
+  This call retrieves an externalized port label for the specified port,
+  with respect to the specified policies. If the port represents a label
+  handle, the returned label text refers to the stored label and not the
+  access control label.
+
+  @return Standard MiG return values (0 for success)
+*/
+
+routine mach_get_label_text(task      : ipc_space_t;
+			    name      : mach_port_name_t;
+			    policies  : labelstr_t;
+			    out label : labelstr_t);
+
+/**
+  @brief Relabel a port
+  @param task Task containing specified ports
+  @param name Port to relabel
+  @param label String representation of new label
+
+  This call attempts to relabel the specified port to the
+  label specified. For label handles, it changes the access control
+  label and not the stored label.
+
+  @return Standard MiG return values (0 for success)
+*/
+
+routine mach_set_port_label(task      : ipc_space_t;
+			    name      : mach_port_name_t;
+			    label     : labelstr_t);
+
+/**
+  @brief Generic access control check
+  @param task Any task port
+  @param subj subject label in textual form
+  @param obj object label in textual form
+  @param serv Service or object class name
+  @param perm Permission, or method, within the specified service
+
+  This function provides a general way for a user process to query
+  an arbitrary access control decision from the system's security policies.
+  Currently, there are no standards for the format of the service and
+  permission names. 
+
+  @return Standard MiG return values (0 for success)
+*/
+
+routine mac_check_service(task    : ipc_space_t;
+			  subject : labelstr_t;
+			  object  : labelstr_t;
+			  service : labelstr_t;
+			  perm    : labelstr_t);
+
+/**
+  @brief Generic access control check
+  @param task Task containing specified ports (usually caller's)
+  @param subj subject label in textual form
+  @param obj port containing object label
+  @param serv Service or object class name
+  @param perm Permission, or method, within the specified service
+
+  This function provides a general way for a user process to query
+  an arbitrary access control decision from the system's security policies.
+  Currently, there are no standards for the format of the service and
+  permission names. If the port is a label handle, the stored label is
+  used. Otherwise, its access control label is used.
+
+  @return Standard MiG return values (0 for success)
+*/
+
+routine mac_port_check_service_obj(task    : ipc_space_t;
+				   subject : labelstr_t;
+				   object  : mach_port_name_t;
+				   service : labelstr_t;
+				   perm    : labelstr_t);
+
+/**
+  @brief Generic access control check
+  @param task Task containing specified ports (usually caller's)
+  @param subj port containing subject label
+  @param obj port containing object label
+  @param serv Service or object class name
+  @param perm Permission, or method, within the specified service
+
+  This function provides a general way for a user process to query
+  an arbitrary access control decision from the system's security policies.
+  Currently, there are no standards for the format of the service and
+  permission names. If any ports are label handles, the stored label is
+  used. Otherwise, the access control labels are used.
+
+  @return Standard MiG return values (0 for success)
+*/
+
+routine mac_port_check_access(task    : ipc_space_t;
+			      subject : mach_port_name_t;
+			      object  : mach_port_name_t;
+			      service : labelstr_t;
+			      perm    : labelstr_t);
+
+/**
+  @brief Create a new label handle
+  @param task Task to receive new ports (usually caller's)
+  @param name Returned label handle port
+  @param label String representation of new label
+
+  Creates a new label handle, with the stored label defined by the
+  given text. Any task may create a label handle with any valid label,
+  not necessarily one that it has permission to access. A port right
+  for the new label handle is inserted into the specified task.
+  Posession of label handles should not imply any security properties.
+
+  @return Standard MiG return values (0 for success)
+*/
+
+routine mac_label_new(task     : ipc_space_t;
+		      out name : mach_port_name_t;
+		      label    : labelstr_t);
+
+/**
+  @brief Request a computed label
+  @param task subj,obj,newlabel relative to this task (usually caller's)
+  @param subj port containing subject label
+  @param obj port containing object label
+  @param serv Service or object class name
+  @param newlabel Returned label handle port
+  
+  Ask the loaded policies to compute a label based on the two input labels
+  and the service name. There is currently no standard for the service name,
+  or even what the input labels represent (Subject and parent object are only
+  a suggestion). If any ports are label handles, the stored label is
+  used. Otherwise, the access control labels are used. A new label handle
+  is created to contain the computed label, and is stored into the
+  specified task.
+
+  @return Standard MiG return values (0 for success)
+*/
+
+routine mac_request_label(task         : ipc_space_t;
+			  subject      : mach_port_name_t;
+			  object       : mach_port_name_t;
+			  service      : labelstr_t;
+			  out newlabel : mach_port_name_t);
diff -urN cctools-806-old/include/mach/semaphore.h cctools-806/include/mach/semaphore.h
--- cctools-806-old/include/mach/semaphore.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/semaphore.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,78 @@
+/*
+ * Copyright (c) 2000-2008 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_SEMAPHORE_H_
+#define _MACH_SEMAPHORE_H_
+
+#include <mach/port.h>
+#include <mach/mach_types.h>
+#include <mach/kern_return.h>
+#include <mach/sync_policy.h>
+
+/*
+ *	Forward Declarations
+ *
+ *	The semaphore creation and deallocation routines are
+ *	defined with the Mach task APIs in <mach/task.h>.
+ *
+ *      kern_return_t	semaphore_create(task_t task,
+ *                                       semaphore_t *new_semaphore,
+ *					 sync_policy_t policy,
+ *					 int value);
+ *
+ *	kern_return_t	semaphore_destroy(task_t task,
+ *					  semaphore_t semaphore);
+ */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+extern	kern_return_t	semaphore_signal     	(semaphore_t semaphore);
+extern	kern_return_t	semaphore_signal_all 	(semaphore_t semaphore);
+
+extern	kern_return_t	semaphore_wait       	(semaphore_t semaphore);
+
+
+extern	kern_return_t	semaphore_timedwait    	(semaphore_t semaphore, 
+												 mach_timespec_t wait_time);
+
+extern  kern_return_t	semaphore_timedwait_signal(semaphore_t wait_semaphore,
+												   semaphore_t signal_semaphore,
+												   mach_timespec_t wait_time);
+
+extern  kern_return_t   semaphore_wait_signal   (semaphore_t wait_semaphore,
+                                                 semaphore_t signal_semaphore);
+
+extern	kern_return_t	semaphore_signal_thread	(semaphore_t semaphore,
+                                                 thread_t thread);
+
+
+__END_DECLS
+
+
+#endif	/* _MACH_SEMAPHORE_H_ */
diff -urN cctools-806-old/include/mach/shared_memory_server.h cctools-806/include/mach/shared_memory_server.h
--- cctools-806-old/include/mach/shared_memory_server.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/shared_memory_server.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,147 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ *
+ *	File: mach/shared_memory_server.h
+ *
+ * 	protos and struct definitions for shared library
+ *	server and interface
+ */
+
+/*
+ * XXX
+ * 
+ * NOTE: this file is deprecated and will be removed in the near future.
+ * Any project that includes this file should be changed to:
+ * 1. use <mach/shared_region.h> instead of this file,
+ * 2. handle the new shared regions, now available on more platforms
+ */
+
+#ifndef _MACH_SHARED_MEMORY_SERVER_H_
+#define _MACH_SHARED_MEMORY_SERVER_H_
+
+#warning "<mach/shared_memory_server.h> is deprecated.  Please use <mach/shared_region.h> instead."
+
+#include <sys/cdefs.h>
+#include <mach/vm_prot.h>
+#include <mach/vm_types.h>
+#include <mach/mach_types.h>
+
+#define VM_PROT_COW  0x8  /* must not interfere with normal prot assignments */
+#define VM_PROT_ZF  0x10  /* must not interfere with normal prot assignments */
+
+#ifdef	__arm__
+#define GLOBAL_SHARED_TEXT_SEGMENT	0x30000000U
+#define GLOBAL_SHARED_DATA_SEGMENT	0x38000000U
+#define GLOBAL_SHARED_SEGMENT_MASK	0xF8000000U
+
+#define	SHARED_TEXT_REGION_SIZE		0x08000000
+#define	SHARED_DATA_REGION_SIZE		0x08000000
+#else
+#define GLOBAL_SHARED_TEXT_SEGMENT	0x90000000U
+#define GLOBAL_SHARED_DATA_SEGMENT	0xA0000000U
+#define GLOBAL_SHARED_SEGMENT_MASK	0xF0000000U
+
+#define	SHARED_TEXT_REGION_SIZE		0x10000000
+#define	SHARED_DATA_REGION_SIZE		0x10000000
+#endif
+
+#if !defined(__LP64__)
+
+#define	SHARED_LIBRARY_SERVER_SUPPORTED
+
+#define	SHARED_ALTERNATE_LOAD_BASE	0x09000000
+
+/* 
+ *  Note: the two masks below are useful because the assumption is 
+ *  made that these shared regions will always be mapped on natural boundaries 
+ *  i.e. if the size is 0x10000000 the object can be mapped at 
+ *  0x20000000, or 0x30000000, but not 0x1000000
+ */
+#ifdef	__arm__
+#define	SHARED_TEXT_REGION_MASK		0x07FFFFFF
+#define	SHARED_DATA_REGION_MASK		0x07FFFFFF
+#else
+#define	SHARED_TEXT_REGION_MASK		0x0FFFFFFF
+#define	SHARED_DATA_REGION_MASK		0x0FFFFFFF
+#endif
+
+
+/* flags field aliases for copyin_shared_file and load_shared_file */
+
+/* IN */
+#define ALTERNATE_LOAD_SITE 0x1
+#define NEW_LOCAL_SHARED_REGIONS 0x2
+#define	QUERY_IS_SYSTEM_REGION 0x4
+
+/* OUT */
+#define SF_PREV_LOADED    0x1
+#define SYSTEM_REGION_BACKED 0x2
+
+
+struct sf_mapping {
+	vm_offset_t	mapping_offset;
+	vm_size_t	size;
+	vm_offset_t	file_offset;
+	vm_prot_t	protection;  /* read/write/execute/COW/ZF */
+	vm_offset_t	cksum;
+};
+typedef struct sf_mapping sf_mapping_t;
+
+#endif  /* !defined(__LP64__) */
+
+/* 
+ * All shared_region_* declarations are a private interface
+ * between dyld and the kernel.
+ *
+ */
+struct shared_file_mapping_np {
+	mach_vm_address_t	sfm_address;
+	mach_vm_size_t		sfm_size;
+	mach_vm_offset_t	sfm_file_offset;
+	vm_prot_t		sfm_max_prot;
+	vm_prot_t		sfm_init_prot;
+};
+
+struct shared_region_range_np {
+	mach_vm_address_t	srr_address;
+	mach_vm_size_t		srr_size;
+};
+
+
+__BEGIN_DECLS
+int	shared_region_map_file_np(int fd,
+				  uint32_t mappingCount,
+				  const struct shared_file_mapping_np *mappings,
+				  int64_t *slide_p);
+int	shared_region_make_private_np(uint32_t rangeCount,
+				      const struct shared_region_range_np *ranges);
+__END_DECLS
+
+
+#endif /* _MACH_SHARED_MEMORY_SERVER_H_ */
diff -urN cctools-806-old/include/mach/shared_region.h cctools-806/include/mach/shared_region.h
--- cctools-806-old/include/mach/shared_region.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/shared_region.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,122 @@
+/*
+ * Copyright (c) 2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ *
+ *	File: mach/shared_region.h
+ *
+ * 	protos and struct definitions for shared region
+ */
+
+#ifndef _MACH_SHARED_REGION_H_
+#define _MACH_SHARED_REGION_H_
+
+#include <sys/cdefs.h>
+#include <mach/vm_prot.h>
+#include <mach/vm_types.h>
+#include <mach/mach_types.h>
+
+#define SHARED_REGION_BASE_I386			0x90000000ULL
+#define SHARED_REGION_SIZE_I386			0x20000000ULL
+#define SHARED_REGION_NESTING_BASE_I386		0x90000000ULL
+#define SHARED_REGION_NESTING_SIZE_I386		0x20000000ULL
+#define SHARED_REGION_NESTING_MIN_I386		0x00200000ULL
+#define SHARED_REGION_NESTING_MAX_I386		0xFFE00000ULL
+
+#define SHARED_REGION_BASE_X86_64		0x00007FFF70000000ULL
+#define SHARED_REGION_SIZE_X86_64		0x000000008FE00000ULL
+#define SHARED_REGION_NESTING_BASE_X86_64	0x00007FFF80000000ULL
+#define SHARED_REGION_NESTING_SIZE_X86_64	0x0000000040000000ULL
+#define SHARED_REGION_NESTING_MIN_X86_64	0x0000000000200000ULL
+#define SHARED_REGION_NESTING_MAX_X86_64	0xFFFFFFFFFFE00000ULL
+
+#define SHARED_REGION_BASE_PPC			0x90000000ULL
+#define SHARED_REGION_SIZE_PPC			0x20000000ULL
+#define SHARED_REGION_NESTING_BASE_PPC		0x90000000ULL
+#define SHARED_REGION_NESTING_SIZE_PPC		0x10000000ULL
+#define SHARED_REGION_NESTING_MIN_PPC		0x10000000ULL
+#define SHARED_REGION_NESTING_MAX_PPC		0x10000000ULL
+
+#define SHARED_REGION_BASE_PPC64		0x00007FFF60000000ULL
+#define SHARED_REGION_SIZE_PPC64		0x00000000A0000000ULL
+#define SHARED_REGION_NESTING_BASE_PPC64	0x00007FFF60000000ULL
+#define SHARED_REGION_NESTING_SIZE_PPC64	0x00000000A0000000ULL
+#define SHARED_REGION_NESTING_MIN_PPC64		0x0000000010000000ULL
+#define SHARED_REGION_NESTING_MAX_PPC64		0x0000000010000000ULL
+
+#define SHARED_REGION_BASE_ARM			0x30000000ULL
+#define SHARED_REGION_SIZE_ARM			0x10000000ULL
+#define SHARED_REGION_NESTING_BASE_ARM		0x30000000ULL
+#define SHARED_REGION_NESTING_SIZE_ARM		0x10000000ULL
+#define SHARED_REGION_NESTING_MIN_ARM		?
+#define SHARED_REGION_NESTING_MAX_ARM		?
+
+#if defined(__i386__)
+#define SHARED_REGION_BASE			SHARED_REGION_BASE_I386
+#define SHARED_REGION_SIZE			SHARED_REGION_SIZE_I386
+#define SHARED_REGION_NESTING_BASE		SHARED_REGION_NESTING_BASE_I386
+#define SHARED_REGION_NESTING_SIZE		SHARED_REGION_NESTING_SIZE_I386
+#define SHARED_REGION_NESTING_MIN		SHARED_REGION_NESTING_MIN_I386
+#define SHARED_REGION_NESTING_MAX		SHARED_REGION_NESTING_MAX_I386
+#elif defined(__x86_64__)
+#define SHARED_REGION_BASE			SHARED_REGION_BASE_X86_64
+#define SHARED_REGION_SIZE			SHARED_REGION_SIZE_X86_64
+#define SHARED_REGION_NESTING_BASE		SHARED_REGION_NESTING_BASE_X86_64
+#define SHARED_REGION_NESTING_SIZE		SHARED_REGION_NESTING_SIZE_X86_64
+#define SHARED_REGION_NESTING_MIN		SHARED_REGION_NESTING_MIN_X86_64
+#define SHARED_REGION_NESTING_MAX		SHARED_REGION_NESTING_MAX_X86_64
+#elif defined(__arm__)
+#define SHARED_REGION_BASE			SHARED_REGION_BASE_ARM
+#define SHARED_REGION_SIZE			SHARED_REGION_SIZE_ARM
+#define SHARED_REGION_NESTING_BASE		SHARED_REGION_NESTING_BASE_ARM
+#define SHARED_REGION_NESTING_SIZE		SHARED_REGION_NESTING_SIZE_ARM
+#define SHARED_REGION_NESTING_MIN		SHARED_REGION_NESTING_MIN_ARM
+#define SHARED_REGION_NESTING_MAX		SHARED_REGION_NESTING_MAX_ARM
+#endif
+
+/* 
+ * All shared_region_* declarations are a private interface
+ * between dyld and the kernel.
+ *
+ */
+struct shared_file_mapping_np {
+	mach_vm_address_t	sfm_address;
+	mach_vm_size_t		sfm_size;
+	mach_vm_offset_t	sfm_file_offset;
+	vm_prot_t		sfm_max_prot;
+	vm_prot_t		sfm_init_prot;
+};
+#define VM_PROT_COW  0x8  /* must not interfere with normal prot assignments */
+#define VM_PROT_ZF  0x10  /* must not interfere with normal prot assignments */
+#define VM_PROT_SLIDE  0x20  /* must not interfere with normal prot assignments */
+
+
+__BEGIN_DECLS
+int	shared_region_check_np(uint64_t	*startaddress);
+int	shared_region_map_np(int fd,
+			     uint32_t mappingCount,
+			     const struct shared_file_mapping_np *mappings);
+int	shared_region_slide_np(void);
+__END_DECLS
+
+
+#endif /* _MACH_SHARED_REGION_H_ */
diff -urN cctools-806-old/include/mach/std_types.defs cctools-806/include/mach/std_types.defs
--- cctools-806-old/include/mach/std_types.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/std_types.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,150 @@
+/*
+ * Copyright (c) 2002,2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	Mach kernel standard interface type declarations
+ */
+
+#ifndef	_MACH_STD_TYPES_DEFS_
+#define _MACH_STD_TYPES_DEFS_
+
+/* from ISO/IEC 988:1999 spec */
+/* 7.18.1.1 Exact-width integer types */
+
+type int8_t = MACH_MSG_TYPE_INTEGER_8;
+type uint8_t = MACH_MSG_TYPE_INTEGER_8;
+type int16_t = MACH_MSG_TYPE_INTEGER_16;
+type uint16_t = MACH_MSG_TYPE_INTEGER_16;
+type int32_t = MACH_MSG_TYPE_INTEGER_32;
+type uint32_t = MACH_MSG_TYPE_INTEGER_32;
+type int64_t = MACH_MSG_TYPE_INTEGER_64;
+type uint64_t = MACH_MSG_TYPE_INTEGER_64;
+
+/*
+ * Legacy fixed-length Mach types which should
+ * be replaced with the Standard types from above.
+ */
+type int32 = int32_t;
+type unsigned32 = uint32_t;
+type int64 = int64_t;
+type unsigned64 = uint64_t;
+
+/*
+ * Other fixed length Mach types.
+ */
+type char = MACH_MSG_TYPE_CHAR;
+type boolean_t = MACH_MSG_TYPE_BOOLEAN;
+
+#include <mach/machine/machine_types.defs>
+
+type kern_return_t = int;
+
+type pointer_t = ^array[] of MACH_MSG_TYPE_BYTE
+	ctype: vm_offset_t;
+
+
+type mach_port_t = MACH_MSG_TYPE_COPY_SEND;
+type mach_port_array_t = array[] of mach_port_t;
+
+type mach_port_name_t = MACH_MSG_TYPE_PORT_NAME;
+type mach_port_name_array_t = array[] of mach_port_name_t;
+
+type mach_port_right_t = natural_t;
+
+type mach_port_type_t = natural_t;
+type mach_port_type_array_t = array[] of mach_port_type_t;
+
+type mach_port_urefs_t = natural_t;
+type mach_port_delta_t = integer_t;
+type mach_port_seqno_t = natural_t;
+type mach_port_mscount_t = unsigned;
+type mach_port_msgcount_t = unsigned;
+type mach_port_rights_t = unsigned;
+type mach_msg_id_t = integer_t;
+type mach_msg_size_t = natural_t;
+type mach_msg_type_name_t = unsigned;
+type mach_msg_options_t = integer_t;
+
+type mach_port_move_receive_t =		MACH_MSG_TYPE_MOVE_RECEIVE
+	ctype: mach_port_t;
+type mach_port_copy_send_t =		MACH_MSG_TYPE_COPY_SEND
+	ctype: mach_port_t;
+type mach_port_make_send_t =		MACH_MSG_TYPE_MAKE_SEND
+	ctype: mach_port_t;
+type mach_port_move_send_t =		MACH_MSG_TYPE_MOVE_SEND
+	ctype: mach_port_t;
+type mach_port_make_send_once_t =	MACH_MSG_TYPE_MAKE_SEND_ONCE
+	ctype: mach_port_t;
+type mach_port_move_send_once_t =	MACH_MSG_TYPE_MOVE_SEND_ONCE
+	ctype: mach_port_t;
+
+type mach_port_receive_t =		MACH_MSG_TYPE_PORT_RECEIVE
+	ctype: mach_port_t;
+type mach_port_send_t =			MACH_MSG_TYPE_PORT_SEND
+	ctype: mach_port_t;
+type mach_port_send_once_t =		MACH_MSG_TYPE_PORT_SEND_ONCE
+	ctype: mach_port_t;
+
+type mach_port_poly_t = polymorphic
+	ctype: mach_port_t;
+
+import <mach/std_types.h>;
+import <mach/mig.h>;
+
+#endif	/* _MACH_STD_TYPES_DEFS_ */
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/std_types.h cctools-806/include/mach/std_types.h
--- cctools-806-old/include/mach/std_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/std_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,72 @@
+/*
+ * Copyright (c) 2002,2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	Mach standard external interface type definitions.
+ *
+ */
+
+#ifndef	_MACH_STD_TYPES_H_
+#define	_MACH_STD_TYPES_H_
+
+#include <stdint.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/port.h>
+#include <mach/vm_types.h>
+
+#endif	/* _MACH_STD_TYPES_H_ */
diff -urN cctools-806-old/include/mach/sync.h cctools-806/include/mach/sync.h
--- cctools-806-old/include/mach/sync.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/sync.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,35 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+** This file contains compatibilty wrapper header for things that used
+** to be generated from mach/sync.defs.  Now that code is split into two
+** different interface generator files, so include the two resulting
+** headers here.
+*/
+#include <mach/semaphore.h>
+#include <mach/lock_set.h>
diff -urN cctools-806-old/include/mach/sync_policy.h cctools-806/include/mach/sync_policy.h
--- cctools-806-old/include/mach/sync_policy.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/sync_policy.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,49 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef	_MACH_SYNC_POLICY_H_
+#define _MACH_SYNC_POLICY_H_
+
+typedef int sync_policy_t;
+
+/*
+ *	These options define the wait ordering of the synchronizers
+ */
+#define SYNC_POLICY_FIFO		0x0
+#define SYNC_POLICY_FIXED_PRIORITY	0x1
+#define SYNC_POLICY_REVERSED		0x2
+#define SYNC_POLICY_ORDER_MASK		0x3
+#define SYNC_POLICY_LIFO		(SYNC_POLICY_FIFO|SYNC_POLICY_REVERSED)
+
+
+#define SYNC_POLICY_MAX			0x7
+
+#endif 	/* _MACH_SYNC_POLICY_H_ */
diff -urN cctools-806-old/include/mach/task_access.defs cctools-806/include/mach/task_access.defs
--- cctools-806-old/include/mach/task_access.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/task_access.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,59 @@
+/*
+ * Copyright (c) 2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+subsystem
+#if	KERNEL_USER
+		KernelUser
+#endif	/* KERN_USER */
+			task_access 27000;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+/*
+ *	Verify task_for_pid access for the given pid
+ *	Access granted by return value (success/failure)
+ */
+routine check_task_access(
+		task_access_port			: mach_port_t;
+		calling_pid				: int32_t;
+		calling_gid				: uint32_t;
+		target_pid				: int32_t;
+		ServerAuditToken	caller_cred 	: audit_token_t);
+
+/*
+ *	Search for a code signature for unsigned executables
+ */
+routine find_code_signature(
+		task_access_port			: mach_port_t;
+		new_pid					: int32_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/task.defs cctools-806/include/mach/task.defs
--- cctools-806-old/include/mach/task.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/task.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,413 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_port.defs
+ *	Author:	Rich Draves
+ *
+ *	Exported kernel calls.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  task 3400;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach_debug/mach_debug_types.defs>
+
+/*
+ *	Create a new task with an empty set of IPC rights,
+ *	and having an address space constructed from the
+ *	target task (or empty, if inherit_memory is FALSE).
+ */
+routine task_create(
+		target_task	: task_t;
+		ledgers		: ledger_array_t;
+		inherit_memory	: boolean_t;
+	out	child_task	: task_t);
+
+/*
+ *	Destroy the target task, causing all of its threads
+ *	to be destroyed, all of its IPC rights to be deallocated,
+ *	and all of its address space to be deallocated.
+ */
+routine task_terminate(
+		target_task	: task_t);
+
+/*
+ *	Returns the set of threads belonging to the target task.
+ */
+routine task_threads(
+		target_task	: task_t;
+	out	act_list	: thread_act_array_t);
+
+/*
+ *	Stash a handful of ports for the target task; child
+ *	tasks inherit this stash at task_create time.
+ */
+routine	mach_ports_register(
+		target_task	: task_t;
+		init_port_set	: mach_port_array_t =
+					^array[] of mach_port_t);
+
+/*
+ *	Retrieve the stashed ports for the target task.
+ */
+routine	mach_ports_lookup(
+		target_task	: task_t;
+	out	init_port_set	: mach_port_array_t =
+					^array[] of mach_port_t);
+
+/*
+ *      Returns information about the target task.
+ */
+routine task_info(
+                target_task     : task_name_t;
+                flavor          : task_flavor_t;
+        out     task_info_out   : task_info_t, CountInOut);
+
+/*
+ * Set task information.
+ */
+routine	task_set_info(
+		target_task	: task_t;
+		flavor		: task_flavor_t;
+		task_info_in	: task_info_t);
+
+/*
+ *	Increment the suspend count for the target task.
+ *	No threads within a task may run when the suspend
+ *	count for that task is non-zero.
+ */
+routine	task_suspend(
+		target_task	: task_t);
+
+
+/*
+ *	Decrement the suspend count for the target task,
+ *	if the count is currently non-zero.  If the resulting
+ *	suspend	count is zero, then threads within the task
+ *	that also have non-zero suspend counts may execute.
+ */
+routine	task_resume(
+		target_task	: task_t);
+
+/*
+ *	Returns the current value of the selected special port
+ *	associated with the target task.
+ */
+routine task_get_special_port(
+		task		: task_t;
+		which_port	: int;
+	out	special_port	: mach_port_t);
+
+/*
+ *	Set one of the special ports associated with the
+ *	target task.
+ */
+routine task_set_special_port(
+		task		: task_t;
+		which_port	: int;
+		special_port	: mach_port_t);
+
+/*
+ *	Create a new thread within the target task, returning
+ *	the port representing the first thr_act in that new thread.  The
+ *	initial execution state of the thread is undefined.
+ */
+routine
+#ifdef KERNEL_SERVER
+thread_create_from_user(
+#else
+thread_create(
+#endif
+		parent_task	: task_t;
+	out	child_act	: thread_act_t);
+
+/*
+ *      Create a new thread within the target task, returning
+ *      the port representing that new thread.  The new thread 
+ *	is not suspended; its initial execution state is given
+ *	by flavor and new_state. Returns the port representing 
+ *	the new thread.
+ */
+routine
+#ifdef KERNEL_SERVER
+thread_create_running_from_user(
+#else
+thread_create_running(
+#endif
+                parent_task     : task_t;
+                flavor          : thread_state_flavor_t;
+                new_state       : thread_state_t;
+        out     child_act       : thread_act_t);
+
+/*
+ * Set an exception handler for a task on one or more exception types.
+ * These handlers are invoked for all threads in the task if there are
+ * no thread-specific exception handlers or those handlers returned an
+ * error.
+ */
+routine	task_set_exception_ports(
+		task		: task_t;
+		exception_mask	: exception_mask_t;
+		new_port	: mach_port_t;
+		behavior	: exception_behavior_t;
+		new_flavor	: thread_state_flavor_t);
+
+
+/*
+ * Lookup some of the old exception handlers for a task
+ */
+routine	task_get_exception_ports(
+		task		: task_t;
+		exception_mask	: exception_mask_t;
+	  out	masks		: exception_mask_array_t;
+	  out	old_handlers	: exception_handler_array_t, SameCount;
+	  out	old_behaviors	: exception_behavior_array_t, SameCount;
+	  out	old_flavors	: exception_flavor_array_t, SameCount);
+
+
+/*
+ * Set an exception handler for a thread on one or more exception types.
+ * At the same time, return the previously defined exception handlers for
+ * those types.
+ */
+routine	task_swap_exception_ports(
+		task		: task_t;
+		exception_mask	: exception_mask_t;
+		new_port	: mach_port_t;
+		behavior	: exception_behavior_t;
+		new_flavor	: thread_state_flavor_t;
+	  out	masks		: exception_mask_array_t;
+	  out	old_handlerss	: exception_handler_array_t, SameCount;
+	  out	old_behaviors	: exception_behavior_array_t, SameCount;
+	  out	old_flavors	: exception_flavor_array_t, SameCount);
+
+/*
+ * Create and destroy lock_set and semaphore synchronizers on a
+ * per-task basis (i.e. the task owns them).
+ */
+routine lock_set_create(
+		task		: task_t;
+	out	new_lock_set	: lock_set_t;
+		n_ulocks	: int;
+		policy		: int);
+
+routine lock_set_destroy(
+		task		: task_t;
+		lock_set	: lock_set_t);
+
+routine semaphore_create(
+		task		: task_t;
+	out	semaphore	: semaphore_t;
+		policy		: int;
+		value		: int);
+
+routine semaphore_destroy(
+		task		: task_t;
+		semaphore	: semaphore_consume_ref_t);
+
+/*
+ * Set/get policy information for a task.
+ * (Approved Mac OS X microkernel interface)
+ */
+
+routine task_policy_set(
+	task			: task_t;
+	flavor			: task_policy_flavor_t;
+	policy_info		: task_policy_t);
+
+routine task_policy_get(
+	task			: task_t;
+	flavor			: task_policy_flavor_t;
+out	policy_info		: task_policy_t, CountInOut;
+inout	get_default		: boolean_t);
+
+/*
+ *	Removed from the kernel.
+ */
+#if KERNEL_SERVER
+skip;
+#else
+routine task_sample(
+		task		: task_t;
+		reply		: mach_port_make_send_t);
+#endif
+
+/*
+ * JMM - Everything from here down is likely to go away soon
+ */
+/*
+ * OBSOLETE interface.
+ */
+routine task_policy(
+	task			: task_t;
+	policy			: policy_t;
+	base			: policy_base_t;
+	set_limit		: boolean_t;
+	change			: boolean_t);
+
+
+/*
+ *	Establish a user-level handler for the specified
+ *	system call.
+ */
+routine task_set_emulation(
+		target_port	: task_t;
+		routine_entry_pt: vm_address_t;
+		routine_number  : int);	
+
+/*
+ *	Get user-level handler entry points for all
+ *	emulated system calls.
+ */
+routine task_get_emulation_vector(
+		task		: task_t;
+	out	vector_start	: int;
+	out	emulation_vector: emulation_vector_t);
+
+/*
+ *	Establish user-level handlers for the specified
+ *	system calls. Non-emulated system calls are specified
+ *	with emulation_vector[i] == EML_ROUTINE_NULL.
+ */
+routine task_set_emulation_vector(
+		task		: task_t;
+		vector_start	: int;
+		emulation_vector: emulation_vector_t);
+
+
+/*
+ *      Establish restart pc for interrupted atomic sequences.
+ */
+routine task_set_ras_pc(
+		target_task     : task_t;
+		basepc          : vm_address_t;
+		boundspc        : vm_address_t);
+
+
+/*
+ * Return zone info as seen/used by this task.
+ */
+routine task_zone_info(
+		target_task	: task_t;
+	out	names		: mach_zone_name_array_t,
+					Dealloc;
+	out	info		: task_zone_info_array_t,
+					Dealloc);
+
+
+/* 
+ * JMM - Want to eliminate processor_set so keep them at the end.
+ */
+
+/*
+ *	Assign task to processor set.
+ */
+routine task_assign(
+		task		: task_t;
+		new_set		: processor_set_t;
+		assign_threads	: boolean_t);
+
+/*
+ *	Assign task to default set.
+ */
+routine task_assign_default(
+		task		: task_t;
+		assign_threads	: boolean_t);
+
+/*
+ *	Get current assignment for task.
+ */
+routine task_get_assignment(
+		task		: task_t;
+	out	assigned_set	: processor_set_name_t);
+
+/*
+ * OBSOLETE interface.
+ */
+routine task_set_policy(
+	task			: task_t;
+	pset			: processor_set_t;
+	policy			: policy_t;
+	base			: policy_base_t;
+	limit			: policy_limit_t;
+	change			: boolean_t);
+
+/*
+ * Read the selected state which is to be installed on new 
+ * threads in the task as they are created.
+ */
+routine task_get_state(
+		task		: task_t;
+		flavor		: thread_state_flavor_t;
+	out	old_state	: thread_state_t, CountInOut);
+ 
+/*
+ * Set the selected state information to be installed on
+ * all subsequently created threads in the task.
+ */
+routine	task_set_state(
+		task		: task_t;
+		flavor		: thread_state_flavor_t;
+		new_state	: thread_state_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/task.h cctools-806/include/mach/task.h
--- cctools-806-old/include/mach/task.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/task.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,36 @@
+/*
+ * Copyright (c) 2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#if defined(__i386__)
+#include <mach/i386/task.h>
+#elif defined(__x86_64__)
+#include <mach/x86_64/task.h>
+#elif defined(__arm__)
+#include <mach/arm/task.h>
+#else
+#error unknown architecture
+#endif 
diff -urN cctools-806-old/include/mach/task_info.h cctools-806/include/mach/task_info.h
--- cctools-806-old/include/mach/task_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/task_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,272 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ *	Machine-independent task information structures and definitions.
+ *
+ *	The definitions in this file are exported to the user.  The kernel
+ *	will translate its internal data structures to these structures
+ *	as appropriate.
+ *
+ */
+
+#ifndef	_MACH_TASK_INFO_H_
+#define	_MACH_TASK_INFO_H_
+
+#include <mach/message.h>
+#include <mach/machine/vm_types.h>
+#include <mach/time_value.h>
+#include <mach/policy.h>
+
+#include <sys/cdefs.h>
+
+/*
+ *	Generic information structure to allow for expansion.
+ */
+typedef	natural_t	task_flavor_t;
+typedef	integer_t	*task_info_t;		/* varying array of int */
+
+#define	TASK_INFO_MAX	(1024)		/* maximum array size */
+typedef	integer_t	task_info_data_t[TASK_INFO_MAX];
+
+/*
+ *	Currently defined information structures.
+ */
+
+#pragma pack(4)
+
+#define TASK_BASIC_INFO_32      4       /* basic information */
+#define TASK_BASIC2_INFO_32      6
+
+struct task_basic_info_32 {
+        integer_t       suspend_count;  /* suspend count for task */
+        natural_t       virtual_size;   /* virtual memory size (bytes) */
+        natural_t       resident_size;  /* resident memory size (bytes) */
+        time_value_t    user_time;      /* total user run time for
+                                           terminated threads */
+        time_value_t    system_time;    /* total system run time for
+                                           terminated threads */
+	policy_t	policy;		/* default policy for new threads */
+};
+typedef struct task_basic_info_32       task_basic_info_32_data_t;
+typedef struct task_basic_info_32       *task_basic_info_32_t;
+#define TASK_BASIC_INFO_32_COUNT   \
+                (sizeof(task_basic_info_32_data_t) / sizeof(natural_t))
+
+
+#define TASK_BASIC_INFO_64      5       /* 64-bit capable basic info */
+
+struct task_basic_info_64 {
+        integer_t       suspend_count;  /* suspend count for task */
+        mach_vm_size_t  virtual_size;   /* virtual memory size (bytes) */
+        mach_vm_size_t  resident_size;  /* resident memory size (bytes) */
+        time_value_t    user_time;      /* total user run time for
+                                           terminated threads */
+        time_value_t    system_time;    /* total system run time for
+                                           terminated threads */
+	policy_t	policy;		/* default policy for new threads */
+};
+typedef struct task_basic_info_64       task_basic_info_64_data_t;
+typedef struct task_basic_info_64       *task_basic_info_64_t;
+#define TASK_BASIC_INFO_64_COUNT   \
+                (sizeof(task_basic_info_64_data_t) / sizeof(natural_t))
+
+
+/* localized structure - cannot be safely passed between tasks of differing sizes */
+
+struct task_basic_info {
+        integer_t       suspend_count;  /* suspend count for task */
+        vm_size_t       virtual_size;   /* virtual memory size (bytes) */
+        vm_size_t       resident_size;  /* resident memory size (bytes) */
+        time_value_t    user_time;      /* total user run time for
+                                           terminated threads */
+        time_value_t    system_time;    /* total system run time for
+                                           terminated threads */
+	policy_t	policy;		/* default policy for new threads */
+};
+
+typedef struct task_basic_info          task_basic_info_data_t;
+typedef struct task_basic_info          *task_basic_info_t;
+#define TASK_BASIC_INFO_COUNT   \
+                (sizeof(task_basic_info_data_t) / sizeof(natural_t))
+#if !defined(__LP64__)
+#define TASK_BASIC_INFO TASK_BASIC_INFO_32
+#else
+#define TASK_BASIC_INFO TASK_BASIC_INFO_64
+#endif
+
+
+
+#define	TASK_EVENTS_INFO	2	/* various event counts */
+
+struct task_events_info {
+	integer_t	faults;		/* number of page faults */
+	integer_t 	pageins;	/* number of actual pageins */
+	integer_t 	cow_faults;	/* number of copy-on-write faults */
+	integer_t 	messages_sent;	/* number of messages sent */
+	integer_t 	messages_received; /* number of messages received */
+        integer_t 	syscalls_mach;  /* number of mach system calls */
+	integer_t 	syscalls_unix;  /* number of unix system calls */
+	integer_t 	csw;            /* number of context switches */
+};
+typedef struct task_events_info		task_events_info_data_t;
+typedef struct task_events_info		*task_events_info_t;
+#define	TASK_EVENTS_INFO_COUNT		((mach_msg_type_number_t) \
+		(sizeof(task_events_info_data_t) / sizeof(natural_t)))
+
+#define	TASK_THREAD_TIMES_INFO	3	/* total times for live threads -
+					   only accurate if suspended */
+
+struct task_thread_times_info {
+	time_value_t	user_time;	/* total user run time for
+					   live threads */
+	time_value_t	system_time;	/* total system run time for
+					   live threads */
+};
+
+typedef struct task_thread_times_info	task_thread_times_info_data_t;
+typedef struct task_thread_times_info	*task_thread_times_info_t;
+#define	TASK_THREAD_TIMES_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof(task_thread_times_info_data_t) / sizeof(natural_t)))
+
+#define TASK_ABSOLUTETIME_INFO	1
+
+struct task_absolutetime_info {
+	uint64_t		total_user;		/* total time */
+	uint64_t		total_system;
+	uint64_t		threads_user;	/* existing threads only */
+	uint64_t		threads_system;
+};
+
+typedef struct task_absolutetime_info	task_absolutetime_info_data_t;
+typedef struct task_absolutetime_info	*task_absolutetime_info_t;
+#define TASK_ABSOLUTETIME_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof (task_absolutetime_info_data_t) / sizeof (natural_t)))
+
+#define TASK_KERNELMEMORY_INFO	7
+
+struct task_kernelmemory_info {
+	uint64_t		total_palloc;	/* private kernel mem alloc'ed */
+	uint64_t		total_pfree;	/* private kernel mem freed */
+	uint64_t		total_salloc;	/* shared kernel mem alloc'ed */
+	uint64_t		total_sfree;	/* shared kernel mem freed */
+};
+
+typedef struct task_kernelmemory_info	task_kernelmemory_info_data_t;
+typedef struct task_kernelmemory_info	*task_kernelmemory_info_t;
+#define TASK_KERNELMEMORY_INFO_COUNT	((mach_msg_type_number_t) \
+		(sizeof (task_kernelmemory_info_data_t) / sizeof (natural_t)))
+
+#define TASK_SECURITY_TOKEN		13
+#define TASK_SECURITY_TOKEN_COUNT	((mach_msg_type_number_t) \
+		(sizeof(security_token_t) / sizeof(natural_t)))
+
+#define TASK_AUDIT_TOKEN		15
+#define TASK_AUDIT_TOKEN_COUNT	\
+		(sizeof(audit_token_t) / sizeof(natural_t))
+
+
+#define TASK_AFFINITY_TAG_INFO		16 	/* This is experimental. */
+
+struct task_affinity_tag_info {
+	integer_t		set_count;
+	integer_t		min;
+	integer_t		max;
+	integer_t		task_count;
+};
+typedef struct task_affinity_tag_info	task_affinity_tag_info_data_t;
+typedef struct task_affinity_tag_info	*task_affinity_tag_info_t;
+#define TASK_AFFINITY_TAG_INFO_COUNT	\
+		(sizeof(task_affinity_tag_info_data_t) / sizeof(natural_t))
+
+#define TASK_DYLD_INFO			17
+
+struct task_dyld_info {
+	mach_vm_address_t	all_image_info_addr;
+	mach_vm_size_t		all_image_info_size;
+	integer_t		all_image_info_format;		
+};
+typedef struct task_dyld_info	task_dyld_info_data_t;
+typedef struct task_dyld_info	*task_dyld_info_t;
+#define TASK_DYLD_INFO_COUNT	\
+    		(sizeof(task_dyld_info_data_t) / sizeof(natural_t))
+#define TASK_DYLD_ALL_IMAGE_INFO_32	0	/* format value */
+#define TASK_DYLD_ALL_IMAGE_INFO_64	1	/* format value */
+
+#define TASK_EXTMOD_INFO			18
+
+struct task_extmod_info {
+	unsigned char	task_uuid[16];
+	vm_extmod_statistics_data_t		extmod_statistics;
+};
+typedef struct task_extmod_info	task_extmod_info_data_t;
+typedef struct task_extmod_info	*task_extmod_info_t;
+#define TASK_EXTMOD_INFO_COUNT	\
+    		(sizeof(task_extmod_info_data_t) / sizeof(natural_t))
+
+#pragma pack()
+
+
+/*
+ * Obsolete interfaces.
+ */
+
+#define TASK_SCHED_TIMESHARE_INFO	10
+#define TASK_SCHED_RR_INFO		11
+#define TASK_SCHED_FIFO_INFO		12
+
+#define TASK_SCHED_INFO			14
+
+#endif	/* _MACH_TASK_INFO_H_ */
diff -urN cctools-806-old/include/mach/task_ledger.h cctools-806/include/mach/task_ledger.h
--- cctools-806-old/include/mach/task_ledger.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/task_ledger.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,51 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+
+#ifndef _MACH_TASK_LEDGER_H_
+#define _MACH_TASK_LEDGER_H_
+
+/*
+ * Evolving and likely to change.
+ */
+
+/*
+ * Definitions for task ledger line items
+ */
+#define ITEM_THREADS		0	/* number of threads	*/
+#define ITEM_TASKS		1	/* number of tasks	*/
+
+#define ITEM_VM	   		2	/* virtual space (bytes)*/
+
+#define LEDGER_N_ITEMS		3	/* Total line items	*/
+
+#define LEDGER_UNLIMITED	0	/* ignored item.maximum	*/
+
+#endif  /* _MACH_TASK_LEDGER_H_ */
diff -urN cctools-806-old/include/mach/task_policy.h cctools-806/include/mach/task_policy.h
--- cctools-806-old/include/mach/task_policy.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/task_policy.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,130 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_TASK_POLICY_H_
+#define _MACH_TASK_POLICY_H_
+
+#include <mach/mach_types.h>
+
+/*
+ * These are the calls for accessing the policy parameters
+ * of a particular task.
+ *
+ * The extra 'get_default' parameter to the second call is
+ * IN/OUT as follows:
+ * 1) if asserted on the way in it indicates that the default
+ * values should be returned, not the ones currently set, in
+ * this case 'get_default' will always be asserted on return;
+ * 2) if unasserted on the way in, the current settings are
+ * desired and if still unasserted on return, then the info
+ * returned reflects the current settings, otherwise if
+ * 'get_default' returns asserted, it means that there are no
+ * current settings due to other parameters taking precedence,
+ * and the default ones are being returned instead.
+ */
+
+typedef natural_t	task_policy_flavor_t;
+typedef integer_t	*task_policy_t;
+
+/*
+kern_return_t	task_policy_set(
+					task_t					task,
+					task_policy_flavor_t	flavor,
+					task_policy_t			policy_info,
+					mach_msg_type_number_t	count);
+
+kern_return_t	task_policy_get(
+					task_t					task,
+					task_policy_flavor_t	flavor,
+					task_policy_t			policy_info,
+					mach_msg_type_number_t	*count,
+					boolean_t				*get_default);
+*/
+
+/*
+ * Defined flavors.
+ */
+/*
+ * TASK_CATEGORY_POLICY:
+ *
+ * This provides information to the kernel about the role
+ * of the task in the system.
+ *
+ * Parameters:
+ *
+ * role: Enumerated as follows:
+ *
+ * TASK_UNSPECIFIED is the default, since the role is not
+ * inherited from the parent.
+ *
+ * TASK_FOREGROUND_APPLICATION should be assigned when the
+ * task is a normal UI application in the foreground from
+ * the HI point of view.
+ * **N.B. There may be more than one of these at a given time.
+ *
+ * TASK_BACKGROUND_APPLICATION should be assigned when the
+ * task is a normal UI application in the background from
+ * the HI point of view.
+ *
+ * TASK_CONTROL_APPLICATION should be assigned to the unique
+ * UI application which implements the pop-up application dialog.
+ * There can only be one task at a time with this designation,
+ * which is assigned FCFS.
+ *
+ * TASK_GRAPHICS_SERVER should be assigned to the graphics
+ * management (window) server.  There can only be one task at
+ * a time with this designation, which is assigned FCFS.
+ */
+
+#define TASK_CATEGORY_POLICY		1
+
+enum task_role {
+	TASK_RENICED = -1,
+	TASK_UNSPECIFIED = 0,
+	TASK_FOREGROUND_APPLICATION,
+	TASK_BACKGROUND_APPLICATION,
+	TASK_CONTROL_APPLICATION,
+	TASK_GRAPHICS_SERVER,
+	TASK_THROTTLE_APPLICATION,
+	TASK_NONUI_APPLICATION,
+	TASK_DEFAULT_APPLICATION
+};
+
+typedef enum task_role		task_role_t;
+
+struct task_category_policy {
+	task_role_t		role;
+};
+
+typedef struct task_category_policy		task_category_policy_data_t;
+typedef struct task_category_policy		*task_category_policy_t;
+
+#define TASK_CATEGORY_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (task_category_policy_data_t) / sizeof (integer_t)))
+
+#endif	/* _MACH_TASK_POLICY_H_ */
diff -urN cctools-806-old/include/mach/task_special_ports.h cctools-806/include/mach/task_special_ports.h
--- cctools-806-old/include/mach/task_special_ports.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/task_special_ports.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,141 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/task_special_ports.h
+ *
+ *	Defines codes for special_purpose task ports.  These are NOT
+ *	port identifiers - they are only used for the task_get_special_port
+ *	and task_set_special_port routines.
+ *	
+ */
+
+#ifndef	_MACH_TASK_SPECIAL_PORTS_H_
+#define _MACH_TASK_SPECIAL_PORTS_H_
+
+typedef	int	task_special_port_t;
+
+#define TASK_KERNEL_PORT	1	/* Represents task to the outside
+					   world.*/
+
+#define TASK_HOST_PORT		2	/* The host (priv) port for task.  */
+
+#define TASK_NAME_PORT		3	/* the name (unpriv) port for task */
+
+#define TASK_BOOTSTRAP_PORT	4	/* Bootstrap environment for task. */
+
+/*
+ * Evolving and likely to change.
+ */
+
+#define TASK_WIRED_LEDGER_PORT	5	/* Wired resource ledger for task. */
+
+#define TASK_PAGED_LEDGER_PORT	6	/* Paged resource ledger for task. */
+
+#define TASK_SEATBELT_PORT	7	/* Seatbelt compiler/DEM port for task. */
+
+#define TASK_GSSD_PORT		8	/* GSSD port for security context */
+
+#define TASK_ACCESS_PORT	9	/* Permission check for task_for_pid. */
+
+#define task_get_wired_ledger_port(task, port)	\
+		(task_get_special_port((task), TASK_WIRED_LEDGER_PORT, (port)))
+
+#define task_set_wired_ledger_port(task, port)	\
+		(task_set_special_port((task), TASK_WIRED_LEDGER_PORT, (port)))
+
+#define task_get_paged_ledger_port(task, port)	\
+		(task_get_special_port((task), TASK_PAGED_LEDGER_PORT, (port)))
+
+#define task_set_paged_ledger_port(task, port)	\
+		(task_set_special_port((task), TASK_PAGED_LEDGER_PORT, (port)))
+
+/*
+ *	Definitions for ease of use
+ */
+
+#define task_get_kernel_port(task, port)	\
+		(task_get_special_port((task), TASK_KERNEL_PORT, (port)))
+
+#define task_set_kernel_port(task, port)	\
+		(task_set_special_port((task), TASK_KERNEL_PORT, (port)))
+
+#define task_get_host_port(task, port)		\
+		(task_get_special_port((task), TASK_HOST_PORT, (port)))
+
+#define task_set_host_port(task, port)	\
+		(task_set_special_port((task), TASK_HOST_PORT, (port)))
+
+#define task_get_bootstrap_port(task, port)	\
+		(task_get_special_port((task), TASK_BOOTSTRAP_PORT, (port)))
+
+#define task_set_bootstrap_port(task, port)	\
+		(task_set_special_port((task), TASK_BOOTSTRAP_PORT, (port)))
+
+#define task_get_gssd_port(task, port)	\
+		(task_get_special_port((task), TASK_GSSD_PORT, (port)))
+
+#define task_set_gssd_port(task, port)	\
+		(task_set_special_port((task), TASK_GSSD_PORT, (port)))
+
+#define task_get_task_access_port(task, port)	\
+		(task_get_special_port((task), TASK_ACCESS_PORT, (port)))
+
+#define task_set_task_access_port(task, port)	\
+		(task_set_special_port((task), TASK_ACCESS_PORT, (port)))
+
+#endif	/* _MACH_TASK_SPECIAL_PORTS_H_ */
diff -urN cctools-806-old/include/mach/thread_act.defs cctools-806/include/mach/thread_act.defs
--- cctools-806-old/include/mach/thread_act.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/thread_act.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,333 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/mach_port.defs
+ *	Author:	Rich Draves
+ *
+ *	Exported kernel calls.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  thread_act 3600;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+
+/*
+ *	Destroy the target thread.
+ *
+ *	JMM - For legacy reasons this consumes a reference to the
+ *	target thread.  This will have to change in the future because
+ *	we want the interfaces to be able to be defined in more standard
+ *	IDLs and transports, and most of them do not support the notion
+ *	of reference ownership transfers (just sharing).
+ */
+routine thread_terminate(
+		target_act	: thread_act_consume_ref_t); 
+
+
+/*
+ *	Return the selected state information for the target
+ *	thr_act.  If the thr_act is currently executing, the results
+ *	may be stale.  [Flavor THREAD_STATE_FLAVOR_LIST provides a
+ *	list of valid flavors for the target thread.]
+ */
+routine act_get_state(
+		target_act	: thread_act_t;
+		flavor		: int;
+	out	old_state	: thread_state_t, CountInOut);
+
+/*
+ *	Set the selected state information for the target thread.
+ *	If the thread is currently executing, the state change
+ *	may be ill-defined.
+ */
+routine
+#ifdef KERNEL_SERVER
+act_set_state_from_user(
+#else
+act_set_state(
+#endif
+		target_act	: thread_act_t;
+		flavor		: int;
+		new_state	: thread_state_t);
+
+/*
+ * Backward compatible old-style thread routines.
+ * These have different semantics than the new activation versions.
+ *
+ *	Return the selected state information for the target
+ *	thread.  If the thread is currently executing, the results
+ *	may be stale.  [Flavor THREAD_STATE_FLAVOR_LIST provides a
+ *	list of valid flavors for the target thr_act.]
+ */
+routine thread_get_state(
+		target_act	: thread_act_t;
+		flavor		: thread_state_flavor_t;
+	out	old_state	: thread_state_t, CountInOut);
+
+/*
+ *	Set the selected state information for the target thread.
+ *	If the thread is currently executing, the state change
+ *	may be ill-defined.
+ */
+routine
+#ifdef KERNEL_SERVER
+thread_set_state_from_user(
+#else
+thread_set_state(
+#endif
+		target_act	: thread_act_t;
+		flavor		: thread_state_flavor_t;
+		new_state	: thread_state_t);
+
+/*
+ *	Increment the suspend count for the target thread.
+ *	Once this call has completed, the thread will not
+ *	execute any further user or meta- instructions.
+ *	Once suspended, a thread may not execute again until
+ *	its suspend count is zero, and the suspend count
+ *	for its task is also zero.
+ */
+routine	thread_suspend(
+		target_act	: thread_act_t);
+
+/*
+ *	Decrement the suspend count for the target thread,
+ *	if that count is not already zero.
+ */
+routine	thread_resume(
+		target_act	: thread_act_t);
+
+/*
+ *	Cause any user or meta- instructions currently being
+ *	executed by the target thread to be aborted.  [Meta-
+ *	instructions consist of the basic traps for IPC
+ *	(e.g., msg_send, msg_receive) and self-identification
+ *	(e.g., task_self, thread_self, thread_reply).  Calls
+ *	described by MiG interfaces are not meta-instructions
+ *	themselves.]
+ */
+routine thread_abort(
+		target_act	: thread_act_t);
+
+/*
+ *	Cause any user or meta- instructions currently being
+ *	executed by the target thread to be aborted so that
+ *	they are transparently restartable.  This call fails
+ *	if the abort would result in a non-restartable condition.
+ *	Retry is the caller's responsibility.  [Meta-
+ *	instructions consist of the basic traps for IPC
+ *	(e.g., msg_send, msg_receive) and self-identification
+ *	(e.g., task_self, thread_self, thread_reply).  Calls
+ *	described by MiG interfaces are not meta-instructions
+ *	themselves.]
+ */
+routine thread_abort_safely(
+		target_act	: thread_act_t);
+
+
+routine thread_depress_abort(
+		thread		: thread_act_t);
+
+
+/*
+ *	Returns the current value of the selected special port
+ *	associated with the target thread.
+ */
+routine thread_get_special_port(
+		thr_act		: thread_act_t;
+		which_port	: int;
+	out	special_port	: mach_port_t);
+
+/*
+ *	Set one of the special ports associated with the
+ *	target thread.
+ */
+routine thread_set_special_port(
+		thr_act		: thread_act_t;
+		which_port	: int;
+		special_port	: mach_port_t);
+
+/*
+ *      Returns information about the target thread.
+ */
+routine thread_info(
+                target_act      : thread_act_t;
+                flavor          : thread_flavor_t;
+        out     thread_info_out : thread_info_t, CountInOut);
+
+/*
+ * Set an exception handler for a thread on one or more exception types
+ */
+routine		thread_set_exception_ports(
+			thread		: thread_act_t;
+			exception_mask	: exception_mask_t;
+			new_port	: mach_port_t;
+			behavior	: exception_behavior_t;
+			new_flavor	: thread_state_flavor_t);
+
+/*
+ * Lookup some of the old exception handlers for a thread
+ */
+routine		thread_get_exception_ports(
+			thread		: thread_act_t;
+			exception_mask	: exception_mask_t;
+		  out	masks		: exception_mask_array_t;
+		  out	old_handlers	: exception_handler_array_t, SameCount;
+		  out	old_behaviors	: exception_behavior_array_t, SameCount;
+		  out	old_flavors	: exception_flavor_array_t, SameCount);
+
+/*
+ * Set an exception handler for a thread on one or more exception types.
+ * At the same time, return the previously defined exception handlers for
+ * those types.
+ */
+routine		thread_swap_exception_ports(
+			thread		: thread_act_t;
+			exception_mask	: exception_mask_t;
+			new_port	: mach_port_t;
+			behavior	: exception_behavior_t;
+			new_flavor	: thread_state_flavor_t;
+		  out	masks		: exception_mask_array_t;
+		  out	old_handlers	: exception_handler_array_t, SameCount;
+		  out	old_behaviors	: exception_behavior_array_t, SameCount;
+		  out	old_flavors	: exception_flavor_array_t, SameCount);
+
+/*
+ * OBSOLETE interface.
+ */
+routine thread_policy(
+	thr_act			: thread_act_t;
+	policy			: policy_t;
+	base			: policy_base_t;
+	set_limit		: boolean_t);
+
+/*
+ * Set/get policy information for a thread.
+ * (Approved Mac OS X microkernel interface)
+ */
+
+routine thread_policy_set(
+	thread			: thread_act_t;
+	flavor			: thread_policy_flavor_t;
+	policy_info		: thread_policy_t);
+
+routine thread_policy_get(
+	thread			: thread_act_t;
+	flavor			: thread_policy_flavor_t;
+out	policy_info		: thread_policy_t, CountInOut;
+inout	get_default		: boolean_t);
+
+/*
+ *	Removed from the kernel.
+ */
+#if KERNEL_SERVER
+skip;
+#else
+routine thread_sample(
+		thread		: thread_act_t;
+		reply		: mach_port_make_send_t);
+#endif
+
+/*
+ *	ETAP has been removed from the kernel.
+ */
+#if KERNEL_SERVER
+skip;
+#else
+routine	etap_trace_thread(
+		target_act	: thread_act_t;
+		trace_status	: boolean_t);
+#endif
+
+/*
+ *	Assign thread to processor set.
+ */
+routine	thread_assign(
+		thread		: thread_act_t;
+		new_set		: processor_set_t);
+
+/*
+ *	Assign thread to default set.
+ */
+routine thread_assign_default(
+		thread		: thread_act_t);
+
+/*
+ *	Get current assignment for thread.
+ */
+routine thread_get_assignment(
+		thread		: thread_act_t;
+	out	assigned_set	: processor_set_name_t);
+
+
+/*
+ * OBSOLETE interface.
+ */
+routine thread_set_policy(
+	thr_act			: thread_act_t;
+	pset			: processor_set_t;
+	policy			: policy_t;
+	base			: policy_base_t;
+	limit			: policy_limit_t);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/thread_act.h cctools-806/include/mach/thread_act.h
--- cctools-806-old/include/mach/thread_act.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/thread_act.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,36 @@
+/*
+ * Copyright (c) 2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+#if defined(__i386__)
+#include <mach/i386/thread_act.h>
+#elif defined(__x86_64__)
+#include <mach/x86_64/thread_act.h>
+#elif defined(__arm__)
+#include <mach/arm/thread_act.h>
+#else
+#error unknown architecture
+#endif 
diff -urN cctools-806-old/include/mach/thread_info.h cctools-806/include/mach/thread_info.h
--- cctools-806-old/include/mach/thread_info.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/thread_info.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,154 @@
+/*
+ * Copyright (c) 2000-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/thread_info
+ *
+ *	Thread information structure and definitions.
+ *
+ *	The defintions in this file are exported to the user.  The kernel
+ *	will translate its internal data structures to these structures
+ *	as appropriate.
+ *
+ */
+
+#ifndef	_MACH_THREAD_INFO_H_
+#define _MACH_THREAD_INFO_H_
+
+#include <mach/boolean.h>
+#include <mach/policy.h>
+#include <mach/time_value.h>
+#include <mach/message.h>
+#include <mach/machine/vm_types.h>
+
+/*
+ *	Generic information structure to allow for expansion.
+ */
+typedef	natural_t	thread_flavor_t;
+typedef	integer_t	*thread_info_t;		/* varying array of int */
+
+#define THREAD_INFO_MAX		(1024)	/* maximum array size */
+typedef	integer_t	thread_info_data_t[THREAD_INFO_MAX];
+
+/*
+ *	Currently defined information.
+ */
+#define THREAD_BASIC_INFO         	3     /* basic information */
+
+struct thread_basic_info {
+        time_value_t    user_time;      /* user run time */
+        time_value_t    system_time;    /* system run time */
+        integer_t       cpu_usage;      /* scaled cpu usage percentage */
+	policy_t	policy;		/* scheduling policy in effect */
+        integer_t       run_state;      /* run state (see below) */
+        integer_t       flags;          /* various flags (see below) */
+        integer_t       suspend_count;  /* suspend count for thread */
+        integer_t       sleep_time;     /* number of seconds that thread
+                                           has been sleeping */
+};
+
+typedef struct thread_basic_info  thread_basic_info_data_t;
+typedef struct thread_basic_info  *thread_basic_info_t;
+#define THREAD_BASIC_INFO_COUNT   ((mach_msg_type_number_t) \
+                (sizeof(thread_basic_info_data_t) / sizeof(natural_t)))
+
+#define THREAD_IDENTIFIER_INFO		4     /* thread id and other information */
+
+struct thread_identifier_info {
+	uint64_t	thread_id;	/* system-wide unique 64-bit thread id */
+	uint64_t	thread_handle;	/* handle to be used by libproc */
+	uint64_t	dispatch_qaddr;	/* libdispatch queue address */
+};
+
+typedef struct thread_identifier_info  thread_identifier_info_data_t;
+typedef struct thread_identifier_info  *thread_identifier_info_t;
+#define THREAD_IDENTIFIER_INFO_COUNT   ((mach_msg_type_number_t) \
+                (sizeof(thread_identifier_info_data_t) / sizeof(natural_t)))
+
+/*
+ *	Scale factor for usage field.
+ */
+
+#define TH_USAGE_SCALE	1000
+
+/*
+ *	Thread run states (state field).
+ */
+
+#define TH_STATE_RUNNING	1	/* thread is running normally */
+#define TH_STATE_STOPPED	2	/* thread is stopped */
+#define TH_STATE_WAITING	3	/* thread is waiting normally */
+#define TH_STATE_UNINTERRUPTIBLE 4	/* thread is in an uninterruptible
+					   wait */
+#define TH_STATE_HALTED		5	/* thread is halted at a
+					   clean point */
+
+/*
+ *	Thread flags (flags field).
+ */
+#define TH_FLAGS_SWAPPED	0x1	/* thread is swapped out */
+#define TH_FLAGS_IDLE		0x2	/* thread is an idle thread */
+
+/*
+ * Obsolete interfaces.
+ */
+
+#define THREAD_SCHED_TIMESHARE_INFO	10
+#define THREAD_SCHED_RR_INFO		11
+#define THREAD_SCHED_FIFO_INFO		12
+
+#endif	/* _MACH_THREAD_INFO_H_ */
diff -urN cctools-806-old/include/mach/thread_policy.h cctools-806/include/mach/thread_policy.h
--- cctools-806-old/include/mach/thread_policy.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/thread_policy.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,234 @@
+/*
+ * Copyright (c) 2000-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MACH_THREAD_POLICY_H_
+#define _MACH_THREAD_POLICY_H_
+
+#include <mach/mach_types.h>
+
+/*
+ * These are the calls for accessing the policy parameters
+ * of a particular thread.
+ *
+ * The extra 'get_default' parameter to the second call is
+ * IN/OUT as follows:
+ * 1) if asserted on the way in it indicates that the default
+ * values should be returned, not the ones currently set, in
+ * this case 'get_default' will always be asserted on return;
+ * 2) if unasserted on the way in, the current settings are
+ * desired and if still unasserted on return, then the info
+ * returned reflects the current settings, otherwise if
+ * 'get_default' returns asserted, it means that there are no
+ * current settings due to other parameters taking precedence,
+ * and the default ones are being returned instead.
+ */
+
+typedef natural_t	thread_policy_flavor_t;
+typedef integer_t	*thread_policy_t;
+
+/*
+kern_return_t	thread_policy_set(
+					thread_t					thread,
+					thread_policy_flavor_t		flavor,
+					thread_policy_t				policy_info,
+					mach_msg_type_number_t		count);
+
+kern_return_t	thread_policy_get(
+					thread_t					thread,
+					thread_policy_flavor_t		flavor,
+					thread_policy_t				policy_info,
+					mach_msg_type_number_t		*count,
+					boolean_t					*get_default);
+*/
+
+/*
+ * Defined flavors.
+ */
+/*
+ * THREAD_STANDARD_POLICY:
+ *
+ * This is the standard (fair) scheduling mode, assigned to new
+ * threads.  The thread will be given processor time in a manner
+ * which apportions approximately equal share to long running
+ * computations.
+ *
+ * Parameters:
+ *	[none]
+ */
+
+#define THREAD_STANDARD_POLICY			1
+
+struct thread_standard_policy {
+	natural_t		no_data;
+};
+
+typedef struct thread_standard_policy	thread_standard_policy_data_t;
+typedef struct thread_standard_policy	*thread_standard_policy_t;
+
+#define THREAD_STANDARD_POLICY_COUNT	0
+
+/*
+ * THREAD_EXTENDED_POLICY:
+ *
+ * Extended form of THREAD_STANDARD_POLICY, which supplies a
+ * hint indicating whether this is a long running computation.
+ *
+ * Parameters:
+ *
+ * timeshare: TRUE (the default) results in identical scheduling
+ * behavior as THREAD_STANDARD_POLICY.
+ */
+
+#define THREAD_EXTENDED_POLICY			1
+
+struct thread_extended_policy {
+	boolean_t		timeshare;
+};
+
+typedef struct thread_extended_policy	thread_extended_policy_data_t;
+typedef struct thread_extended_policy	*thread_extended_policy_t;
+
+#define THREAD_EXTENDED_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (thread_extended_policy_data_t) / sizeof (integer_t)))
+
+/*
+ * THREAD_TIME_CONSTRAINT_POLICY:
+ *
+ * This scheduling mode is for threads which have real time
+ * constraints on their execution.
+ *
+ * Parameters:
+ *
+ * period: This is the nominal amount of time between separate
+ * processing arrivals, specified in absolute time units.  A
+ * value of 0 indicates that there is no inherent periodicity in
+ * the computation.
+ *
+ * computation: This is the nominal amount of computation
+ * time needed during a separate processing arrival, specified
+ * in absolute time units.
+ *
+ * constraint: This is the maximum amount of real time that
+ * may elapse from the start of a separate processing arrival
+ * to the end of computation for logically correct functioning,
+ * specified in absolute time units.  Must be (>= computation).
+ * Note that latency = (constraint - computation).
+ *
+ * preemptible: This indicates that the computation may be
+ * interrupted, subject to the constraint specified above.
+ */
+
+#define THREAD_TIME_CONSTRAINT_POLICY	2
+
+struct thread_time_constraint_policy {
+	uint32_t		period;
+	uint32_t		computation;
+	uint32_t		constraint;
+	boolean_t		preemptible;
+};
+
+typedef struct thread_time_constraint_policy	\
+									thread_time_constraint_policy_data_t;
+typedef struct thread_time_constraint_policy	\
+									*thread_time_constraint_policy_t;
+
+#define THREAD_TIME_CONSTRAINT_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (thread_time_constraint_policy_data_t) / sizeof (integer_t)))
+
+/*
+ * THREAD_PRECEDENCE_POLICY:
+ *
+ * This may be used to indicate the relative value of the
+ * computation compared to the other threads in the task.
+ *
+ * Parameters:
+ *
+ * importance: The importance is specified as a signed value.
+ */
+
+#define THREAD_PRECEDENCE_POLICY		3
+
+struct thread_precedence_policy {
+	integer_t		importance;
+};
+
+typedef struct thread_precedence_policy		thread_precedence_policy_data_t;
+typedef struct thread_precedence_policy		*thread_precedence_policy_t;
+
+#define THREAD_PRECEDENCE_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (thread_precedence_policy_data_t) / sizeof (integer_t)))
+
+/*
+ * THREAD_AFFINITY_POLICY:
+ *
+ * This policy is experimental.
+ * This may be used to express affinity relationships 
+ * between threads in the task. Threads with the same affinity tag will
+ * be scheduled to share an L2 cache if possible. That is, affinity tags
+ * are a hint to the scheduler for thread placement. 
+ *
+ * The namespace of affinity tags is generally local to one task. However,
+ * a child task created after the assignment of affinity tags by its parent
+ * will share that namespace. In particular, a family of forked processes
+ * may be created with a shared affinity namespace.
+ *
+ * Parameters:
+ * tag: The affinity set identifier.
+ */
+
+#define THREAD_AFFINITY_POLICY		4
+
+struct thread_affinity_policy {
+	integer_t	affinity_tag;
+};
+
+#define THREAD_AFFINITY_TAG_NULL		0
+
+typedef struct thread_affinity_policy		thread_affinity_policy_data_t;
+typedef struct thread_affinity_policy		*thread_affinity_policy_t;
+
+#define THREAD_AFFINITY_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (thread_affinity_policy_data_t) / sizeof (integer_t)))
+
+/*
+ * THREAD_BACKGROUND_POLICY:
+ */
+
+#define THREAD_BACKGROUND_POLICY	5
+
+struct thread_background_policy {
+	integer_t	priority;
+};
+
+typedef struct thread_background_policy		thread_background_policy_data_t;
+typedef struct thread_background_policy 	*thread_background_policy_t;
+
+#define THREAD_BACKGROUND_POLICY_COUNT	((mach_msg_type_number_t) \
+	(sizeof (thread_background_policy_data_t) / sizeof (integer_t)))
+
+#endif	/* _MACH_THREAD_POLICY_H_ */
diff -urN cctools-806-old/include/mach/thread_special_ports.h cctools-806/include/mach/thread_special_ports.h
--- cctools-806-old/include/mach/thread_special_ports.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/thread_special_ports.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,83 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/thread_special_ports.h
+ *
+ *	Defines codes for special_purpose thread ports.  These are NOT
+ *	port identifiers - they are only used for the thread_get_special_port
+ *	and thread_set_special_port routines.
+ *	
+ */
+
+#ifndef	_MACH_THREAD_SPECIAL_PORTS_H_
+#define _MACH_THREAD_SPECIAL_PORTS_H_
+
+#define THREAD_KERNEL_PORT	1	/* Represents the thread to the outside
+					   world.*/
+
+/*
+ *	Definitions for ease of use
+ */
+
+#define thread_get_kernel_port(thread, port)	\
+		(thread_get_special_port((thread), THREAD_KERNEL_PORT, (port)))
+
+#define thread_set_kernel_port(thread, port)	\
+		(thread_set_special_port((thread), THREAD_KERNEL_PORT, (port)))
+
+#endif	/* _MACH_THREAD_SPECIAL_PORTS_H_ */
diff -urN cctools-806-old/include/mach/thread_status.h cctools-806/include/mach/thread_status.h
--- cctools-806-old/include/mach/thread_status.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/thread_status.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,94 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/thread_status.h
+ *	Author:	Avadis Tevanian, Jr.
+ *
+ *	This file contains the structure definitions for the user-visible
+ *	thread state.  This thread state is examined with the thread_get_state
+ *	kernel call and may be changed with the thread_set_state kernel call.
+ *
+ */
+
+#ifndef	_MACH_THREAD_STATUS_H_
+#define	_MACH_THREAD_STATUS_H_
+
+/*
+ *	The actual structure that comprises the thread state is defined
+ *	in the machine dependent module.
+ */
+#include <mach/machine/vm_types.h>
+#include <mach/machine/thread_status.h>
+#include <mach/machine/thread_state.h>
+
+/*
+ *	Generic definition for machine-dependent thread status.
+ */
+
+typedef	natural_t	*thread_state_t;	/* Variable-length array */
+
+/* THREAD_STATE_MAX is now defined in <mach/machine/thread_state.h> */
+typedef	natural_t	thread_state_data_t[THREAD_STATE_MAX];
+
+#define	THREAD_STATE_FLAVOR_LIST	0	/* List of valid flavors */
+#define THREAD_STATE_FLAVOR_LIST_NEW	128
+
+typedef	int			thread_state_flavor_t;
+typedef thread_state_flavor_t	*thread_state_flavor_array_t;
+
+#endif	/* _MACH_THREAD_STATUS_H_ */
diff -urN cctools-806-old/include/mach/thread_switch.h cctools-806/include/mach/thread_switch.h
--- cctools-806-old/include/mach/thread_switch.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/thread_switch.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,77 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+
+#ifndef	_MACH_THREAD_SWITCH_H_
+#define	_MACH_THREAD_SWITCH_H_
+
+#include <mach/mach_types.h>
+#include <mach/kern_return.h>
+#include <mach/message.h>
+#include <mach/mach_traps.h>
+
+/*
+ *	Constant definitions for thread_switch trap.
+ */
+
+#define	SWITCH_OPTION_NONE			0
+#define SWITCH_OPTION_DEPRESS		1
+#define SWITCH_OPTION_WAIT			2
+
+#define valid_switch_option(opt)	(0 <= (opt) && (opt) <= 2)
+
+#endif	/* _MACH_THREAD_SWITCH_H_ */
diff -urN cctools-806-old/include/mach/time_value.h cctools-806/include/mach/time_value.h
--- cctools-806-old/include/mach/time_value.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/time_value.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,96 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+
+#ifndef	_MACH_TIME_VALUE_H_
+#define	_MACH_TIME_VALUE_H_
+
+#include <mach/machine/vm_types.h>
+
+/*
+ *	Time value returned by kernel.
+ */
+
+struct time_value {
+	integer_t seconds;
+	integer_t microseconds;
+};
+
+typedef	struct time_value	time_value_t;
+
+/*
+ *	Macros to manipulate time values.  Assume that time values
+ *	are normalized (microseconds <= 999999).
+ */
+#define	TIME_MICROS_MAX	(1000000)
+
+#define	time_value_add_usec(val, micros)	{	\
+	if (((val)->microseconds += (micros))		\
+		>= TIME_MICROS_MAX) {			\
+	    (val)->microseconds -= TIME_MICROS_MAX;	\
+	    (val)->seconds++;				\
+	}						\
+}
+
+#define	time_value_add(result, addend)		{		\
+	(result)->microseconds += (addend)->microseconds;	\
+	(result)->seconds += (addend)->seconds;			\
+	if ((result)->microseconds >= TIME_MICROS_MAX) {	\
+	    (result)->microseconds -= TIME_MICROS_MAX;		\
+	    (result)->seconds++;				\
+	}							\
+}
+
+#endif	/* _MACH_TIME_VALUE_H_ */
diff -urN cctools-806-old/include/mach/vm_attributes.h cctools-806/include/mach/vm_attributes.h
--- cctools-806-old/include/mach/vm_attributes.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_attributes.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,99 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/vm_attributes.h
+ *	Author:	Alessandro Forin
+ *
+ *	Virtual memory attributes definitions.
+ *
+ *	These definitions are in addition to the machine-independent
+ *	ones (e.g. protection), and are only selectively supported
+ *	on specific machine architectures.
+ *
+ */
+
+#ifndef	_MACH_VM_ATTRIBUTES_H_
+#define	_MACH_VM_ATTRIBUTES_H_
+
+/*
+ *	Types of machine-dependent attributes
+ */
+typedef unsigned int	vm_machine_attribute_t;
+
+#define	MATTR_CACHE		1	/* cachability */
+#define MATTR_MIGRATE		2	/* migrability */
+#define	MATTR_REPLICATE		4	/* replicability */
+
+/*
+ *	Values for the above, e.g. operations on attribute
+ */
+typedef int		vm_machine_attribute_val_t;
+
+#define MATTR_VAL_OFF		0	/* (generic) turn attribute off */
+#define MATTR_VAL_ON		1	/* (generic) turn attribute on */
+#define MATTR_VAL_GET		2	/* (generic) return current value */
+
+#define MATTR_VAL_CACHE_FLUSH	6	/* flush from all caches */
+#define MATTR_VAL_DCACHE_FLUSH	7	/* flush from data caches */
+#define MATTR_VAL_ICACHE_FLUSH	8	/* flush from instruction caches */
+#define MATTR_VAL_CACHE_SYNC	9	/* sync I+D caches */
+#define MATTR_VAL_CACHE_SYNC	9	/* sync I+D caches */
+
+#define MATTR_VAL_GET_INFO	10	/* get page info (stats) */
+
+#endif	/* _MACH_VM_ATTRIBUTES_H_ */
diff -urN cctools-806-old/include/mach/vm_behavior.h cctools-806/include/mach/vm_behavior.h
--- cctools-806-old/include/mach/vm_behavior.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_behavior.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,78 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ *	File:	mach/vm_behavior.h
+ *
+ *	Virtual memory map behavior definitions.
+ *
+ */
+
+#ifndef	_MACH_VM_BEHAVIOR_H_
+#define _MACH_VM_BEHAVIOR_H_
+
+/*
+ *	Types defined:
+ *
+ *	vm_behavior_t	behavior codes.
+ */
+
+typedef int		vm_behavior_t;
+
+/*
+ *	Enumeration of valid values for vm_behavior_t.
+ *	These describe expected page reference behavior for 
+ *	for a given range of virtual memory.  For implementation 
+ *	details see vm/vm_fault.c
+ */
+
+
+/*
+ * The following behaviors affect the memory region's future behavior
+ * and are stored in the VM map entry data structure.
+ */
+#define VM_BEHAVIOR_DEFAULT	((vm_behavior_t) 0)	/* default */
+#define VM_BEHAVIOR_RANDOM	((vm_behavior_t) 1)	/* random */
+#define VM_BEHAVIOR_SEQUENTIAL	((vm_behavior_t) 2)	/* forward sequential */
+#define VM_BEHAVIOR_RSEQNTL	((vm_behavior_t) 3)	/* reverse sequential */
+
+/*
+ * The following "behaviors" affect the memory region only at the time of the
+ * call and are not stored in the VM map entry.
+ */
+#define VM_BEHAVIOR_WILLNEED	((vm_behavior_t) 4)	/* will need in near future */
+#define VM_BEHAVIOR_DONTNEED	((vm_behavior_t) 5)	/* dont need in near future */
+#define VM_BEHAVIOR_FREE	((vm_behavior_t) 6)	/* free memory without write-back */
+#define VM_BEHAVIOR_ZERO_WIRED_PAGES	((vm_behavior_t) 7)	/* zero out the wired pages of an entry if it is being deleted without unwiring them first */
+#define VM_BEHAVIOR_REUSABLE	((vm_behavior_t) 8)
+#define VM_BEHAVIOR_REUSE	((vm_behavior_t) 9)
+#define VM_BEHAVIOR_CAN_REUSE	((vm_behavior_t) 10)
+
+#endif	/*_MACH_VM_BEHAVIOR_H_*/
diff -urN cctools-806-old/include/mach/vm_inherit.h cctools-806/include/mach/vm_inherit.h
--- cctools-806-old/include/mach/vm_inherit.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_inherit.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,89 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/vm_inherit.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *
+ *	Virtual memory map inheritance definitions.
+ *
+ */
+
+#ifndef	_MACH_VM_INHERIT_H_
+#define	_MACH_VM_INHERIT_H_
+
+/*
+ *	Types defined:
+ *
+ *	vm_inherit_t	inheritance codes.
+ */
+
+typedef unsigned int		vm_inherit_t;	/* might want to change this */
+
+/*
+ *	Enumeration of valid values for vm_inherit_t.
+ */
+
+#define	VM_INHERIT_SHARE	((vm_inherit_t) 0)	/* share with child */
+#define	VM_INHERIT_COPY		((vm_inherit_t) 1)	/* copy into child */
+#define VM_INHERIT_NONE		((vm_inherit_t) 2)	/* absent from child */
+#define	VM_INHERIT_DONATE_COPY	((vm_inherit_t) 3)	/* copy and delete */
+
+#define VM_INHERIT_DEFAULT	VM_INHERIT_COPY
+#define VM_INHERIT_LAST_VALID VM_INHERIT_NONE
+
+#endif	/* _MACH_VM_INHERIT_H_ */
diff -urN cctools-806-old/include/mach/vm_map.defs cctools-806/include/mach/vm_map.defs
--- cctools-806-old/include/mach/vm_map.defs	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_map.defs	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,475 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_FREE_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/vm_map.defs
+ *
+ *	Exported (native-sized) kernel VM calls.
+ */
+
+subsystem
+#if	KERNEL_SERVER
+	  KernelServer
+#endif	/* KERNEL_SERVER */
+	  vm_map 3800;
+
+#include <mach/std_types.defs>
+#include <mach/mach_types.defs>
+#include <mach_debug/mach_debug_types.defs>
+
+/*
+ *      Returns information about the contents of the virtual
+ *      address space of the target task at the specified
+ *      address.  The returned protection, inheritance, sharing
+ *      and memory object values apply to the entire range described
+ *      by the address range returned; the memory object offset
+ *      corresponds to the beginning of the address range.
+ *      [If the specified address is not allocated, the next
+ *      highest address range is described.  If no addresses beyond
+ *      the one specified are allocated, the call returns KERN_NO_SPACE.]
+ */
+routine vm_region(
+                target_task     : vm_map_t;
+	inout	address		: vm_address_t;
+        out     size            : vm_size_t;
+		flavor		: vm_region_flavor_t;
+	out	info		: vm_region_info_t, CountInOut;
+        out     object_name     : memory_object_name_t =
+                                        MACH_MSG_TYPE_MOVE_SEND
+                                        ctype: mach_port_t);
+
+/*
+ *	Allocate zero-filled memory in the address space
+ *	of the target task, either at the specified address,
+ *	or wherever space can be found (if anywhere is TRUE),
+ *	of the specified size.  The address at which the
+ *	allocation actually took place is returned.
+ */
+routine vm_allocate(
+		target_task	: vm_task_entry_t;
+	inout	address		: vm_address_t;
+		size		: vm_size_t;
+		flags		: int);
+
+/*
+ *	Deallocate the specified range from the virtual
+ *	address space of the target task.
+ */
+routine vm_deallocate(
+		target_task	: vm_task_entry_t;
+		address		: vm_address_t;
+		size		: vm_size_t);
+
+/*
+ *	Set the current or maximum protection attribute
+ *	for the specified range of the virtual address
+ *	space of the target task.  The current protection
+ *	limits the memory access rights of threads within
+ *	the task; the maximum protection limits the accesses
+ *	that may be given in the current protection.
+ *	Protections are specified as a set of {read, write, execute}
+ *	*permissions*.
+ */
+routine vm_protect(
+		target_task	: vm_task_entry_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		set_maximum	: boolean_t;
+		new_protection	: vm_prot_t);
+
+/*
+ *	Set the inheritance attribute for the specified range
+ *	of the virtual address space of the target task.
+ *	The inheritance value is one of {none, copy, share}, and
+ *	specifies how the child address space should acquire
+ *	this memory at the time of a task_create call.
+ */
+routine vm_inherit(
+		target_task	: vm_task_entry_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		new_inheritance	: vm_inherit_t);
+
+/*
+ *	Returns the contents of the specified range of the
+ *	virtual address space of the target task.  [The
+ *	range must be aligned on a virtual page boundary,
+ *	and must be a multiple of pages in extent.  The
+ *	protection on the specified range must permit reading.]
+ */
+routine vm_read(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+	out	data		: pointer_t);
+
+/* 
+ * List corrollary to vm_read, returns mapped contents of specified
+ * ranges within target address space.
+ */
+routine vm_read_list(
+		target_task 	: vm_map_t;
+	inout	data_list   	: vm_read_entry_t;
+		count		: natural_t);
+
+/*
+ *	Writes the contents of the specified range of the
+ *	virtual address space of the target task.  [The
+ *	range must be aligned on a virtual page boundary,
+ *	and must be a multiple of pages in extent.  The
+ *	protection on the specified range must permit writing.]
+ */
+routine vm_write(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		data		: pointer_t);
+
+/*
+ *	Copy the contents of the source range of the virtual
+ *	address space of the target task to the destination
+ *	range in that same address space.  [Both of the
+ *	ranges must be aligned on a virtual page boundary,
+ *	and must be multiples of pages in extent.  The
+ *	protection on the source range must permit reading,
+ *	and the protection on the destination range must
+ *	permit writing.]
+ */
+routine vm_copy(
+		target_task	: vm_map_t;
+		source_address	: vm_address_t;
+		size		: vm_size_t;
+		dest_address	: vm_address_t);
+
+/*
+ *	Returns the contents of the specified range of the
+ *	virtual address space of the target task.  [There
+ *	are no alignment restrictions, and the results will
+ *      overwrite the area pointed to by data - which must
+ *      already exist. The protection on the specified range
+ *	must permit reading.]
+ */
+routine vm_read_overwrite(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		data		: vm_address_t;
+	out	outsize		: vm_size_t);
+
+
+routine vm_msync(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		sync_flags	: vm_sync_t );
+
+/*
+ *	Set the paging behavior attribute for the specified range
+ *	of the virtual address space of the target task.
+ *	The behavior value is one of {default, random, forward 
+ *	sequential, reverse sequential} and indicates the expected
+ *	page reference pattern for the specified range.
+ */
+routine vm_behavior_set(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		new_behavior	: vm_behavior_t);
+
+
+/*
+ *	Map a user-defined memory object into the virtual address
+ *	space of the target task.  If desired (anywhere is TRUE),
+ *	the kernel will find a suitable address range of the
+ *	specified size; else, the specific address will be allocated.
+ *
+ *	The beginning address of the range will be aligned on a virtual
+ *	page boundary, be at or beyond the address specified, and
+ *	meet the mask requirements (bits turned on in the mask must not
+ *	be turned on in the result); the size of the range, in bytes,
+ *	will be rounded	up to an integral number of virtual pages.
+ *
+ *	The memory in the resulting range will be associated with the
+ *	specified memory object, with the beginning of the memory range
+ *	referring to the specified offset into the memory object.
+ *
+ *	The mapping will take the current and maximum protections and
+ *	the inheritance attributes specified; see the vm_protect and
+ *	vm_inherit calls for a description of these attributes.
+ *
+ *	If desired (copy is TRUE), the memory range will be filled
+ *	with a copy of the data from the memory object; this copy will
+ *	be private to this mapping in this target task.  Otherwise,
+ *	the memory in this mapping will be shared with other mappings
+ *	of the same memory object at the same offset (in this task or
+ *	in other tasks).  [The Mach kernel only enforces shared memory
+ *	consistency among mappings on one host with similar page alignments.
+ *	The user-defined memory manager for this object is responsible
+ *	for further consistency.]
+ */
+routine vm_map(
+		target_task	: vm_task_entry_t;
+	inout	address		: vm_address_t;
+		size		: vm_size_t;
+		mask		: vm_address_t;
+		flags		: int;
+		object		: mem_entry_name_port_t;
+		offset		: vm_offset_t;
+		copy		: boolean_t;
+		cur_protection	: vm_prot_t;
+		max_protection	: vm_prot_t;
+		inheritance	: vm_inherit_t);
+
+/*
+ *	Set/Get special properties of memory associated
+ *	to some virtual address range, such as cachability, 
+ *	migrability, replicability.  Machine-dependent.
+ */
+routine vm_machine_attribute(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		size		: vm_size_t;
+		attribute	: vm_machine_attribute_t;
+	inout	value		: vm_machine_attribute_val_t);
+
+/*
+ *      Map portion of a task's address space.
+ */
+routine vm_remap(
+		target_task	: vm_map_t;
+	inout	target_address	: vm_address_t;
+		size		: vm_size_t;
+		mask		: vm_address_t;
+		flags		: int;
+		src_task	: vm_map_t;
+		src_address	: vm_address_t;
+		copy		: boolean_t;
+	out	cur_protection	: vm_prot_t;
+	out	max_protection	: vm_prot_t;
+		inheritance	: vm_inherit_t);
+
+/*
+ *	Require that all future virtual memory allocation
+ *	allocates wired memory.  Setting must_wire to FALSE
+ *	disables the wired future feature.
+ */
+routine task_wire(
+		target_task	: vm_map_t;
+		must_wire	: boolean_t);
+
+	
+/*
+ *	Allow application level processes to create named entries which
+ *	correspond to mapped portions of their address space.  These named
+ *	entries can then be manipulated, shared with other processes in
+ *	other address spaces and ultimately mapped in ohter address spaces
+ */
+
+routine mach_make_memory_entry(
+		target_task	:vm_map_t;
+	inout	size		:vm_size_t;
+		offset		:vm_offset_t;
+		permission	:vm_prot_t;
+	out	object_handle	:mem_entry_name_port_move_send_t;
+		parent_entry	:mem_entry_name_port_t);
+
+/*
+ *      Give the caller information on the given location in a virtual
+ *      address space.  If a page is mapped return ref and dirty info.
+ */
+routine vm_map_page_query(
+                target_map      :vm_map_t;
+                offset          :vm_offset_t;
+        out     disposition     :integer_t;
+        out     ref_count       :integer_t);
+
+/*
+ *	Returns information about a region of memory.
+ *	Includes info about the chain of objects rooted at that region.
+ *      Only available in MACH_VM_DEBUG compiled kernels,
+ *      otherwise returns KERN_FAILURE.
+ */
+routine mach_vm_region_info(
+		task		: vm_map_t;
+		address		: vm_address_t;
+	out	region		: vm_info_region_t;
+	out	objects		: vm_info_object_array_t);
+
+routine	vm_mapped_pages_info(
+		task		: vm_map_t;
+	out	pages		: page_address_array_t);
+
+#if 0
+/*
+ *    Allow application level processes to create named entries which
+ *    are backed by sub-maps which describe regions of address space.
+ *    These regions of space can have objects mapped into them and
+ *    in turn, can be mapped into target address spaces 
+ */
+
+routine	vm_region_object_create(
+		target_task	:vm_map_t;
+	in	size		:vm_size_t;
+	out	region_object	:mach_port_move_send_t);
+#else
+skip; /* was vm_region_object_create */
+#endif
+
+/*
+ *	A recursive form of vm_region which probes submaps withint the
+ *	address space.
+ */
+routine vm_region_recurse(
+                target_task     : vm_map_t;
+	inout	address		: vm_address_t;
+        out     size            : vm_size_t;
+	inout	nesting_depth	: natural_t;
+	out	info		: vm_region_recurse_info_t,CountInOut);
+
+
+/* 
+ *	The routines below are temporary, meant for transitional use
+ *	as their counterparts are moved from 32 to 64 bit data path
+ */
+
+
+routine vm_region_recurse_64(
+                target_task     : vm_map_t;
+	inout	address		: vm_address_t;
+        out     size            : vm_size_t;
+	inout	nesting_depth	: natural_t;
+	out	info		: vm_region_recurse_info_t,CountInOut);
+
+routine mach_vm_region_info_64(
+		task		: vm_map_t;
+		address		: vm_address_t;
+	out	region		: vm_info_region_64_t;
+	out	objects		: vm_info_object_array_t);
+
+routine vm_region_64(
+                target_task     : vm_map_t;
+	inout	address		: vm_address_t;
+        out     size            : vm_size_t;
+		flavor		: vm_region_flavor_t;
+	out	info		: vm_region_info_t, CountInOut;
+        out     object_name     : memory_object_name_t =
+                                        MACH_MSG_TYPE_MOVE_SEND
+                                        ctype: mach_port_t);
+
+routine mach_make_memory_entry_64(
+		target_task	:vm_map_t;
+	inout	size		:memory_object_size_t;
+		offset		:memory_object_offset_t;
+		permission	:vm_prot_t;
+	out	object_handle	:mach_port_move_send_t;
+		parent_entry	:mem_entry_name_port_t);
+
+
+
+routine vm_map_64(
+		target_task	: vm_task_entry_t;
+	inout	address		: vm_address_t;
+		size		: vm_size_t;
+		mask		: vm_address_t;
+		flags		: int;
+		object		: mem_entry_name_port_t;
+		offset		: memory_object_offset_t;
+		copy		: boolean_t;
+		cur_protection	: vm_prot_t;
+		max_protection	: vm_prot_t;
+		inheritance	: vm_inherit_t);
+
+#if 0
+/*
+ * The UPL interfaces are not ready for user-level export.
+ */
+routine vm_map_get_upl(
+		target_task	: vm_map_t;
+		address		: vm_map_offset_t;
+	inout	size		: vm_size_t;
+	out	upl		: upl_t;
+	out	page_info	: upl_page_info_array_t, CountInOut;
+	inout	flags		: integer_t;
+		force_data_sync	: integer_t);
+
+routine vm_upl_map(
+		target_task	: vm_map_t;
+		upl		: upl_t;
+	inout	address		: vm_address_t);
+
+routine vm_upl_unmap(
+		target_task	: vm_map_t;
+		upl		: upl_t);
+#else
+skip; /* was vm_map_get_upl */
+skip; /* was vm_upl_map */
+skip; /* was vm_upl_unmap */
+#endif		
+
+/*
+ *	Control behavior and investigate state of a "purgable" object in
+ *	the virtual address space of the target task.  A purgable object is
+ *	created via a call to vm_allocate() with VM_FLAGS_PURGABLE
+ *	specified.  See the routine implementation for a complete
+ *	definition of the routine.
+ */
+routine vm_purgable_control(
+		target_task	: vm_map_t;
+		address		: vm_address_t;
+		control		: vm_purgable_t;
+	inout	state		: int);
+
+/* vim: set ft=c : */
diff -urN cctools-806-old/include/mach/vm_map.h cctools-806/include/mach/vm_map.h
--- cctools-806-old/include/mach/vm_map.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_map.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1379 @@
+#ifndef	_vm_map_user_
+#define	_vm_map_user_
+
+/* Module vm_map */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	vm_map_MSG_COUNT
+#define	vm_map_MSG_COUNT	31
+#endif	/* vm_map_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine vm_region */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_region
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t *size,
+	vm_region_flavor_t flavor,
+	vm_region_info_t info,
+	mach_msg_type_number_t *infoCnt,
+	mach_port_t *object_name
+);
+
+/* Routine vm_allocate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_allocate
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t size,
+	int flags
+);
+
+/* Routine vm_deallocate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_deallocate
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size
+);
+
+/* Routine vm_protect */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_protect
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	boolean_t set_maximum,
+	vm_prot_t new_protection
+);
+
+/* Routine vm_inherit */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_inherit
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_inherit_t new_inheritance
+);
+
+/* Routine vm_read */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_read
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_offset_t *data,
+	mach_msg_type_number_t *dataCnt
+);
+
+/* Routine vm_read_list */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_read_list
+(
+	vm_map_t target_task,
+	vm_read_entry_t data_list,
+	natural_t count
+);
+
+/* Routine vm_write */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_write
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_offset_t data,
+	mach_msg_type_number_t dataCnt
+);
+
+/* Routine vm_copy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_copy
+(
+	vm_map_t target_task,
+	vm_address_t source_address,
+	vm_size_t size,
+	vm_address_t dest_address
+);
+
+/* Routine vm_read_overwrite */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_read_overwrite
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_address_t data,
+	vm_size_t *outsize
+);
+
+/* Routine vm_msync */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_msync
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_sync_t sync_flags
+);
+
+/* Routine vm_behavior_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_behavior_set
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_behavior_t new_behavior
+);
+
+/* Routine vm_map */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_map
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t size,
+	vm_address_t mask,
+	int flags,
+	mem_entry_name_port_t object,
+	vm_offset_t offset,
+	boolean_t copy,
+	vm_prot_t cur_protection,
+	vm_prot_t max_protection,
+	vm_inherit_t inheritance
+);
+
+/* Routine vm_machine_attribute */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_machine_attribute
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_size_t size,
+	vm_machine_attribute_t attribute,
+	vm_machine_attribute_val_t *value
+);
+
+/* Routine vm_remap */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_remap
+(
+	vm_map_t target_task,
+	vm_address_t *target_address,
+	vm_size_t size,
+	vm_address_t mask,
+	int flags,
+	vm_map_t src_task,
+	vm_address_t src_address,
+	boolean_t copy,
+	vm_prot_t *cur_protection,
+	vm_prot_t *max_protection,
+	vm_inherit_t inheritance
+);
+
+/* Routine task_wire */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_wire
+(
+	vm_map_t target_task,
+	boolean_t must_wire
+);
+
+/* Routine mach_make_memory_entry */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_make_memory_entry
+(
+	vm_map_t target_task,
+	vm_size_t *size,
+	vm_offset_t offset,
+	vm_prot_t permission,
+	mem_entry_name_port_t *object_handle,
+	mem_entry_name_port_t parent_entry
+);
+
+/* Routine vm_map_page_query */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_map_page_query
+(
+	vm_map_t target_map,
+	vm_offset_t offset,
+	integer_t *disposition,
+	integer_t *ref_count
+);
+
+/* Routine mach_vm_region_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_region_info
+(
+	vm_map_t task,
+	vm_address_t address,
+	vm_info_region_t *region,
+	vm_info_object_array_t *objects,
+	mach_msg_type_number_t *objectsCnt
+);
+
+/* Routine vm_mapped_pages_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_mapped_pages_info
+(
+	vm_map_t task,
+	page_address_array_t *pages,
+	mach_msg_type_number_t *pagesCnt
+);
+
+/* Routine vm_region_recurse */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_region_recurse
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t *size,
+	natural_t *nesting_depth,
+	vm_region_recurse_info_t info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine vm_region_recurse_64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_region_recurse_64
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t *size,
+	natural_t *nesting_depth,
+	vm_region_recurse_info_t info,
+	mach_msg_type_number_t *infoCnt
+);
+
+/* Routine mach_vm_region_info_64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_vm_region_info_64
+(
+	vm_map_t task,
+	vm_address_t address,
+	vm_info_region_64_t *region,
+	vm_info_object_array_t *objects,
+	mach_msg_type_number_t *objectsCnt
+);
+
+/* Routine vm_region_64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_region_64
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t *size,
+	vm_region_flavor_t flavor,
+	vm_region_info_t info,
+	mach_msg_type_number_t *infoCnt,
+	mach_port_t *object_name
+);
+
+/* Routine mach_make_memory_entry_64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_make_memory_entry_64
+(
+	vm_map_t target_task,
+	memory_object_size_t *size,
+	memory_object_offset_t offset,
+	vm_prot_t permission,
+	mach_port_t *object_handle,
+	mem_entry_name_port_t parent_entry
+);
+
+/* Routine vm_map_64 */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_map_64
+(
+	vm_map_t target_task,
+	vm_address_t *address,
+	vm_size_t size,
+	vm_address_t mask,
+	int flags,
+	mem_entry_name_port_t object,
+	memory_object_offset_t offset,
+	boolean_t copy,
+	vm_prot_t cur_protection,
+	vm_prot_t max_protection,
+	vm_inherit_t inheritance
+);
+
+/* Routine vm_purgable_control */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t vm_purgable_control
+(
+	vm_map_t target_task,
+	vm_address_t address,
+	vm_purgable_t control,
+	int *state
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__vm_map_subsystem__defined
+#define __Request__vm_map_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_region_flavor_t flavor;
+		mach_msg_type_number_t infoCnt;
+	} __Request__vm_region_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		int flags;
+	} __Request__vm_allocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+	} __Request__vm_deallocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		boolean_t set_maximum;
+		vm_prot_t new_protection;
+	} __Request__vm_protect_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_inherit_t new_inheritance;
+	} __Request__vm_inherit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+	} __Request__vm_read_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_read_entry_t data_list;
+		natural_t count;
+	} __Request__vm_read_list_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		mach_msg_type_number_t dataCnt;
+	} __Request__vm_write_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t source_address;
+		vm_size_t size;
+		vm_address_t dest_address;
+	} __Request__vm_copy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_address_t data;
+	} __Request__vm_read_overwrite_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_sync_t sync_flags;
+	} __Request__vm_msync_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_behavior_t new_behavior;
+	} __Request__vm_behavior_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_address_t mask;
+		int flags;
+		vm_offset_t offset;
+		boolean_t copy;
+		vm_prot_t cur_protection;
+		vm_prot_t max_protection;
+		vm_inherit_t inheritance;
+	} __Request__vm_map_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_machine_attribute_t attribute;
+		vm_machine_attribute_val_t value;
+	} __Request__vm_machine_attribute_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t src_task;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t target_address;
+		vm_size_t size;
+		vm_address_t mask;
+		int flags;
+		vm_address_t src_address;
+		boolean_t copy;
+		vm_inherit_t inheritance;
+	} __Request__vm_remap_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		boolean_t must_wire;
+	} __Request__task_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t parent_entry;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_size_t size;
+		vm_offset_t offset;
+		vm_prot_t permission;
+	} __Request__mach_make_memory_entry_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_offset_t offset;
+	} __Request__vm_map_page_query_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+	} __Request__mach_vm_region_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__vm_mapped_pages_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		natural_t nesting_depth;
+		mach_msg_type_number_t infoCnt;
+	} __Request__vm_region_recurse_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		natural_t nesting_depth;
+		mach_msg_type_number_t infoCnt;
+	} __Request__vm_region_recurse_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+	} __Request__mach_vm_region_info_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_region_flavor_t flavor;
+		mach_msg_type_number_t infoCnt;
+	} __Request__vm_region_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t parent_entry;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		memory_object_size_t size;
+		memory_object_offset_t offset;
+		vm_prot_t permission;
+	} __Request__mach_make_memory_entry_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		vm_address_t mask;
+		int flags;
+		memory_object_offset_t offset;
+		boolean_t copy;
+		vm_prot_t cur_protection;
+		vm_prot_t max_protection;
+		vm_inherit_t inheritance;
+	} __Request__vm_map_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_purgable_t control;
+		int state;
+	} __Request__vm_purgable_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__vm_map_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__vm_map_subsystem__defined
+#define __RequestUnion__vm_map_subsystem__defined
+union __RequestUnion__vm_map_subsystem {
+	__Request__vm_region_t Request_vm_region;
+	__Request__vm_allocate_t Request_vm_allocate;
+	__Request__vm_deallocate_t Request_vm_deallocate;
+	__Request__vm_protect_t Request_vm_protect;
+	__Request__vm_inherit_t Request_vm_inherit;
+	__Request__vm_read_t Request_vm_read;
+	__Request__vm_read_list_t Request_vm_read_list;
+	__Request__vm_write_t Request_vm_write;
+	__Request__vm_copy_t Request_vm_copy;
+	__Request__vm_read_overwrite_t Request_vm_read_overwrite;
+	__Request__vm_msync_t Request_vm_msync;
+	__Request__vm_behavior_set_t Request_vm_behavior_set;
+	__Request__vm_map_t Request_vm_map;
+	__Request__vm_machine_attribute_t Request_vm_machine_attribute;
+	__Request__vm_remap_t Request_vm_remap;
+	__Request__task_wire_t Request_task_wire;
+	__Request__mach_make_memory_entry_t Request_mach_make_memory_entry;
+	__Request__vm_map_page_query_t Request_vm_map_page_query;
+	__Request__mach_vm_region_info_t Request_mach_vm_region_info;
+	__Request__vm_mapped_pages_info_t Request_vm_mapped_pages_info;
+	__Request__vm_region_recurse_t Request_vm_region_recurse;
+	__Request__vm_region_recurse_64_t Request_vm_region_recurse_64;
+	__Request__mach_vm_region_info_64_t Request_mach_vm_region_info_64;
+	__Request__vm_region_64_t Request_vm_region_64;
+	__Request__mach_make_memory_entry_64_t Request_mach_make_memory_entry_64;
+	__Request__vm_map_64_t Request_vm_map_64;
+	__Request__vm_purgable_control_t Request_vm_purgable_control;
+};
+#endif /* !__RequestUnion__vm_map_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__vm_map_subsystem__defined
+#define __Reply__vm_map_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object_name;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		mach_msg_type_number_t infoCnt;
+		int info[10];
+	} __Reply__vm_region_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t address;
+	} __Reply__vm_allocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_deallocate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_protect_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_inherit_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t data;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t dataCnt;
+	} __Reply__vm_read_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_read_entry_t data_list;
+	} __Reply__vm_read_list_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_write_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_copy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_size_t outsize;
+	} __Reply__vm_read_overwrite_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_msync_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__vm_behavior_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t address;
+	} __Reply__vm_map_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_machine_attribute_val_t value;
+	} __Reply__vm_machine_attribute_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t target_address;
+		vm_prot_t cur_protection;
+		vm_prot_t max_protection;
+	} __Reply__vm_remap_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_wire_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object_handle;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_size_t size;
+	} __Reply__mach_make_memory_entry_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		integer_t disposition;
+		integer_t ref_count;
+	} __Reply__vm_map_page_query_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t objects;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_info_region_t region;
+		mach_msg_type_number_t objectsCnt;
+	} __Reply__mach_vm_region_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t pages;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t pagesCnt;
+	} __Reply__vm_mapped_pages_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t address;
+		vm_size_t size;
+		natural_t nesting_depth;
+		mach_msg_type_number_t infoCnt;
+		int info[19];
+	} __Reply__vm_region_recurse_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t address;
+		vm_size_t size;
+		natural_t nesting_depth;
+		mach_msg_type_number_t infoCnt;
+		int info[19];
+	} __Reply__vm_region_recurse_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t objects;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_info_region_64_t region;
+		mach_msg_type_number_t objectsCnt;
+	} __Reply__mach_vm_region_info_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object_name;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		vm_address_t address;
+		vm_size_t size;
+		mach_msg_type_number_t infoCnt;
+		int info[10];
+	} __Reply__vm_region_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t object_handle;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		memory_object_size_t size;
+	} __Reply__mach_make_memory_entry_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		vm_address_t address;
+	} __Reply__vm_map_64_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		int state;
+	} __Reply__vm_purgable_control_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__vm_map_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__vm_map_subsystem__defined
+#define __ReplyUnion__vm_map_subsystem__defined
+union __ReplyUnion__vm_map_subsystem {
+	__Reply__vm_region_t Reply_vm_region;
+	__Reply__vm_allocate_t Reply_vm_allocate;
+	__Reply__vm_deallocate_t Reply_vm_deallocate;
+	__Reply__vm_protect_t Reply_vm_protect;
+	__Reply__vm_inherit_t Reply_vm_inherit;
+	__Reply__vm_read_t Reply_vm_read;
+	__Reply__vm_read_list_t Reply_vm_read_list;
+	__Reply__vm_write_t Reply_vm_write;
+	__Reply__vm_copy_t Reply_vm_copy;
+	__Reply__vm_read_overwrite_t Reply_vm_read_overwrite;
+	__Reply__vm_msync_t Reply_vm_msync;
+	__Reply__vm_behavior_set_t Reply_vm_behavior_set;
+	__Reply__vm_map_t Reply_vm_map;
+	__Reply__vm_machine_attribute_t Reply_vm_machine_attribute;
+	__Reply__vm_remap_t Reply_vm_remap;
+	__Reply__task_wire_t Reply_task_wire;
+	__Reply__mach_make_memory_entry_t Reply_mach_make_memory_entry;
+	__Reply__vm_map_page_query_t Reply_vm_map_page_query;
+	__Reply__mach_vm_region_info_t Reply_mach_vm_region_info;
+	__Reply__vm_mapped_pages_info_t Reply_vm_mapped_pages_info;
+	__Reply__vm_region_recurse_t Reply_vm_region_recurse;
+	__Reply__vm_region_recurse_64_t Reply_vm_region_recurse_64;
+	__Reply__mach_vm_region_info_64_t Reply_mach_vm_region_info_64;
+	__Reply__vm_region_64_t Reply_vm_region_64;
+	__Reply__mach_make_memory_entry_64_t Reply_mach_make_memory_entry_64;
+	__Reply__vm_map_64_t Reply_vm_map_64;
+	__Reply__vm_purgable_control_t Reply_vm_purgable_control;
+};
+#endif /* !__RequestUnion__vm_map_subsystem__defined */
+
+#ifndef subsystem_to_name_map_vm_map
+#define subsystem_to_name_map_vm_map \
+    { "vm_region", 3800 },\
+    { "vm_allocate", 3801 },\
+    { "vm_deallocate", 3802 },\
+    { "vm_protect", 3803 },\
+    { "vm_inherit", 3804 },\
+    { "vm_read", 3805 },\
+    { "vm_read_list", 3806 },\
+    { "vm_write", 3807 },\
+    { "vm_copy", 3808 },\
+    { "vm_read_overwrite", 3809 },\
+    { "vm_msync", 3810 },\
+    { "vm_behavior_set", 3811 },\
+    { "vm_map", 3812 },\
+    { "vm_machine_attribute", 3813 },\
+    { "vm_remap", 3814 },\
+    { "task_wire", 3815 },\
+    { "mach_make_memory_entry", 3816 },\
+    { "vm_map_page_query", 3817 },\
+    { "mach_vm_region_info", 3818 },\
+    { "vm_mapped_pages_info", 3819 },\
+    { "vm_region_recurse", 3821 },\
+    { "vm_region_recurse_64", 3822 },\
+    { "mach_vm_region_info_64", 3823 },\
+    { "vm_region_64", 3824 },\
+    { "mach_make_memory_entry_64", 3825 },\
+    { "vm_map_64", 3826 },\
+    { "vm_purgable_control", 3830 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _vm_map_user_ */
diff -urN cctools-806-old/include/mach/vm_param.h cctools-806/include/mach/vm_param.h
--- cctools-806-old/include/mach/vm_param.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_param.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,73 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/vm_param.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *	Date:	1985
+ *
+ *	Machine independent virtual memory parameters.
+ *
+ */
+
+#ifndef	_MACH_VM_PARAM_H_
+#define _MACH_VM_PARAM_H_
+
+#include <mach/machine/vm_param.h>
+
+
+#endif	/* _MACH_VM_PARAM_H_ */
diff -urN cctools-806-old/include/mach/vm_prot.h cctools-806/include/mach/vm_prot.h
--- cctools-806-old/include/mach/vm_prot.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_prot.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,140 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/vm_prot.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young
+ *
+ *	Virtual memory protection definitions.
+ *
+ */
+
+#ifndef	_MACH_VM_PROT_H_
+#define	_MACH_VM_PROT_H_
+
+/*
+ *	Types defined:
+ *
+ *	vm_prot_t		VM protection values.
+ */
+
+typedef int		vm_prot_t;
+
+/*
+ *	Protection values, defined as bits within the vm_prot_t type
+ */
+
+#define	VM_PROT_NONE	((vm_prot_t) 0x00)
+
+#define VM_PROT_READ	((vm_prot_t) 0x01)	/* read permission */
+#define VM_PROT_WRITE	((vm_prot_t) 0x02)	/* write permission */
+#define VM_PROT_EXECUTE	((vm_prot_t) 0x04)	/* execute permission */
+
+/*
+ *	The default protection for newly-created virtual memory
+ */
+
+#define VM_PROT_DEFAULT	(VM_PROT_READ|VM_PROT_WRITE)
+
+/*
+ *	The maximum privileges possible, for parameter checking.
+ */
+
+#define VM_PROT_ALL	(VM_PROT_READ|VM_PROT_WRITE|VM_PROT_EXECUTE)
+
+/*
+ *	An invalid protection value.
+ *	Used only by memory_object_lock_request to indicate no change
+ *	to page locks.  Using -1 here is a bad idea because it
+ *	looks like VM_PROT_ALL and then some.
+ */
+
+#define VM_PROT_NO_CHANGE	((vm_prot_t) 0x08)
+
+/* 
+ *      When a caller finds that he cannot obtain write permission on a
+ *      mapped entry, the following flag can be used.  The entry will
+ *      be made "needs copy" effectively copying the object (using COW),
+ *      and write permission will be added to the maximum protections
+ *      for the associated entry. 
+ */        
+
+#define VM_PROT_COPY            ((vm_prot_t) 0x10)
+
+
+/*
+ *	Another invalid protection value.
+ *	Used only by memory_object_data_request upon an object
+ *	which has specified a copy_call copy strategy. It is used
+ *	when the kernel wants a page belonging to a copy of the
+ *	object, and is only asking the object as a result of
+ *	following a shadow chain. This solves the race between pages
+ *	being pushed up by the memory manager and the kernel
+ *	walking down the shadow chain.
+ */
+
+#define VM_PROT_WANTS_COPY	((vm_prot_t) 0x10)
+
+
+/*
+ * 	Another invalid protection value.
+ *	Indicates that the other protection bits are to be applied as a mask
+ *	against the actual protection bits of the map entry.
+ */
+#define VM_PROT_IS_MASK		((vm_prot_t) 0x40)
+
+#endif	/* _MACH_VM_PROT_H_ */
diff -urN cctools-806-old/include/mach/vm_purgable.h cctools-806/include/mach/vm_purgable.h
--- cctools-806-old/include/mach/vm_purgable.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_purgable.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,134 @@
+/*
+ * Copyright (c) 2003-2007 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+
+/*
+ * Virtual memory map purgeable object definitions.
+ * Objects that will be needed in the future (forward cached objects) should be queued LIFO. 
+ * Objects that have been used and are cached for reuse (backward cached) should be queued FIFO.
+ * Every user of purgeable memory is entitled to using the highest volatile group (7).
+ * Only if a client wants some of its objects to definitely be purged earlier, it can put those in
+ * another group. This could be used to make all FIFO objects (in the lower group) go away before 
+ * any LIFO objects (in the higher group) go away.
+ * Objects that should not get any chance to stay around can be marked as "obsolete". They will
+ * be emptied before any other objects or pages are reclaimed. Obsolete objects are not emptied
+ * in any particular order.
+ * 'purgeable' is recognized as the correct spelling. For historical reasons, definitions 
+ * in this file are spelled 'purgable'.
+ */
+
+#ifndef	_MACH_VM_PURGABLE_H_
+#define	_MACH_VM_PURGABLE_H_
+
+/*
+ *	Types defined:
+ *
+ *	vm_purgable_t	purgeable object control codes.
+ */
+
+typedef int	vm_purgable_t;
+
+/*
+ *	Enumeration of valid values for vm_purgable_t.
+ */
+#define VM_PURGABLE_SET_STATE	((vm_purgable_t) 0)	/* set state of purgeable object */
+#define VM_PURGABLE_GET_STATE	((vm_purgable_t) 1)	/* get state of purgeable object */
+#define VM_PURGABLE_PURGE_ALL	((vm_purgable_t) 2)	/* purge all volatile objects now */
+
+#define VM_PURGABLE_DEBUG_SHIFT	12
+#define VM_PURGABLE_DEBUG_MASK	(0x3 << VM_PURGABLE_DEBUG_SHIFT)
+#define VM_PURGABLE_DEBUG_EMPTY	(0x1 << VM_PURGABLE_DEBUG_SHIFT)
+#define VM_PURGABLE_DEBUG_FAULT	(0x2 << VM_PURGABLE_DEBUG_SHIFT)
+
+/*
+ * Volatile memory ordering groups (group zero objects are purged before group 1, etc...
+ * It is implementation dependent as to whether these groups are global or per-address space.
+ * (for the moment, they are global).
+ */
+#define VM_VOLATILE_GROUP_SHIFT		8
+#define VM_VOLATILE_GROUP_MASK		(7 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_DEFAULT   VM_VOLATILE_GROUP_7
+
+#define VM_VOLATILE_GROUP_0			(0 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_1			(1 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_2			(2 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_3			(3 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_4			(4 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_5			(5 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_6			(6 << VM_VOLATILE_GROUP_SHIFT)
+#define VM_VOLATILE_GROUP_7			(7 << VM_VOLATILE_GROUP_SHIFT)
+
+/*
+ * Purgeable behavior
+ * Within the same group, FIFO objects will be emptied before objects that are added later.
+ * LIFO objects will be emptied after objects that are added later.
+ * - Input only, not returned on state queries.
+ */
+#define VM_PURGABLE_BEHAVIOR_SHIFT  6
+#define VM_PURGABLE_BEHAVIOR_MASK   (1 << VM_PURGABLE_BEHAVIOR_SHIFT)
+#define VM_PURGABLE_BEHAVIOR_FIFO   (0 << VM_PURGABLE_BEHAVIOR_SHIFT)
+#define VM_PURGABLE_BEHAVIOR_LIFO   (1 << VM_PURGABLE_BEHAVIOR_SHIFT)
+
+/*
+ * Obsolete object.
+ * Disregard volatile group, and put object into obsolete queue instead, so it is the next object
+ * to be purged.
+ * - Input only, not returned on state queries.
+ */
+#define VM_PURGABLE_ORDERING_SHIFT		5
+#define VM_PURGABLE_ORDERING_MASK		(1 << VM_PURGABLE_ORDERING_SHIFT)
+#define VM_PURGABLE_ORDERING_OBSOLETE	(1 << VM_PURGABLE_ORDERING_SHIFT)
+#define VM_PURGABLE_ORDERING_NORMAL		(0 << VM_PURGABLE_ORDERING_SHIFT)
+
+
+/*
+ * Obsolete parameter - do not use
+ */
+#define VM_VOLATILE_ORDER_SHIFT			4
+#define VM_VOLATILE_ORDER_MASK			(1 << VM_VOLATILE_ORDER_SHIFT)
+#define VM_VOLATILE_MAKE_FIRST_IN_GROUP	(1 << VM_VOLATILE_ORDER_SHIFT)
+#define VM_VOLATILE_MAKE_LAST_IN_GROUP	(0 << VM_VOLATILE_ORDER_SHIFT)
+
+/*
+ * Valid states of a purgeable object.
+ */
+#define VM_PURGABLE_STATE_MIN	0		/* minimum purgeable object state value */
+#define VM_PURGABLE_STATE_MAX	3		/* maximum purgeable object state value */
+#define VM_PURGABLE_STATE_MASK	3		/* mask to separate state from group */
+
+#define VM_PURGABLE_NONVOLATILE	0		/* purgeable object is non-volatile */
+#define VM_PURGABLE_VOLATILE	1		/* purgeable object is volatile */
+#define VM_PURGABLE_EMPTY		2		/* purgeable object is volatile and empty */
+#define VM_PURGABLE_DENY		3		/* (mark) object not purgeable */
+
+#define VM_PURGABLE_ALL_MASKS	(VM_PURGABLE_STATE_MASK | \
+				 VM_VOLATILE_ORDER_MASK | \
+				 VM_PURGABLE_ORDERING_MASK | \
+				 VM_PURGABLE_BEHAVIOR_MASK | \
+				 VM_VOLATILE_GROUP_MASK | \
+				 VM_PURGABLE_DEBUG_MASK)
+#endif	/* _MACH_VM_PURGABLE_H_ */
diff -urN cctools-806-old/include/mach/vm_region.h cctools-806/include/mach/vm_region.h
--- cctools-806-old/include/mach/vm_region.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_region.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,322 @@
+/*
+ * Copyright (c) 2000-2006 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/*
+ *	File:	mach/vm_region.h
+ *
+ *	Define the attributes of a task's memory region
+ *
+ */
+
+#ifndef	_MACH_VM_REGION_H_
+#define _MACH_VM_REGION_H_
+
+#include <mach/boolean.h>
+#include <mach/vm_prot.h>
+#include <mach/vm_inherit.h>
+#include <mach/vm_behavior.h>
+#include <mach/vm_types.h>
+#include <mach/message.h>
+#include <mach/machine/vm_param.h>
+#include <mach/machine/vm_types.h>
+#include <mach/memory_object_types.h>
+
+#include <sys/cdefs.h>
+
+#pragma pack(4)
+
+// LP64todo: all the current tools are 32bit, obviously never worked for 64b
+// so probably should be a real 32b ID vs. ptr.
+// Current users just check for equality
+typedef uint32_t vm32_object_id_t;
+
+/*
+ *	Types defined:
+ *
+ *	vm_region_info_t	memory region attributes
+ */
+
+#define VM_REGION_INFO_MAX      (1024)
+typedef int	*vm_region_info_t;
+typedef int	*vm_region_info_64_t;
+typedef int	*vm_region_recurse_info_t;
+typedef int	*vm_region_recurse_info_64_t;
+typedef int	 vm_region_flavor_t;
+typedef int	 vm_region_info_data_t[VM_REGION_INFO_MAX];
+
+#define VM_REGION_BASIC_INFO_64		9
+struct vm_region_basic_info_64 {
+	vm_prot_t		protection;
+	vm_prot_t		max_protection;
+	vm_inherit_t		inheritance;
+	boolean_t		shared;
+	boolean_t		reserved;
+	memory_object_offset_t	offset;
+	vm_behavior_t		behavior;
+	unsigned short		user_wired_count;
+};
+typedef struct vm_region_basic_info_64		*vm_region_basic_info_64_t;
+typedef struct vm_region_basic_info_64		 vm_region_basic_info_data_64_t;
+
+#define VM_REGION_BASIC_INFO_COUNT_64	((mach_msg_type_number_t) \
+	(sizeof(vm_region_basic_info_data_64_t)/sizeof(int)))
+
+/*
+ * Passing VM_REGION_BASIC_INFO to vm_region_64
+ * automatically converts it to a VM_REGION_BASIC_INFO_64.
+ * Please use that explicitly instead.
+ */
+#define VM_REGION_BASIC_INFO		10
+
+/*
+ * This is the legacy basic info structure.  It is
+ * deprecated because it passes only a 32-bit memory object
+ * offset back - too small for many larger objects (e.g. files).
+ */
+struct vm_region_basic_info {
+	vm_prot_t		protection;
+	vm_prot_t		max_protection;
+	vm_inherit_t		inheritance;
+	boolean_t		shared;
+	boolean_t		reserved;
+	uint32_t		offset; /* too small for a real offset */
+	vm_behavior_t		behavior;
+	unsigned short		user_wired_count;
+};
+
+typedef struct vm_region_basic_info		*vm_region_basic_info_t;
+typedef struct vm_region_basic_info		 vm_region_basic_info_data_t;
+
+#define VM_REGION_BASIC_INFO_COUNT ((mach_msg_type_number_t) \
+	(sizeof(vm_region_basic_info_data_t)/sizeof(int)))
+
+#define VM_REGION_EXTENDED_INFO	11
+
+#define SM_COW             1
+#define SM_PRIVATE         2
+#define SM_EMPTY           3
+#define SM_SHARED          4
+#define SM_TRUESHARED      5
+#define SM_PRIVATE_ALIASED 6
+#define SM_SHARED_ALIASED  7
+#define SM_LARGE_PAGE      8
+
+/* 
+ * For submap info,  the SM flags above are overlayed when a submap
+ * is encountered.  The field denotes whether or not machine level mapping
+ * information is being shared.  PTE's etc.  When such sharing is taking
+ * place the value returned is SM_TRUESHARED otherwise SM_PRIVATE is passed
+ * back.
+ */
+
+struct vm_region_extended_info {
+	vm_prot_t		protection;
+        unsigned int            user_tag;
+        unsigned int            pages_resident;
+        unsigned int            pages_shared_now_private;
+        unsigned int            pages_swapped_out;
+        unsigned int            pages_dirtied;
+        unsigned int            ref_count;
+        unsigned short          shadow_depth;
+        unsigned char           external_pager;
+        unsigned char           share_mode;
+};
+
+typedef struct vm_region_extended_info		*vm_region_extended_info_t;
+typedef struct vm_region_extended_info		 vm_region_extended_info_data_t;
+
+#define VM_REGION_EXTENDED_INFO_COUNT	((mach_msg_type_number_t) \
+	(sizeof(vm_region_extended_info_data_t)/sizeof(int)))
+
+
+#define VM_REGION_TOP_INFO	12
+
+struct vm_region_top_info {
+        unsigned int            obj_id;
+        unsigned int            ref_count;
+        unsigned int            private_pages_resident;
+        unsigned int            shared_pages_resident;
+        unsigned char           share_mode;
+};
+
+typedef struct vm_region_top_info		*vm_region_top_info_t;
+typedef struct vm_region_top_info		 vm_region_top_info_data_t;
+
+#define VM_REGION_TOP_INFO_COUNT ((mach_msg_type_number_t) \
+	(sizeof(vm_region_top_info_data_t)/sizeof(int)))
+
+
+
+/* 
+ * vm_region_submap_info will return information on a submap or object.
+ * The user supplies a nesting level on the call.  When a walk of the
+ * user's map is done and a submap is encountered, the nesting count is
+ * checked. If the nesting count is greater than 1 the submap is entered and
+ * the offset relative to the address in the base map is examined.  If the
+ * nesting count is zero, the information on the submap is returned.
+ * The caller may thus learn about a submap and its contents by judicious
+ * choice of the base map address and nesting count.  The nesting count
+ * allows penetration of recursively mapped submaps.  If a submap is
+ * encountered as a mapped entry of another submap, the caller may bump
+ * the nesting count and call vm_region_recurse again on the target address
+ * range.  The "is_submap" field tells the caller whether or not a submap
+ * has been encountered.
+ *
+ * Object only fields are filled in through a walking of the object shadow
+ * chain (where one is present), and a walking of the resident page queue.
+ * 
+ */
+
+struct vm_region_submap_info {
+	vm_prot_t		protection;     /* present access protection */
+	vm_prot_t		max_protection; /* max avail through vm_prot */
+	vm_inherit_t		inheritance;/* behavior of map/obj on fork */
+	uint32_t		offset;		/* offset into object/map */
+        unsigned int            user_tag;	/* user tag on map entry */
+        unsigned int            pages_resident;	/* only valid for objects */
+        unsigned int            pages_shared_now_private; /* only for objects */
+        unsigned int            pages_swapped_out; /* only for objects */
+        unsigned int            pages_dirtied;   /* only for objects */
+        unsigned int            ref_count;	 /* obj/map mappers, etc */
+        unsigned short          shadow_depth; 	/* only for obj */
+        unsigned char           external_pager;  /* only for obj */
+        unsigned char           share_mode;	/* see enumeration */
+	boolean_t		is_submap;	/* submap vs obj */
+	vm_behavior_t		behavior;	/* access behavior hint */
+	vm32_object_id_t		object_id;	/* obj/map name, not a handle */
+	unsigned short		user_wired_count; 
+};
+
+typedef struct vm_region_submap_info		*vm_region_submap_info_t;
+typedef struct vm_region_submap_info		 vm_region_submap_info_data_t;
+
+#define VM_REGION_SUBMAP_INFO_COUNT ((mach_msg_type_number_t) \
+	(sizeof(vm_region_submap_info_data_t)/sizeof(int)))
+
+struct vm_region_submap_info_64 {
+	vm_prot_t		protection;     /* present access protection */
+	vm_prot_t		max_protection; /* max avail through vm_prot */
+	vm_inherit_t		inheritance;/* behavior of map/obj on fork */
+	memory_object_offset_t	offset;		/* offset into object/map */
+        unsigned int            user_tag;	/* user tag on map entry */
+        unsigned int            pages_resident;	/* only valid for objects */
+        unsigned int            pages_shared_now_private; /* only for objects */
+        unsigned int            pages_swapped_out; /* only for objects */
+        unsigned int            pages_dirtied;   /* only for objects */
+        unsigned int            ref_count;	 /* obj/map mappers, etc */
+        unsigned short          shadow_depth; 	/* only for obj */
+        unsigned char           external_pager;  /* only for obj */
+        unsigned char           share_mode;	/* see enumeration */
+	boolean_t		is_submap;	/* submap vs obj */
+	vm_behavior_t		behavior;	/* access behavior hint */
+	vm32_object_id_t		object_id;	/* obj/map name, not a handle */
+	unsigned short		user_wired_count; 
+};
+
+typedef struct vm_region_submap_info_64		*vm_region_submap_info_64_t;
+typedef struct vm_region_submap_info_64		 vm_region_submap_info_data_64_t;
+
+#define VM_REGION_SUBMAP_INFO_COUNT_64		((mach_msg_type_number_t) \
+	(sizeof(vm_region_submap_info_data_64_t)/sizeof(int)))
+
+struct vm_region_submap_short_info_64 {
+	vm_prot_t		protection;     /* present access protection */
+	vm_prot_t		max_protection; /* max avail through vm_prot */
+	vm_inherit_t		inheritance;/* behavior of map/obj on fork */
+	memory_object_offset_t	offset;		/* offset into object/map */
+        unsigned int            user_tag;	/* user tag on map entry */
+        unsigned int            ref_count;	 /* obj/map mappers, etc */
+        unsigned short          shadow_depth; 	/* only for obj */
+        unsigned char           external_pager;  /* only for obj */
+        unsigned char           share_mode;	/* see enumeration */
+	boolean_t		is_submap;	/* submap vs obj */
+	vm_behavior_t		behavior;	/* access behavior hint */
+	vm32_object_id_t		object_id;	/* obj/map name, not a handle */
+	unsigned short		user_wired_count; 
+};
+
+typedef struct vm_region_submap_short_info_64	*vm_region_submap_short_info_64_t;
+typedef struct vm_region_submap_short_info_64	 vm_region_submap_short_info_data_64_t;
+
+#define VM_REGION_SUBMAP_SHORT_INFO_COUNT_64	((mach_msg_type_number_t) \
+	(sizeof(vm_region_submap_short_info_data_64_t)/sizeof(int)))
+
+
+struct mach_vm_read_entry {
+	mach_vm_address_t address;
+	mach_vm_size_t size;
+};
+
+struct vm_read_entry {
+	vm_address_t	address;
+	vm_size_t	size;
+};
+
+#if VM32_SUPPORT
+struct vm32_read_entry {
+	vm32_address_t	address;
+	vm32_size_t	size;
+};
+#endif
+
+
+#define VM_MAP_ENTRY_MAX  (256)
+
+typedef struct mach_vm_read_entry	mach_vm_read_entry_t[VM_MAP_ENTRY_MAX];
+typedef struct vm_read_entry		vm_read_entry_t[VM_MAP_ENTRY_MAX];
+#if VM32_SUPPORT
+typedef struct vm32_read_entry		vm32_read_entry_t[VM_MAP_ENTRY_MAX];
+#endif
+
+#pragma pack()
+
+
+#define VM_PAGE_INFO_MAX 
+typedef int *vm_page_info_t;
+typedef int vm_page_info_data_t[VM_PAGE_INFO_MAX];
+typedef int vm_page_info_flavor_t;
+
+#define VM_PAGE_INFO_BASIC		1
+struct vm_page_info_basic {
+	int			disposition;
+	int			ref_count;
+	vm_object_id_t		object_id;
+	memory_object_offset_t	offset;
+	int			depth;
+	int			__pad; /* pad to 64-bit boundary */
+};
+typedef struct vm_page_info_basic		*vm_page_info_basic_t;
+typedef struct vm_page_info_basic		vm_page_info_basic_data_t;
+
+#define VM_PAGE_INFO_BASIC_COUNT	((mach_msg_type_number_t) \
+	(sizeof(vm_page_info_basic_data_t)/sizeof(int)))
+
+
+#endif	/*_MACH_VM_REGION_H_*/
diff -urN cctools-806-old/include/mach/vm_statistics.h cctools-806/include/mach/vm_statistics.h
--- cctools-806-old/include/mach/vm_statistics.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_statistics.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,369 @@
+/*
+ * Copyright (c) 2000-2009 Apple Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ */
+/*
+ *	File:	mach/vm_statistics.h
+ *	Author:	Avadis Tevanian, Jr., Michael Wayne Young, David Golub
+ *
+ *	Virtual memory statistics structure.
+ *
+ */
+
+#ifndef	_MACH_VM_STATISTICS_H_
+#define	_MACH_VM_STATISTICS_H_
+
+#include <mach/machine/vm_types.h>
+
+
+/*
+ * vm_statistics
+ *
+ * History:
+ *	rev0 - 	original structure.
+ *	rev1 - 	added purgable info (purgable_count and purges).
+ *	rev2 - 	added speculative_count.
+ *
+ * Note: you cannot add any new fields to this structure. Add them below in
+ * 	 vm_statistics64.
+ */
+
+struct vm_statistics {
+	natural_t	free_count;		/* # of pages free */
+	natural_t	active_count;		/* # of pages active */
+	natural_t	inactive_count;		/* # of pages inactive */
+	natural_t	wire_count;		/* # of pages wired down */
+	natural_t	zero_fill_count;	/* # of zero fill pages */
+	natural_t	reactivations;		/* # of pages reactivated */
+	natural_t	pageins;		/* # of pageins */
+	natural_t	pageouts;		/* # of pageouts */
+	natural_t	faults;			/* # of faults */
+	natural_t	cow_faults;		/* # of copy-on-writes */
+	natural_t	lookups;		/* object cache lookups */
+	natural_t	hits;			/* object cache hits */
+
+	/* added for rev1 */
+	natural_t	purgeable_count;	/* # of pages purgeable */
+	natural_t	purges;			/* # of pages purged */
+
+	/* added for rev2 */
+	/*
+	 * NB: speculative pages are already accounted for in "free_count",
+	 * so "speculative_count" is the number of "free" pages that are
+	 * used to hold data that was read speculatively from disk but
+	 * haven't actually been used by anyone so far.
+	 */
+	natural_t	speculative_count;	/* # of pages speculative */
+};
+
+/* Used by all architectures */
+typedef struct vm_statistics	*vm_statistics_t;
+typedef struct vm_statistics	vm_statistics_data_t;
+
+/* 
+ * vm_statistics64
+ *
+ * History:
+ *	rev0 - 	original structure.
+ *	rev1 - 	added purgable info (purgable_count and purges).
+ *	rev2 - 	added speculative_count.
+ *	   ----
+ *	rev3 - 	changed name to vm_statistics64.
+ *		changed some fields in structure to 64-bit on 
+ *		arm, i386 and x86_64 architectures.
+ *	rev4 -  require 64-bit alignment for efficient access
+ *		in the kernel. No change to reported data.
+ *
+ */
+
+struct vm_statistics64 {
+	natural_t	free_count;		/* # of pages free */
+	natural_t	active_count;		/* # of pages active */
+	natural_t	inactive_count;		/* # of pages inactive */
+	natural_t	wire_count;		/* # of pages wired down */
+	uint64_t	zero_fill_count;	/* # of zero fill pages */
+	uint64_t	reactivations;		/* # of pages reactivated */
+	uint64_t	pageins;		/* # of pageins */
+	uint64_t	pageouts;		/* # of pageouts */
+	uint64_t	faults;			/* # of faults */
+	uint64_t	cow_faults;		/* # of copy-on-writes */
+	uint64_t	lookups;		/* object cache lookups */
+	uint64_t	hits;			/* object cache hits */
+
+	/* added for rev1 */
+	uint64_t	purges;			/* # of pages purged */
+	natural_t	purgeable_count;	/* # of pages purgeable */
+
+	/* added for rev2 */
+	/*
+	 * NB: speculative pages are already accounted for in "free_count",
+	 * so "speculative_count" is the number of "free" pages that are
+	 * used to hold data that was read speculatively from disk but
+	 * haven't actually been used by anyone so far.
+	 */
+	natural_t	speculative_count;	/* # of pages speculative */
+
+} __attribute__((aligned(8)));
+
+typedef struct vm_statistics64	*vm_statistics64_t;
+typedef struct vm_statistics64	vm_statistics64_data_t;
+
+/* 
+ * VM_STATISTICS_TRUNCATE_TO_32_BIT
+ *
+ * This is used by host_statistics() to truncate and peg the 64-bit in-kernel values from
+ * vm_statistics64 to the 32-bit values of the older structure above (vm_statistics).
+ */
+#define VM_STATISTICS_TRUNCATE_TO_32_BIT(value) ((uint32_t)(((value) > UINT32_MAX ) ? UINT32_MAX : (value)))
+
+/* 
+ * vm_extmod_statistics
+ *
+ * Structure to record modifications to a task by an
+ * external agent.
+ *
+ * History:
+ *	rev0 - 	original structure.
+ */
+
+struct vm_extmod_statistics {
+	int64_t	task_for_pid_count;			/* # of times task port was looked up */
+	int64_t task_for_pid_caller_count;	/* # of times this task called task_for_pid */
+	int64_t	thread_creation_count;		/* # of threads created in task */
+	int64_t	thread_creation_caller_count;	/* # of threads created by task */
+	int64_t	thread_set_state_count;		/* # of register state sets in task */
+	int64_t	thread_set_state_caller_count;	/* # of register state sets by task */
+} __attribute__((aligned(8)));
+
+typedef struct vm_extmod_statistics *vm_extmod_statistics_t;
+typedef struct vm_extmod_statistics vm_extmod_statistics_data_t;
+
+
+/* included for the vm_map_page_query call */
+
+#define VM_PAGE_QUERY_PAGE_PRESENT      0x1
+#define VM_PAGE_QUERY_PAGE_FICTITIOUS   0x2
+#define VM_PAGE_QUERY_PAGE_REF          0x4
+#define VM_PAGE_QUERY_PAGE_DIRTY        0x8
+#define VM_PAGE_QUERY_PAGE_PAGED_OUT    0x10
+#define VM_PAGE_QUERY_PAGE_COPIED       0x20
+#define VM_PAGE_QUERY_PAGE_SPECULATIVE	0x40
+#define VM_PAGE_QUERY_PAGE_EXTERNAL	0x80
+#define VM_PAGE_QUERY_PAGE_CS_VALIDATED	0x100
+#define VM_PAGE_QUERY_PAGE_CS_TAINTED	0x200
+
+
+/*
+ * VM allocation flags:
+ * 
+ * VM_FLAGS_FIXED
+ * 	(really the absence of VM_FLAGS_ANYWHERE)
+ *	Allocate new VM region at the specified virtual address, if possible.
+ * 
+ * VM_FLAGS_ANYWHERE
+ *	Allocate new VM region anywhere it would fit in the address space.
+ *
+ * VM_FLAGS_PURGABLE
+ *	Create a purgable VM object for that new VM region.
+ *
+ * VM_FLAGS_NO_PMAP_CHECK
+ *	(for DEBUG kernel config only, ignored for other configs)
+ *	Do not check that there is no stale pmap mapping for the new VM region.
+ *	This is useful for kernel memory allocations at bootstrap when building
+ *	the initial kernel address space while some memory is already in use.
+ *
+ * VM_FLAGS_OVERWRITE
+ *	The new VM region can replace existing VM regions if necessary
+ *	(to be used in combination with VM_FLAGS_FIXED).
+ *
+ * VM_FLAGS_NO_CACHE
+ *	Pages brought in to this VM region are placed on the speculative
+ *	queue instead of the active queue.  In other words, they are not
+ *	cached so that they will be stolen first if memory runs low.
+ */
+#define VM_FLAGS_FIXED		0x0000
+#define VM_FLAGS_ANYWHERE	0x0001
+#define VM_FLAGS_PURGABLE	0x0002
+#define VM_FLAGS_NO_CACHE	0x0010
+#define VM_FLAGS_OVERWRITE	0x4000	/* delete any existing mappings first */
+
+/*
+ * VM_FLAGS_SUPERPAGE_MASK
+ *	3 bits that specify whether large pages should be used instead of
+ *	base pages (!=0), as well as the requested page size.
+ */
+#define VM_FLAGS_SUPERPAGE_MASK	0x70000	/* bits 0x10000, 0x20000, 0x40000 */
+#define VM_FLAGS_SUPERPAGE_SHIFT 16
+
+#define SUPERPAGE_NONE			0	/* no superpages, if all bits are 0 */
+#define SUPERPAGE_SIZE_ANY		1
+#define VM_FLAGS_SUPERPAGE_NONE     (SUPERPAGE_NONE     << VM_FLAGS_SUPERPAGE_SHIFT)
+#define VM_FLAGS_SUPERPAGE_SIZE_ANY (SUPERPAGE_SIZE_ANY << VM_FLAGS_SUPERPAGE_SHIFT)
+#if defined(__x86_64__) || !defined(KERNEL)
+#define SUPERPAGE_SIZE_2MB		2
+#define VM_FLAGS_SUPERPAGE_SIZE_2MB (SUPERPAGE_SIZE_2MB<<VM_FLAGS_SUPERPAGE_SHIFT)
+#endif
+
+#define VM_FLAGS_ALIAS_MASK	0xFF000000
+#define VM_GET_FLAGS_ALIAS(flags, alias)			\
+		(alias) = ((flags) & VM_FLAGS_ALIAS_MASK) >> 24	
+#define VM_SET_FLAGS_ALIAS(flags, alias)			\
+		(flags) = (((flags) & ~VM_FLAGS_ALIAS_MASK) |	\
+		(((alias) & ~VM_FLAGS_ALIAS_MASK) << 24))
+
+/* These are the flags that we accept from user-space */
+#define VM_FLAGS_USER_ALLOCATE	(VM_FLAGS_FIXED |		\
+				 VM_FLAGS_ANYWHERE |		\
+				 VM_FLAGS_PURGABLE |		\
+				 VM_FLAGS_NO_CACHE |		\
+				 VM_FLAGS_OVERWRITE |		\
+				 VM_FLAGS_SUPERPAGE_MASK |	\
+				 VM_FLAGS_ALIAS_MASK)
+#define VM_FLAGS_USER_MAP	VM_FLAGS_USER_ALLOCATE
+#define VM_FLAGS_USER_REMAP	(VM_FLAGS_FIXED |    \
+				 VM_FLAGS_ANYWHERE | \
+				 VM_FLAGS_OVERWRITE)
+
+#define VM_MEMORY_MALLOC 1
+#define VM_MEMORY_MALLOC_SMALL 2
+#define VM_MEMORY_MALLOC_LARGE 3
+#define VM_MEMORY_MALLOC_HUGE 4
+#define VM_MEMORY_SBRK 5// uninteresting -- no one should call
+#define VM_MEMORY_REALLOC 6
+#define VM_MEMORY_MALLOC_TINY 7
+#define VM_MEMORY_MALLOC_LARGE_REUSABLE 8
+#define VM_MEMORY_MALLOC_LARGE_REUSED 9
+
+#define VM_MEMORY_ANALYSIS_TOOL 10
+
+#define VM_MEMORY_MACH_MSG 20
+#define VM_MEMORY_IOKIT	21
+#define VM_MEMORY_STACK  30
+#define VM_MEMORY_GUARD  31
+#define	VM_MEMORY_SHARED_PMAP 32
+/* memory containing a dylib */
+#define VM_MEMORY_DYLIB	33
+#define VM_MEMORY_OBJC_DISPATCHERS 34
+
+// Placeholders for now -- as we analyze the libraries and find how they
+// use memory, we can make these labels more specific.
+#define VM_MEMORY_APPKIT 40
+#define VM_MEMORY_FOUNDATION 41
+#define VM_MEMORY_COREGRAPHICS 42
+#define VM_MEMORY_CARBON 43
+#define VM_MEMORY_JAVA 44
+#define VM_MEMORY_ATS 50
+#define VM_MEMORY_LAYERKIT 51
+#define VM_MEMORY_CGIMAGE 52
+#define VM_MEMORY_TCMALLOC 53
+
+/* private raster data (i.e. layers, some images, QGL allocator) */
+#define	VM_MEMORY_COREGRAPHICS_DATA	54
+
+/* shared image and font caches */
+#define VM_MEMORY_COREGRAPHICS_SHARED	55
+
+/* Memory used for virtual framebuffers, shadowing buffers, etc... */
+#define	VM_MEMORY_COREGRAPHICS_FRAMEBUFFERS	56
+
+/* Window backing stores, custom shadow data, and compressed backing stores */
+#define VM_MEMORY_COREGRAPHICS_BACKINGSTORES	57
+
+/* catch-all for other uses, such as the read-only shared data page */
+#define VM_MEMORY_COREGRAPHICS_MISC VM_MEMORY_COREGRAPHICS
+
+/* memory allocated by the dynamic loader for itself */
+#define VM_MEMORY_DYLD 60
+/* malloc'd memory created by dyld */
+#define VM_MEMORY_DYLD_MALLOC 61
+
+/* Used for sqlite page cache */
+#define VM_MEMORY_SQLITE 62
+
+/* JavaScriptCore heaps */
+#define VM_MEMORY_JAVASCRIPT_CORE 63
+/* memory allocated for the JIT */
+#define VM_MEMORY_JAVASCRIPT_JIT_EXECUTABLE_ALLOCATOR 64
+#define VM_MEMORY_JAVASCRIPT_JIT_REGISTER_FILE 65
+
+/* memory allocated for GLSL */
+#define VM_MEMORY_GLSL  66
+
+/* memory allocated for OpenCL.framework */
+#define VM_MEMORY_OPENCL    67
+
+/* memory allocated for QuartzCore.framework */
+#define VM_MEMORY_COREIMAGE 68
+
+/* memory allocated for WebCore Purgeable Buffers */
+#define VM_MEMORY_WEBCORE_PURGEABLE_BUFFERS 69
+
+/* ImageIO memory */
+#define VM_MEMORY_IMAGEIO	70
+
+/* CoreProfile memory */
+#define VM_MEMORY_COREPROFILE	71
+
+/* assetsd / MobileSlideShow memory */
+#define VM_MEMORY_ASSETSD    72
+
+/* Reserve 240-255 for application */
+#define VM_MEMORY_APPLICATION_SPECIFIC_1 240
+#define VM_MEMORY_APPLICATION_SPECIFIC_16 255
+
+#define VM_MAKE_TAG(tag) ((tag) << 24)
+
+#endif	/* _MACH_VM_STATISTICS_H_ */
diff -urN cctools-806-old/include/mach/vm_sync.h cctools-806/include/mach/vm_sync.h
--- cctools-806-old/include/mach/vm_sync.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_sync.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,80 @@
+/*
+ * Copyright (c) 2000-2002 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1991,1990,1989,1988,1987 Carnegie Mellon University
+ * All Rights Reserved.
+ * 
+ * Permission to use, copy, modify and distribute this software and its
+ * documentation is hereby granted, provided that both the copyright
+ * notice and this permission notice appear in all copies of the
+ * software, derivative works or modified versions, and any portions
+ * thereof, and that both notices appear in supporting documentation.
+ * 
+ * CARNEGIE MELLON ALLOWS FREE USE OF THIS SOFTWARE IN ITS "AS IS"
+ * CONDITION.  CARNEGIE MELLON DISCLAIMS ANY LIABILITY OF ANY KIND FOR
+ * ANY DAMAGES WHATSOEVER RESULTING FROM THE USE OF THIS SOFTWARE.
+ * 
+ * Carnegie Mellon requests users of this software to return to
+ * 
+ *  Software Distribution Coordinator  or  Software.Distribution@CS.CMU.EDU
+ *  School of Computer Science
+ *  Carnegie Mellon University
+ *  Pittsburgh PA 15213-3890
+ * 
+ * any improvements or extensions that they make and grant Carnegie Mellon
+ * the rights to redistribute these changes.
+ */
+/*
+ *	File:	mach/vm_sync.h
+ *
+ *	Virtual memory synchronisation definitions.
+ *
+ */
+
+#ifndef _MACH_VM_SYNC_H_
+#define _MACH_VM_SYNC_H_
+
+typedef unsigned		vm_sync_t;
+
+/*
+ *	Synchronization flags, defined as bits within the vm_sync_t type
+ */
+
+#define	VM_SYNC_ASYNCHRONOUS	((vm_sync_t) 0x01)
+#define	VM_SYNC_SYNCHRONOUS	((vm_sync_t) 0x02)
+#define VM_SYNC_INVALIDATE	((vm_sync_t) 0x04)
+#define VM_SYNC_KILLPAGES       ((vm_sync_t) 0x08)
+#define VM_SYNC_DEACTIVATE      ((vm_sync_t) 0x10)
+#define VM_SYNC_CONTIGUOUS      ((vm_sync_t) 0x20)
+#define VM_SYNC_REUSABLEPAGES	((vm_sync_t) 0x40)
+
+#endif  /* _MACH_VM_SYNC_H_ */
diff -urN cctools-806-old/include/mach/vm_task.h cctools-806/include/mach/vm_task.h
--- cctools-806-old/include/mach/vm_task.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_task.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,34 @@
+/*
+ * Copyright (c) 2000 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+** This file contains compatibilty wrapper header for things that are
+** generated from mach/vm_map.defs into mach/vm_map.h. 
+** 
+** This file will go away eventually - please switch.
+*/
+#include <mach/vm_map.h>
diff -urN cctools-806-old/include/mach/vm_types.h cctools-806/include/mach/vm_types.h
--- cctools-806-old/include/mach/vm_types.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/vm_types.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,93 @@
+/*
+ * Copyright (c) 2000-2004 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/*
+ * @OSF_COPYRIGHT@
+ * 
+ */
+#ifndef	_MACH_VM_TYPES_H_
+#define _MACH_VM_TYPES_H_
+
+#include <mach/port.h>
+#include <mach/machine/vm_types.h>
+
+#include <stdint.h>
+
+typedef vm_offset_t     	pointer_t;
+typedef vm_offset_t     	vm_address_t;
+
+/*
+ * We use addr64_t for 64-bit addresses that are used on both
+ * 32 and 64-bit machines.  On PPC, they are passed and returned as
+ * two adjacent 32-bit GPRs.  We use addr64_t in places where
+ * common code must be useable both on 32 and 64-bit machines.
+ */
+typedef uint64_t addr64_t;		/* Basic effective address */
+
+/*
+ * We use reg64_t for addresses that are 32 bits on a 32-bit
+ * machine, and 64 bits on a 64-bit machine, but are always
+ * passed and returned in a single GPR on PPC.  This type
+ * cannot be used in generic 32-bit c, since on a 64-bit
+ * machine the upper half of the register will be ignored
+ * by the c compiler in 32-bit mode.  In c, we can only use the
+ * type in prototypes of functions that are written in and called
+ * from assembly language.  This type is basically a comment.
+ */
+typedef	uint32_t	reg64_t;
+
+/*
+ * To minimize the use of 64-bit fields, we keep some physical
+ * addresses (that are page aligned) as 32-bit page numbers. 
+ * This limits the physical address space to 16TB of RAM.
+ */
+typedef uint32_t ppnum_t;		/* Physical page number */
+#define PPNUM_MAX UINT32_MAX
+
+
+
+typedef mach_port_t		vm_map_t;
+
+
+#define VM_MAP_NULL		((vm_map_t) 0)
+
+/*
+ * Evolving definitions, likely to change.
+ */
+
+typedef uint64_t		vm_object_offset_t;
+typedef uint64_t		vm_object_size_t;
+
+
+typedef mach_port_t		upl_t;
+typedef mach_port_t		vm_named_entry_t;
+
+
+#define UPL_NULL		((upl_t) 0)
+#define VM_NAMED_ENTRY_NULL	((vm_named_entry_t) 0)
+
+#endif	/* _MACH_VM_TYPES_H_ */
diff -urN cctools-806-old/include/mach/x86_64/task.h cctools-806/include/mach/x86_64/task.h
--- cctools-806-old/include/mach/x86_64/task.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/x86_64/task.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1626 @@
+#ifndef	_task_user_
+#define	_task_user_
+
+/* Module task */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	task_MSG_COUNT
+#define	task_MSG_COUNT	35
+#endif	/* task_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+#include <mach_debug/mach_debug_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine task_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_create
+(
+	task_t target_task,
+	ledger_array_t ledgers,
+	mach_msg_type_number_t ledgersCnt,
+	boolean_t inherit_memory,
+	task_t *child_task
+);
+
+/* Routine task_terminate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_terminate
+(
+	task_t target_task
+);
+
+/* Routine task_threads */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_threads
+(
+	task_t target_task,
+	thread_act_array_t *act_list,
+	mach_msg_type_number_t *act_listCnt
+);
+
+/* Routine mach_ports_register */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_ports_register
+(
+	task_t target_task,
+	mach_port_array_t init_port_set,
+	mach_msg_type_number_t init_port_setCnt
+);
+
+/* Routine mach_ports_lookup */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t mach_ports_lookup
+(
+	task_t target_task,
+	mach_port_array_t *init_port_set,
+	mach_msg_type_number_t *init_port_setCnt
+);
+
+/* Routine task_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_info
+(
+	task_name_t target_task,
+	task_flavor_t flavor,
+	task_info_t task_info_out,
+	mach_msg_type_number_t *task_info_outCnt
+);
+
+/* Routine task_set_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_info
+(
+	task_t target_task,
+	task_flavor_t flavor,
+	task_info_t task_info_in,
+	mach_msg_type_number_t task_info_inCnt
+);
+
+/* Routine task_suspend */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_suspend
+(
+	task_t target_task
+);
+
+/* Routine task_resume */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_resume
+(
+	task_t target_task
+);
+
+/* Routine task_get_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_special_port
+(
+	task_t task,
+	int which_port,
+	mach_port_t *special_port
+);
+
+/* Routine task_set_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_special_port
+(
+	task_t task,
+	int which_port,
+	mach_port_t special_port
+);
+
+/* Routine thread_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_create
+(
+	task_t parent_task,
+	thread_act_t *child_act
+);
+
+/* Routine thread_create_running */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_create_running
+(
+	task_t parent_task,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt,
+	thread_act_t *child_act
+);
+
+/* Routine task_set_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor
+);
+
+/* Routine task_get_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine task_swap_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_swap_exception_ports
+(
+	task_t task,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlerss,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine lock_set_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_set_create
+(
+	task_t task,
+	lock_set_t *new_lock_set,
+	int n_ulocks,
+	int policy
+);
+
+/* Routine lock_set_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t lock_set_destroy
+(
+	task_t task,
+	lock_set_t lock_set
+);
+
+/* Routine semaphore_create */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t semaphore_create
+(
+	task_t task,
+	semaphore_t *semaphore,
+	int policy,
+	int value
+);
+
+/* Routine semaphore_destroy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t semaphore_destroy
+(
+	task_t task,
+	semaphore_t semaphore
+);
+
+/* Routine task_policy_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy_set
+(
+	task_t task,
+	task_policy_flavor_t flavor,
+	task_policy_t policy_info,
+	mach_msg_type_number_t policy_infoCnt
+);
+
+/* Routine task_policy_get */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy_get
+(
+	task_t task,
+	task_policy_flavor_t flavor,
+	task_policy_t policy_info,
+	mach_msg_type_number_t *policy_infoCnt,
+	boolean_t *get_default
+);
+
+/* Routine task_sample */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_sample
+(
+	task_t task,
+	mach_port_t reply
+);
+
+/* Routine task_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_policy
+(
+	task_t task,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	boolean_t set_limit,
+	boolean_t change
+);
+
+/* Routine task_set_emulation */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_emulation
+(
+	task_t target_port,
+	vm_address_t routine_entry_pt,
+	int routine_number
+);
+
+/* Routine task_get_emulation_vector */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_emulation_vector
+(
+	task_t task,
+	int *vector_start,
+	emulation_vector_t *emulation_vector,
+	mach_msg_type_number_t *emulation_vectorCnt
+);
+
+/* Routine task_set_emulation_vector */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_emulation_vector
+(
+	task_t task,
+	int vector_start,
+	emulation_vector_t emulation_vector,
+	mach_msg_type_number_t emulation_vectorCnt
+);
+
+/* Routine task_set_ras_pc */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_ras_pc
+(
+	task_t target_task,
+	vm_address_t basepc,
+	vm_address_t boundspc
+);
+
+/* Routine task_zone_info */
+/*#ifdef	mig_external
+mig_external
+#else
+extern
+#endif*/	/* mig_external */
+/* NOTE: These are defined in mach_debug directory in Kernel.framework */
+/*kern_return_t task_zone_info
+(
+	task_t target_task,
+	mach_zone_name_array_t *names,
+	mach_msg_type_number_t *namesCnt,
+	task_zone_info_array_t *info,
+	mach_msg_type_number_t *infoCnt
+);*/
+
+/* Routine task_assign */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_assign
+(
+	task_t task,
+	processor_set_t new_set,
+	boolean_t assign_threads
+);
+
+/* Routine task_assign_default */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_assign_default
+(
+	task_t task,
+	boolean_t assign_threads
+);
+
+/* Routine task_get_assignment */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_assignment
+(
+	task_t task,
+	processor_set_name_t *assigned_set
+);
+
+/* Routine task_set_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_policy
+(
+	task_t task,
+	processor_set_t pset,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	policy_limit_t limit,
+	mach_msg_type_number_t limitCnt,
+	boolean_t change
+);
+
+/* Routine task_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_get_state
+(
+	task_t task,
+	thread_state_flavor_t flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine task_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t task_set_state
+(
+	task_t task,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__task_subsystem__defined
+#define __Request__task_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t ledgers;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t ledgersCnt;
+		boolean_t inherit_memory;
+	} __Request__task_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t init_port_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t init_port_setCnt;
+	} __Request__mach_ports_register_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__mach_ports_lookup_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_flavor_t flavor;
+		mach_msg_type_number_t task_info_outCnt;
+	} __Request__task_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_flavor_t flavor;
+		mach_msg_type_number_t task_info_inCnt;
+		integer_t task_info_in[32];
+	} __Request__task_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__task_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__task_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__thread_create_running_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__task_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+	} __Request__task_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__task_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int n_ulocks;
+		int policy;
+	} __Request__lock_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t lock_set;
+		/* end of the kernel processed data */
+	} __Request__lock_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int policy;
+		int value;
+	} __Request__semaphore_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t semaphore;
+		/* end of the kernel processed data */
+	} __Request__semaphore_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+	} __Request__task_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		task_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		boolean_t get_default;
+	} __Request__task_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t reply;
+		/* end of the kernel processed data */
+	} __Request__task_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		boolean_t set_limit;
+		boolean_t change;
+	} __Request__task_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t routine_entry_pt;
+		int routine_number;
+	} __Request__task_set_emulation_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_get_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t emulation_vector;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int vector_start;
+		mach_msg_type_number_t emulation_vectorCnt;
+	} __Request__task_set_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		vm_address_t basepc;
+		vm_address_t boundspc;
+	} __Request__task_set_ras_pc_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		boolean_t assign_threads;
+	} __Request__task_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		boolean_t assign_threads;
+	} __Request__task_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__task_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pset;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		mach_msg_type_number_t limitCnt;
+		integer_t limit[1];
+		boolean_t change;
+	} __Request__task_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__task_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__task_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__task_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__task_subsystem__defined
+#define __RequestUnion__task_subsystem__defined
+union __RequestUnion__task_subsystem {
+	__Request__task_create_t Request_task_create;
+	__Request__task_terminate_t Request_task_terminate;
+	__Request__task_threads_t Request_task_threads;
+	__Request__mach_ports_register_t Request_mach_ports_register;
+	__Request__mach_ports_lookup_t Request_mach_ports_lookup;
+	__Request__task_info_t Request_task_info;
+	__Request__task_set_info_t Request_task_set_info;
+	__Request__task_suspend_t Request_task_suspend;
+	__Request__task_resume_t Request_task_resume;
+	__Request__task_get_special_port_t Request_task_get_special_port;
+	__Request__task_set_special_port_t Request_task_set_special_port;
+	__Request__thread_create_t Request_thread_create;
+	__Request__thread_create_running_t Request_thread_create_running;
+	__Request__task_set_exception_ports_t Request_task_set_exception_ports;
+	__Request__task_get_exception_ports_t Request_task_get_exception_ports;
+	__Request__task_swap_exception_ports_t Request_task_swap_exception_ports;
+	__Request__lock_set_create_t Request_lock_set_create;
+	__Request__lock_set_destroy_t Request_lock_set_destroy;
+	__Request__semaphore_create_t Request_semaphore_create;
+	__Request__semaphore_destroy_t Request_semaphore_destroy;
+	__Request__task_policy_set_t Request_task_policy_set;
+	__Request__task_policy_get_t Request_task_policy_get;
+	__Request__task_sample_t Request_task_sample;
+	__Request__task_policy_t Request_task_policy;
+	__Request__task_set_emulation_t Request_task_set_emulation;
+	__Request__task_get_emulation_vector_t Request_task_get_emulation_vector;
+	__Request__task_set_emulation_vector_t Request_task_set_emulation_vector;
+	__Request__task_set_ras_pc_t Request_task_set_ras_pc;
+	__Request__task_zone_info_t Request_task_zone_info;
+	__Request__task_assign_t Request_task_assign;
+	__Request__task_assign_default_t Request_task_assign_default;
+	__Request__task_get_assignment_t Request_task_get_assignment;
+	__Request__task_set_policy_t Request_task_set_policy;
+	__Request__task_get_state_t Request_task_get_state;
+	__Request__task_set_state_t Request_task_set_state;
+};
+#endif /* !__RequestUnion__task_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__task_subsystem__defined
+#define __Reply__task_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_task;
+		/* end of the kernel processed data */
+	} __Reply__task_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t act_list;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t act_listCnt;
+	} __Reply__task_threads_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__mach_ports_register_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_ports_descriptor_t init_port_set;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t init_port_setCnt;
+	} __Reply__mach_ports_lookup_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t task_info_outCnt;
+		integer_t task_info_out[32];
+	} __Reply__task_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+	} __Reply__task_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_act;
+		/* end of the kernel processed data */
+	} __Reply__thread_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t child_act;
+		/* end of the kernel processed data */
+	} __Reply__thread_create_running_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__task_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlerss[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__task_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_lock_set;
+		/* end of the kernel processed data */
+	} __Reply__lock_set_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__lock_set_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t semaphore;
+		/* end of the kernel processed data */
+	} __Reply__semaphore_create_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__semaphore_destroy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+		boolean_t get_default;
+	} __Reply__task_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_emulation_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t emulation_vector;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int vector_start;
+		mach_msg_type_number_t emulation_vectorCnt;
+	} __Reply__task_get_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_emulation_vector_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_ras_pc_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_ool_descriptor_t names;
+		mach_msg_ool_descriptor_t info;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t namesCnt;
+		mach_msg_type_number_t infoCnt;
+	} __Reply__task_zone_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t assigned_set;
+		/* end of the kernel processed data */
+	} __Reply__task_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[144];
+	} __Reply__task_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__task_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__task_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__task_subsystem__defined
+#define __ReplyUnion__task_subsystem__defined
+union __ReplyUnion__task_subsystem {
+	__Reply__task_create_t Reply_task_create;
+	__Reply__task_terminate_t Reply_task_terminate;
+	__Reply__task_threads_t Reply_task_threads;
+	__Reply__mach_ports_register_t Reply_mach_ports_register;
+	__Reply__mach_ports_lookup_t Reply_mach_ports_lookup;
+	__Reply__task_info_t Reply_task_info;
+	__Reply__task_set_info_t Reply_task_set_info;
+	__Reply__task_suspend_t Reply_task_suspend;
+	__Reply__task_resume_t Reply_task_resume;
+	__Reply__task_get_special_port_t Reply_task_get_special_port;
+	__Reply__task_set_special_port_t Reply_task_set_special_port;
+	__Reply__thread_create_t Reply_thread_create;
+	__Reply__thread_create_running_t Reply_thread_create_running;
+	__Reply__task_set_exception_ports_t Reply_task_set_exception_ports;
+	__Reply__task_get_exception_ports_t Reply_task_get_exception_ports;
+	__Reply__task_swap_exception_ports_t Reply_task_swap_exception_ports;
+	__Reply__lock_set_create_t Reply_lock_set_create;
+	__Reply__lock_set_destroy_t Reply_lock_set_destroy;
+	__Reply__semaphore_create_t Reply_semaphore_create;
+	__Reply__semaphore_destroy_t Reply_semaphore_destroy;
+	__Reply__task_policy_set_t Reply_task_policy_set;
+	__Reply__task_policy_get_t Reply_task_policy_get;
+	__Reply__task_sample_t Reply_task_sample;
+	__Reply__task_policy_t Reply_task_policy;
+	__Reply__task_set_emulation_t Reply_task_set_emulation;
+	__Reply__task_get_emulation_vector_t Reply_task_get_emulation_vector;
+	__Reply__task_set_emulation_vector_t Reply_task_set_emulation_vector;
+	__Reply__task_set_ras_pc_t Reply_task_set_ras_pc;
+	__Reply__task_zone_info_t Reply_task_zone_info;
+	__Reply__task_assign_t Reply_task_assign;
+	__Reply__task_assign_default_t Reply_task_assign_default;
+	__Reply__task_get_assignment_t Reply_task_get_assignment;
+	__Reply__task_set_policy_t Reply_task_set_policy;
+	__Reply__task_get_state_t Reply_task_get_state;
+	__Reply__task_set_state_t Reply_task_set_state;
+};
+#endif /* !__RequestUnion__task_subsystem__defined */
+
+#ifndef subsystem_to_name_map_task
+#define subsystem_to_name_map_task \
+    { "task_create", 3400 },\
+    { "task_terminate", 3401 },\
+    { "task_threads", 3402 },\
+    { "mach_ports_register", 3403 },\
+    { "mach_ports_lookup", 3404 },\
+    { "task_info", 3405 },\
+    { "task_set_info", 3406 },\
+    { "task_suspend", 3407 },\
+    { "task_resume", 3408 },\
+    { "task_get_special_port", 3409 },\
+    { "task_set_special_port", 3410 },\
+    { "thread_create", 3411 },\
+    { "thread_create_running", 3412 },\
+    { "task_set_exception_ports", 3413 },\
+    { "task_get_exception_ports", 3414 },\
+    { "task_swap_exception_ports", 3415 },\
+    { "lock_set_create", 3416 },\
+    { "lock_set_destroy", 3417 },\
+    { "semaphore_create", 3418 },\
+    { "semaphore_destroy", 3419 },\
+    { "task_policy_set", 3420 },\
+    { "task_policy_get", 3421 },\
+    { "task_sample", 3422 },\
+    { "task_policy", 3423 },\
+    { "task_set_emulation", 3424 },\
+    { "task_get_emulation_vector", 3425 },\
+    { "task_set_emulation_vector", 3426 },\
+    { "task_set_ras_pc", 3427 },\
+    { "task_zone_info", 3428 },\
+    { "task_assign", 3429 },\
+    { "task_assign_default", 3430 },\
+    { "task_get_assignment", 3431 },\
+    { "task_set_policy", 3432 },\
+    { "task_get_state", 3433 },\
+    { "task_set_state", 3434 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _task_user_ */
diff -urN cctools-806-old/include/mach/x86_64/thread_act.h cctools-806/include/mach/x86_64/thread_act.h
--- cctools-806-old/include/mach/x86_64/thread_act.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach/x86_64/thread_act.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,1155 @@
+#ifndef	_thread_act_user_
+#define	_thread_act_user_
+
+/* Module thread_act */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	thread_act_MSG_COUNT
+#define	thread_act_MSG_COUNT	25
+#endif	/* thread_act_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <mach/mig.h>
+#include <mach/mach_types.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine thread_terminate */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_terminate
+(
+	thread_act_t target_act
+);
+
+/* Routine act_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t act_get_state
+(
+	thread_act_t target_act,
+	int flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine act_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t act_set_state
+(
+	thread_act_t target_act,
+	int flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+/* Routine thread_get_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_state
+(
+	thread_act_t target_act,
+	thread_state_flavor_t flavor,
+	thread_state_t old_state,
+	mach_msg_type_number_t *old_stateCnt
+);
+
+/* Routine thread_set_state */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_state
+(
+	thread_act_t target_act,
+	thread_state_flavor_t flavor,
+	thread_state_t new_state,
+	mach_msg_type_number_t new_stateCnt
+);
+
+/* Routine thread_suspend */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_suspend
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_resume */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_resume
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_abort */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_abort
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_abort_safely */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_abort_safely
+(
+	thread_act_t target_act
+);
+
+/* Routine thread_depress_abort */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_depress_abort
+(
+	thread_act_t thread
+);
+
+/* Routine thread_get_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_special_port
+(
+	thread_act_t thr_act,
+	int which_port,
+	mach_port_t *special_port
+);
+
+/* Routine thread_set_special_port */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_special_port
+(
+	thread_act_t thr_act,
+	int which_port,
+	mach_port_t special_port
+);
+
+/* Routine thread_info */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_info
+(
+	thread_act_t target_act,
+	thread_flavor_t flavor,
+	thread_info_t thread_info_out,
+	mach_msg_type_number_t *thread_info_outCnt
+);
+
+/* Routine thread_set_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor
+);
+
+/* Routine thread_get_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine thread_swap_exception_ports */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_swap_exception_ports
+(
+	thread_act_t thread,
+	exception_mask_t exception_mask,
+	mach_port_t new_port,
+	exception_behavior_t behavior,
+	thread_state_flavor_t new_flavor,
+	exception_mask_array_t masks,
+	mach_msg_type_number_t *masksCnt,
+	exception_handler_array_t old_handlers,
+	exception_behavior_array_t old_behaviors,
+	exception_flavor_array_t old_flavors
+);
+
+/* Routine thread_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy
+(
+	thread_act_t thr_act,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	boolean_t set_limit
+);
+
+/* Routine thread_policy_set */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy_set
+(
+	thread_act_t thread,
+	thread_policy_flavor_t flavor,
+	thread_policy_t policy_info,
+	mach_msg_type_number_t policy_infoCnt
+);
+
+/* Routine thread_policy_get */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_policy_get
+(
+	thread_act_t thread,
+	thread_policy_flavor_t flavor,
+	thread_policy_t policy_info,
+	mach_msg_type_number_t *policy_infoCnt,
+	boolean_t *get_default
+);
+
+/* Routine thread_sample */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_sample
+(
+	thread_act_t thread,
+	mach_port_t reply
+);
+
+/* Routine etap_trace_thread */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t etap_trace_thread
+(
+	thread_act_t target_act,
+	boolean_t trace_status
+);
+
+/* Routine thread_assign */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_assign
+(
+	thread_act_t thread,
+	processor_set_t new_set
+);
+
+/* Routine thread_assign_default */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_assign_default
+(
+	thread_act_t thread
+);
+
+/* Routine thread_get_assignment */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_get_assignment
+(
+	thread_act_t thread,
+	processor_set_name_t *assigned_set
+);
+
+/* Routine thread_set_policy */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t thread_set_policy
+(
+	thread_act_t thr_act,
+	processor_set_t pset,
+	policy_t policy,
+	policy_base_t base,
+	mach_msg_type_number_t baseCnt,
+	policy_limit_t limit,
+	mach_msg_type_number_t limitCnt
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__thread_act_subsystem__defined
+#define __Request__thread_act_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__act_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__act_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t old_stateCnt;
+	} __Request__thread_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_state_flavor_t flavor;
+		mach_msg_type_number_t new_stateCnt;
+		natural_t new_state[144];
+	} __Request__thread_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_abort_safely_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_depress_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__thread_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		int which_port;
+	} __Request__thread_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_flavor_t flavor;
+		mach_msg_type_number_t thread_info_outCnt;
+	} __Request__thread_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__thread_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+	} __Request__thread_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_port;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		exception_mask_t exception_mask;
+		exception_behavior_t behavior;
+		thread_state_flavor_t new_flavor;
+	} __Request__thread_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		boolean_t set_limit;
+	} __Request__thread_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+	} __Request__thread_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		thread_policy_flavor_t flavor;
+		mach_msg_type_number_t policy_infoCnt;
+		boolean_t get_default;
+	} __Request__thread_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t reply;
+		/* end of the kernel processed data */
+	} __Request__thread_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		boolean_t trace_status;
+	} __Request__etap_trace_thread_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t new_set;
+		/* end of the kernel processed data */
+	} __Request__thread_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__thread_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t pset;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		policy_t policy;
+		mach_msg_type_number_t baseCnt;
+		integer_t base[5];
+		mach_msg_type_number_t limitCnt;
+		integer_t limit[1];
+	} __Request__thread_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__thread_act_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__thread_act_subsystem__defined
+#define __RequestUnion__thread_act_subsystem__defined
+union __RequestUnion__thread_act_subsystem {
+	__Request__thread_terminate_t Request_thread_terminate;
+	__Request__act_get_state_t Request_act_get_state;
+	__Request__act_set_state_t Request_act_set_state;
+	__Request__thread_get_state_t Request_thread_get_state;
+	__Request__thread_set_state_t Request_thread_set_state;
+	__Request__thread_suspend_t Request_thread_suspend;
+	__Request__thread_resume_t Request_thread_resume;
+	__Request__thread_abort_t Request_thread_abort;
+	__Request__thread_abort_safely_t Request_thread_abort_safely;
+	__Request__thread_depress_abort_t Request_thread_depress_abort;
+	__Request__thread_get_special_port_t Request_thread_get_special_port;
+	__Request__thread_set_special_port_t Request_thread_set_special_port;
+	__Request__thread_info_t Request_thread_info;
+	__Request__thread_set_exception_ports_t Request_thread_set_exception_ports;
+	__Request__thread_get_exception_ports_t Request_thread_get_exception_ports;
+	__Request__thread_swap_exception_ports_t Request_thread_swap_exception_ports;
+	__Request__thread_policy_t Request_thread_policy;
+	__Request__thread_policy_set_t Request_thread_policy_set;
+	__Request__thread_policy_get_t Request_thread_policy_get;
+	__Request__thread_sample_t Request_thread_sample;
+	__Request__etap_trace_thread_t Request_etap_trace_thread;
+	__Request__thread_assign_t Request_thread_assign;
+	__Request__thread_assign_default_t Request_thread_assign_default;
+	__Request__thread_get_assignment_t Request_thread_get_assignment;
+	__Request__thread_set_policy_t Request_thread_set_policy;
+};
+#endif /* !__RequestUnion__thread_act_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__thread_act_subsystem__defined
+#define __Reply__thread_act_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_terminate_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[144];
+	} __Reply__act_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__act_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t old_stateCnt;
+		natural_t old_state[144];
+	} __Reply__thread_get_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_state_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_suspend_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_resume_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_abort_safely_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_depress_abort_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t special_port;
+		/* end of the kernel processed data */
+	} __Reply__thread_get_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_special_port_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t thread_info_outCnt;
+		integer_t thread_info_out[12];
+	} __Reply__thread_info_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__thread_get_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t old_handlers[32];
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t masksCnt;
+		exception_mask_t masks[32];
+		exception_behavior_t old_behaviors[32];
+		thread_state_flavor_t old_flavors[32];
+	} __Reply__thread_swap_exception_ports_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_policy_set_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t policy_infoCnt;
+		integer_t policy_info[16];
+		boolean_t get_default;
+	} __Reply__thread_policy_get_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_sample_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__etap_trace_thread_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_assign_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_assign_default_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t assigned_set;
+		/* end of the kernel processed data */
+	} __Reply__thread_get_assignment_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__thread_set_policy_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__thread_act_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__thread_act_subsystem__defined
+#define __ReplyUnion__thread_act_subsystem__defined
+union __ReplyUnion__thread_act_subsystem {
+	__Reply__thread_terminate_t Reply_thread_terminate;
+	__Reply__act_get_state_t Reply_act_get_state;
+	__Reply__act_set_state_t Reply_act_set_state;
+	__Reply__thread_get_state_t Reply_thread_get_state;
+	__Reply__thread_set_state_t Reply_thread_set_state;
+	__Reply__thread_suspend_t Reply_thread_suspend;
+	__Reply__thread_resume_t Reply_thread_resume;
+	__Reply__thread_abort_t Reply_thread_abort;
+	__Reply__thread_abort_safely_t Reply_thread_abort_safely;
+	__Reply__thread_depress_abort_t Reply_thread_depress_abort;
+	__Reply__thread_get_special_port_t Reply_thread_get_special_port;
+	__Reply__thread_set_special_port_t Reply_thread_set_special_port;
+	__Reply__thread_info_t Reply_thread_info;
+	__Reply__thread_set_exception_ports_t Reply_thread_set_exception_ports;
+	__Reply__thread_get_exception_ports_t Reply_thread_get_exception_ports;
+	__Reply__thread_swap_exception_ports_t Reply_thread_swap_exception_ports;
+	__Reply__thread_policy_t Reply_thread_policy;
+	__Reply__thread_policy_set_t Reply_thread_policy_set;
+	__Reply__thread_policy_get_t Reply_thread_policy_get;
+	__Reply__thread_sample_t Reply_thread_sample;
+	__Reply__etap_trace_thread_t Reply_etap_trace_thread;
+	__Reply__thread_assign_t Reply_thread_assign;
+	__Reply__thread_assign_default_t Reply_thread_assign_default;
+	__Reply__thread_get_assignment_t Reply_thread_get_assignment;
+	__Reply__thread_set_policy_t Reply_thread_set_policy;
+};
+#endif /* !__RequestUnion__thread_act_subsystem__defined */
+
+#ifndef subsystem_to_name_map_thread_act
+#define subsystem_to_name_map_thread_act \
+    { "thread_terminate", 3600 },\
+    { "act_get_state", 3601 },\
+    { "act_set_state", 3602 },\
+    { "thread_get_state", 3603 },\
+    { "thread_set_state", 3604 },\
+    { "thread_suspend", 3605 },\
+    { "thread_resume", 3606 },\
+    { "thread_abort", 3607 },\
+    { "thread_abort_safely", 3608 },\
+    { "thread_depress_abort", 3609 },\
+    { "thread_get_special_port", 3610 },\
+    { "thread_set_special_port", 3611 },\
+    { "thread_info", 3612 },\
+    { "thread_set_exception_ports", 3613 },\
+    { "thread_get_exception_ports", 3614 },\
+    { "thread_swap_exception_ports", 3615 },\
+    { "thread_policy", 3616 },\
+    { "thread_policy_set", 3617 },\
+    { "thread_policy_get", 3618 },\
+    { "thread_sample", 3619 },\
+    { "etap_trace_thread", 3620 },\
+    { "thread_assign", 3621 },\
+    { "thread_assign_default", 3622 },\
+    { "thread_get_assignment", 3623 },\
+    { "thread_set_policy", 3624 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _thread_act_user_ */
diff -urN cctools-806-old/include/mach-o/arch-install.h cctools-806/include/mach-o/arch-install.h
--- cctools-806-old/include/mach-o/arch-install.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/mach-o/arch-install.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,110 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+#ifndef _MACH_O_ARCH_H_
+#define _MACH_O_ARCH_H_
+/*
+ * Copyright (c) 1997 Apple Computer, Inc.
+ *
+ * Functions that deal with information about architectures.
+ *
+ */
+
+#include <stdint.h>
+#include <mach-o/machine.h>
+
+enum NXByteOrder {
+  NX_UnknownByteOrder,
+  NX_LittleEndian,
+  NX_BigEndian
+};
+
+/* The NXArchInfo structs contain the architectures symbolic name
+ * (such as "ppc"), its CPU type and CPU subtype as defined in
+ * mach/machine.h, the byte order for the architecture, and a
+ * describing string (such as "PowerPC").
+ * There will both be entries for specific CPUs (such as ppc604e) as
+ * well as generic "family" entries (such as ppc).
+ */
+typedef struct {
+    const char *name;
+    cpu_type_t cputype;
+    cpu_subtype_t cpusubtype;
+    enum NXByteOrder byteorder;
+    const char *description;
+} NXArchInfo;
+
+#if __cplusplus
+extern "C" {
+#endif /* __cplusplus */
+
+/* NXGetAllArchInfos() returns a pointer to an array of all known
+ * NXArchInfo structures.  The last NXArchInfo is marked by a NULL name.
+ */
+extern const NXArchInfo *NXGetAllArchInfos(void);
+
+/* NXGetLocalArchInfo() returns the NXArchInfo for the local host, or NULL
+ * if none is known. 
+ */
+extern const NXArchInfo *NXGetLocalArchInfo(void);
+
+/* NXGetArchInfoFromName() and NXGetArchInfoFromCpuType() return the
+ * NXArchInfo from the architecture's name or cputype/cpusubtype
+ * combination.  A cpusubtype of CPU_SUBTYPE_MULTIPLE can be used
+ * to request the most general NXArchInfo known for the given cputype.
+ * NULL is returned if no matching NXArchInfo can be found.
+ */
+extern const NXArchInfo *NXGetArchInfoFromName(const char *name);
+extern const NXArchInfo *NXGetArchInfoFromCpuType(cpu_type_t cputype,
+						  cpu_subtype_t cpusubtype);
+
+/* NXFindBestFatArch() is passed a cputype and cpusubtype and a set of
+ * fat_arch structs and selects the best one that matches (if any) and returns
+ * a pointer to that fat_arch struct (or NULL).  The fat_arch structs must be
+ * in the host byte order and correct such that the fat_archs really points to
+ * enough memory for nfat_arch structs.  It is possible that this routine could
+ * fail if new cputypes or cpusubtypes are added and an old version of this
+ * routine is used.  But if there is an exact match between the cputype and
+ * cpusubtype and one of the fat_arch structs this routine will always succeed.
+ */
+extern struct fat_arch *NXFindBestFatArch(cpu_type_t cputype,
+					  cpu_subtype_t cpusubtype,
+					  struct fat_arch *fat_archs,
+					  uint32_t nfat_archs);
+
+/* NXCombineCpuSubtypes() returns the resulting cpusubtype when combining two
+ * different cpusubtypes for the specified cputype.  If the two cpusubtypes
+ * can't be combined (the specific subtypes are mutually exclusive) -1 is
+ * returned indicating it is an error to combine them.  This can also fail and
+ * return -1 if new cputypes or cpusubtypes are added and an old version of
+ * this routine is used.  But if the cpusubtypes are the same they can always
+ * be combined and this routine will return the cpusubtype pass in.
+ */
+extern cpu_subtype_t NXCombineCpuSubtypes(cpu_type_t cputype,
+					  cpu_subtype_t cpusubtype1,
+					  cpu_subtype_t cpusubtype2);
+
+#if __cplusplus
+};
+#endif /* __cplusplus */
+
+#endif /* _MACH_O_ARCH_H_ */
diff -urN cctools-806-old/include/Makefile cctools-806/include/Makefile
--- cctools-806-old/include/Makefile	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,186 +0,0 @@
-# Note that the macros are not used for the install target any more with the
-# change to the install(1) program.  Edit the install commands.
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-FILES = mach-o/ldsyms.h mach-o/reloc.h \
-	mach-o/nlist.h mach-o/stab.h mach-o/loader.h mach-o/fat.h \
-	mach-o/dyld_debug.h mach-o/arch.h mach-o/gmon.h mach-o/ranlib.h \
-	mach-o/swap.h mach-o/getsect.h mach-o/i386/swap.h \
-	mach-o/ppc/swap.h mach-o/ppc/reloc.h mach-o/x86_64/reloc.h \
-	mach-o/dyld.h mach-o/dyld_gdb.h mach-o/arm/reloc.h
-
-LOCFILES = mach-o/rld_state.h mach-o/rld.h mach-o/sarld.h mach-o/kld.h \
-	   mach-o/redo_prebinding.h \
-	   mach-o/i860/swap.h mach-o/i860/reloc.h \
-	   mach-o/hppa/swap.h mach-o/hppa/reloc.h \
-	   mach-o/m88k/swap.h mach-o/m88k/reloc.h \
-	   mach-o/m68k/swap.h \
-	   mach-o/sparc/swap.h mach-o/sparc/reloc.h \
-	   cbt/libsyminfo.h mach-o/dyld_priv.h
-
-# Note that OTHER_SRCS do NOT get installed
-GAS_OTHER_SRCS = stuff/bytesex.h stuff/bool.h stuff/rnd.h stuff/errors.h \
-		 stuff/openstep_mach.h opcode/arm.h
-OTHER_SRCS = notes gnu/symseg.h \
-	     stuff/allocate.h stuff/arch.h stuff/execute.h \
-	     stuff/ofile.h stuff/lto.h \
-	     stuff/hash_string.h stuff/breakout.h stuff/best_arch.h \
-	     stuff/hppa.h stuff/reloc.h stuff/vm_flush_cache.h \
-	     stuff/print.h stuff/version_number.h stuff/crc32.h sys/gmon.h \
-	     stuff/seg_addr_table.h stuff/dylib_table.h \
-	     stuff/SymLoc.h stuff/dylib_roots.h stuff/guess_short_name.h \
-	     stuff/macosx_deployment_target.h stuff/symbol_list.h \
-	     stuff/symbol.h stuff/unix_standard_mode.h \
-	     coff/base_relocs.h coff/bytesex.h coff/ms_dos_stub.h \
-	     coff/filehdr.h coff/aouthdr.h coff/scnhdr.h coff/syment.h \
-	     coff/debug_directory.h elf/dwarf2.h $(GAS_OTHER_SRCS)
-
-ENCUMBERED_SRCS = gnu/a.out.h gnu/exec.h
-
-# Note that MISSING_SRCS are those may not be on all build machines
-GAS_MISSING_SRCS = mach/m68k/thread_status.h \
-		   mach/i860/thread_status.h \
-		   mach/m88k/thread_status.h \
-		   architecture/m88k/fp_regs.h \
-		   architecture/m88k/reg_help.h \
-		   architecture/nrw/reg_help.h \
-		   architecture/nrw/macro_help.h \
-		   mach/hppa/thread_status.h \
-		   mach/sparc/thread_status.h \
-		   architecture/sparc/reg.h \
-		   mach/arm/thread_status.h \
-		   mach/ppc/thread_status.h \
-		   mach/ppc/_structs.h
-
-MISSING_SRCS = mach/machine.h \
-	       architecture/i386/fpu.h architecture/i386/frame.h \
-	       standalone/libsa.h \
-	       $(GAS_MISSING_SRCS)
-		
-nextstep_INCDIR = /NextDeveloper/Headers
-nextstep_LOCINCDIR = /LocalDeveloper/Headers
-
-teflon_INCDIR = /System/Library/Frameworks/System.framework/Versions/B/Headers
-teflon_LOCINCDIR = /System/Library/Frameworks/System.framework/Versions/B/PrivateHeaders
-
-ifeq "macos" "$(RC_OS)"
- macos_INCDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
-			    [ "$(RC_RELEASE)" = "Bunsen" ] ||    \
-			    [ "$(RC_RELEASE)" = "Gonzo"  ] ||    \
-			    [ "$(RC_RELEASE)" = "Kodiak" ]; then \
-	 echo /System/Library/Frameworks/System.framework/Versions/B/Headers; \
-	 else echo /usr/include; \
-	 fi; )
- macos_LOCINCDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
-			       [ "$(RC_RELEASE)" = "Bunsen" ] ||    \
-			       [ "$(RC_RELEASE)" = "Gonzo"  ] ||    \
-			       [ "$(RC_RELEASE)" = "Kodiak" ]; then \
- echo /System/Library/Frameworks/System.framework/Versions/B/PrivateHeaders; \
- else echo /usr/local/include; \
- fi; )
-else
-  macos_INCDIR = /System/Library/Frameworks/System.framework/Versions/B/Headers
-  macos_LOCINCDIR = /System/Library/Frameworks/System.framework/Versions/B/PrivateHeaders
-endif
-
-SRC_FILES = Makefile $(FILES) $(LOCFILES) $(OTHER_SRCS) $(MISSING_SRCS)
-GAS_SRC_FILES = Makefile $(GAS_OTHER_SRCS) $(GAS_MISSING_SRCS)
-ENCUMBERED_SRC_FILES = $(SRC_FILES) $(ENCUMBERED_SRCS)
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(ENCUMBERED_SRC_FILES) | (cd $(SRCROOT); gnutar xf -)
-
-installGASsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(GAS_SRC_FILES) | (cd $(SRCROOT); gnutar xf -)
-
-install: dirs $(RC_OS)_install
-
-teflon_install macos_install: common_install
-
-nextstep_install: common_install
-	cd mach-o; \
-	    install -c -m 444 ${IFLAGS} gmon.h \
-	    ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o
-
-common_install:
-	cd mach-o; \
-	    install -c -m 444 ${IFLAGS} arch.h ldsyms.h reloc.h \
-	    stab.h loader.h fat.h swap.h getsect.h nlist.h \
-	    ranlib.h ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o
-	if [ $(OLD_DYLD_STUFF) ];				\
-	then							\
-	    cd mach-o; install -c -m 444 ${IFLAGS} dyld.h dyld_debug.h	\
-		${DSTROOT}${$(RC_OS)_INCDIR}/mach-o ;		\
-	fi
-	cd mach-o/i386; \
-	    install -c -m 444 ${IFLAGS} swap.h \
-	    ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/i386
-	cd mach-o/ppc; \
-	    install -c -m 444 ${IFLAGS} reloc.h swap.h \
-	    ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/ppc
-	cd mach-o/x86_64; \
-	    install -c -m 444 ${IFLAGS} reloc.h \
-	    ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/x86_64
-	cd mach-o/arm; \
-	    install -c -m 444 ${IFLAGS} reloc.h \
-	    ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/arm
-	cd mach-o/m68k; \
-	    install -c -m 444 ${IFLAGS} swap.h \
-	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/m68k
-	cd mach-o/sparc; \
-	    install -c -m 444 ${IFLAGS} reloc.h swap.h \
-	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/sparc
-	cd mach-o/hppa; \
-	    install -c -m 444 ${IFLAGS} reloc.h swap.h \
-	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/hppa
-	cd mach-o/i860; \
-	    install -c -m 444 ${IFLAGS} reloc.h swap.h \
-	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/i860
-	cd mach-o/m88k; \
-	    install -c -m 444 ${IFLAGS} reloc.h swap.h \
-	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/m88k
-	cd mach-o; \
-	    install -c -m 444 ${IFLAGS} rld.h rld_state.h \
-	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o
-	if [ $(OLD_DYLD_STUFF) ];					  \
-	then								  \
-	    cd mach-o; install -c -m 444 ${IFLAGS} dyld_gdb.h dyld_priv.h \
-		${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o ;		  \
-	fi
-	cd mach-o; \
-	    install -c -m 444 ${IFLAGS} sarld.h kld.h redo_prebinding.h \
-	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o
-	cd stuff; \
-	    install -c -m 444 ${IFLAGS} bool.h \
-	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/dyld
-	cd cbt; \
-	    install -c -m 444 ${IFLAGS} libsyminfo.h \
-	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/cbt
-
-dirs:
-	$(MKDIRS) ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/i386
-	$(MKDIRS) ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/ppc
-	$(MKDIRS) ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/x86_64
-	$(MKDIRS) ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/arm
-	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/m68k
-	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/sparc
-	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/hppa
-	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/i860
-	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/m88k
-	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/dyld
-	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/cbt
-
-depend:
-
-clean shlib_clean:
-
-all:
diff -urN cctools-806-old/include/Makefile.apple cctools-806/include/Makefile.apple
--- cctools-806-old/include/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,186 @@
+# Note that the macros are not used for the install target any more with the
+# change to the install(1) program.  Edit the install commands.
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+FILES = mach-o/ldsyms.h mach-o/reloc.h \
+	mach-o/nlist.h mach-o/stab.h mach-o/loader.h mach-o/fat.h \
+	mach-o/dyld_debug.h mach-o/arch.h mach-o/gmon.h mach-o/ranlib.h \
+	mach-o/swap.h mach-o/getsect.h mach-o/i386/swap.h \
+	mach-o/ppc/swap.h mach-o/ppc/reloc.h mach-o/x86_64/reloc.h \
+	mach-o/dyld.h mach-o/dyld_gdb.h mach-o/arm/reloc.h
+
+LOCFILES = mach-o/rld_state.h mach-o/rld.h mach-o/sarld.h mach-o/kld.h \
+	   mach-o/redo_prebinding.h \
+	   mach-o/i860/swap.h mach-o/i860/reloc.h \
+	   mach-o/hppa/swap.h mach-o/hppa/reloc.h \
+	   mach-o/m88k/swap.h mach-o/m88k/reloc.h \
+	   mach-o/m68k/swap.h \
+	   mach-o/sparc/swap.h mach-o/sparc/reloc.h \
+	   cbt/libsyminfo.h mach-o/dyld_priv.h
+
+# Note that OTHER_SRCS do NOT get installed
+GAS_OTHER_SRCS = stuff/bytesex.h stuff/bool.h stuff/rnd.h stuff/errors.h \
+		 stuff/openstep_mach.h opcode/arm.h
+OTHER_SRCS = notes gnu/symseg.h \
+	     stuff/allocate.h stuff/arch.h stuff/execute.h \
+	     stuff/ofile.h stuff/lto.h \
+	     stuff/hash_string.h stuff/breakout.h stuff/best_arch.h \
+	     stuff/hppa.h stuff/reloc.h stuff/vm_flush_cache.h \
+	     stuff/print.h stuff/version_number.h stuff/crc32.h sys/gmon.h \
+	     stuff/seg_addr_table.h stuff/dylib_table.h \
+	     stuff/SymLoc.h stuff/dylib_roots.h stuff/guess_short_name.h \
+	     stuff/macosx_deployment_target.h stuff/symbol_list.h \
+	     stuff/symbol.h stuff/unix_standard_mode.h \
+	     coff/base_relocs.h coff/bytesex.h coff/ms_dos_stub.h \
+	     coff/filehdr.h coff/aouthdr.h coff/scnhdr.h coff/syment.h \
+	     coff/debug_directory.h elf/dwarf2.h $(GAS_OTHER_SRCS)
+
+ENCUMBERED_SRCS = gnu/a.out.h gnu/exec.h
+
+# Note that MISSING_SRCS are those may not be on all build machines
+GAS_MISSING_SRCS = mach/m68k/thread_status.h \
+		   mach/i860/thread_status.h \
+		   mach/m88k/thread_status.h \
+		   architecture/m88k/fp_regs.h \
+		   architecture/m88k/reg_help.h \
+		   architecture/nrw/reg_help.h \
+		   architecture/nrw/macro_help.h \
+		   mach/hppa/thread_status.h \
+		   mach/sparc/thread_status.h \
+		   architecture/sparc/reg.h \
+		   mach/arm/thread_status.h \
+		   mach/ppc/thread_status.h \
+		   mach/ppc/_structs.h
+
+MISSING_SRCS = mach/machine.h \
+	       architecture/i386/fpu.h architecture/i386/frame.h \
+	       standalone/libsa.h \
+	       $(GAS_MISSING_SRCS)
+		
+nextstep_INCDIR = /NextDeveloper/Headers
+nextstep_LOCINCDIR = /LocalDeveloper/Headers
+
+teflon_INCDIR = /System/Library/Frameworks/System.framework/Versions/B/Headers
+teflon_LOCINCDIR = /System/Library/Frameworks/System.framework/Versions/B/PrivateHeaders
+
+ifeq "macos" "$(RC_OS)"
+ macos_INCDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
+			    [ "$(RC_RELEASE)" = "Bunsen" ] ||    \
+			    [ "$(RC_RELEASE)" = "Gonzo"  ] ||    \
+			    [ "$(RC_RELEASE)" = "Kodiak" ]; then \
+	 echo /System/Library/Frameworks/System.framework/Versions/B/Headers; \
+	 else echo /usr/include; \
+	 fi; )
+ macos_LOCINCDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
+			       [ "$(RC_RELEASE)" = "Bunsen" ] ||    \
+			       [ "$(RC_RELEASE)" = "Gonzo"  ] ||    \
+			       [ "$(RC_RELEASE)" = "Kodiak" ]; then \
+ echo /System/Library/Frameworks/System.framework/Versions/B/PrivateHeaders; \
+ else echo /usr/local/include; \
+ fi; )
+else
+  macos_INCDIR = /System/Library/Frameworks/System.framework/Versions/B/Headers
+  macos_LOCINCDIR = /System/Library/Frameworks/System.framework/Versions/B/PrivateHeaders
+endif
+
+SRC_FILES = Makefile $(FILES) $(LOCFILES) $(OTHER_SRCS) $(MISSING_SRCS)
+GAS_SRC_FILES = Makefile $(GAS_OTHER_SRCS) $(GAS_MISSING_SRCS)
+ENCUMBERED_SRC_FILES = $(SRC_FILES) $(ENCUMBERED_SRCS)
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(ENCUMBERED_SRC_FILES) | (cd $(SRCROOT); gnutar xf -)
+
+installGASsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(GAS_SRC_FILES) | (cd $(SRCROOT); gnutar xf -)
+
+install: dirs $(RC_OS)_install
+
+teflon_install macos_install: common_install
+
+nextstep_install: common_install
+	cd mach-o; \
+	    install -c -m 444 ${IFLAGS} gmon.h \
+	    ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o
+
+common_install:
+	cd mach-o; \
+	    install -c -m 444 ${IFLAGS} arch.h ldsyms.h reloc.h \
+	    stab.h loader.h fat.h swap.h getsect.h nlist.h \
+	    ranlib.h ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o
+	if [ $(OLD_DYLD_STUFF) ];				\
+	then							\
+	    cd mach-o; install -c -m 444 ${IFLAGS} dyld.h dyld_debug.h	\
+		${DSTROOT}${$(RC_OS)_INCDIR}/mach-o ;		\
+	fi
+	cd mach-o/i386; \
+	    install -c -m 444 ${IFLAGS} swap.h \
+	    ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/i386
+	cd mach-o/ppc; \
+	    install -c -m 444 ${IFLAGS} reloc.h swap.h \
+	    ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/ppc
+	cd mach-o/x86_64; \
+	    install -c -m 444 ${IFLAGS} reloc.h \
+	    ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/x86_64
+	cd mach-o/arm; \
+	    install -c -m 444 ${IFLAGS} reloc.h \
+	    ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/arm
+	cd mach-o/m68k; \
+	    install -c -m 444 ${IFLAGS} swap.h \
+	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/m68k
+	cd mach-o/sparc; \
+	    install -c -m 444 ${IFLAGS} reloc.h swap.h \
+	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/sparc
+	cd mach-o/hppa; \
+	    install -c -m 444 ${IFLAGS} reloc.h swap.h \
+	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/hppa
+	cd mach-o/i860; \
+	    install -c -m 444 ${IFLAGS} reloc.h swap.h \
+	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/i860
+	cd mach-o/m88k; \
+	    install -c -m 444 ${IFLAGS} reloc.h swap.h \
+	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/m88k
+	cd mach-o; \
+	    install -c -m 444 ${IFLAGS} rld.h rld_state.h \
+	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o
+	if [ $(OLD_DYLD_STUFF) ];					  \
+	then								  \
+	    cd mach-o; install -c -m 444 ${IFLAGS} dyld_gdb.h dyld_priv.h \
+		${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o ;		  \
+	fi
+	cd mach-o; \
+	    install -c -m 444 ${IFLAGS} sarld.h kld.h redo_prebinding.h \
+	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o
+	cd stuff; \
+	    install -c -m 444 ${IFLAGS} bool.h \
+	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/dyld
+	cd cbt; \
+	    install -c -m 444 ${IFLAGS} libsyminfo.h \
+	    ${DSTROOT}${$(RC_OS)_LOCINCDIR}/cbt
+
+dirs:
+	$(MKDIRS) ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/i386
+	$(MKDIRS) ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/ppc
+	$(MKDIRS) ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/x86_64
+	$(MKDIRS) ${DSTROOT}${$(RC_OS)_INCDIR}/mach-o/arm
+	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/m68k
+	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/sparc
+	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/hppa
+	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/i860
+	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/mach-o/m88k
+	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/dyld
+	$(MKDIRS) ${DSTROOT}${$(RC_OS)_LOCINCDIR}/cbt
+
+depend:
+
+clean shlib_clean:
+
+all:
diff -urN cctools-806-old/include/Makefile.in cctools-806/include/Makefile.in
--- cctools-806-old/include/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,35 @@
+builddir = @builddir@
+top_builddir = @top_builddir@
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+
+prefix	= @prefix@
+datarootdir = @datarootdir@
+datadir=@datadir@
+exec_prefix	= @exec_prefix@
+mandir		= @mandir@
+includedir	= @includedir@
+
+VPATH = @srcdir@
+
+INSTALL		= @INSTALL@
+INSTALL_PROGRAM = @INSTALL_PROGRAM@
+INSTALL_DATA	= @INSTALL_DATA@
+
+.PHONY: default install clean distclean
+
+default:
+
+install: 
+	mkdir -p $(DESTDIR)$(includedir)
+	mkdir -p $(DESTDIR)$(includedir)/mach-o
+	for h in loader.h fat.h; do		\
+		$(INSTALL_DATA) $(srcdir)/mach-o/$$h		\
+			$(DESTDIR)$(includedir)/mach-o/$$h;	\
+	done
+	$(INSTALL_DATA) $(srcdir)/mach-o/arch-install.h \
+		$(DESTDIR)$(includedir)/mach-o/arch.h
+	$(INSTALL_DATA) $(srcdir)/mach/machine.h \
+		$(DESTDIR)$(includedir)/mach-o/
+
+clean:
diff -urN cctools-806-old/include/malloc/malloc.h cctools-806/include/malloc/malloc.h
--- cctools-806-old/include/malloc/malloc.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/malloc/malloc.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,268 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_LICENSE_HEADER_END@
+ */
+
+#ifndef _MALLOC_MALLOC_H_
+#define _MALLOC_MALLOC_H_
+
+#include <stddef.h>
+#include <mach/mach_types.h>
+#include <sys/cdefs.h>
+#include <Availability.h>
+
+__BEGIN_DECLS
+/*********	Type definitions	************/
+
+typedef struct _malloc_zone_t {
+    /* Only zone implementors should depend on the layout of this structure;
+    Regular callers should use the access functions below */
+    void	*reserved1;	/* RESERVED FOR CFAllocator DO NOT USE */
+    void	*reserved2;	/* RESERVED FOR CFAllocator DO NOT USE */
+    size_t 	(*size)(struct _malloc_zone_t *zone, const void *ptr); /* returns the size of a block or 0 if not in this zone; must be fast, especially for negative answers */
+    void 	*(*malloc)(struct _malloc_zone_t *zone, size_t size);
+    void 	*(*calloc)(struct _malloc_zone_t *zone, size_t num_items, size_t size); /* same as malloc, but block returned is set to zero */
+    void 	*(*valloc)(struct _malloc_zone_t *zone, size_t size); /* same as malloc, but block returned is set to zero and is guaranteed to be page aligned */
+    void 	(*free)(struct _malloc_zone_t *zone, void *ptr);
+    void 	*(*realloc)(struct _malloc_zone_t *zone, void *ptr, size_t size);
+    void 	(*destroy)(struct _malloc_zone_t *zone); /* zone is destroyed and all memory reclaimed */
+    const char	*zone_name;
+
+    /* Optional batch callbacks; these may be NULL */
+    unsigned	(*batch_malloc)(struct _malloc_zone_t *zone, size_t size, void **results, unsigned num_requested); /* given a size, returns pointers capable of holding that size; returns the number of pointers allocated (maybe 0 or less than num_requested) */
+    void	(*batch_free)(struct _malloc_zone_t *zone, void **to_be_freed, unsigned num_to_be_freed); /* frees all the pointers in to_be_freed; note that to_be_freed may be overwritten during the process */
+
+    struct malloc_introspection_t	*introspect;
+    unsigned	version;
+    
+    /* aligned memory allocation. The callback may be NULL. Present in version >= 5. */
+    void *(*memalign)(struct _malloc_zone_t *zone, size_t alignment, size_t size);
+    
+    /* free a pointer known to be in zone and known to have the given size. The callback may be NULL. Present in version >= 6.*/
+    void (*free_definite_size)(struct _malloc_zone_t *zone, void *ptr, size_t size);
+
+    /* Empty out caches in the face of memory pressure. The callback may be NULL. Present in version >= 8. */
+    size_t 	(*pressure_relief)(struct _malloc_zone_t *zone, size_t goal);
+} malloc_zone_t;
+
+/*********	Creation and destruction	************/
+
+extern malloc_zone_t *malloc_default_zone(void);
+    /* The initial zone */
+
+extern malloc_zone_t *malloc_create_zone(vm_size_t start_size, unsigned flags);
+    /* Creates a new zone with default behavior and registers it */
+
+extern void malloc_destroy_zone(malloc_zone_t *zone);
+    /* Destroys zone and everything it allocated */
+
+/*********	Block creation and manipulation	************/
+
+extern void *malloc_zone_malloc(malloc_zone_t *zone, size_t size);
+    /* Allocates a new pointer of size size; zone must be non-NULL */
+
+extern void *malloc_zone_calloc(malloc_zone_t *zone, size_t num_items, size_t size);
+    /* Allocates a new pointer of size num_items * size; block is cleared; zone must be non-NULL */
+
+extern void *malloc_zone_valloc(malloc_zone_t *zone, size_t size);
+    /* Allocates a new pointer of size size; zone must be non-NULL; Pointer is guaranteed to be page-aligned and block is cleared */
+
+extern void malloc_zone_free(malloc_zone_t *zone, void *ptr);
+    /* Frees pointer in zone; zone must be non-NULL */
+
+extern void *malloc_zone_realloc(malloc_zone_t *zone, void *ptr, size_t size);
+    /* Enlarges block if necessary; zone must be non-NULL */
+
+extern malloc_zone_t *malloc_zone_from_ptr(const void *ptr);
+    /* Returns the zone for a pointer, or NULL if not in any zone.
+    The ptr must have been returned from a malloc or realloc call. */
+
+extern size_t malloc_size(const void *ptr);
+    /* Returns size of given ptr */
+
+extern size_t malloc_good_size(size_t size);
+    /* Returns number of bytes greater than or equal to size that can be allocated without padding */
+
+extern void *malloc_zone_memalign(malloc_zone_t *zone, size_t alignment, size_t size) __OSX_AVAILABLE_STARTING(__MAC_10_6, __IPHONE_3_0);
+    /* 
+     * Allocates a new pointer of size size whose address is an exact multiple of alignment.
+     * alignment must be a power of two and at least as large as sizeof(void *).
+     * zone must be non-NULL.
+     */
+
+/*********	Batch methods	************/
+
+extern unsigned malloc_zone_batch_malloc(malloc_zone_t *zone, size_t size, void **results, unsigned num_requested);
+    /* Allocates num blocks of the same size; Returns the number truly allocated (may be 0) */
+
+extern void malloc_zone_batch_free(malloc_zone_t *zone, void **to_be_freed, unsigned num);
+    /* frees all the pointers in to_be_freed; note that to_be_freed may be overwritten during the process; This function will always free even if the zone has no batch callback */
+
+/*********	Functions for libcache	************/
+
+extern malloc_zone_t *malloc_default_purgeable_zone(void) __OSX_AVAILABLE_STARTING(__MAC_10_6, __IPHONE_3_0);
+    /* Returns a pointer to the default purgeable_zone. */
+
+extern void malloc_make_purgeable(void *ptr) __OSX_AVAILABLE_STARTING(__MAC_10_6, __IPHONE_3_0);
+    /* Make an allocation from the purgeable zone purgeable if possible.  */
+
+extern int malloc_make_nonpurgeable(void *ptr) __OSX_AVAILABLE_STARTING(__MAC_10_6, __IPHONE_3_0);
+    /* Makes an allocation from the purgeable zone nonpurgeable.
+     * Returns zero if the contents were not purged since the last
+     * call to malloc_make_purgeable, else returns non-zero. */
+
+/*********	Functions for zone implementors	************/
+
+extern void malloc_zone_register(malloc_zone_t *zone);
+    /* Registers a custom malloc zone; Should typically be called after a 
+     * malloc_zone_t has been filled in with custom methods by a client.  See
+     * malloc_create_zone for creating additional malloc zones with the
+     * default allocation and free behavior. */
+
+extern void malloc_zone_unregister(malloc_zone_t *zone);
+    /* De-registers a zone
+    Should typically be called before calling the zone destruction routine */
+
+extern void malloc_set_zone_name(malloc_zone_t *zone, const char *name);
+    /* Sets the name of a zone */
+
+extern const char *malloc_get_zone_name(malloc_zone_t *zone);
+    /* Returns the name of a zone */
+
+size_t malloc_zone_pressure_relief(malloc_zone_t *zone, size_t goal) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
+    /* malloc_zone_pressure_relief() advises the malloc subsystem that the process is under memory pressure and 
+     * that the subsystem should make its best effort towards releasing (i.e. munmap()-ing) "goal" bytes from "zone". 
+     * If "goal" is passed as zero, the malloc subsystem will attempt to achieve maximal pressure relief in "zone". 
+     * If "zone" is passed as NULL, all zones are examined for pressure relief opportunities. 
+     * malloc_zone_pressure_relief() returns the number of bytes released. 
+     */
+
+typedef struct {
+    vm_address_t	address;
+    vm_size_t		size;
+} vm_range_t;
+
+typedef struct malloc_statistics_t {
+    unsigned	blocks_in_use;
+    size_t	size_in_use;
+    size_t	max_size_in_use;	/* high water mark of touched memory */
+    size_t	size_allocated;		/* reserved in memory */
+} malloc_statistics_t;
+
+typedef kern_return_t memory_reader_t(task_t remote_task, vm_address_t remote_address, vm_size_t size, void **local_memory);
+    /* given a task, "reads" the memory at the given address and size
+local_memory: set to a contiguous chunk of memory; validity of local_memory is assumed to be limited (until next call) */
+
+#define MALLOC_PTR_IN_USE_RANGE_TYPE	1	/* for allocated pointers */
+#define MALLOC_PTR_REGION_RANGE_TYPE	2	/* for region containing pointers */
+#define MALLOC_ADMIN_REGION_RANGE_TYPE	4	/* for region used internally */
+#define MALLOC_ZONE_SPECIFIC_FLAGS	0xff00	/* bits reserved for zone-specific purposes */
+
+typedef void vm_range_recorder_t(task_t, void *, unsigned type, vm_range_t *, unsigned);
+    /* given a task and context, "records" the specified addresses */
+
+typedef struct malloc_introspection_t {
+    kern_return_t (*enumerator)(task_t task, void *, unsigned type_mask, vm_address_t zone_address, memory_reader_t reader, vm_range_recorder_t recorder); /* enumerates all the malloc pointers in use */
+    size_t	(*good_size)(malloc_zone_t *zone, size_t size);
+    boolean_t 	(*check)(malloc_zone_t *zone); /* Consistency checker */
+    void 	(*print)(malloc_zone_t *zone, boolean_t verbose); /* Prints zone  */
+    void	(*log)(malloc_zone_t *zone, void *address); /* Enables logging of activity */
+    void	(*force_lock)(malloc_zone_t *zone); /* Forces locking zone */
+    void	(*force_unlock)(malloc_zone_t *zone); /* Forces unlocking zone */
+    void	(*statistics)(malloc_zone_t *zone, malloc_statistics_t *stats); /* Fills statistics */
+    boolean_t   (*zone_locked)(malloc_zone_t *zone); /* Are any zone locks held */
+
+    /* Discharge checking. Present in version >= 7. */
+    boolean_t	(*enable_discharge_checking)(malloc_zone_t *zone);
+    void	(*disable_discharge_checking)(malloc_zone_t *zone);
+    void	(*discharge)(malloc_zone_t *zone, void *memory);
+#ifdef __BLOCKS__
+    void        (*enumerate_discharged_pointers)(malloc_zone_t *zone, void (^report_discharged)(void *memory, void *info));
+#else
+    void	*enumerate_unavailable_without_blocks;   
+#endif /* __BLOCKS__ */
+} malloc_introspection_t;
+
+extern void malloc_printf(const char *format, ...);
+    /* Convenience for logging errors and warnings;
+    No allocation is performed during execution of this function;
+    Only understands usual %p %d %s formats, and %y that expresses a number of bytes (5b,10KB,1MB...)
+    */
+
+/*********	Functions for performance tools	************/
+
+extern kern_return_t malloc_get_all_zones(task_t task, memory_reader_t reader, vm_address_t **addresses, unsigned *count);
+    /* Fills addresses and count with the addresses of the zones in task;
+    Note that the validity of the addresses returned correspond to the validity of the memory returned by reader */
+
+/*********	Debug helpers	************/
+
+extern void malloc_zone_print_ptr_info(void *ptr);
+    /* print to stdout if this pointer is in the malloc heap, free status, and size */
+
+extern boolean_t malloc_zone_check(malloc_zone_t *zone);
+    /* Checks zone is well formed; if !zone, checks all zones */
+
+extern void malloc_zone_print(malloc_zone_t *zone, boolean_t verbose);
+    /* Prints summary on zone; if !zone, prints all zones */
+
+extern void malloc_zone_statistics(malloc_zone_t *zone, malloc_statistics_t *stats);
+    /* Fills statistics for zone; if !zone, sums up all zones */
+
+extern void malloc_zone_log(malloc_zone_t *zone, void *address);
+    /* Controls logging of all activity; if !zone, for all zones;
+    If address==0 nothing is logged;
+    If address==-1 all activity is logged;
+    Else only the activity regarding address is logged */
+
+struct mstats {
+    size_t	bytes_total;
+    size_t	chunks_used;
+    size_t	bytes_used;
+    size_t	chunks_free;
+    size_t	bytes_free;
+};
+
+extern struct mstats mstats(void);
+
+extern boolean_t malloc_zone_enable_discharge_checking(malloc_zone_t *zone) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
+/* Increment the discharge checking enabled counter for a zone. Returns true if the zone supports checking, false if it does not. */
+
+extern void malloc_zone_disable_discharge_checking(malloc_zone_t *zone) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
+/* Decrement the discharge checking enabled counter for a zone. */
+
+extern void malloc_zone_discharge(malloc_zone_t *zone, void *memory) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
+/* Register memory that the programmer expects to be freed soon. 
+   zone may be NULL in which case the zone is determined using malloc_zone_from_ptr(). 
+   If discharge checking is off for the zone this function is a no-op. */
+ 
+#ifdef __BLOCKS__
+extern void malloc_zone_enumerate_discharged_pointers(malloc_zone_t *zone, void (^report_discharged)(void *memory, void *info)) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
+/* Calls report_discharged for each block that was registered using malloc_zone_discharge() but has not yet been freed. 
+   info is used to provide zone defined information about the memory block. 
+   If zone is NULL then the enumeration covers all zones. */
+#else
+extern void malloc_zone_enumerate_discharged_pointers(malloc_zone_t *zone, void *) __OSX_AVAILABLE_STARTING(__MAC_10_7, __IPHONE_4_3);
+#endif /* __BLOCKS__ */
+
+__END_DECLS
+
+#endif /* _MALLOC_MALLOC_H_ */
diff -urN cctools-806-old/include/servers/bootstrap_defs.h cctools-806/include/servers/bootstrap_defs.h
--- cctools-806-old/include/servers/bootstrap_defs.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/servers/bootstrap_defs.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,358 @@
+#ifndef _BOOTSTRAP_H_
+#define _BOOTSTRAP_H_
+/*
+ * Copyright (c) 1999-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_APACHE_LICENSE_HEADER_START@
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ * 
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ * 
+ * @APPLE_APACHE_LICENSE_HEADER_END@
+ */
+
+/*
+ * bootstrap -- fundamental service initiator and port server
+ * Mike DeMoney, NeXT, Inc.
+ * Copyright, 1990.  All rights reserved.
+ */
+
+/*
+ *	Interface:	Bootstrap server
+ *
+ *  The bootstrap server is the first user-mode task initiated by the Mach
+ *  kernel at system boot time.  The bootstrap server provides two services,
+ *  it initiates other system tasks, and manages a table of name-port bindings
+ *  for fundamental system services  (e.g. lookupd, Window Manager, etc...).
+ *
+ *  Name-port bindings can be established with the bootstrap server by either 
+ *  of two mechanisms:
+ *
+ *  1.  The binding can be indicated, in advance of the service that backs it
+ *  being available, via a "service create" request.  In this case, bootstrap
+ *  will immediately create a port and bind the indicated name with that port.
+ *  At a later time, a service may "checkin" for the name-port
+ *  binding and will be returned receive rights for the bound port.  Lookup's
+ *  on bindings created by this mechanism will return send rights to the port,
+ *  even if no service has "checked-in".  In this case, requests sent to the
+ *  bound port will be queued until a server has checked-in and can satisfy the
+ *  request.
+ *
+ *  2.  Bindings can be established dynamically via a "register" request.  In
+ *  this case, the register request provides bootstrap with a name and send
+ *  rights for a port.  Bootstrap will provide send rights for the bound port
+ *  to any requestor via the lookup request.
+ *
+ *  Bootstrap provides its service port to descendant tasks via the Mach
+ *  "bootstrap" special task port.  All direct descendants of bootstrap receive
+ *  a "privileged" bootstrap service port.  System services that initiate
+ *  untrusted tasks should replace the Mach bootstrap task special port with
+ *  a subset bootstrap port to prevent them from infecting the namespace.
+ *
+ *  The bootstrap server creates a "backup" port for each service that it
+ *  creates.  This is used to detect when a checked out service is no longer
+ *  being served.  The bootstrap server regains all rights to the port and
+ *  it is marked available for check-out again.  This allows crashed servers to 
+ *  resume service to previous clients.  Lookup's on this named port will 
+ *  continue to be serviced by bootstrap while holding receive rights for the 
+ *  bound port.  A client may detect that the service is inactive via the
+ *  bootstrap status request.  If an inactive service re-registers rather
+ *  than "checking-in" the original bound port is destroyed.
+ *
+ *  The status of a named service may be obtained via the "status" request.
+ *  A service is "active" if a name-port binding exists and receive rights
+ *  to the bound port are held by a task other than bootstrap.
+ *
+ *  The bootstrap server may also (re)start server processes associated with
+ *  with a set of services. The definition of the server process is done
+ *  through the "create server" request.  The server will be launched in the
+ *  same bootstrap context in which it was registered.
+ */
+#include <AvailabilityMacros.h>
+#include <mach/std_types.h>
+#include <mach/message.h>
+#include <sys/types.h>
+#include <sys/cdefs.h>
+#include <stdbool.h>
+
+__BEGIN_DECLS
+
+#pragma GCC visibility push(default)
+
+#define	BOOTSTRAP_MAX_NAME_LEN			128
+#define	BOOTSTRAP_MAX_CMD_LEN			512
+
+typedef char name_t[BOOTSTRAP_MAX_NAME_LEN];
+typedef char cmd_t[BOOTSTRAP_MAX_CMD_LEN];
+typedef name_t *name_array_t;
+typedef int bootstrap_status_t;
+typedef bootstrap_status_t *bootstrap_status_array_t;
+typedef unsigned int bootstrap_property_t;
+typedef bootstrap_property_t * bootstrap_property_array_t;
+
+typedef boolean_t *bool_array_t;
+
+#define	BOOTSTRAP_MAX_LOOKUP_COUNT		20
+
+#define	BOOTSTRAP_SUCCESS				0
+#define	BOOTSTRAP_NOT_PRIVILEGED		1100
+#define	BOOTSTRAP_NAME_IN_USE			1101
+#define	BOOTSTRAP_UNKNOWN_SERVICE		1102
+#define	BOOTSTRAP_SERVICE_ACTIVE		1103
+#define	BOOTSTRAP_BAD_COUNT				1104
+#define	BOOTSTRAP_NO_MEMORY				1105
+#define BOOTSTRAP_NO_CHILDREN			1106
+
+#define BOOTSTRAP_STATUS_INACTIVE		0
+#define BOOTSTRAP_STATUS_ACTIVE			1
+#define BOOTSTRAP_STATUS_ON_DEMAND		2
+
+/*
+ * After main() starts, it is safe to assume that this variable is always set.
+ */
+extern mach_port_t bootstrap_port;
+
+/*
+ * bootstrap_create_server()
+ *
+ * Declares a server that mach_init will re-spawn within the specified
+ * bootstrap context.  The server is considered already "active"
+ * (i.e. will not be re-spawned) until the returned server_port is
+ * deallocated.
+ *
+ * In the meantime, services can be declared against the server,
+ * by using the server_port as the privileged bootstrap target of
+ * subsequent bootstrap_create_service() calls.
+ *
+ * When mach_init re-spawns the server, its task bootstrap port
+ * is set to the privileged sever_port.  Through this special
+ * bootstrap port, it can access all of parent bootstrap's context
+ * (and all services are created in the parent's namespace). But
+ * all additional service declarations (and declaration removals)
+ * will be associated with this particular server.
+ *
+ * Only a holder of the server_port privilege bootstrap port can
+ * check in or register over those services.  
+ *
+ * When all services associated with a server are deleted, and the server
+ * exits, it will automatically be deleted itself.
+ *
+ * If the server is declared "on_demand," then a non-running server
+ * will be re-launched on first use of one of the service ports
+ * registered against it.  Otherwise, it will be re-launched
+ * immediately upon exiting (whether any client is actively using
+ * any of the service ports or not).
+ *
+ * Errors:	Returns appropriate kernel errors on rpc failure.
+ *		Returns BOOTSTRAP_NOT_PRIVILEGED, bootstrap or uid invalid.
+ */
+kern_return_t bootstrap_create_server(
+		mach_port_t bp,
+		cmd_t server_cmd,
+		uid_t server_uid,
+		boolean_t on_demand,
+		mach_port_t *server_port);
+
+/*
+ * bootstrap_subset()
+ *
+ * Returns a new port to use as a bootstrap port.  This port behaves
+ * exactly like the previous bootstrap_port, except that ports dynamically
+ * registered via bootstrap_register() are available only to users of this
+ * specific subset_port.  Lookups on the subset_port will return ports
+ * registered with this port specifically, and ports registered with
+ * ancestors of this subset_port.  Duplications of services already
+ * registered with an ancestor port may be registered with the subset port
+ * are allowed.  Services already advertised may then be effectively removed
+ * by registering PORT_NULL for the service.
+ * When it is detected that the requestor_port is destroyed the subset
+ * port and all services advertized by it are destroyed as well.
+ *
+ * Errors:	Returns appropriate kernel errors on rpc failure.
+ */
+kern_return_t bootstrap_subset(
+		mach_port_t bp,
+		mach_port_t requestor_port,
+		mach_port_t *subset_port);
+
+/*
+ * bootstrap_unprivileged()
+ *
+ * Given a bootstrap port, return its unprivileged equivalent.  If
+ * the port is already unprivileged, another reference to the same
+ * port is returned.
+ *
+ * This is most often used by servers, which are launched with their
+ * bootstrap port set to the privileged port for the server, to get
+ * an unprivileged version of the same port for use by its unprivileged
+ * children (or any offspring that it does not want to count as part
+ * of the "server" for mach_init registration and re-launch purposes).
+ *
+ * Native launchd jobs are always started with an unprivileged port.
+ */
+kern_return_t bootstrap_unprivileged(
+		mach_port_t bp,
+		mach_port_t *unpriv_port)
+		AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5;
+
+/*
+ * bootstrap_parent()
+ *
+ * Given a bootstrap subset port, return the parent bootstrap port.
+ * If the specified bootstrap port is already the root subset,
+ * the same port will be returned. Much like "." and ".." are the same
+ * in the file system name space for the root directory ("/").
+ *
+ * Errors:
+ *	Returns BOOTSTRAP_NOT_PRIVILEGED if the caller is not running
+ *	with an effective user id of root (as determined by the security
+ *	token in the message trailer).
+ */
+kern_return_t bootstrap_parent(
+		mach_port_t bp,
+		mach_port_t *parent_port);
+
+/*
+ * bootstrap_register()
+ *
+ * Registers a send right for service_port with the service identified by
+ * service_name.  Attempts to register a service where an active binding
+ * already exists are rejected.
+ *
+ * If the service was previously declared with bootstrap_create_service(),
+ * but is not currently active, this call can be used to undeclare the
+ * service. The bootstrap port used must have sufficient privilege to
+ * do so.  (Registering MACH_PORT_NULL is especially useful for shutting
+ * down declared services).
+ *
+ * This API is deprecated. Old scenarios and recommendations:
+ *
+ * 1) Code that used to call bootstrap_check_in() and then bootstrap_register()
+ *    can now always call bootstrap_check_in().
+ *
+ * 2) If the code was registering a well known name, please switch to launchd.
+ *
+ * 3) If the code was registering a dynamically generated string and passing
+ *    the string to other applications, please rewrite the code to send a Mach
+ *    send-right directly.
+ *
+ * 4) If the launchd job maintained an optional Mach service, please reserve
+ *    the name with launchd and control the presense of the service through
+ *    ownership of the Mach receive right like so.
+ *
+ *	<key>MachServices</key>
+ *	<dict>
+ *		<key>com.apple.windowserver</key>
+ *		<true/>
+ *		<key>com.apple.windowserver.active</key>
+ *		<dict>
+ *			<key>HideUntilCheckIn</key>
+ *			<true/>
+ *		</dict>
+ *	</dict>
+ *
+ *
+ * Errors:	Returns appropriate kernel errors on rpc failure.
+ *		Returns BOOTSTRAP_NOT_PRIVILEGED, if request directed to
+ *			bootstrap port without privilege.
+ *		Returns BOOTSTRAP_NAME_IN_USE, if service has already been
+ *			register or checked-in.
+ */
+AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5
+kern_return_t
+bootstrap_register(mach_port_t bp, name_t service_name, mach_port_t sp);
+
+/*
+ * bootstrap_create_service()
+ *
+ * Creates a service named "service_name" and returns a send right to that
+ * port in "service_port."  The port may later be checked in as if this
+ * port were configured in the bootstrap configuration file.
+ *
+ * This API is deprecated. Please call bootstrap_check_in() instead.
+ *
+ * Errors:	Returns appropriate kernel errors on rpc failure.
+ *		Returns BOOTSTRAP_SERVICE_ACTIVE, if service already exists.
+ */
+#ifdef AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6
+AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6
+#endif
+kern_return_t
+bootstrap_create_service(mach_port_t bp, name_t service_name, mach_port_t *sp);
+
+/*
+ * bootstrap_check_in()
+ *
+ * Returns the receive right for the service named by service_name. The
+ * service must have been declared in the launchd.plist(5) file associated 
+ * with the job.  Attempts to check_in a service which is already active 
+ * are not allowed.
+ *
+ * If the service was declared as being associated with a server, the
+ * check_in must come from the server's privileged port (server_port).
+ *
+ * Errors:	Returns appropriate kernel errors on rpc failure.
+ *		Returns BOOTSTRAP_UNKNOWN_SERVICE, if service does not exist.
+ *		Returns BOOTSTRAP_NOT_PRIVILEGED, if request directed to
+ *			bootstrap port without privilege.
+ *		Returns BOOTSTRAP_SERVICE_ACTIVE, if service has already been
+ *			registered or checked-in.
+ */
+kern_return_t bootstrap_check_in(
+		mach_port_t bp,
+		const name_t service_name,
+		mach_port_t *sp);
+
+/*
+ * bootstrap_look_up()
+ *
+ * Returns a send right for the service port declared/registered under the
+ * name service_name. The service is not guaranteed to be active.  Use the
+ * bootstrap_status call to determine the status of the service.
+ *
+ * Errors:	Returns appropriate kernel errors on rpc failure.
+ *		Returns BOOTSTRAP_UNKNOWN_SERVICE, if service does not exist.
+ */
+kern_return_t bootstrap_look_up(
+		mach_port_t bp,
+		const name_t service_name,
+		mach_port_t *sp);
+
+/*
+ * bootstrap_status()
+ *
+ * In practice, this call was used to preflight whether the following two
+ * APIs would succeed.
+ *
+ * bootstrap_look_up()
+ * bootstrap_check_in()
+ *
+ * Please don't bother. Just call the above two APIs directly and check
+ * for failure.
+ */
+kern_return_t bootstrap_status(
+		mach_port_t bp,
+		name_t service_name,
+		bootstrap_status_t *service_active)
+		AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5;
+
+/* bootstrap_strerror()
+ *
+ * Translate a return value from the bootstrap_*() APIs to a string.
+ */
+const char *bootstrap_strerror(kern_return_t r) __attribute__((__nothrow__, __pure__, __warn_unused_result__));
+
+#pragma GCC visibility pop
+
+__END_DECLS
+
+#endif
diff -urN cctools-806-old/include/servers/bootstrap.h cctools-806/include/servers/bootstrap.h
--- cctools-806-old/include/servers/bootstrap.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/servers/bootstrap.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,358 @@
+#ifndef _BOOTSTRAP_H_
+#define _BOOTSTRAP_H_
+/*
+ * Copyright (c) 1999-2005 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_APACHE_LICENSE_HEADER_START@
+ * 
+ * Licensed under the Apache License, Version 2.0 (the "License");
+ * you may not use this file except in compliance with the License.
+ * You may obtain a copy of the License at
+ * 
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ * 
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ * 
+ * @APPLE_APACHE_LICENSE_HEADER_END@
+ */
+
+/*
+ * bootstrap -- fundamental service initiator and port server
+ * Mike DeMoney, NeXT, Inc.
+ * Copyright, 1990.  All rights reserved.
+ */
+
+/*
+ *	Interface:	Bootstrap server
+ *
+ *  The bootstrap server is the first user-mode task initiated by the Mach
+ *  kernel at system boot time.  The bootstrap server provides two services,
+ *  it initiates other system tasks, and manages a table of name-port bindings
+ *  for fundamental system services  (e.g. lookupd, Window Manager, etc...).
+ *
+ *  Name-port bindings can be established with the bootstrap server by either 
+ *  of two mechanisms:
+ *
+ *  1.  The binding can be indicated, in advance of the service that backs it
+ *  being available, via a "service create" request.  In this case, bootstrap
+ *  will immediately create a port and bind the indicated name with that port.
+ *  At a later time, a service may "checkin" for the name-port
+ *  binding and will be returned receive rights for the bound port.  Lookup's
+ *  on bindings created by this mechanism will return send rights to the port,
+ *  even if no service has "checked-in".  In this case, requests sent to the
+ *  bound port will be queued until a server has checked-in and can satisfy the
+ *  request.
+ *
+ *  2.  Bindings can be established dynamically via a "register" request.  In
+ *  this case, the register request provides bootstrap with a name and send
+ *  rights for a port.  Bootstrap will provide send rights for the bound port
+ *  to any requestor via the lookup request.
+ *
+ *  Bootstrap provides its service port to descendant tasks via the Mach
+ *  "bootstrap" special task port.  All direct descendants of bootstrap receive
+ *  a "privileged" bootstrap service port.  System services that initiate
+ *  untrusted tasks should replace the Mach bootstrap task special port with
+ *  a subset bootstrap port to prevent them from infecting the namespace.
+ *
+ *  The bootstrap server creates a "backup" port for each service that it
+ *  creates.  This is used to detect when a checked out service is no longer
+ *  being served.  The bootstrap server regains all rights to the port and
+ *  it is marked available for check-out again.  This allows crashed servers to 
+ *  resume service to previous clients.  Lookup's on this named port will 
+ *  continue to be serviced by bootstrap while holding receive rights for the 
+ *  bound port.  A client may detect that the service is inactive via the
+ *  bootstrap status request.  If an inactive service re-registers rather
+ *  than "checking-in" the original bound port is destroyed.
+ *
+ *  The status of a named service may be obtained via the "status" request.
+ *  A service is "active" if a name-port binding exists and receive rights
+ *  to the bound port are held by a task other than bootstrap.
+ *
+ *  The bootstrap server may also (re)start server processes associated with
+ *  with a set of services. The definition of the server process is done
+ *  through the "create server" request.  The server will be launched in the
+ *  same bootstrap context in which it was registered.
+ */
+#include <AvailabilityMacros.h>
+#include <mach/std_types.h>
+#include <mach/message.h>
+#include <sys/types.h>
+#include <sys/cdefs.h>
+#include <stdbool.h>
+
+__BEGIN_DECLS
+
+#pragma GCC visibility push(default)
+
+#define	BOOTSTRAP_MAX_NAME_LEN			128
+#define	BOOTSTRAP_MAX_CMD_LEN			512
+
+typedef char name_t[BOOTSTRAP_MAX_NAME_LEN];
+typedef char cmd_t[BOOTSTRAP_MAX_CMD_LEN];
+typedef name_t *name_array_t;
+typedef int bootstrap_status_t;
+typedef bootstrap_status_t *bootstrap_status_array_t;
+typedef unsigned int bootstrap_property_t;
+typedef bootstrap_property_t * bootstrap_property_array_t;
+
+typedef boolean_t *bool_array_t;
+
+#define	BOOTSTRAP_MAX_LOOKUP_COUNT		20
+
+#define	BOOTSTRAP_SUCCESS				0
+#define	BOOTSTRAP_NOT_PRIVILEGED		1100
+#define	BOOTSTRAP_NAME_IN_USE			1101
+#define	BOOTSTRAP_UNKNOWN_SERVICE		1102
+#define	BOOTSTRAP_SERVICE_ACTIVE		1103
+#define	BOOTSTRAP_BAD_COUNT				1104
+#define	BOOTSTRAP_NO_MEMORY				1105
+#define BOOTSTRAP_NO_CHILDREN			1106
+
+#define BOOTSTRAP_STATUS_INACTIVE		0
+#define BOOTSTRAP_STATUS_ACTIVE			1
+#define BOOTSTRAP_STATUS_ON_DEMAND		2
+
+/*
+ * After main() starts, it is safe to assume that this variable is always set.
+ */
+extern mach_port_t bootstrap_port;
+
+/*
+ * bootstrap_create_server()
+ *
+ * Declares a server that mach_init will re-spawn within the specified
+ * bootstrap context.  The server is considered already "active"
+ * (i.e. will not be re-spawned) until the returned server_port is
+ * deallocated.
+ *
+ * In the meantime, services can be declared against the server,
+ * by using the server_port as the privileged bootstrap target of
+ * subsequent bootstrap_create_service() calls.
+ *
+ * When mach_init re-spawns the server, its task bootstrap port
+ * is set to the privileged sever_port.  Through this special
+ * bootstrap port, it can access all of parent bootstrap's context
+ * (and all services are created in the parent's namespace). But
+ * all additional service declarations (and declaration removals)
+ * will be associated with this particular server.
+ *
+ * Only a holder of the server_port privilege bootstrap port can
+ * check in or register over those services.  
+ *
+ * When all services associated with a server are deleted, and the server
+ * exits, it will automatically be deleted itself.
+ *
+ * If the server is declared "on_demand," then a non-running server
+ * will be re-launched on first use of one of the service ports
+ * registered against it.  Otherwise, it will be re-launched
+ * immediately upon exiting (whether any client is actively using
+ * any of the service ports or not).
+ *
+ * Errors:	Returns appropriate kernel errors on rpc failure.
+ *		Returns BOOTSTRAP_NOT_PRIVILEGED, bootstrap or uid invalid.
+ */
+kern_return_t bootstrap_create_server(
+		mach_port_t bp,
+		cmd_t server_cmd,
+		uid_t server_uid,
+		boolean_t on_demand,
+		mach_port_t *server_port);
+
+/*
+ * bootstrap_subset()
+ *
+ * Returns a new port to use as a bootstrap port.  This port behaves
+ * exactly like the previous bootstrap_port, except that ports dynamically
+ * registered via bootstrap_register() are available only to users of this
+ * specific subset_port.  Lookups on the subset_port will return ports
+ * registered with this port specifically, and ports registered with
+ * ancestors of this subset_port.  Duplications of services already
+ * registered with an ancestor port may be registered with the subset port
+ * are allowed.  Services already advertised may then be effectively removed
+ * by registering PORT_NULL for the service.
+ * When it is detected that the requestor_port is destroyed the subset
+ * port and all services advertized by it are destroyed as well.
+ *
+ * Errors:	Returns appropriate kernel errors on rpc failure.
+ */
+kern_return_t bootstrap_subset(
+		mach_port_t bp,
+		mach_port_t requestor_port,
+		mach_port_t *subset_port);
+
+/*
+ * bootstrap_unprivileged()
+ *
+ * Given a bootstrap port, return its unprivileged equivalent.  If
+ * the port is already unprivileged, another reference to the same
+ * port is returned.
+ *
+ * This is most often used by servers, which are launched with their
+ * bootstrap port set to the privileged port for the server, to get
+ * an unprivileged version of the same port for use by its unprivileged
+ * children (or any offspring that it does not want to count as part
+ * of the "server" for mach_init registration and re-launch purposes).
+ *
+ * Native launchd jobs are always started with an unprivileged port.
+ */
+kern_return_t bootstrap_unprivileged(
+		mach_port_t bp,
+		mach_port_t *unpriv_port)
+		AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5;
+
+/*
+ * bootstrap_parent()
+ *
+ * Given a bootstrap subset port, return the parent bootstrap port.
+ * If the specified bootstrap port is already the root subset,
+ * the same port will be returned. Much like "." and ".." are the same
+ * in the file system name space for the root directory ("/").
+ *
+ * Errors:
+ *	Returns BOOTSTRAP_NOT_PRIVILEGED if the caller is not running
+ *	with an effective user id of root (as determined by the security
+ *	token in the message trailer).
+ */
+kern_return_t bootstrap_parent(
+		mach_port_t bp,
+		mach_port_t *parent_port);
+
+/*
+ * bootstrap_register()
+ *
+ * Registers a send right for service_port with the service identified by
+ * service_name.  Attempts to register a service where an active binding
+ * already exists are rejected.
+ *
+ * If the service was previously declared with bootstrap_create_service(),
+ * but is not currently active, this call can be used to undeclare the
+ * service. The bootstrap port used must have sufficient privilege to
+ * do so.  (Registering MACH_PORT_NULL is especially useful for shutting
+ * down declared services).
+ *
+ * This API is deprecated. Old scenarios and recommendations:
+ *
+ * 1) Code that used to call bootstrap_check_in() and then bootstrap_register()
+ *    can now always call bootstrap_check_in().
+ *
+ * 2) If the code was registering a well known name, please switch to launchd.
+ *
+ * 3) If the code was registering a dynamically generated string and passing
+ *    the string to other applications, please rewrite the code to send a Mach
+ *    send-right directly.
+ *
+ * 4) If the launchd job maintained an optional Mach service, please reserve
+ *    the name with launchd and control the presense of the service through
+ *    ownership of the Mach receive right like so.
+ *
+ *	<key>MachServices</key>
+ *	<dict>
+ *		<key>com.apple.windowserver</key>
+ *		<true/>
+ *		<key>com.apple.windowserver.active</key>
+ *		<dict>
+ *			<key>HideUntilCheckIn</key>
+ *			<true/>
+ *		</dict>
+ *	</dict>
+ *
+ *
+ * Errors:	Returns appropriate kernel errors on rpc failure.
+ *		Returns BOOTSTRAP_NOT_PRIVILEGED, if request directed to
+ *			bootstrap port without privilege.
+ *		Returns BOOTSTRAP_NAME_IN_USE, if service has already been
+ *			register or checked-in.
+ */
+AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5
+kern_return_t
+bootstrap_register(mach_port_t bp, name_t service_name, mach_port_t sp);
+
+/*
+ * bootstrap_create_service()
+ *
+ * Creates a service named "service_name" and returns a send right to that
+ * port in "service_port."  The port may later be checked in as if this
+ * port were configured in the bootstrap configuration file.
+ *
+ * This API is deprecated. Please call bootstrap_check_in() instead.
+ *
+ * Errors:	Returns appropriate kernel errors on rpc failure.
+ *		Returns BOOTSTRAP_SERVICE_ACTIVE, if service already exists.
+ */
+#ifdef AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6
+AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_6
+#endif
+kern_return_t
+bootstrap_create_service(mach_port_t bp, name_t service_name, mach_port_t *sp);
+
+/*
+ * bootstrap_check_in()
+ *
+ * Returns the receive right for the service named by service_name. The
+ * service must have been declared in the launchd.plist(5) file associated 
+ * with the job.  Attempts to check_in a service which is already active 
+ * are not allowed.
+ *
+ * If the service was declared as being associated with a server, the
+ * check_in must come from the server's privileged port (server_port).
+ *
+ * Errors:	Returns appropriate kernel errors on rpc failure.
+ *		Returns BOOTSTRAP_UNKNOWN_SERVICE, if service does not exist.
+ *		Returns BOOTSTRAP_NOT_PRIVILEGED, if request directed to
+ *			bootstrap port without privilege.
+ *		Returns BOOTSTRAP_SERVICE_ACTIVE, if service has already been
+ *			registered or checked-in.
+ */
+kern_return_t bootstrap_check_in(
+		mach_port_t bp,
+		const name_t service_name,
+		mach_port_t *sp);
+
+/*
+ * bootstrap_look_up()
+ *
+ * Returns a send right for the service port declared/registered under the
+ * name service_name. The service is not guaranteed to be active.  Use the
+ * bootstrap_status call to determine the status of the service.
+ *
+ * Errors:	Returns appropriate kernel errors on rpc failure.
+ *		Returns BOOTSTRAP_UNKNOWN_SERVICE, if service does not exist.
+ */
+kern_return_t bootstrap_look_up(
+		mach_port_t bp,
+		const name_t service_name,
+		mach_port_t *sp);
+
+/*
+ * bootstrap_status()
+ *
+ * In practice, this call was used to preflight whether the following two
+ * APIs would succeed.
+ *
+ * bootstrap_look_up()
+ * bootstrap_check_in()
+ *
+ * Please don't bother. Just call the above two APIs directly and check
+ * for failure.
+ */
+kern_return_t bootstrap_status(
+		mach_port_t bp,
+		name_t service_name,
+		bootstrap_status_t *service_active)
+		AVAILABLE_MAC_OS_X_VERSION_10_0_AND_LATER_BUT_DEPRECATED_IN_MAC_OS_X_VERSION_10_5;
+
+/* bootstrap_strerror()
+ *
+ * Translate a return value from the bootstrap_*() APIs to a string.
+ */
+const char *bootstrap_strerror(kern_return_t r) __attribute__((__nothrow__, __pure__, __warn_unused_result__));
+
+#pragma GCC visibility pop
+
+__END_DECLS
+
+#endif
diff -urN cctools-806-old/include/servers/key_defs.h cctools-806/include/servers/key_defs.h
--- cctools-806-old/include/servers/key_defs.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/servers/key_defs.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,108 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1987 Carnegie-Mellon University
+ * All rights reserved.  The CMU software License Agreement specifies
+ * the terms and conditions for use and redistribution.
+ */
+
+/*
+ * Definitions of encryption keys etc..
+ */
+
+/*
+ * HISTORY:
+ *  5-Jun-87  Robert Sansom (rds) at Carnegie Mellon University
+ *	Added macros to convert keys between network and host order.
+ *
+ * 12-Apr-87  Robert Sansom (rds) at Carnegie Mellon University
+ *	Added KEY_IS_NULL.
+ *
+ *  2-Feb-87  Robert Sansom (rds) at Carnegie Mellon University
+ *	Added KEY_EQUAL.
+ *
+ *  5-Nov-86  Robert Sansom (rds) at Carnegie-Mellon University
+ *	Started.
+ *
+ */
+
+#ifndef	_KEY_DEFS_
+#define	_KEY_DEFS_
+
+/*
+ * An encrytion key.
+ */
+typedef union {
+    unsigned char	key_bytes[16];
+    unsigned long	key_longs[4];
+} key_t, *key_ptr_t;
+
+#define KEY_EQUAL(key1, key2) 					\
+    ((key1.key_longs[0] == key2.key_longs[0])			\
+	&& (key1.key_longs[1] == key2.key_longs[1])		\
+	&& (key1.key_longs[2] == key2.key_longs[2])		\
+	&& (key1.key_longs[3] == key2.key_longs[3]))
+
+#define KEY_IS_NULL(key)					\
+    (((key).key_longs[0] == 0) && ((key).key_longs[1] == 0)	\
+	&& ((key).key_longs[2] == 0) && ((key).key_longs[3] == 0))
+
+
+/*
+ * Macros to convert keys between network and host byte order.
+ */
+#define NTOH_KEY(key) {							\
+    (key).key_longs[0] = ntohl((key).key_longs[0]);			\
+    (key).key_longs[1] = ntohl((key).key_longs[1]);			\
+    (key).key_longs[2] = ntohl((key).key_longs[2]);			\
+    (key).key_longs[3] = ntohl((key).key_longs[3]);			\
+}
+
+#define HTON_KEY(key) {							\
+    (key).key_longs[0] = htonl((key).key_longs[0]);			\
+    (key).key_longs[1] = htonl((key).key_longs[1]);			\
+    (key).key_longs[2] = htonl((key).key_longs[2]);			\
+    (key).key_longs[3] = htonl((key).key_longs[3]);			\
+}
+
+/*
+ * Structure used to transmit or store a token or a key.
+ */
+typedef union {
+    key_t	si_key;
+    key_t	si_token;
+} secure_info_t, *secure_info_ptr_t;
+
+/*
+ * Security Level of ports and messages.
+ */
+#define PORT_NOT_SECURE		0
+#define MESSAGE_NOT_SECURE	0
+
+#endif	/* _KEY_DEFS_ */
diff -urN cctools-806-old/include/servers/ls_defs.h cctools-806/include/servers/ls_defs.h
--- cctools-806-old/include/servers/ls_defs.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/servers/ls_defs.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,238 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1989 Carnegie-Mellon University
+ * Copyright (c) 1988 Carnegie-Mellon University
+ * Copyright (c) 1987 Carnegie-Mellon University
+ * All rights reserved.  The CMU software License Agreement specifies
+ * the terms and conditions for use and redistribution.
+ */
+
+/*
+ * Definitions for the logstat module.
+ */
+
+
+#ifndef	_LS_DEFS_
+#define	_LS_DEFS_
+
+#include <sys/types.h>
+
+/*
+ * Definition for a log record.
+ */
+typedef	struct	{
+	long	code;
+	long	thread;
+	long	a1;
+	long	a2;
+	long	a3;
+	long	a4;
+	long	a5;
+	long	a6;
+} log_rec_t;
+
+typedef	log_rec_t	*log_ptr_t;
+
+/*
+ * Statistics record.
+ */
+typedef	struct {
+	int	datagram_pkts_sent;
+	int	datagram_pkts_rcvd;
+	int	srr_requests_sent;
+	int	srr_bcasts_sent;
+	int	srr_requests_rcvd;
+	int	srr_bcasts_rcvd;
+	int	srr_replies_sent;
+	int	srr_replies_rcvd;
+	int	srr_retries_sent;
+	int	srr_retries_rcvd;
+	int	srr_cfailures_sent;
+	int	srr_cfailures_rcvd;
+	int	deltat_dpkts_sent;
+	int	deltat_acks_rcvd;
+	int	deltat_dpkts_rcvd;
+	int	deltat_acks_sent;
+	int	deltat_oldpkts_rcvd;
+	int	deltat_oospkts_rcvd;
+	int	deltat_retries_sent;
+	int	deltat_retries_rcvd;
+	int	deltat_cfailures_sent;
+	int	deltat_cfailures_rcvd;
+	int	deltat_aborts_sent;
+	int	deltat_aborts_rcvd;
+	int	vmtp_requests_sent;
+	int	vmtp_requests_rcvd;
+	int	vmtp_replies_sent;
+	int	vmtp_replies_rcvd;
+	int	ipc_in_messages;
+	int	ipc_out_messages;
+	int	ipc_unblocks_sent;
+	int	ipc_unblocks_rcvd;
+	int	pc_requests_sent;
+	int	pc_requests_rcvd;
+	int	pc_replies_rcvd;
+	int	pc_startups_rcvd;
+	int	nn_requests_sent;
+	int	nn_requests_rcvd;
+	int	nn_replies_rcvd;
+	int	po_ro_hints_sent;
+	int	po_ro_hints_rcvd;
+	int	po_token_requests_sent;
+	int	po_token_requests_rcvd;
+	int	po_token_replies_rcvd;
+	int	po_xfer_requests_sent;
+	int	po_xfer_requests_rcvd;
+	int	po_xfer_replies_rcvd;
+	int	po_deaths_sent;
+	int	po_deaths_rcvd;
+	int	ps_requests_sent;
+	int	ps_requests_rcvd;
+	int	ps_replies_rcvd;
+	int	ps_auth_requests_sent;
+	int	ps_auth_requests_rcvd;
+	int	ps_auth_replies_rcvd;
+	int	mallocs_or_vm_allocates;
+	int	mem_allocs;
+	int	mem_deallocs;
+	int	mem_allocobjs;
+	int	mem_deallocobjs;
+	int	pkts_encrypted;
+	int	pkts_decrypted;
+	int	vmtp_segs_encrypted;
+	int	vmtp_segs_decrypted;
+	int	tcp_requests_sent;
+	int	tcp_replies_sent;
+	int	tcp_requests_rcvd;
+	int	tcp_replies_rcvd;
+	int	tcp_send;
+	int	tcp_recv;
+	int	tcp_connect;
+	int	tcp_accept;
+	int	tcp_close;
+} stat_t;
+
+typedef	stat_t	*stat_ptr_t;
+
+
+/*
+ * Debugging flags record.
+ */
+typedef	struct {
+	int	print_level;
+	int	ipc_in;
+	int	ipc_out;
+	int	tracing;
+	int	vmtp;
+	int	netname;
+	int	deltat;
+	int	tcp;
+	int	mem;
+} debug_t;
+
+typedef	debug_t	*debug_ptr_t;
+
+
+/*
+ * Parameters record.
+ */
+typedef struct {
+    	int	srr_max_tries;
+	int	srr_retry_sec;
+	int	srr_retry_usec;
+    	int	deltat_max_tries;
+	int	deltat_retry_sec;
+	int	deltat_retry_usec;
+	int	deltat_msg_life;
+	int	pc_checkup_interval;
+	int	crypt_algorithm;
+	int	transport_default;
+	int	conf_network;
+	int	conf_netport;
+	int	timer_quantum;
+	int	tcp_conn_steady;
+	int	tcp_conn_opening;
+	int	tcp_conn_max;
+	int	compat;
+	int	syslog;
+	int	old_nmmonitor;
+} param_t;
+
+typedef param_t *param_ptr_t;
+
+
+/*
+ * Port statistics record.
+ */
+typedef struct {
+	u_int	port_id;
+	u_int	alive;
+	u_int	nport_id_high;
+	u_int	nport_id_low;
+	u_int	nport_receiver;
+	u_int	nport_owner;
+	u_int	messages_sent;
+	u_int	messages_rcvd;
+	u_int	send_rights_sent;
+	u_int	send_rights_rcvd_sender;
+	u_int	send_rights_rcvd_recown;
+	u_int	rcv_rights_xferd;
+	u_int	own_rights_xferd;
+	u_int	all_rights_xferd;
+	u_int	tokens_sent;
+	u_int	tokens_requested;
+	u_int	xfer_hints_sent;
+	u_int	xfer_hints_rcvd;
+} port_stat_t, *port_stat_ptr_t;
+
+extern port_stat_ptr_t	port_stat_cur;
+extern port_stat_ptr_t	port_stat_end;
+extern struct mutex	port_stat_lock;
+
+
+/*
+ * Types for the mem_list operation.
+ *
+ * XXX These must be faked, because we cannot include mem.h here
+ * (mutual includes).
+ */
+typedef char			*mem_class_ptr_t;
+typedef char			*mem_nam_ptr_t;
+typedef int			*mem_bucket_ptr_t;
+
+	
+/*
+ * Definitions for print_level.
+ */
+#define	LS_PRINT_NEVER		5
+#define	LS_PRINT_LOG		3
+#define	LS_PRINT_ALWAYS		0
+
+#endif	/* _LS_DEFS_ */
diff -urN cctools-806-old/include/servers/netname_defs.h cctools-806/include/servers/netname_defs.h
--- cctools-806-old/include/servers/netname_defs.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/servers/netname_defs.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,71 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1987 Carnegie-Mellon University
+ * All rights reserved.  The CMU software License Agreement specifies
+ * the terms and conditions for use and redistribution.
+ */
+
+/*
+ * Definitions for the mig interface to the network name service.
+ */
+
+/*
+ * HISTORY:
+ * 28-Jul-88  Mary R. Thompson (mrt) at Carnegie Mellon
+ *	Copied definitions of NAME_NOT_YOURS and NAME_NOT_CHECKED_IN
+ *	from the old netname_defs.h so that old code would not break
+ *
+ *  8-Mar-88  Daniel Julin (dpj) at Carnegie-Mellon University
+ *	Added NETNAME_INVALID_PORT.
+ *
+ * 28-Feb-88  Daniel Julin (dpj) at Carnegie-Mellon University
+ *	Added NETNAME_PENDING.
+ *
+ * 23-Dec-86  Robert Sansom (rds) at Carnegie Mellon University
+ *	Copied from the previous version of the network server.
+ *
+ */
+
+#ifndef	_NETNAME_DEFS_
+#define	_NETNAME_DEFS_
+
+#define NETNAME_SUCCESS		(0)
+#define	NETNAME_PENDING		(-1)
+#define NETNAME_NOT_YOURS	(1000)
+#define NAME_NOT_YOURS		(1000)
+#define NETNAME_NOT_CHECKED_IN	(1001)
+#define NAME_NOT_CHECKED_IN	(1001)
+#define NETNAME_NO_SUCH_HOST	(1002)
+#define NETNAME_HOST_NOT_FOUND	(1003)
+#define	NETNAME_INVALID_PORT	(1004)
+
+typedef char netname_name_t[80];
+
+#endif /* NETNAME_DEFS_ */
diff -urN cctools-806-old/include/servers/netname.h cctools-806/include/servers/netname.h
--- cctools-806-old/include/servers/netname.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/servers/netname.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,274 @@
+#ifndef	_netname_user_
+#define	_netname_user_
+
+/* Module netname */
+
+#include <string.h>
+#include <mach/ndr.h>
+#include <mach/boolean.h>
+#include <mach/kern_return.h>
+#include <mach/notify.h>
+#include <mach/mach_types.h>
+#include <mach/message.h>
+#include <mach/mig_errors.h>
+#include <mach/port.h>
+
+#ifdef AUTOTEST
+#ifndef FUNCTION_PTR_T
+#define FUNCTION_PTR_T
+typedef void (*function_ptr_t)(mach_port_t, char *, mach_msg_type_number_t);
+typedef struct {
+        char            *name;
+        function_ptr_t  function;
+} function_table_entry;
+typedef function_table_entry   *function_table_t;
+#endif /* FUNCTION_PTR_T */
+#endif /* AUTOTEST */
+
+#ifndef	netname_MSG_COUNT
+#define	netname_MSG_COUNT	4
+#endif	/* netname_MSG_COUNT */
+
+#include <mach/std_types.h>
+#include <mach/mig.h>
+#include <servers/netname_defs.h>
+
+#ifdef __BeforeMigUserHeader
+__BeforeMigUserHeader
+#endif /* __BeforeMigUserHeader */
+
+#include <sys/cdefs.h>
+__BEGIN_DECLS
+
+
+/* Routine netname_check_in */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t netname_check_in
+(
+	mach_port_t server_port,
+	netname_name_t port_name,
+	mach_port_t signature,
+	mach_port_t port_id
+);
+
+/* Routine netname_look_up */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t netname_look_up
+(
+	mach_port_t server_port,
+	netname_name_t host_name,
+	netname_name_t port_name,
+	mach_port_t *port_id
+);
+
+/* Routine netname_check_out */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t netname_check_out
+(
+	mach_port_t server_port,
+	netname_name_t port_name,
+	mach_port_t signature
+);
+
+/* Routine netname_version */
+#ifdef	mig_external
+mig_external
+#else
+extern
+#endif	/* mig_external */
+kern_return_t netname_version
+(
+	mach_port_t server_port,
+	netname_name_t version
+);
+
+__END_DECLS
+
+/********************** Caution **************************/
+/* The following data types should be used to calculate  */
+/* maximum message sizes only. The actual message may be */
+/* smaller, and the position of the arguments within the */
+/* message layout may vary from what is presented here.  */
+/* For example, if any of the arguments are variable-    */
+/* sized, and less than the maximum is sent, the data    */
+/* will be packed tight in the actual message to reduce  */
+/* the presence of holes.                                */
+/********************** Caution **************************/
+
+/* typedefs for all requests */
+
+#ifndef __Request__netname_subsystem__defined
+#define __Request__netname_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t signature;
+		mach_msg_port_descriptor_t port_id;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t port_nameOffset; /* MiG doesn't use it */
+		mach_msg_type_number_t port_nameCnt;
+		char port_name[80];
+	} __Request__netname_check_in_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		mach_msg_type_number_t host_nameOffset; /* MiG doesn't use it */
+		mach_msg_type_number_t host_nameCnt;
+		char host_name[80];
+		mach_msg_type_number_t port_nameOffset; /* MiG doesn't use it */
+		mach_msg_type_number_t port_nameCnt;
+		char port_name[80];
+	} __Request__netname_look_up_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t signature;
+		/* end of the kernel processed data */
+		NDR_record_t NDR;
+		mach_msg_type_number_t port_nameOffset; /* MiG doesn't use it */
+		mach_msg_type_number_t port_nameCnt;
+		char port_name[80];
+	} __Request__netname_check_out_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+	} __Request__netname_version_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Request__netname_subsystem__defined */
+
+/* union of all requests */
+
+#ifndef __RequestUnion__netname_subsystem__defined
+#define __RequestUnion__netname_subsystem__defined
+union __RequestUnion__netname_subsystem {
+	__Request__netname_check_in_t Request_netname_check_in;
+	__Request__netname_look_up_t Request_netname_look_up;
+	__Request__netname_check_out_t Request_netname_check_out;
+	__Request__netname_version_t Request_netname_version;
+};
+#endif /* !__RequestUnion__netname_subsystem__defined */
+/* typedefs for all replies */
+
+#ifndef __Reply__netname_subsystem__defined
+#define __Reply__netname_subsystem__defined
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__netname_check_in_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		/* start of the kernel processed data */
+		mach_msg_body_t msgh_body;
+		mach_msg_port_descriptor_t port_id;
+		/* end of the kernel processed data */
+	} __Reply__netname_look_up_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+	} __Reply__netname_check_out_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+
+#ifdef  __MigPackStructs
+#pragma pack(4)
+#endif
+	typedef struct {
+		mach_msg_header_t Head;
+		NDR_record_t NDR;
+		kern_return_t RetCode;
+		mach_msg_type_number_t versionOffset; /* MiG doesn't use it */
+		mach_msg_type_number_t versionCnt;
+		char version[80];
+	} __Reply__netname_version_t;
+#ifdef  __MigPackStructs
+#pragma pack()
+#endif
+#endif /* !__Reply__netname_subsystem__defined */
+
+/* union of all replies */
+
+#ifndef __ReplyUnion__netname_subsystem__defined
+#define __ReplyUnion__netname_subsystem__defined
+union __ReplyUnion__netname_subsystem {
+	__Reply__netname_check_in_t Reply_netname_check_in;
+	__Reply__netname_look_up_t Reply_netname_look_up;
+	__Reply__netname_check_out_t Reply_netname_check_out;
+	__Reply__netname_version_t Reply_netname_version;
+};
+#endif /* !__RequestUnion__netname_subsystem__defined */
+
+#ifndef subsystem_to_name_map_netname
+#define subsystem_to_name_map_netname \
+    { "netname_check_in", 1040 },\
+    { "netname_look_up", 1041 },\
+    { "netname_check_out", 1042 },\
+    { "netname_version", 1043 }
+#endif
+
+#ifdef __AfterMigUserHeader
+__AfterMigUserHeader
+#endif /* __AfterMigUserHeader */
+
+#endif	 /* _netname_user_ */
diff -urN cctools-806-old/include/servers/nm_defs.h cctools-806/include/servers/nm_defs.h
--- cctools-806-old/include/servers/nm_defs.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/servers/nm_defs.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,84 @@
+/*
+ * Copyright (c) 1999 Apple Computer, Inc. All rights reserved.
+ *
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_START@
+ * 
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. The rights granted to you under the License
+ * may not be used to create, or enable the creation or redistribution of,
+ * unlawful or unlicensed copies of an Apple operating system, or to
+ * circumvent, violate, or enable the circumvention or violation of, any
+ * terms of an Apple operating system software license agreement.
+ * 
+ * Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this file.
+ * 
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ * 
+ * @APPLE_OSREFERENCE_LICENSE_HEADER_END@
+ */
+/* 
+ * Mach Operating System
+ * Copyright (c) 1987 Carnegie-Mellon University
+ * All rights reserved.  The CMU software License Agreement specifies
+ * the terms and conditions for use and redistribution.
+ */
+
+/*
+ * Random definitions for the network service that everyone needs!
+ */
+
+/*
+ * HISTORY:
+ * 27-Mar-90  Gregg Kellogg (gk) at NeXT
+ *	include <sys/netport.h> rather than <sys/ipc_netport.h>
+ *
+ * 24-Aug-88  Daniel Julin (dpj) at Carnegie-Mellon University
+ *	Replace sys/mach_ipc_netport.h with kern/ipc_netport.h. Sigh.
+ *
+ * 24-May-88  Daniel Julin (dpj) at Carnegie-Mellon University
+ *	Replace mach_ipc_vmtp.h with mach_ipc_netport.h.
+ *
+ *  4-Sep-87  Daniel Julin (dpj) at Carnegie-Mellon University
+ *	Fixed for new kernel include files which declare a lot
+ *	of network server stuff internally, because of the NETPORT
+ *	option.
+ *
+ *  5-Nov-86  Robert Sansom (rds) at Carnegie-Mellon University
+ *	Started.
+ *
+ */
+
+#ifndef	_NM_DEFS_
+#define	_NM_DEFS_
+
+/*
+ * netaddr_t is declared with the kernel files,
+ * in <sys/netport.h>.
+ */
+#include	<sys/netport.h>
+
+#ifdef	notdef
+typedef unsigned long	netaddr_t;
+#endif	/* notdef */
+
+typedef union {
+    struct {
+	unsigned char ia_net_owner;
+	unsigned char ia_net_node_type;
+	unsigned char ia_host_high;
+	unsigned char ia_host_low;
+    } ia_bytes;
+    netaddr_t ia_netaddr;
+} ip_addr_t;
+
+#endif	/* _NM_DEFS_ */
+
diff -urN cctools-806-old/include/stuff/arch.h cctools-806/include/stuff/arch.h
--- cctools-806-old/include/stuff/arch.h	2008-06-20 17:47:16.000000000 -0500
+++ cctools-806/include/stuff/arch.h	2011-09-07 01:45:04.000000000 -0500
@@ -23,8 +23,8 @@
 #ifndef _STUFF_ARCH_H_
 #define _STUFF_ARCH_H_
 
-#if defined(__MWERKS__) && !defined(__private_extern__)
-#define __private_extern__ __declspec(private_extern)
+#if defined(__MWERKS__) && !defined(extern)
+#define extern __declspec(private_extern)
 #endif
 /*
  * This file contains the current known set of flags and constants for the
@@ -49,7 +49,7 @@
  * If the pointer to the arch_flag is not NULL it is filled in with the
  * arch_flag struct that matches the name.
  */
-__private_extern__ int get_arch_from_flag(
+extern int get_arch_from_flag(
     char *name,
     struct arch_flag *arch_flag);
 
@@ -61,7 +61,7 @@
  * architecture and specific architecure for the host.  If the architecture
  * is unknown and the parameters are not NULL then all fields are set to zero.
  */
-__private_extern__ int get_arch_from_host(
+extern int get_arch_from_host(
     struct arch_flag *family_arch_flag,
     struct arch_flag *specific_arch_flag);
 
@@ -69,14 +69,14 @@
  * get_arch_flags() returns a pointer to an array of all currently know
  * architecture flags (terminated with an entry with all zeros).
  */
-__private_extern__ const struct arch_flag *get_arch_flags(
+extern const struct arch_flag *get_arch_flags(
     void);
 
 /*
  * arch_usage() is called when an unknown architecture flag is encountered.
  * It prints the currently know architecture flags on stderr.
  */
-__private_extern__ void arch_usage(
+extern void arch_usage(
     void);
 
 /*
@@ -85,7 +85,7 @@
  * the routines in "allocate.h" and errors are handled by the routines in
  * "error.h".
  */
-__private_extern__ void set_arch_flag_name(
+extern void set_arch_flag_name(
     struct arch_flag *p);
 
 /*
@@ -93,7 +93,7 @@
  * specified cputype and cpusubtype if known.  If unknown it returns a pointer
  * to the string "unknown".
  */
-__private_extern__ const char *get_arch_name_from_types(
+extern const char *get_arch_name_from_types(
     cpu_type_t cputype,
     cpu_subtype_t cpusubtype);
 
@@ -101,7 +101,7 @@
  * get_arch_family_from_cputype() returns the family architecture for the
  * specified cputype if known.  If unknown it returns NULL.
  */
-__private_extern__ const struct arch_flag *get_arch_family_from_cputype(
+extern const struct arch_flag *get_arch_family_from_cputype(
     cpu_type_t cputype);
 
 /*
@@ -111,7 +111,7 @@
  * of reading a magic number from a file that should be done and this routine
  * should not be used as it could be out of date.
  */
-__private_extern__ enum byte_sex get_byte_sex_from_flag(
+extern enum byte_sex get_byte_sex_from_flag(
     const struct arch_flag *flag);
 
 /*
@@ -119,39 +119,39 @@
  * either positive (+1) or negative (-1) of the architecture for the
  * specified cputype and cpusubtype if known.  If unknown it returns 0.
  */
-__private_extern__ int get_stack_direction_from_flag(
+extern int get_stack_direction_from_flag(
     const struct arch_flag *flag);
 
 /*
  * get_stack_addr_from_flag() returns the default starting address of the user
  * stack.
  */
-__private_extern__ uint64_t get_stack_addr_from_flag(
+extern uint64_t get_stack_addr_from_flag(
     const struct arch_flag *flag);
 
 /*
  * get_stack_size_from_flag() returns the default size of the userstack.
  */
-__private_extern__ uint32_t get_stack_size_from_flag(
+extern uint32_t get_stack_size_from_flag(
     const struct arch_flag *flag);
 
 /*
  * get_segalign_from_flag() returns the default segment alignment (page size).
  */
-__private_extern__ uint32_t get_segalign_from_flag(
+extern uint32_t get_segalign_from_flag(
     const struct arch_flag *flag);
 
 /*
  * get_segprot_from_flag() returns the default segment protection.
  */
-__private_extern__ vm_prot_t get_segprot_from_flag(
+extern vm_prot_t get_segprot_from_flag(
     const struct arch_flag *flag);
 
 /*
  * get_shared_region_size_from_flag() returns the size of the read only shared
  * region.
  */
-__private_extern__ uint32_t get_shared_region_size_from_flag(
+extern uint32_t get_shared_region_size_from_flag(
     const struct arch_flag *flag);
 
 /*
@@ -159,6 +159,6 @@
  * that cputype the cpusubtype should always be forced to the ALL cpusubtype,
  * otherwise it returns FALSE.
  */
-__private_extern__ enum bool force_cpusubtype_ALL_for_cputype(
+extern enum bool force_cpusubtype_ALL_for_cputype(
     cpu_type_t cputype);
 #endif /* _STUFF_ARCH_H_ */
diff -urN cctools-806-old/include/stuff/bytesex.h cctools-806/include/stuff/bytesex.h
--- cctools-806-old/include/stuff/bytesex.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/stuff/bytesex.h	2011-09-07 01:45:04.000000000 -0500
@@ -30,7 +30,7 @@
 #define _STUFF_BYTESEX_H_
 
 #if defined(__MWERKS__) && !defined(__private_extern__)
-#define __private_extern__ __declspec(private_extern)
+#define extern __declspec(private_extern)
 #endif
 
 #include <mach-o/fat.h>
diff -urN cctools-806-old/include/tzfile.h cctools-806/include/tzfile.h
--- cctools-806-old/include/tzfile.h	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/include/tzfile.h	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,206 @@
+#ifndef TZFILE_H
+#define TZFILE_H
+
+
+/*
+** This file is in the public domain, so clarified as of
+** 1996-06-05 by Arthur David Olson (arthur_david_olson@nih.gov).
+**
+** $FreeBSD: src/lib/libc/stdtime/tzfile.h,v 1.8 2002/03/22 23:42:05 obrien Exp $
+*/
+
+/*
+** This header is for use ONLY with the time conversion code.
+** There is no guarantee that it will remain unchanged,
+** or that it will remain at all.
+** Do NOT copy it to any system include directory.
+** Thank you!
+*/
+
+/*
+** ID
+*/
+
+#ifndef lint
+#ifndef NOID
+/*
+static char	tzfilehid[] = "@(#)tzfile.h	7.14";
+*/
+#endif /* !defined NOID */
+#endif /* !defined lint */
+
+/*
+** Information about time zone files.
+*/
+
+#ifndef TZDIR
+#define TZDIR	"/usr/share/zoneinfo" /* Time zone object file directory */
+#endif /* !defined TZDIR */
+
+#ifndef TZDEFAULT
+#define TZDEFAULT	"/etc/localtime"
+#endif /* !defined TZDEFAULT */
+
+#ifndef TZDEFRULES
+#define TZDEFRULES	"posixrules"
+#endif /* !defined TZDEFRULES */
+
+/*
+** Each file begins with. . .
+*/
+
+#define	TZ_MAGIC	"TZif"
+
+struct tzhead {
+ 	char	tzh_magic[4];		/* TZ_MAGIC */
+	char	tzh_reserved[16];	/* reserved for future use */
+	char	tzh_ttisgmtcnt[4];	/* coded number of trans. time flags */
+	char	tzh_ttisstdcnt[4];	/* coded number of trans. time flags */
+	char	tzh_leapcnt[4];		/* coded number of leap seconds */
+	char	tzh_timecnt[4];		/* coded number of transition times */
+	char	tzh_typecnt[4];		/* coded number of local time types */
+	char	tzh_charcnt[4];		/* coded number of abbr. chars */
+};
+
+/*
+** . . .followed by. . .
+**
+**	tzh_timecnt (char [4])s		coded transition times a la time(2)
+**	tzh_timecnt (unsigned char)s	types of local time starting at above
+**	tzh_typecnt repetitions of
+**		one (char [4])		coded UTC offset in seconds
+**		one (unsigned char)	used to set tm_isdst
+**		one (unsigned char)	that's an abbreviation list index
+**	tzh_charcnt (char)s		'\0'-terminated zone abbreviations
+**	tzh_leapcnt repetitions of
+**		one (char [4])		coded leap second transition times
+**		one (char [4])		total correction after above
+**	tzh_ttisstdcnt (char)s		indexed by type; if TRUE, transition
+**					time is standard time, if FALSE,
+**					transition time is wall clock time
+**					if absent, transition times are
+**					assumed to be wall clock time
+**	tzh_ttisgmtcnt (char)s		indexed by type; if TRUE, transition
+**					time is UTC, if FALSE,
+**					transition time is local time
+**					if absent, transition times are
+**					assumed to be local time
+*/
+
+/*
+** In the current implementation, "tzset()" refuses to deal with files that
+** exceed any of the limits below.
+*/
+
+#ifndef TZ_MAX_TIMES
+/*
+** The TZ_MAX_TIMES value below is enough to handle a bit more than a
+** year's worth of solar time (corrected daily to the nearest second) or
+** 138 years of Pacific Presidential Election time
+** (where there are three time zone transitions every fourth year).
+*/
+#define TZ_MAX_TIMES	370
+#endif /* !defined TZ_MAX_TIMES */
+
+#ifndef TZ_MAX_TYPES
+#ifndef NOSOLAR
+#define TZ_MAX_TYPES	256 /* Limited by what (unsigned char)'s can hold */
+#endif /* !defined NOSOLAR */
+#ifdef NOSOLAR
+/*
+** Must be at least 14 for Europe/Riga as of Jan 12 1995,
+** as noted by Earl Chew <earl@hpato.aus.hp.com>.
+*/
+#define TZ_MAX_TYPES	20	/* Maximum number of local time types */
+#endif /* !defined NOSOLAR */
+#endif /* !defined TZ_MAX_TYPES */
+
+#ifndef TZ_MAX_CHARS
+#define TZ_MAX_CHARS	50	/* Maximum number of abbreviation characters */
+				/* (limited by what unsigned chars can hold) */
+#endif /* !defined TZ_MAX_CHARS */
+
+#ifndef TZ_MAX_LEAPS
+#define TZ_MAX_LEAPS	50	/* Maximum number of leap second corrections */
+#endif /* !defined TZ_MAX_LEAPS */
+
+#define SECSPERMIN	60
+#define MINSPERHOUR	60
+#define HOURSPERDAY	24
+#define DAYSPERWEEK	7
+#define DAYSPERNYEAR	365
+#define DAYSPERLYEAR	366
+#define SECSPERHOUR	(SECSPERMIN * MINSPERHOUR)
+#define SECSPERDAY	((long) SECSPERHOUR * HOURSPERDAY)
+#define MONSPERYEAR	12
+
+#define TM_SUNDAY	0
+#define TM_MONDAY	1
+#define TM_TUESDAY	2
+#define TM_WEDNESDAY	3
+#define TM_THURSDAY	4
+#define TM_FRIDAY	5
+#define TM_SATURDAY	6
+
+#define TM_JANUARY	0
+#define TM_FEBRUARY	1
+#define TM_MARCH	2
+#define TM_APRIL	3
+#define TM_MAY		4
+#define TM_JUNE		5
+#define TM_JULY		6
+#define TM_AUGUST	7
+#define TM_SEPTEMBER	8
+#define TM_OCTOBER	9
+#define TM_NOVEMBER	10
+#define TM_DECEMBER	11
+
+#define TM_YEAR_BASE	1900
+
+#define EPOCH_YEAR	1970
+#define EPOCH_WDAY	TM_THURSDAY
+
+/*
+** Accurate only for the past couple of centuries;
+** that will probably do.
+*/
+
+#define isleap(y) (((y) % 4) == 0 && (((y) % 100) != 0 || ((y) % 400) == 0))
+
+/*
+** Since everything in isleap is modulo 400 (or a factor of 400), we know that
+**	isleap(y) == isleap(y % 400)
+** and so
+**	isleap(a + b) == isleap((a + b) % 400)
+** or
+**	isleap(a + b) == isleap(a % 400 + b % 400)
+** This is true even if % means modulo rather than Fortran remainder
+** (which is allowed by C89 but not C99).
+** We use this to avoid addition overflow problems.
+*/
+
+#define isleap_sum(a, b)	isleap((a) % 400 + (b) % 400)
+
+#ifndef USG
+
+/*
+** Use of the underscored variants may cause problems if you move your code to
+** certain System-V-based systems; for maximum portability, use the
+** underscore-free variants.  The underscored variants are provided for
+** backward compatibility only; they may disappear from future versions of
+** this file.
+*/
+
+#define SECS_PER_MIN	SECSPERMIN
+#define MINS_PER_HOUR	MINSPERHOUR
+#define HOURS_PER_DAY	HOURSPERDAY
+#define DAYS_PER_WEEK	DAYSPERWEEK
+#define DAYS_PER_NYEAR	DAYSPERNYEAR
+#define DAYS_PER_LYEAR	DAYSPERLYEAR
+#define SECS_PER_HOUR	SECSPERHOUR
+#define SECS_PER_DAY	SECSPERDAY
+#define MONS_PER_YEAR	MONSPERYEAR
+
+#endif /* !defined USG */
+
+#endif /* !defined TZFILE_H */
diff -urN cctools-806-old/install-sh cctools-806/install-sh
--- cctools-806-old/install-sh	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/install-sh	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,323 @@
+#!/bin/sh
+# install - install a program, script, or datafile
+
+scriptversion=2004-12-17.09
+
+# This originates from X11R5 (mit/util/scripts/install.sh), which was
+# later released in X11R6 (xc/config/util/install.sh) with the
+# following copyright and license.
+#
+# Copyright (C) 1994 X Consortium
+#
+# Permission is hereby granted, free of charge, to any person obtaining a copy
+# of this software and associated documentation files (the "Software"), to
+# deal in the Software without restriction, including without limitation the
+# rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
+# sell copies of the Software, and to permit persons to whom the Software is
+# furnished to do so, subject to the following conditions:
+#
+# The above copyright notice and this permission notice shall be included in
+# all copies or substantial portions of the Software.
+#
+# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE
+# X CONSORTIUM BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN
+# AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNEC-
+# TION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
+#
+# Except as contained in this notice, the name of the X Consortium shall not
+# be used in advertising or otherwise to promote the sale, use or other deal-
+# ings in this Software without prior written authorization from the X Consor-
+# tium.
+#
+#
+# FSF changes to this file are in the public domain.
+#
+# Calling this script install-sh is preferred over install.sh, to prevent
+# `make' implicit rules from creating a file called install from it
+# when there is no Makefile.
+#
+# This script is compatible with the BSD install script, but was written
+# from scratch.  It can only install one file at a time, a restriction
+# shared with many OS's install programs.
+
+# set DOITPROG to echo to test this script
+
+# Don't use :- since 4.3BSD and earlier shells don't like it.
+doit="${DOITPROG-}"
+
+# put in absolute paths if you don't have them in your path; or use env. vars.
+
+mvprog="${MVPROG-mv}"
+cpprog="${CPPROG-cp}"
+chmodprog="${CHMODPROG-chmod}"
+chownprog="${CHOWNPROG-chown}"
+chgrpprog="${CHGRPPROG-chgrp}"
+stripprog="${STRIPPROG-strip}"
+rmprog="${RMPROG-rm}"
+mkdirprog="${MKDIRPROG-mkdir}"
+
+chmodcmd="$chmodprog 0755"
+chowncmd=
+chgrpcmd=
+stripcmd=
+rmcmd="$rmprog -f"
+mvcmd="$mvprog"
+src=
+dst=
+dir_arg=
+dstarg=
+no_target_directory=
+
+usage="Usage: $0 [OPTION]... [-T] SRCFILE DSTFILE
+   or: $0 [OPTION]... SRCFILES... DIRECTORY
+   or: $0 [OPTION]... -t DIRECTORY SRCFILES...
+   or: $0 [OPTION]... -d DIRECTORIES...
+
+In the 1st form, copy SRCFILE to DSTFILE.
+In the 2nd and 3rd, copy all SRCFILES to DIRECTORY.
+In the 4th, create DIRECTORIES.
+
+Options:
+-c         (ignored)
+-d         create directories instead of installing files.
+-g GROUP   $chgrpprog installed files to GROUP.
+-m MODE    $chmodprog installed files to MODE.
+-o USER    $chownprog installed files to USER.
+-s         $stripprog installed files.
+-t DIRECTORY  install into DIRECTORY.
+-T         report an error if DSTFILE is a directory.
+--help     display this help and exit.
+--version  display version info and exit.
+
+Environment variables override the default commands:
+  CHGRPPROG CHMODPROG CHOWNPROG CPPROG MKDIRPROG MVPROG RMPROG STRIPPROG
+"
+
+while test -n "$1"; do
+  case $1 in
+    -c) shift
+        continue;;
+
+    -d) dir_arg=true
+        shift
+        continue;;
+
+    -g) chgrpcmd="$chgrpprog $2"
+        shift
+        shift
+        continue;;
+
+    --help) echo "$usage"; exit 0;;
+
+    -m) chmodcmd="$chmodprog $2"
+        shift
+        shift
+        continue;;
+
+    -o) chowncmd="$chownprog $2"
+        shift
+        shift
+        continue;;
+
+    -s) stripcmd=$stripprog
+        shift
+        continue;;
+
+    -t) dstarg=$2
+	shift
+	shift
+	continue;;
+
+    -T) no_target_directory=true
+	shift
+	continue;;
+
+    --version) echo "$0 $scriptversion"; exit 0;;
+
+    *)  # When -d is used, all remaining arguments are directories to create.
+	# When -t is used, the destination is already specified.
+	test -n "$dir_arg$dstarg" && break
+        # Otherwise, the last argument is the destination.  Remove it from $@.
+	for arg
+	do
+          if test -n "$dstarg"; then
+	    # $@ is not empty: it contains at least $arg.
+	    set fnord "$@" "$dstarg"
+	    shift # fnord
+	  fi
+	  shift # arg
+	  dstarg=$arg
+	done
+	break;;
+  esac
+done
+
+if test -z "$1"; then
+  if test -z "$dir_arg"; then
+    echo "$0: no input file specified." >&2
+    exit 1
+  fi
+  # It's OK to call `install-sh -d' without argument.
+  # This can happen when creating conditional directories.
+  exit 0
+fi
+
+for src
+do
+  # Protect names starting with `-'.
+  case $src in
+    -*) src=./$src ;;
+  esac
+
+  if test -n "$dir_arg"; then
+    dst=$src
+    src=
+
+    if test -d "$dst"; then
+      mkdircmd=:
+      chmodcmd=
+    else
+      mkdircmd=$mkdirprog
+    fi
+  else
+    # Waiting for this to be detected by the "$cpprog $src $dsttmp" command
+    # might cause directories to be created, which would be especially bad
+    # if $src (and thus $dsttmp) contains '*'.
+    if test ! -f "$src" && test ! -d "$src"; then
+      echo "$0: $src does not exist." >&2
+      exit 1
+    fi
+
+    if test -z "$dstarg"; then
+      echo "$0: no destination specified." >&2
+      exit 1
+    fi
+
+    dst=$dstarg
+    # Protect names starting with `-'.
+    case $dst in
+      -*) dst=./$dst ;;
+    esac
+
+    # If destination is a directory, append the input filename; won't work
+    # if double slashes aren't ignored.
+    if test -d "$dst"; then
+      if test -n "$no_target_directory"; then
+	echo "$0: $dstarg: Is a directory" >&2
+	exit 1
+      fi
+      dst=$dst/`basename "$src"`
+    fi
+  fi
+
+  # This sed command emulates the dirname command.
+  dstdir=`echo "$dst" | sed -e 's,/*$,,;s,[^/]*$,,;s,/*$,,;s,^$,.,'`
+
+  # Make sure that the destination directory exists.
+
+  # Skip lots of stat calls in the usual case.
+  if test ! -d "$dstdir"; then
+    defaultIFS='
+	 '
+    IFS="${IFS-$defaultIFS}"
+
+    oIFS=$IFS
+    # Some sh's can't handle IFS=/ for some reason.
+    IFS='%'
+    set x `echo "$dstdir" | sed -e 's@/@%@g' -e 's@^%@/@'`
+    shift
+    IFS=$oIFS
+
+    pathcomp=
+
+    while test $# -ne 0 ; do
+      pathcomp=$pathcomp$1
+      shift
+      if test ! -d "$pathcomp"; then
+        $mkdirprog "$pathcomp"
+	# mkdir can fail with a `File exist' error in case several
+	# install-sh are creating the directory concurrently.  This
+	# is OK.
+	test -d "$pathcomp" || exit
+      fi
+      pathcomp=$pathcomp/
+    done
+  fi
+
+  if test -n "$dir_arg"; then
+    $doit $mkdircmd "$dst" \
+      && { test -z "$chowncmd" || $doit $chowncmd "$dst"; } \
+      && { test -z "$chgrpcmd" || $doit $chgrpcmd "$dst"; } \
+      && { test -z "$stripcmd" || $doit $stripcmd "$dst"; } \
+      && { test -z "$chmodcmd" || $doit $chmodcmd "$dst"; }
+
+  else
+    dstfile=`basename "$dst"`
+
+    # Make a couple of temp file names in the proper directory.
+    dsttmp=$dstdir/_inst.$$_
+    rmtmp=$dstdir/_rm.$$_
+
+    # Trap to clean up those temp files at exit.
+    trap 'ret=$?; rm -f "$dsttmp" "$rmtmp" && exit $ret' 0
+    trap '(exit $?); exit' 1 2 13 15
+
+    # Copy the file name to the temp name.
+    $doit $cpprog "$src" "$dsttmp" &&
+
+    # and set any options; do chmod last to preserve setuid bits.
+    #
+    # If any of these fail, we abort the whole thing.  If we want to
+    # ignore errors from any of these, just make sure not to ignore
+    # errors from the above "$doit $cpprog $src $dsttmp" command.
+    #
+    { test -z "$chowncmd" || $doit $chowncmd "$dsttmp"; } \
+      && { test -z "$chgrpcmd" || $doit $chgrpcmd "$dsttmp"; } \
+      && { test -z "$stripcmd" || $doit $stripcmd "$dsttmp"; } \
+      && { test -z "$chmodcmd" || $doit $chmodcmd "$dsttmp"; } &&
+
+    # Now rename the file to the real destination.
+    { $doit $mvcmd -f "$dsttmp" "$dstdir/$dstfile" 2>/dev/null \
+      || {
+	   # The rename failed, perhaps because mv can't rename something else
+	   # to itself, or perhaps because mv is so ancient that it does not
+	   # support -f.
+
+	   # Now remove or move aside any old file at destination location.
+	   # We try this two ways since rm can't unlink itself on some
+	   # systems and the destination file might be busy for other
+	   # reasons.  In this case, the final cleanup might fail but the new
+	   # file should still install successfully.
+	   {
+	     if test -f "$dstdir/$dstfile"; then
+	       $doit $rmcmd -f "$dstdir/$dstfile" 2>/dev/null \
+	       || $doit $mvcmd -f "$dstdir/$dstfile" "$rmtmp" 2>/dev/null \
+	       || {
+		 echo "$0: cannot unlink or rename $dstdir/$dstfile" >&2
+		 (exit 1); exit 1
+	       }
+	     else
+	       :
+	     fi
+	   } &&
+
+	   # Now rename the file to the real destination.
+	   $doit $mvcmd "$dsttmp" "$dstdir/$dstfile"
+	 }
+    }
+  fi || { (exit 1); exit 1; }
+done
+
+# The final little trick to "correctly" pass the exit status to the exit trap.
+{
+  (exit 0); exit 0
+}
+
+# Local variables:
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "scriptversion="
+# time-stamp-format: "%:y-%02m-%02d.%02H"
+# time-stamp-end: "$"
+# End:
diff -urN cctools-806-old/ld/ld.h cctools-806/ld/ld.h
--- cctools-806-old/ld/ld.h	2009-12-16 13:36:25.000000000 -0600
+++ cctools-806/ld/ld.h	2011-09-07 01:45:04.000000000 -0500
@@ -82,7 +82,7 @@
     WEAK_REFS_MISMATCH_NON_WEAK
 };
 
-__private_extern__ struct macosx_deployment_target macosx_deployment_target;
+extern struct macosx_deployment_target macosx_deployment_target;
 
 /* name of this program as executed (argv[0]) */
 __private_extern__ char *progname;
@@ -107,7 +107,7 @@
  * cputype and cpusubtype.  specific_arch_flag is true if an -arch flag is
  * specified and the flag for a specific implementation of an architecture.
  */
-__private_extern__ struct arch_flag arch_flag;
+extern struct arch_flag arch_flag;
 __private_extern__ enum bool specific_arch_flag;
 
 /*
diff -urN cctools-806-old/ld/Makefile cctools-806/ld/Makefile
--- cctools-806-old/ld/Makefile	2009-12-17 13:02:42.000000000 -0600
+++ cctools-806/ld/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,496 +0,0 @@
-export USE_APPLE_PB_SUPPORT = all
-RC_OS = macos
-OFLAG = -Os
-ifneq "$(RC_MAJOR_RELEASE_TRAIN)" "Tiger"
-KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
-       -msoft-float -nostdinc \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/PrivateHeaders \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers/libsa \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers/bsd \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers \
-       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
-else
-KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
-       -msoft-float -nostdinc \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/libsa \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/bsd \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers \
-       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
-endif
-
-KERN += -D__DARWIN_UNIX03=__arm__
-
-X_CFLAGS =
-
-ifneq "clang" "$(notdir $(CC))"
-  GCC_FLAGS = $(X_CFLAGS)
-  PG = -pg
-endif
-
-USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
-				  [ "$(RC_XBS)" != "YES" ]; then \
-	     echo YES ; else echo NO ; \
-	     fi; )
-
-ifneq "" "$(SDKROOT)"
-  SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
-endif
-CFLAGS = -g -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) -Wall \
-	 $(GCC_FLAGS) $(SDK)
-
-ifeq "macos" "$(RC_OS)"
-  SYSTEMDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
-			  [ "$(RC_RELEASE)" = "Bunsen" ] || \
-			  [ "$(RC_RELEASE)" = "Gonzo" ]; then \
-	 echo /Local/Developer/System; else echo /usr/local/lib/system; fi; )
-else
-  SYSTEMDIR = /Local/Developer/System
-endif
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-SRCROOT = .
-SYMROOT = .
-OBJROOT = .
-OFILE_DIRS = $(OBJROOT)/ld_dir $(OBJROOT)/shlib_obj $(OBJROOT)/profile_obj \
-	     $(OBJROOT)/optimized_obj $(OBJROOT)/dynamic_obj \
-	     $(OBJROOT)/ptmp_obj $(OBJROOT)/otmp_obj $(OBJROOT)/dtmp_obj \
-	     $(OBJROOT)/sarld_dir $(OBJROOT)/dynamic_kld $(OBJROOT)/static_kld
-
-BINDIR = /bin
-USRBINDIR = /usr/bin
-LOCLIBDIR = /usr/local/lib
-
-ifeq "macos" "$(RC_OS)"
-  SYSTEMDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] || \
-			  [ "$(RC_RELEASE)" = "Bunsen" ] || \
-			  [ "$(RC_RELEASE)" = "Gonzo" ]; then \
-	 echo /Local/Developer/System; else echo /usr/local/lib/system; fi; )
-else
-  SYSTEMDIR = /Local/Developer/System
-endif
-
-HFILES = ld.h pass1.h objects.h sections.h cstring_literals.h symbols.h \
-	 fvmlibs.h layout.h specs.h pass2.h generic_reloc.h hash_string.h \
-	 sets.h 4byte_literals.h 8byte_literals.h literal_pointers.h dylibs.h \
-	 indirect_sections.h mod_sections.h i860_reloc.h ppc_reloc.h \
-	 m88k_reloc.h hppa_reloc.h sparc_reloc.h coalesced_sections.h \
-	 live_refs.h uuid.h debugcompunit.h dwarf2.h debugline.h arm_reloc.h
-CFILES = ld.c pass1.c objects.c sections.c cstring_literals.c symbols.c \
-	 fvmlibs.c layout.c specs.c pass2.c generic_reloc.c rld.c sets.c \
-	 4byte_literals.c 8byte_literals.c literal_pointers.c dylibs.c \
-	 indirect_sections.c mod_sections.c i860_reloc.c ppc_reloc.c \
-	 m88k_reloc.c hppa_reloc.c sparc_reloc.c coalesced_sections.c uuid.c \
-	 debugcompunit.c debugline.c arm_reloc.c
-OBJS = $(CFILES:.c=.o)
-INSTALL_FILES = $(CFILES) $(HFILES) Makefile notes \
-		librld.ofileList
-
-all:	$(OFILE_DIRS) $(SYMROOT) ld_build kld_build lib_ofiles
-
-macos_lib_ofiles:
-
-teflon_lib_ofiles nextstep_lib_ofiles: lib_ofiles
-
-
-lib_ofiles: $(OFILE_DIRS) $(SYMROOT) sarld_build \
-	    $(RC_OS) dynamic_ofiles profile_ofiles
-
-macos:
-
-teflon: optimized_ofiles
-
-nextstep: optimized_ofiles shlib_ofiles
-
-
-ld_build:	$(OBJROOT)/ld_dir $(SYMROOT)/ld_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd ld_dir; $(MAKE) -f ../Makefile ld.NEW VPATH=..		\
-		OFILE_DIR=. SRCROOT=.. RC_CFLAGS="$(RC_CFLAGS)"		\
-		LIBSTUFF="-L../../libstuff -lstuff"			\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		MAKEINCDIR="`pwd`" COPTS="-DDEBUG" CC="$(CC)";		\
-	else								\
-	    cd $(OBJROOT)/ld_dir; $(MAKE) -f $(SRCROOT)/Makefile ld.NEW	\
-		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/ld_dir		\
-		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT)		\
-		MAKEINCDIR="`pwd`" COPTS="-DDEBUG"			\
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" CC="$(CC)";			\
-	fi
-
-ld_g_build: ld_g_dir
-	cd ld_g_dir; $(MAKE) -f ../Makefile ld_g.NEW VPATH=.. OFILE_DIR=. \
-		SRCROOT=.. MAKEINCDIR="`pwd`" COPTS="-DDEBUG" OFLAG=""	\
-		LIBSTUFF="-L../../libstuff -lstuff"
-
-ld_p_build: ld_p_dir
-	cd ld_p_dir; $(MAKE) -f ../Makefile ld.NEW VPATH=.. OFILE_DIR=. \
-		SRCROOT=.. MAKEINCDIR="`pwd`" COPTS="$(PG) -DDEBUG"	\
-		LIBSTUFF="-L../../libstuff -lstuff_p"
-
-shlib_ofiles: $(OBJROOT)/shlib_obj $(SYMROOT)/ld_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    (cd shlib_obj; $(MAKE) -f ../Makefile librld.o VPATH=.. 	\
-		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
-		COPTS="-static -DRLD -DSHLIB -I/LocalDeveloper/Headers/libsys" \
-		LIBSTUFF="-L../../libstuff -lstuff_s"			\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" CC="$(CC)"	\
-		RC_CFLAGS="$(RC_CFLAGS)" RC_ARCHS="$(RC_ARCHS)");	\
-	    rm -f shlib_obj/librld.ofileList;				\
-	    cp librld.ofileList shlib_obj;				\
-	else								\
-	    (cd $(OBJROOT)/shlib_obj; $(MAKE) -f $(SRCROOT)/Makefile librld.o \
-		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/shlib_obj		\
-		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT)		\
-		RC_CFLAGS="$(RC_CFLAGS)" CC="$(CC)"			\
-		COPTS="-static -DRLD -DSHLIB -I/LocalDeveloper/Headers/libsys" \
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff_s"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		MAKEINCDIR="`pwd`" RC_ARCHS="$(RC_ARCHS)");		\
-	    rm -f $(OBJROOT)/shlib_obj/librld.ofileList;		\
-	    cp librld.ofileList $(OBJROOT)/shlib_obj;			\
-	fi
-
-profile_ofiles:	$(OBJROOT)/profile_obj $(OBJROOT)/ptmp_obj $(SYMROOT)/ld_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    (cd ptmp_obj; $(MAKE) -f ../Makefile librld_pg.a VPATH=.. 	\
-		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
-		LIBSTUFF="-L../../libstuff -lstuff_p"			\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" CC="$(CC)"	\
-		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-dynamic -DRLD $(PG)");	\
-	    rm -f profile_obj/librld.o;					\
-	    rm -f  profile_obj/librld.ofileList;			\
-	    cp ptmp_obj/librld.o profile_obj/librld.o;			\
-	    cp librld.ofileList profile_obj;				\
-	    rm -f dynamic_profile_obj;					\
-	    ln -s ./profile_obj dynamic_profile_obj;			\
-	else								\
-	    (cd $(OBJROOT)/ptmp_obj; $(MAKE) -f $(SRCROOT)/Makefile	\
-	        librld_pg.a VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/ptmp_obj \
-		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT)		\
-		RC_CFLAGS="$(RC_CFLAGS)" CC="$(CC)"			\
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff_p"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		MAKEINCDIR="`pwd`" COPTS="-dynamic -DRLD $(PG)");	\
-	    rm -f $(OBJROOT)/profile_obj/librld.o; 			\
-	    rm -f $(OBJROOT)/profile_obj/librld.ofileList;		\
-	    cp $(OBJROOT)/ptmp_obj/librld.o $(OBJROOT)/profile_obj/librld.o; \
-	    cp librld.ofileList $(OBJROOT)/profile_obj;			\
-	    rm -f $(OBJROOT)/dynamic_profile_obj;			\
-	    ln -s ./profile_obj $(OBJROOT)/dynamic_profile_obj;\
-	fi
-
-optimized_ofiles: $(OBJROOT)/optimized_obj $(OBJROOT)/otmp_obj $(SYMROOT)/ld_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    (cd otmp_obj; $(MAKE) -f ../Makefile librld_static.a VPATH=.. \
-		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
-		LIBSTUFF="-L../../libstuff -lstuff" CC="$(CC)"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-static -DRLD");	\
-	    rm -f optimized_obj/librld.o;				\
-	    rm -f optimized_obj/librld.ofileList;			\
-	    cp otmp_obj/librld.o optimized_obj/librld.o;		\
-	    cp librld.ofileList optimized_obj;				\
-	    rm -f static_obj;						\
-	    ln -s ./optimized_obj static_obj;				\
-	else								\
-	    (cd $(OBJROOT)/otmp_obj; $(MAKE) -f $(SRCROOT)/Makefile	\
-		librld_static.a VPATH=$(SRCROOT)			\
-		OFILE_DIR=$(OBJROOT)/otmp_obj				\
-		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT)		\
-		RC_CFLAGS="$(RC_CFLAGS)" CC="$(CC)"			\
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		MAKEINCDIR="`pwd`" COPTS="-static -DRLD");		\
-	    rm -f $(OBJROOT)/optimized_obj/librld.o; 			\
-	    rm -f $(OBJROOT)/optimized_obj/librld.ofileList;		\
-	    cp $(OBJROOT)/otmp_obj/librld.o $(OBJROOT)/optimized_obj/librld.o;\
-	    cp librld.ofileList $(OBJROOT)/optimized_obj;		\
-	    rm -f $(OBJROOT)/static_obj;				\
-	    ln -s ./optimized_obj $(OBJROOT)/static_obj;	\
-	fi
-
-dynamic_ofiles: $(OBJROOT)/dynamic_obj $(OBJROOT)/dtmp_obj $(SYMROOT)/ld_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    (cd dtmp_obj; $(MAKE) -f ../Makefile librld.a VPATH=.. 	\
-		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
-		LIBSTUFF="-L../../libstuff -lstuff" CC="$(CC)"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-dynamic -DRLD");	\
-	    rm -f dynamic_obj/librld.o;					\
-	    rm -f dynamic_obj/librld.ofileList;				\
-	    cp dtmp_obj/librld.o dynamic_obj/librld.o;			\
-	    cp librld.ofileList dynamic_obj;				\
-	else								\
-	    (cd $(OBJROOT)/dtmp_obj; $(MAKE) -f $(SRCROOT)/Makefile librld.a \
-		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/dtmp_obj		\
-		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT)		\
-		RC_CFLAGS="$(RC_CFLAGS)" CC="$(CC)"			\
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		MAKEINCDIR="`pwd`" COPTS="-dynamic -DRLD");		\
-	    rm -f $(OBJROOT)/dynamic_obj/librld.o; 			\
-	    rm -f $(OBJROOT)/dynamic_obj/librld.ofileList;		\
-	    cp $(OBJROOT)/dtmp_obj/librld.o $(OBJROOT)/dynamic_obj/librld.o;\
-	    cp librld.ofileList $(OBJROOT)/dynamic_obj;			\
-	fi
-
-sarld_build: $(OBJROOT)/sarld_dir $(SYMROOT)/ld_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd sarld_dir; $(MAKE) -f ../Makefile libsarld.a VPATH=..	\
-		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
-		COPTS="-static -DRLD -DSA_RLD" CC="$(CC)"		\
-		LIBSTUFF="-L../../libstuff -lstuff"			\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" RC_ARCHS="$(RC_ARCHS)";	\
-	else								\
-	    cd $(OBJROOT)/sarld_dir; $(MAKE) -f $(SRCROOT)/Makefile	\
-		libsarld.a VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/sarld_dir \
-		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT) CC="$(CC)"	\
-		COPTS="-static -DRLD -DSA_RLD" RC_CFLAGS="$(RC_CFLAGS)"	\
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		MAKEINCDIR="`pwd`" RC_ARCHS="$(RC_ARCHS)";		\
-	fi
-
-kld_build: $(OBJROOT)/dynamic_kld $(OBJROOT)/static_kld $(SYMROOT)/ld_dir
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd dynamic_kld; $(MAKE) -f ../Makefile libkld.dylib VPATH=.. \
-		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
-		COPTS="-DRLD -DKLD" CC="$(CC)"				\
-		LIBSTUFF="-L../../libstuff -lstuff"			\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" RC_ARCHS="$(RC_ARCHS)";	\
-	else								\
-	    cd $(OBJROOT)/dynamic_kld; $(MAKE) -f $(SRCROOT)/Makefile	\
-		libkld.dylib VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/dynamic_kld \
-		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT) CC="$(CC)"	\
-		COPTS="-DRLD -DKLD" RC_CFLAGS="$(RC_CFLAGS)"		\
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		MAKEINCDIR="`pwd`" RC_ARCHS="$(RC_ARCHS)";		\
-	fi
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd static_kld; $(MAKE) -f ../Makefile libkld.a VPATH=.. \
-		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
-		COPTS="-static -DRLD -DKLD $(KERN)" CC="$(CC)"		\
-		LIBSTUFF="-L../../libstuff -lstuff_kld"			\
-		LIBMACHO="-L../../libmacho/ktmp_obj -lmacho_kld"	\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		RC_CFLAGS="$(RC_CFLAGS)" RC_ARCHS="$(RC_ARCHS)";	\
-	else								\
-	    cd $(OBJROOT)/static_kld; $(MAKE) -f $(SRCROOT)/Makefile	\
-		libkld.a VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/static_kld \
-		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT) CC="$(CC)"	\
-		COPTS="-static -DRLD -DKLD $(KERN)" RC_CFLAGS="$(RC_CFLAGS)" \
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff_kld"		\
-		LIBMACHO="-L$(SYMROOT)/../libmacho -lmacho_kld"		\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		MAKEINCDIR="`pwd`" RC_ARCHS="$(RC_ARCHS)";		\
-	fi
-
-ld.NEW:	$(OBJS) ld_vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		$(OBJS) ld_vers.o $(LIBSTUFF) \
-		-o $(SYMROOT)/ld.private.o
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/ld.NEW \
-		$(SYMROOT)/ld.private.o
-
-ld_g.NEW: $(OBJS) ld_vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		$(OBJS) ld_vers.o $(LIBSTUFF) \
-		-o $(SYMROOT)/ld_g.private.o
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/ld_g.NEW \
-		$(SYMROOT)/ld_g.private.o
-
-librld_static.a librld_pg.a librld.a: librld.o
-	libtool -static -o $(SYMROOT)/$@ librld.o
-
-librld.o: $(OBJS)
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OFILE_DIR)/librld.o $(OBJS) $(LIBSTUFF)
-
-libsarld.a: $(OBJS)
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(SYMROOT)/libsarld.a $(OBJS) $(LIBSTUFF)
-
-libkld.a: $(OBJS)
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(SYMROOT)/prehack_libkld.a $(OBJS) $(LIBSTUFF) $(LIBMACHO)
-	nmedit -p $(SYMROOT)/prehack_libkld.a
-	seg_hack __KLD $(SYMROOT)/prehack_libkld.a -o $(SYMROOT)/static_libkld.o
-	libtool -o $(SYMROOT)/libkld.a $(SYMROOT)/static_libkld.o
-
-libkld.dylib: $(OBJS)
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(SYMROOT)/dynamic_libkld.o $(OBJS) $(LIBSTUFF)
-	nmedit -p $(SYMROOT)/dynamic_libkld.o
-	libtool -o $(SYMROOT)/libkld.dylib $(SYMROOT)/dynamic_libkld.o
-
-ld_vers.c:
-	echo "const char apple_version[]= " \"`vers_string $(VERS_STRING_FLAGS) -f cctools`\" ";" > \
-                $(OFILE_DIR)/$@
-
-ld_vers.o: ld_vers.c
-ifeq "mwccppc" "$(notdir $(CC))"
-	$(CC) $(COPTS) $(CFLAGS) $(OFLAG) $(RC_CFLAGS) -c \
-		-Dstatic="__declspec(private_extern)"
-else
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-	$(CC) $(COPTS) $(CFLAGS) $(OFLAG) $(RC_CFLAGS) -c \
-		-Dstatic=__private_extern__ -o $(OFILE_DIR)/$*.o $<
-else
-	$(CC) $(COPTS) $(CFLAGS) $(OFLAG) $(RC_CFLAGS) -c -MD \
-		-Dstatic=__private_extern__ \
-		-dependency-file $(OFILE_DIR)/$*.d -o $(OFILE_DIR)/$*.o $<
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-endif
-
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-.c.o:
-	$(CC) $(CFLAGS) $(COPTS) $(OFLAG) $(RC_CFLAGS) -c \
-		-o $(OFILE_DIR)/$*.o $<
-else
-.c.o:
-	$(CC) $(CFLAGS) $(COPTS) $(OFLAG) $(RC_CFLAGS) -c -MD \
-		-dependency-file $(OFILE_DIR)/$*.d -o $(OFILE_DIR)/$*.o $<
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-clean:
-	-rm -r -f $(OFILE_DIRS) ld_g_dir ld_p_dir make.out
-
-shlib_clean:
-	-rm -r -f $(OBJROOT)/ld_dir $(OBJROOT)/ptmp_obj $(OBJROOT)/otmp_obj \
-		$(OBJROOT)/dtmp_obj $(OBJROOT)/sarld_dir ld_g_dir ld_p_dir
-	-cd $(OBJROOT)/shlib_obj; rm -f $(OBJS) \
-		Makedep ld_vers.c ld_vers.o
-
-
-install: $(OFILE_DIRS) $(SYMROOT) ld_build $(RC_OS)_lib_ofiles $(RC_OS)_install
-
-macos_install:
-	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
-	install -c -s -m 555 $(SYMROOT)/ld_dir/ld.NEW \
-		$(DSTROOT)$(USRBINDIR)/ld_classic
-
-teflon_install: common_install
-	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
-	install -c -s -m 555 $(SYMROOT)/ld_dir/ld.NEW $(DSTROOT)$(USRBINDIR)/ld
-
-nextstep_install: common_install
-	$(MKDIRS) $(DSTROOT)$(BINDIR)
-	install -c -s -m 555 $(SYMROOT)/ld_dir/ld.NEW $(DSTROOT)$(BINDIR)/ld
-
-common_install:
-	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)
-	-install -p -c -m 444 $(SYMROOT)/ld_dir/libsarld.a \
-		$(DSTROOT)$(LOCLIBDIR)/libsarld.a
-
-lib_ofiles_install: $(RC_OS)_lib_ofiles_install
-
-ifeq "macos" "$(RC_OS)"
-  KLD_BUILD := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
-			  [ "$(RC_RELEASE)" = "Bunsen" ] || \
-			  [ "$(RC_RELEASE)" = "Gonzo" ] || \
-			  [ "$(RC_RELEASE)" = "Kodiak" ] || \
-			  [ "$(OLD_LIBKLD)" = "NO" ]; then \
-	 echo ""; else echo kld_build; fi; )
-  X_LIB_OFILES := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
-			     [ "$(RC_RELEASE)" = "Bunsen" ] || \
-			     [ "$(RC_RELEASE)" = "Gonzo" ] || \
-			     [ "$(RC_RELEASE)" = "Kodiak" ] || \
-			     [ "$(RC_RELEASE)" = "Cheetah" ]; then \
-	 echo "x_lib_ofiles"; else echo ""; fi; )
-else
-  KLD_BUILD = 
-  X_LIB_OFILES = 
-endif
-
-x_lib_ofiles: lib_ofiles common_install
-
-macos_lib_ofiles_install: $(KLD_BUILD) $(X_LIB_OFILES)
-	$(MKDIRS) $(DSTROOT)$(SYSTEMDIR)
-	if [ "$(X_LIB_OFILES)" = x_lib_ofiles ];			\
-	then								\
-	    if [ $(SRCROOT) = . ];					\
-	    then							\
-		install -p -c -m 444 dtmp_obj/librld.a			\
-			 $(DSTROOT)$(LOCLIBDIR)/librld.a ;		\
-		ranlib $(DSTROOT)$(LOCLIBDIR)/librld.a ;		\
-		install -p -c -m 444 dtmp_obj/librld.a			\
-			 $(DSTROOT)$(SYSTEMDIR)/librld.a ;		\
-		ranlib $(DSTROOT)$(SYSTEMDIR)/librld.a ;		\
-		(cd $(DSTROOT)$(SYSTEMDIR);				\
-		rm -f librld_debug.a ; ln -s librld.a librld_debug.a) ;	\
-		install -p -c -m 444 ptmp_obj/librld_pg.a		\
-			 $(DSTROOT)$(LOCLIBDIR)/librld_profile.a ;	\
-		ranlib $(DSTROOT)$(LOCLIBDIR)/librld_profile.a ;	\
-		install -p -c -m 444 ptmp_obj/ld_dir/librld_pg.a	\
-			 $(DSTROOT)$(SYSTEMDIR)/librld_profile.a ;	\
-		ranlib $(DSTROOT)$(SYSTEMDIR)/librld_profile.a ;	\
-	    else							\
-		install -p -c -m 444 $(SYMROOT)/ld_dir/librld.a		\
-			 $(DSTROOT)$(LOCLIBDIR)/librld.a ;		\
-		ranlib $(DSTROOT)$(LOCLIBDIR)/librld.a ;		\
-		install -p -c -m 444 $(SYMROOT)/ld_dir/librld.a		\
-			 $(DSTROOT)$(SYSTEMDIR)/librld.a ;		\
-		ranlib $(DSTROOT)$(SYSTEMDIR)/librld.a ;		\
-		(cd $(DSTROOT)$(SYSTEMDIR);				\
-		rm -f librld_debug.a ; ln -s librld.a librld_debug.a) ;	\
-		install -p -c -m 444 $(SYMROOT)/ld_dir/librld_pg.a	\
-			 $(DSTROOT)$(LOCLIBDIR)/librld_profile.a ;	\
-		ranlib $(DSTROOT)$(LOCLIBDIR)/librld_profile.a ;	\
-		install -p -c -m 444 $(SYMROOT)/ld_dir/librld_pg.a	\
-			 $(DSTROOT)$(SYSTEMDIR)/librld_profile.a ;	\
-		ranlib $(DSTROOT)$(SYSTEMDIR)/librld_profile.a ;	\
-	    fi								\
-	fi
-	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)
-	if [ "$(KLD_BUILD)" = kld_build ];				\
-	then								\
-	    if [ $(SRCROOT) = . ];					\
-	    then							\
-		install -p -c -m 444 static_kld/libkld.a		\
-			$(DSTROOT)$(LOCLIBDIR)/libkld.a ;		\
-		install -p -c -m 444 dynamic_kld/libkld.dylib		\
-			$(DSTROOT)$(LOCLIBDIR)/libkld.dylib ;		\
-	    else							\
-		install -p -c -m 444 $(SYMROOT)/ld_dir/libkld.a		\
-			$(DSTROOT)$(LOCLIBDIR)/libkld.a ;		\
-		install -p -c -m 444 $(SYMROOT)/ld_dir/libkld.dylib	\
-			$(DSTROOT)$(LOCLIBDIR)/libkld.dylib ;		\
-	    fi								\
-	fi
-
-teflon_lib_ofiles_install nextstep_lib_ofiles_install:
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-$(OFILE_DIRS) $(SYMROOT) $(SYMROOT)/ld_dir ld_g_dir ld_p_dir:
-	$(MKDIRS) $@
-
--include $(MAKEINCDIR)/Makedep
diff -urN cctools-806-old/ld/Makefile.apple cctools-806/ld/Makefile.apple
--- cctools-806-old/ld/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/ld/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,496 @@
+export USE_APPLE_PB_SUPPORT = all
+RC_OS = macos
+OFLAG = -Os
+ifneq "$(RC_MAJOR_RELEASE_TRAIN)" "Tiger"
+KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
+       -msoft-float -nostdinc \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/PrivateHeaders \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers/libsa \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers/bsd \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers \
+       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
+else
+KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
+       -msoft-float -nostdinc \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/libsa \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/bsd \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers \
+       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
+endif
+
+KERN += -D__DARWIN_UNIX03=__arm__
+
+X_CFLAGS =
+
+ifneq "clang" "$(notdir $(CC))"
+  GCC_FLAGS = $(X_CFLAGS)
+  PG = -pg
+endif
+
+USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
+				  [ "$(RC_XBS)" != "YES" ]; then \
+	     echo YES ; else echo NO ; \
+	     fi; )
+
+ifneq "" "$(SDKROOT)"
+  SDK = -isysroot $(SDKROOT)
+  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
+endif
+CFLAGS = -g -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) -Wall \
+	 $(GCC_FLAGS) $(SDK)
+
+ifeq "macos" "$(RC_OS)"
+  SYSTEMDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
+			  [ "$(RC_RELEASE)" = "Bunsen" ] || \
+			  [ "$(RC_RELEASE)" = "Gonzo" ]; then \
+	 echo /Local/Developer/System; else echo /usr/local/lib/system; fi; )
+else
+  SYSTEMDIR = /Local/Developer/System
+endif
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+SRCROOT = .
+SYMROOT = .
+OBJROOT = .
+OFILE_DIRS = $(OBJROOT)/ld_dir $(OBJROOT)/shlib_obj $(OBJROOT)/profile_obj \
+	     $(OBJROOT)/optimized_obj $(OBJROOT)/dynamic_obj \
+	     $(OBJROOT)/ptmp_obj $(OBJROOT)/otmp_obj $(OBJROOT)/dtmp_obj \
+	     $(OBJROOT)/sarld_dir $(OBJROOT)/dynamic_kld $(OBJROOT)/static_kld
+
+BINDIR = /bin
+USRBINDIR = /usr/bin
+LOCLIBDIR = /usr/local/lib
+
+ifeq "macos" "$(RC_OS)"
+  SYSTEMDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] || \
+			  [ "$(RC_RELEASE)" = "Bunsen" ] || \
+			  [ "$(RC_RELEASE)" = "Gonzo" ]; then \
+	 echo /Local/Developer/System; else echo /usr/local/lib/system; fi; )
+else
+  SYSTEMDIR = /Local/Developer/System
+endif
+
+HFILES = ld.h pass1.h objects.h sections.h cstring_literals.h symbols.h \
+	 fvmlibs.h layout.h specs.h pass2.h generic_reloc.h hash_string.h \
+	 sets.h 4byte_literals.h 8byte_literals.h literal_pointers.h dylibs.h \
+	 indirect_sections.h mod_sections.h i860_reloc.h ppc_reloc.h \
+	 m88k_reloc.h hppa_reloc.h sparc_reloc.h coalesced_sections.h \
+	 live_refs.h uuid.h debugcompunit.h dwarf2.h debugline.h arm_reloc.h
+CFILES = ld.c pass1.c objects.c sections.c cstring_literals.c symbols.c \
+	 fvmlibs.c layout.c specs.c pass2.c generic_reloc.c rld.c sets.c \
+	 4byte_literals.c 8byte_literals.c literal_pointers.c dylibs.c \
+	 indirect_sections.c mod_sections.c i860_reloc.c ppc_reloc.c \
+	 m88k_reloc.c hppa_reloc.c sparc_reloc.c coalesced_sections.c uuid.c \
+	 debugcompunit.c debugline.c arm_reloc.c
+OBJS = $(CFILES:.c=.o)
+INSTALL_FILES = $(CFILES) $(HFILES) Makefile notes \
+		librld.ofileList
+
+all:	$(OFILE_DIRS) $(SYMROOT) ld_build kld_build lib_ofiles
+
+macos_lib_ofiles:
+
+teflon_lib_ofiles nextstep_lib_ofiles: lib_ofiles
+
+
+lib_ofiles: $(OFILE_DIRS) $(SYMROOT) sarld_build \
+	    $(RC_OS) dynamic_ofiles profile_ofiles
+
+macos:
+
+teflon: optimized_ofiles
+
+nextstep: optimized_ofiles shlib_ofiles
+
+
+ld_build:	$(OBJROOT)/ld_dir $(SYMROOT)/ld_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd ld_dir; $(MAKE) -f ../Makefile ld.NEW VPATH=..		\
+		OFILE_DIR=. SRCROOT=.. RC_CFLAGS="$(RC_CFLAGS)"		\
+		LIBSTUFF="-L../../libstuff -lstuff"			\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		MAKEINCDIR="`pwd`" COPTS="-DDEBUG" CC="$(CC)";		\
+	else								\
+	    cd $(OBJROOT)/ld_dir; $(MAKE) -f $(SRCROOT)/Makefile ld.NEW	\
+		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/ld_dir		\
+		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT)		\
+		MAKEINCDIR="`pwd`" COPTS="-DDEBUG"			\
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" CC="$(CC)";			\
+	fi
+
+ld_g_build: ld_g_dir
+	cd ld_g_dir; $(MAKE) -f ../Makefile ld_g.NEW VPATH=.. OFILE_DIR=. \
+		SRCROOT=.. MAKEINCDIR="`pwd`" COPTS="-DDEBUG" OFLAG=""	\
+		LIBSTUFF="-L../../libstuff -lstuff"
+
+ld_p_build: ld_p_dir
+	cd ld_p_dir; $(MAKE) -f ../Makefile ld.NEW VPATH=.. OFILE_DIR=. \
+		SRCROOT=.. MAKEINCDIR="`pwd`" COPTS="$(PG) -DDEBUG"	\
+		LIBSTUFF="-L../../libstuff -lstuff_p"
+
+shlib_ofiles: $(OBJROOT)/shlib_obj $(SYMROOT)/ld_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    (cd shlib_obj; $(MAKE) -f ../Makefile librld.o VPATH=.. 	\
+		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
+		COPTS="-static -DRLD -DSHLIB -I/LocalDeveloper/Headers/libsys" \
+		LIBSTUFF="-L../../libstuff -lstuff_s"			\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" CC="$(CC)"	\
+		RC_CFLAGS="$(RC_CFLAGS)" RC_ARCHS="$(RC_ARCHS)");	\
+	    rm -f shlib_obj/librld.ofileList;				\
+	    cp librld.ofileList shlib_obj;				\
+	else								\
+	    (cd $(OBJROOT)/shlib_obj; $(MAKE) -f $(SRCROOT)/Makefile librld.o \
+		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/shlib_obj		\
+		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT)		\
+		RC_CFLAGS="$(RC_CFLAGS)" CC="$(CC)"			\
+		COPTS="-static -DRLD -DSHLIB -I/LocalDeveloper/Headers/libsys" \
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff_s"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		MAKEINCDIR="`pwd`" RC_ARCHS="$(RC_ARCHS)");		\
+	    rm -f $(OBJROOT)/shlib_obj/librld.ofileList;		\
+	    cp librld.ofileList $(OBJROOT)/shlib_obj;			\
+	fi
+
+profile_ofiles:	$(OBJROOT)/profile_obj $(OBJROOT)/ptmp_obj $(SYMROOT)/ld_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    (cd ptmp_obj; $(MAKE) -f ../Makefile librld_pg.a VPATH=.. 	\
+		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
+		LIBSTUFF="-L../../libstuff -lstuff_p"			\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)" CC="$(CC)"	\
+		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-dynamic -DRLD $(PG)");	\
+	    rm -f profile_obj/librld.o;					\
+	    rm -f  profile_obj/librld.ofileList;			\
+	    cp ptmp_obj/librld.o profile_obj/librld.o;			\
+	    cp librld.ofileList profile_obj;				\
+	    rm -f dynamic_profile_obj;					\
+	    ln -s ./profile_obj dynamic_profile_obj;			\
+	else								\
+	    (cd $(OBJROOT)/ptmp_obj; $(MAKE) -f $(SRCROOT)/Makefile	\
+	        librld_pg.a VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/ptmp_obj \
+		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT)		\
+		RC_CFLAGS="$(RC_CFLAGS)" CC="$(CC)"			\
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff_p"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		MAKEINCDIR="`pwd`" COPTS="-dynamic -DRLD $(PG)");	\
+	    rm -f $(OBJROOT)/profile_obj/librld.o; 			\
+	    rm -f $(OBJROOT)/profile_obj/librld.ofileList;		\
+	    cp $(OBJROOT)/ptmp_obj/librld.o $(OBJROOT)/profile_obj/librld.o; \
+	    cp librld.ofileList $(OBJROOT)/profile_obj;			\
+	    rm -f $(OBJROOT)/dynamic_profile_obj;			\
+	    ln -s ./profile_obj $(OBJROOT)/dynamic_profile_obj;\
+	fi
+
+optimized_ofiles: $(OBJROOT)/optimized_obj $(OBJROOT)/otmp_obj $(SYMROOT)/ld_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    (cd otmp_obj; $(MAKE) -f ../Makefile librld_static.a VPATH=.. \
+		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
+		LIBSTUFF="-L../../libstuff -lstuff" CC="$(CC)"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-static -DRLD");	\
+	    rm -f optimized_obj/librld.o;				\
+	    rm -f optimized_obj/librld.ofileList;			\
+	    cp otmp_obj/librld.o optimized_obj/librld.o;		\
+	    cp librld.ofileList optimized_obj;				\
+	    rm -f static_obj;						\
+	    ln -s ./optimized_obj static_obj;				\
+	else								\
+	    (cd $(OBJROOT)/otmp_obj; $(MAKE) -f $(SRCROOT)/Makefile	\
+		librld_static.a VPATH=$(SRCROOT)			\
+		OFILE_DIR=$(OBJROOT)/otmp_obj				\
+		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT)		\
+		RC_CFLAGS="$(RC_CFLAGS)" CC="$(CC)"			\
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		MAKEINCDIR="`pwd`" COPTS="-static -DRLD");		\
+	    rm -f $(OBJROOT)/optimized_obj/librld.o; 			\
+	    rm -f $(OBJROOT)/optimized_obj/librld.ofileList;		\
+	    cp $(OBJROOT)/otmp_obj/librld.o $(OBJROOT)/optimized_obj/librld.o;\
+	    cp librld.ofileList $(OBJROOT)/optimized_obj;		\
+	    rm -f $(OBJROOT)/static_obj;				\
+	    ln -s ./optimized_obj $(OBJROOT)/static_obj;	\
+	fi
+
+dynamic_ofiles: $(OBJROOT)/dynamic_obj $(OBJROOT)/dtmp_obj $(SYMROOT)/ld_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    (cd dtmp_obj; $(MAKE) -f ../Makefile librld.a VPATH=.. 	\
+		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
+		LIBSTUFF="-L../../libstuff -lstuff" CC="$(CC)"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" COPTS="-dynamic -DRLD");	\
+	    rm -f dynamic_obj/librld.o;					\
+	    rm -f dynamic_obj/librld.ofileList;				\
+	    cp dtmp_obj/librld.o dynamic_obj/librld.o;			\
+	    cp librld.ofileList dynamic_obj;				\
+	else								\
+	    (cd $(OBJROOT)/dtmp_obj; $(MAKE) -f $(SRCROOT)/Makefile librld.a \
+		VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/dtmp_obj		\
+		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT)		\
+		RC_CFLAGS="$(RC_CFLAGS)" CC="$(CC)"			\
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		MAKEINCDIR="`pwd`" COPTS="-dynamic -DRLD");		\
+	    rm -f $(OBJROOT)/dynamic_obj/librld.o; 			\
+	    rm -f $(OBJROOT)/dynamic_obj/librld.ofileList;		\
+	    cp $(OBJROOT)/dtmp_obj/librld.o $(OBJROOT)/dynamic_obj/librld.o;\
+	    cp librld.ofileList $(OBJROOT)/dynamic_obj;			\
+	fi
+
+sarld_build: $(OBJROOT)/sarld_dir $(SYMROOT)/ld_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd sarld_dir; $(MAKE) -f ../Makefile libsarld.a VPATH=..	\
+		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
+		COPTS="-static -DRLD -DSA_RLD" CC="$(CC)"		\
+		LIBSTUFF="-L../../libstuff -lstuff"			\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" RC_ARCHS="$(RC_ARCHS)";	\
+	else								\
+	    cd $(OBJROOT)/sarld_dir; $(MAKE) -f $(SRCROOT)/Makefile	\
+		libsarld.a VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/sarld_dir \
+		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT) CC="$(CC)"	\
+		COPTS="-static -DRLD -DSA_RLD" RC_CFLAGS="$(RC_CFLAGS)"	\
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		MAKEINCDIR="`pwd`" RC_ARCHS="$(RC_ARCHS)";		\
+	fi
+
+kld_build: $(OBJROOT)/dynamic_kld $(OBJROOT)/static_kld $(SYMROOT)/ld_dir
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd dynamic_kld; $(MAKE) -f ../Makefile libkld.dylib VPATH=.. \
+		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
+		COPTS="-DRLD -DKLD" CC="$(CC)"				\
+		LIBSTUFF="-L../../libstuff -lstuff"			\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" RC_ARCHS="$(RC_ARCHS)";	\
+	else								\
+	    cd $(OBJROOT)/dynamic_kld; $(MAKE) -f $(SRCROOT)/Makefile	\
+		libkld.dylib VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/dynamic_kld \
+		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT) CC="$(CC)"	\
+		COPTS="-DRLD -DKLD" RC_CFLAGS="$(RC_CFLAGS)"		\
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		MAKEINCDIR="`pwd`" RC_ARCHS="$(RC_ARCHS)";		\
+	fi
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd static_kld; $(MAKE) -f ../Makefile libkld.a VPATH=.. \
+		MAKEINCDIR="`pwd`" OFILE_DIR=. SRCROOT=.. 		\
+		COPTS="-static -DRLD -DKLD $(KERN)" CC="$(CC)"		\
+		LIBSTUFF="-L../../libstuff -lstuff_kld"			\
+		LIBMACHO="-L../../libmacho/ktmp_obj -lmacho_kld"	\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		RC_CFLAGS="$(RC_CFLAGS)" RC_ARCHS="$(RC_ARCHS)";	\
+	else								\
+	    cd $(OBJROOT)/static_kld; $(MAKE) -f $(SRCROOT)/Makefile	\
+		libkld.a VPATH=$(SRCROOT) OFILE_DIR=$(OBJROOT)/static_kld \
+		SYMROOT=$(SYMROOT)/ld_dir SRCROOT=$(SRCROOT) CC="$(CC)"	\
+		COPTS="-static -DRLD -DKLD $(KERN)" RC_CFLAGS="$(RC_CFLAGS)" \
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff_kld"		\
+		LIBMACHO="-L$(SYMROOT)/../libmacho -lmacho_kld"		\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		MAKEINCDIR="`pwd`" RC_ARCHS="$(RC_ARCHS)";		\
+	fi
+
+ld.NEW:	$(OBJS) ld_vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		$(OBJS) ld_vers.o $(LIBSTUFF) \
+		-o $(SYMROOT)/ld.private.o
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/ld.NEW \
+		$(SYMROOT)/ld.private.o
+
+ld_g.NEW: $(OBJS) ld_vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		$(OBJS) ld_vers.o $(LIBSTUFF) \
+		-o $(SYMROOT)/ld_g.private.o
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/ld_g.NEW \
+		$(SYMROOT)/ld_g.private.o
+
+librld_static.a librld_pg.a librld.a: librld.o
+	libtool -static -o $(SYMROOT)/$@ librld.o
+
+librld.o: $(OBJS)
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OFILE_DIR)/librld.o $(OBJS) $(LIBSTUFF)
+
+libsarld.a: $(OBJS)
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(SYMROOT)/libsarld.a $(OBJS) $(LIBSTUFF)
+
+libkld.a: $(OBJS)
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(SYMROOT)/prehack_libkld.a $(OBJS) $(LIBSTUFF) $(LIBMACHO)
+	nmedit -p $(SYMROOT)/prehack_libkld.a
+	seg_hack __KLD $(SYMROOT)/prehack_libkld.a -o $(SYMROOT)/static_libkld.o
+	libtool -o $(SYMROOT)/libkld.a $(SYMROOT)/static_libkld.o
+
+libkld.dylib: $(OBJS)
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(SYMROOT)/dynamic_libkld.o $(OBJS) $(LIBSTUFF)
+	nmedit -p $(SYMROOT)/dynamic_libkld.o
+	libtool -o $(SYMROOT)/libkld.dylib $(SYMROOT)/dynamic_libkld.o
+
+ld_vers.c:
+	echo "const char apple_version[]= " \"`vers_string $(VERS_STRING_FLAGS) -f cctools`\" ";" > \
+                $(OFILE_DIR)/$@
+
+ld_vers.o: ld_vers.c
+ifeq "mwccppc" "$(notdir $(CC))"
+	$(CC) $(COPTS) $(CFLAGS) $(OFLAG) $(RC_CFLAGS) -c \
+		-Dstatic="__declspec(private_extern)"
+else
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+	$(CC) $(COPTS) $(CFLAGS) $(OFLAG) $(RC_CFLAGS) -c \
+		-Dstatic=__private_extern__ -o $(OFILE_DIR)/$*.o $<
+else
+	$(CC) $(COPTS) $(CFLAGS) $(OFLAG) $(RC_CFLAGS) -c -MD \
+		-Dstatic=__private_extern__ \
+		-dependency-file $(OFILE_DIR)/$*.d -o $(OFILE_DIR)/$*.o $<
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+endif
+
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+.c.o:
+	$(CC) $(CFLAGS) $(COPTS) $(OFLAG) $(RC_CFLAGS) -c \
+		-o $(OFILE_DIR)/$*.o $<
+else
+.c.o:
+	$(CC) $(CFLAGS) $(COPTS) $(OFLAG) $(RC_CFLAGS) -c -MD \
+		-dependency-file $(OFILE_DIR)/$*.d -o $(OFILE_DIR)/$*.o $<
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+clean:
+	-rm -r -f $(OFILE_DIRS) ld_g_dir ld_p_dir make.out
+
+shlib_clean:
+	-rm -r -f $(OBJROOT)/ld_dir $(OBJROOT)/ptmp_obj $(OBJROOT)/otmp_obj \
+		$(OBJROOT)/dtmp_obj $(OBJROOT)/sarld_dir ld_g_dir ld_p_dir
+	-cd $(OBJROOT)/shlib_obj; rm -f $(OBJS) \
+		Makedep ld_vers.c ld_vers.o
+
+
+install: $(OFILE_DIRS) $(SYMROOT) ld_build $(RC_OS)_lib_ofiles $(RC_OS)_install
+
+macos_install:
+	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
+	install -c -s -m 555 $(SYMROOT)/ld_dir/ld.NEW \
+		$(DSTROOT)$(USRBINDIR)/ld_classic
+
+teflon_install: common_install
+	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
+	install -c -s -m 555 $(SYMROOT)/ld_dir/ld.NEW $(DSTROOT)$(USRBINDIR)/ld
+
+nextstep_install: common_install
+	$(MKDIRS) $(DSTROOT)$(BINDIR)
+	install -c -s -m 555 $(SYMROOT)/ld_dir/ld.NEW $(DSTROOT)$(BINDIR)/ld
+
+common_install:
+	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)
+	-install -p -c -m 444 $(SYMROOT)/ld_dir/libsarld.a \
+		$(DSTROOT)$(LOCLIBDIR)/libsarld.a
+
+lib_ofiles_install: $(RC_OS)_lib_ofiles_install
+
+ifeq "macos" "$(RC_OS)"
+  KLD_BUILD := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
+			  [ "$(RC_RELEASE)" = "Bunsen" ] || \
+			  [ "$(RC_RELEASE)" = "Gonzo" ] || \
+			  [ "$(RC_RELEASE)" = "Kodiak" ] || \
+			  [ "$(OLD_LIBKLD)" = "NO" ]; then \
+	 echo ""; else echo kld_build; fi; )
+  X_LIB_OFILES := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] ||    \
+			     [ "$(RC_RELEASE)" = "Bunsen" ] || \
+			     [ "$(RC_RELEASE)" = "Gonzo" ] || \
+			     [ "$(RC_RELEASE)" = "Kodiak" ] || \
+			     [ "$(RC_RELEASE)" = "Cheetah" ]; then \
+	 echo "x_lib_ofiles"; else echo ""; fi; )
+else
+  KLD_BUILD = 
+  X_LIB_OFILES = 
+endif
+
+x_lib_ofiles: lib_ofiles common_install
+
+macos_lib_ofiles_install: $(KLD_BUILD) $(X_LIB_OFILES)
+	$(MKDIRS) $(DSTROOT)$(SYSTEMDIR)
+	if [ "$(X_LIB_OFILES)" = x_lib_ofiles ];			\
+	then								\
+	    if [ $(SRCROOT) = . ];					\
+	    then							\
+		install -p -c -m 444 dtmp_obj/librld.a			\
+			 $(DSTROOT)$(LOCLIBDIR)/librld.a ;		\
+		ranlib $(DSTROOT)$(LOCLIBDIR)/librld.a ;		\
+		install -p -c -m 444 dtmp_obj/librld.a			\
+			 $(DSTROOT)$(SYSTEMDIR)/librld.a ;		\
+		ranlib $(DSTROOT)$(SYSTEMDIR)/librld.a ;		\
+		(cd $(DSTROOT)$(SYSTEMDIR);				\
+		rm -f librld_debug.a ; ln -s librld.a librld_debug.a) ;	\
+		install -p -c -m 444 ptmp_obj/librld_pg.a		\
+			 $(DSTROOT)$(LOCLIBDIR)/librld_profile.a ;	\
+		ranlib $(DSTROOT)$(LOCLIBDIR)/librld_profile.a ;	\
+		install -p -c -m 444 ptmp_obj/ld_dir/librld_pg.a	\
+			 $(DSTROOT)$(SYSTEMDIR)/librld_profile.a ;	\
+		ranlib $(DSTROOT)$(SYSTEMDIR)/librld_profile.a ;	\
+	    else							\
+		install -p -c -m 444 $(SYMROOT)/ld_dir/librld.a		\
+			 $(DSTROOT)$(LOCLIBDIR)/librld.a ;		\
+		ranlib $(DSTROOT)$(LOCLIBDIR)/librld.a ;		\
+		install -p -c -m 444 $(SYMROOT)/ld_dir/librld.a		\
+			 $(DSTROOT)$(SYSTEMDIR)/librld.a ;		\
+		ranlib $(DSTROOT)$(SYSTEMDIR)/librld.a ;		\
+		(cd $(DSTROOT)$(SYSTEMDIR);				\
+		rm -f librld_debug.a ; ln -s librld.a librld_debug.a) ;	\
+		install -p -c -m 444 $(SYMROOT)/ld_dir/librld_pg.a	\
+			 $(DSTROOT)$(LOCLIBDIR)/librld_profile.a ;	\
+		ranlib $(DSTROOT)$(LOCLIBDIR)/librld_profile.a ;	\
+		install -p -c -m 444 $(SYMROOT)/ld_dir/librld_pg.a	\
+			 $(DSTROOT)$(SYSTEMDIR)/librld_profile.a ;	\
+		ranlib $(DSTROOT)$(SYSTEMDIR)/librld_profile.a ;	\
+	    fi								\
+	fi
+	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)
+	if [ "$(KLD_BUILD)" = kld_build ];				\
+	then								\
+	    if [ $(SRCROOT) = . ];					\
+	    then							\
+		install -p -c -m 444 static_kld/libkld.a		\
+			$(DSTROOT)$(LOCLIBDIR)/libkld.a ;		\
+		install -p -c -m 444 dynamic_kld/libkld.dylib		\
+			$(DSTROOT)$(LOCLIBDIR)/libkld.dylib ;		\
+	    else							\
+		install -p -c -m 444 $(SYMROOT)/ld_dir/libkld.a		\
+			$(DSTROOT)$(LOCLIBDIR)/libkld.a ;		\
+		install -p -c -m 444 $(SYMROOT)/ld_dir/libkld.dylib	\
+			$(DSTROOT)$(LOCLIBDIR)/libkld.dylib ;		\
+	    fi								\
+	fi
+
+teflon_lib_ofiles_install nextstep_lib_ofiles_install:
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+$(OFILE_DIRS) $(SYMROOT) $(SYMROOT)/ld_dir ld_g_dir ld_p_dir:
+	$(MKDIRS) $@
+
+-include $(MAKEINCDIR)/Makedep
diff -urN cctools-806-old/ld/Makefile.in cctools-806/ld/Makefile.in
--- cctools-806-old/ld/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/ld/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,72 @@
+builddir = @builddir@
+top_builddir = @top_builddir@
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+
+prefix		= @prefix@
+exec_prefix	= @exec_prefix@
+bindir		= @bindir@
+
+VPATH = @srcdir@
+
+CC              = @CC@
+CFLAGS          = @CFLAGS@
+WARNINGS	= @WARNINGS@
+MDYNAMICNOPIC   = @MDYNAMICNOPIC@
+CPPFLAGS        = @CPPFLAGS@
+DEFS            = @DEFS@ @ENDIAN_FLAG@
+LDFLAGS         = @LDFLAGS@
+HAVE_PRIVEXT    = @HAVE_PRIVEXT@
+HAVE_FOREIGN_HEADERS    = @HAVE_FOREIGN_HEADERS@
+
+ifeq ($(HAVE_PRIVEXT),NO)
+INCPRIVEXT      = -include $(top_srcdir)/include/extern.h
+endif
+
+ifeq ($(HAVE_FOREIGN_HEADERS),YES)
+FORHDRS         = -I$(top_srcdir)/include/foreign
+endif
+
+INSTALL		= @INSTALL@
+INSTALL_PROGRAM	= @INSTALL_PROGRAM@
+transform       = @program_transform_name@
+LD64PROG	= $(shell echo ld64 | sed '$(transform)')
+
+MYINCLUDES      = -I$(builddir) -I$(srcdir) -I$(top_builddir)/include \
+			-I$(top_srcdir)/include $(INCPRIVEXT) $(FORHDRS)
+MYWARNINGS      = 
+MYDEFS          = -DDEBUG -DBINDIR="\"$(bindir)\"" -DLD64PROG="\"$(LD64PROG)\""
+MYLDFLAGS	= -L$(top_builddir)/libstuff
+MYLIBS		= -lstuff -luuid
+
+MYCOMPILEFLAGS	= $(WARNINGS) $(MYWARNINGS) $(DEFS) $(MYDEFS) \
+	$(CPPFLAGS) $(MYINCLUDES) $(CFLAGS) $(MDYNAMICNOPIC) 
+
+MYLINKFLAGS	= $(LDFLAGS) $(MYLDFLAGS) $(MYLIBS)
+
+CFILES = ld.c pass1.c objects.c sections.c cstring_literals.c symbols.c \
+         fvmlibs.c layout.c specs.c pass2.c generic_reloc.c rld.c sets.c \
+         4byte_literals.c 8byte_literals.c literal_pointers.c dylibs.c \
+         indirect_sections.c mod_sections.c i860_reloc.c ppc_reloc.c \
+         m88k_reloc.c hppa_reloc.c sparc_reloc.c coalesced_sections.c uuid.c \
+	 debugcompunit.c debugline.c arm_reloc.c
+
+OBJS = $(CFILES:.c=.o) 
+.c.o:
+	$(CC) $(MYCOMPILEFLAGS) -c -o $@ $<
+
+.PHONY: default clean distclean install
+
+default: ld
+
+ld: $(OBJS)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+
+install: ld
+	mkdir -p $(DESTDIR)$(bindir)
+	$(INSTALL_PROGRAM) ld \
+		$(DESTDIR)$(bindir)/`echo ld | sed '$(transform)'`
+
+clean:
+	rm -r -f *.o
+	rm -f ld
diff -urN cctools-806-old/ld/pass1.c cctools-806/ld/pass1.c
--- cctools-806-old/ld/pass1.c	2009-12-16 13:36:33.000000000 -0600
+++ cctools-806/ld/pass1.c	2011-09-07 01:45:04.000000000 -0500
@@ -508,7 +508,7 @@
 	    pass1_object(file_name, file_addr, file_size, base_name, FALSE,
 			 FALSE, bundle_loader, force_weak);
 	}
-#ifdef VM_SYNC_DEACTIVATE
+#if defined(VM_SYNC_DEACTIVATE) && !defined(_POSIX_C_SOURCE) && !defined(__CYGWIN__)
 	vm_msync(mach_task_self(), (vm_address_t)file_addr,
 		 (vm_size_t)file_size, VM_SYNC_DEACTIVATE);
 #endif /* VM_SYNC_DEACTIVATE */
diff -urN cctools-806-old/ld/pass2.c cctools-806/ld/pass2.c
--- cctools-806-old/ld/pass2.c	2009-12-17 13:02:47.000000000 -0600
+++ cctools-806/ld/pass2.c	2011-09-07 01:45:04.000000000 -0500
@@ -269,7 +269,7 @@
 		    }
 		}
 		output_local_symbols();
-#ifdef VM_SYNC_DEACTIVATE
+#if defined(VM_SYNC_DEACTIVATE) && !defined(_POSIX_C_SOURCE) && !defined(__CYGWIN__)
 		vm_msync(mach_task_self(), (vm_address_t)cur_obj->obj_addr,
 			 (vm_size_t)cur_obj->obj_size, VM_SYNC_DEACTIVATE);
 #endif /* VM_SYNC_DEACTIVATE */
diff -urN cctools-806-old/libmacho/Makefile cctools-806/libmacho/Makefile
--- cctools-806-old/libmacho/Makefile	2010-03-29 17:57:21.000000000 -0500
+++ cctools-806/libmacho/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,415 +0,0 @@
-RC_OS = macos
-OFLAG = -Os
-LEGACY = -D_MACH_I386_THREAD_STATUS_FPSTATE_LEGACY_FIELD_NAMES_ \
-	 -D_ARCHITECTURE_I386_FPU_FPSTATE_LEGACY_FIELD_NAMES_
-
-ifneq "$(RC_MAJOR_RELEASE_TRAIN)" "Tiger"
-KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
-       -msoft-float -nostdinc \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/PrivateHeaders \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers/libsa \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers/bsd \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers \
-       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
-else
-KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
-       -msoft-float -nostdinc \
--I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
--I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/libsa \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/bsd \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers \
-       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
-endif
-
-ifeq "macos" "$(RC_OS)"
-  CC := $(shell if [ "$(RC_RELEASE)" == "Tiger" ] || \
-		   [ "$(RC_RELEASE)" == "Gordian" ] || \
-		   [ "$(RC_RELEASE)" == "Saffron" ] || \
-		   [ "$(RC_USE_GCC35_FOR_PPC64)" == "YES" ]; then \
-		     echo gcc-3.5 ; \
-		else \
-		     echo "$(CC)" ; \
-	     fi; )
-endif
-ifneq "" "$(SDKROOT)"
-  SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
-endif
-ifeq "clang" "$(notdir $(CC))"
-  CFLAGS = $(OFLAG) -g -Wall $(LEGACY) \
-     -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
-  PG =
-else
-  CFLAGS = $(OFLAG) -g -Wall $(X_CFLAGS) $(LEGACY) \
-     -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
-  PG = -pg
-endif
-
-USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "clang" ] && \
-				  [ "$(RC_XBS)" != "YES" ]; then \
-	     echo YES ; else echo NO ; \
-	     fi; )
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-SRCROOT = .
-SYMROOT = .
-OBJROOT = .
-OFILE_DIRS = $(OBJROOT)/shlib_obj $(OBJROOT)/profile_obj \
-	     $(OBJROOT)/optimized_obj $(OBJROOT)/dynamic_obj \
-	     $(OBJROOT)/ptmp_obj $(OBJROOT)/otmp_obj $(OBJROOT)/dtmp_obj \
-	     $(OBJROOT)/kld_obj $(OBJROOT)/ktmp_obj
-OFILE_DIR = $(OBJROOT)
-VPATH = $(OFILE_DIR)
-
-ifeq "macos" "$(RC_OS)"
-  ARCHIVEDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] || \
-			   [ "$(RC_RELEASE)" = "Bunsen" ] || \
-			   [ "$(RC_RELEASE)" = "Gonzo" ]; then \
-	 echo /Local/Developer/System; else echo /usr/local/lib/system; fi; )
-else
-  ARCHIVEDIR = /Local/Developer/System
-endif
-DYLIBDIR = /usr/lib/system
-
-CFILES = arch.c getsecbyname.c getsegbyname.c get_end.c \
-	 swap.c hppa_swap.c i386_swap.c m68k_swap.c sparc_swap.c \
-	 ppc_swap.c i860_swap.c m88k_swap.c
-
-INSTALL_FILES = $(CFILES) $(HFILES) shlib.ofileList dylib.ofileList Makefile \
-		notes
-
-OBJS = arch.o getsecbyname.o getsegbyname.o get_end.o swap.o \
-       hppa_swap.o i386_swap.o m68k_swap.o sparc_swap.o ppc_swap.o \
-       i860_swap.o m88k_swap.o vers.o
-
-ifeq "$(OLD_LIBKLD)" "YES"
-	KLD_OFILES = kld_ofiles
-else
-	KLD_OFILES = 
-endif
-
-all: lib_ofiles
-
-macos: optimized_ofiles $(KLD_OFILES)
-
-teflon: optimized_ofiles $(KLD_OFILES)
-
-nextstep: optimized_ofiles $(KLD_OFILES) shlib_ofiles
-
-lib_ofiles: $(OFILE_DIRS) $(SYMROOT) $(RC_OS) dynamic_ofiles profile_ofiles
-
-shlib_ofiles: $(OBJROOT)/shlib_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    (cd shlib_obj;						\
-		$(MAKE) -f ../Makefile $(OBJS)				\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		COPTS="-static -DSHLIB -I/LocalDeveloper/Headers/libsys" \
-		LIBSTUFF="-L../../libstuff -lstuff_s"			\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)");				\
-	    rm -f shlib_obj/libmacho.ofileList;				\
-	    cp shlib.ofileList shlib_obj/libmacho.ofileList;		\
-	else								\
-	    (cd $(OBJROOT)/shlib_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile $(OBJS)			\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/shlib_obj				\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="-static -DSHLIB -I/LocalDeveloper/Headers/libsys" \
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff_s"		\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)");				\
-	    rm -f $(OBJROOT)/shlib_obj/libmacho.ofileList;		\
-	    cp shlib.ofileList $(OBJROOT)/shlib_obj/libmacho.ofileList;	\
-	fi
-
-profile_ofiles:	$(OBJROOT)/profile_obj $(OBJROOT)/ptmp_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    (cd ptmp_obj;						\
-		$(MAKE) -f ../Makefile libmacho_pg.a libmacho_profile.dylib \
-		INSTALL_NAME=/usr/lib/system/libmacho_profile.dylib	\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		COPTS="-dynamic $(PG)"					\
-		LIBSTUFF="-L../../libstuff -lstuff_p"			\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)");				\
-	    (cd profile_obj; rm -f $(OBJS));				\
-	    (cd ptmp_obj; cp $(OBJS) ../profile_obj); \
-	    rm -f dynamic_profile_obj;					\
-	    ln -s ./profile_obj dynamic_profile_obj;			\
-	    rm -f profile_obj/libmacho.ofileList;			\
-	    cp dylib.ofileList profile_obj/libmacho.ofileList;		\
-	else								\
-	    (cd $(OBJROOT)/ptmp_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libmacho_pg.a		\
-		libmacho_profile.dylib					\
-		INSTALL_NAME=/usr/lib/system/libmacho_profile.dylib	\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/ptmp_obj				\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff_p"		\
-		COPTS="-dynamic $(PG)"					\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)");				\
-	    (cd $(OBJROOT)/profile_obj; rm -f $(OBJS));			\
-	    (cd $(OBJROOT)/ptmp_obj; 					\
-		cp $(OBJS) $(OBJROOT)/profile_obj); \
-	    rm -f $(OBJROOT)/dynamic_profile_obj;			\
-	    ln -s ./profile_obj $(OBJROOT)/dynamic_profile_obj;		\
-	    rm -f $(OBJROOT)/profile_obj/libmacho.ofileList;		\
-	    cp dylib.ofileList $(OBJROOT)/profile_obj/libmacho.ofileList; \
-	fi
-
-optimized_ofiles: $(OBJROOT)/optimized_obj $(OBJROOT)/otmp_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    (cd otmp_obj;						\
-		$(MAKE) -f ../Makefile libmacho_static.a		\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		COPTS="-static"						\
-		LIBSTUFF="-L../../libstuff -lstuff"			\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)");				\
-	    (cd optimized_obj; rm -f $(OBJS));				\
-	    (cd otmp_obj; cp $(OBJS) ../optimized_obj); 		\
-	    rm -f static_obj;						\
-	    ln -s ./optimized_obj static_obj;				\
-	    rm -f optimized_obj/libmacho.ofileList;			\
-	    cp dylib.ofileList optimized_obj/libmacho.ofileList;	\
-	else								\
-	    (cd $(OBJROOT)/otmp_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libmacho_static.a	\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/otmp_obj				\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="-static"						\
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)");				\
-	    (cd $(OBJROOT)/optimized_obj; rm -f $(OBJS));		\
-	    (cd $(OBJROOT)/otmp_obj; 					\
-		cp $(OBJS) $(OBJROOT)/optimized_obj); 			\
-	    rm -f $(OBJROOT)/static_obj;				\
-	    ln -s ./optimized_obj $(OBJROOT)/static_obj;		\
-	    rm -f $(OBJROOT)/optimized_obj/libmacho.ofileList;		\
-	    cp dylib.ofileList $(OBJROOT)/optimized_obj/libmacho.ofileList; \
-	fi
-
-kld_ofiles: $(OBJROOT)/kld_obj $(OBJROOT)/ktmp_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    (cd ktmp_obj;						\
-		$(MAKE) -f ../Makefile libmacho_kld.a			\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		COPTS="-static -DRLD -DSA_RLD $(KERN)"			\
-		LIBSTUFF="-L../../libstuff -lstuff_kld"			\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)");				\
-	    (cd kld_obj; rm -f $(OBJS));				\
-	    (cd ktmp_obj; cp $(OBJS) ../kld_obj); 			\
-	else								\
-	    (cd $(OBJROOT)/ktmp_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libmacho_kld.a		\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/ktmp_obj				\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="-static -DRLD -DSA_RLD $(KERN)"			\
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff_kld"		\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)");				\
-	    (cd $(OBJROOT)/kld_obj; rm -f $(OBJS));			\
-	    (cd $(OBJROOT)/ktmp_obj; 					\
-		cp $(OBJS) $(OBJROOT)/kld_obj); 			\
-	fi
-
-dynamic_ofiles: $(OBJROOT)/dynamic_obj $(OBJROOT)/dtmp_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    (cd dtmp_obj;						\
-		$(MAKE) -f ../Makefile libmacho.a libmacho.dylib	\
-		INSTALL_NAME=/usr/lib/system/libmacho.dylib		\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		COPTS="-dynamic"					\
-		LIBSTUFF="-L../../libstuff -lstuff"			\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)");				\
-	    (cd dtmp_obj;						\
-		$(MAKE) -f ../Makefile libmacho_debug.dylib		\
-		INSTALL_NAME=/usr/lib/system/libmacho_debug.dylib	\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		COPTS="-dynamic"					\
-		LIBSTUFF="-L../../libstuff -lstuff"			\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)");				\
-	    (cd dynamic_obj; rm -f $(OBJS));				\
-	    (cd dtmp_obj; cp $(OBJS) ../dynamic_obj); 			\
-	    rm -f dynamic_obj/libmacho.ofileList;			\
-	    cp dylib.ofileList dynamic_obj/libmacho.ofileList;		\
-	else								\
-	    (cd $(OBJROOT)/dtmp_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libmacho.a libmacho.dylib \
-		INSTALL_NAME=/usr/lib/system/libmacho.dylib		\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/dtmp_obj				\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
-		COPTS="-dynamic"					\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)");				\
-	    (cd $(OBJROOT)/dtmp_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libmacho_debug.dylib	\
-		INSTALL_NAME=/usr/lib/system/libmacho_debug.dylib	\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/dtmp_obj				\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
-		COPTS="-dynamic"					\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)");				\
-	    (cd $(OBJROOT)/dynamic_obj; rm -f $(OBJS));			\
-	    (cd $(OBJROOT)/dtmp_obj;					\
-		cp $(OBJS) $(OBJROOT)/dynamic_obj); 			\
-	    rm -f $(OBJROOT)/dynamic_obj/libmacho.ofileList;		\
-	    cp dylib.ofileList $(OBJROOT)/dynamic_obj/libmacho.ofileList; \
-	fi
-
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c -o $(OFILE_DIR)/$*.o $<
-else
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
-		-MD -dependency-file $(OFILE_DIR)/$*.d \
-		-o $(OFILE_DIR)/$*.o $<
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-vers.c:
-	vers_string -l $(VERS_STRING_FLAGS) libmacho > $(OFILE_DIR)/$@
-	echo "const char *libmacho_version= SGS_VERS;" >> $(OFILE_DIR)/$@
-
-clean:
-	-rm -r -f $(OFILE_DIRS) $(OBJROOT)/static_obj
-
-shlib_clean:
-	-rm -r -f $(OBJROOT)/ptmp_obj $(OBJROOT)/otmp_obj $(OBJROOT)/dtmp_obj
-
-libmacho.a libmacho_pg.a libmacho_static.a libmacho_kld.a: $(OBJS)
-	libtool -static -o $(SYMROOT)/$@ $(OBJS)
-
-libmacho.dylib libmacho_profile.dylib libmacho_debug.dylib: $(OBJS)
-	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -dynamiclib  \
-		-o $(SYMROOT)/$@ $(OBJS) \
-		-install_name $(INSTALL_NAME) \
-		-compatibility_version 1 \
-		-current_version $(RC_ProjectSourceVersion) \
-		-lSystem
-
-install: $(RC_OS)_install
-
-macos_install:
-
-teflon_install nextstep_install: all
-
-
-lib_ofiles_install: $(RC_OS)_lib_ofiles_install
-
-macos_lib_ofiles_install: all
-	$(MKDIRS) $(DSTROOT)$(ARCHIVEDIR) $(DSTROOT)$(DYLIBDIR)
-	if [ $(SRCROOT) = . ];						\
-	then								\
-	    install -c -m 444 dtmp_obj/libmacho.a			\
-		     $(DSTROOT)$(ARCHIVEDIR)/libmacho.a;		\
-	    ranlib $(DSTROOT)$(ARCHIVEDIR)/libmacho.a;			\
-	    (cd $(DSTROOT)$(ARCHIVEDIR) ;				\
-	    rm -f libmacho_debug.a ; ln -s libmacho.a libmacho_debug.a); \
-	    install -c -m 444 ptmp_obj/libmacho_pg.a			 \
-		     $(DSTROOT)$(ARCHIVEDIR)/libmacho_profile.a;	\
-	    ranlib $(DSTROOT)$(ARCHIVEDIR)/libmacho_profile.a;		\
-	    install -c -m 444 otmp_obj/libmacho_static.a		\
-		     $(DSTROOT)$(ARCHIVEDIR)/libmacho_static.a;		\
-	    ranlib $(DSTROOT)$(ARCHIVEDIR)/libmacho_static.a;		\
-	    install -c -m 555 dtmp_obj/libmacho.dylib			\
-		     $(DSTROOT)$(DYLIBDIR)/libmacho.dylib;		\
-	    strip -S $(DSTROOT)$(DYLIBDIR)/libmacho.dylib;		\
-	    install -c -m 555 dtmp_obj/libmacho_profile.dylib		\
-		     $(DSTROOT)$(DYLIBDIR)/libmacho_profile.dylib;	\
-	    strip -S $(DSTROOT)$(DYLIBDIR)/libmacho_profile.dylib;	\
-	    install -c -m 555 dtmp_obj/libmacho_debug.dylib		\
-		     $(DSTROOT)$(DYLIBDIR)/libmacho_debug.dylib;	\
-	    strip -S $(DSTROOT)$(DYLIBDIR)/libmacho_debug.dylib;	\
-	else								\
-	    install -c -m 444 $(SYMROOT)/libmacho.a			\
-		     $(DSTROOT)$(ARCHIVEDIR)/libmacho.a;		\
-	    ranlib $(DSTROOT)$(ARCHIVEDIR)/libmacho.a;			\
-	    (cd $(DSTROOT)$(ARCHIVEDIR) ;				\
-	    rm -f libmacho_debug.a ; ln -s libmacho.a libmacho_debug.a); \
-	    install -c -m 444 $(SYMROOT)/libmacho_pg.a			 \
-		     $(DSTROOT)$(ARCHIVEDIR)/libmacho_profile.a;	\
-	    ranlib $(DSTROOT)$(ARCHIVEDIR)/libmacho_profile.a;		\
-	    install -c -m 444 $(SYMROOT)/libmacho_static.a		\
-		     $(DSTROOT)$(ARCHIVEDIR)/libmacho_static.a;		\
-	    ranlib $(DSTROOT)$(ARCHIVEDIR)/libmacho_static.a;		\
-	    install -c -m 555 $(SYMROOT)/libmacho.dylib			\
-		     $(DSTROOT)$(DYLIBDIR)/libmacho.dylib;		\
-	    strip -S $(DSTROOT)$(DYLIBDIR)/libmacho.dylib;		\
-	    install -c -m 555 $(SYMROOT)/libmacho_profile.dylib		\
-		     $(DSTROOT)$(DYLIBDIR)/libmacho_profile.dylib;	\
-	    strip -S $(DSTROOT)$(DYLIBDIR)/libmacho_profile.dylib;	\
-	    install -c -m 555 $(SYMROOT)/libmacho_debug.dylib	\
-		     $(DSTROOT)$(DYLIBDIR)/libmacho_debug.dylib;	\
-	    strip -S $(DSTROOT)$(DYLIBDIR)/libmacho_debug.dylib;	\
-	fi
-
-teflon_lib_ofiles_install nextstep_lib_ofiles_install:
-
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-$(OFILE_DIRS) $(SYMROOT):
-	$(MKDIRS) $@
-
--include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/libmacho/Makefile.apple cctools-806/libmacho/Makefile.apple
--- cctools-806-old/libmacho/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/libmacho/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,415 @@
+RC_OS = macos
+OFLAG = -Os
+LEGACY = -D_MACH_I386_THREAD_STATUS_FPSTATE_LEGACY_FIELD_NAMES_ \
+	 -D_ARCHITECTURE_I386_FPU_FPSTATE_LEGACY_FIELD_NAMES_
+
+ifneq "$(RC_MAJOR_RELEASE_TRAIN)" "Tiger"
+KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
+       -msoft-float -nostdinc \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/PrivateHeaders \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers/libsa \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers/bsd \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers \
+       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
+else
+KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
+       -msoft-float -nostdinc \
+-I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
+-I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/libsa \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/bsd \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers \
+       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
+endif
+
+ifeq "macos" "$(RC_OS)"
+  CC := $(shell if [ "$(RC_RELEASE)" == "Tiger" ] || \
+		   [ "$(RC_RELEASE)" == "Gordian" ] || \
+		   [ "$(RC_RELEASE)" == "Saffron" ] || \
+		   [ "$(RC_USE_GCC35_FOR_PPC64)" == "YES" ]; then \
+		     echo gcc-3.5 ; \
+		else \
+		     echo "$(CC)" ; \
+	     fi; )
+endif
+ifneq "" "$(SDKROOT)"
+  SDK = -isysroot $(SDKROOT)
+  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
+endif
+ifeq "clang" "$(notdir $(CC))"
+  CFLAGS = $(OFLAG) -g -Wall $(LEGACY) \
+     -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
+  PG =
+else
+  CFLAGS = $(OFLAG) -g -Wall $(X_CFLAGS) $(LEGACY) \
+     -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
+  PG = -pg
+endif
+
+USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "clang" ] && \
+				  [ "$(RC_XBS)" != "YES" ]; then \
+	     echo YES ; else echo NO ; \
+	     fi; )
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+SRCROOT = .
+SYMROOT = .
+OBJROOT = .
+OFILE_DIRS = $(OBJROOT)/shlib_obj $(OBJROOT)/profile_obj \
+	     $(OBJROOT)/optimized_obj $(OBJROOT)/dynamic_obj \
+	     $(OBJROOT)/ptmp_obj $(OBJROOT)/otmp_obj $(OBJROOT)/dtmp_obj \
+	     $(OBJROOT)/kld_obj $(OBJROOT)/ktmp_obj
+OFILE_DIR = $(OBJROOT)
+VPATH = $(OFILE_DIR)
+
+ifeq "macos" "$(RC_OS)"
+  ARCHIVEDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] || \
+			   [ "$(RC_RELEASE)" = "Bunsen" ] || \
+			   [ "$(RC_RELEASE)" = "Gonzo" ]; then \
+	 echo /Local/Developer/System; else echo /usr/local/lib/system; fi; )
+else
+  ARCHIVEDIR = /Local/Developer/System
+endif
+DYLIBDIR = /usr/lib/system
+
+CFILES = arch.c getsecbyname.c getsegbyname.c get_end.c \
+	 swap.c hppa_swap.c i386_swap.c m68k_swap.c sparc_swap.c \
+	 ppc_swap.c i860_swap.c m88k_swap.c
+
+INSTALL_FILES = $(CFILES) $(HFILES) shlib.ofileList dylib.ofileList Makefile \
+		notes
+
+OBJS = arch.o getsecbyname.o getsegbyname.o get_end.o swap.o \
+       hppa_swap.o i386_swap.o m68k_swap.o sparc_swap.o ppc_swap.o \
+       i860_swap.o m88k_swap.o vers.o
+
+ifeq "$(OLD_LIBKLD)" "YES"
+	KLD_OFILES = kld_ofiles
+else
+	KLD_OFILES = 
+endif
+
+all: lib_ofiles
+
+macos: optimized_ofiles $(KLD_OFILES)
+
+teflon: optimized_ofiles $(KLD_OFILES)
+
+nextstep: optimized_ofiles $(KLD_OFILES) shlib_ofiles
+
+lib_ofiles: $(OFILE_DIRS) $(SYMROOT) $(RC_OS) dynamic_ofiles profile_ofiles
+
+shlib_ofiles: $(OBJROOT)/shlib_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    (cd shlib_obj;						\
+		$(MAKE) -f ../Makefile $(OBJS)				\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		COPTS="-static -DSHLIB -I/LocalDeveloper/Headers/libsys" \
+		LIBSTUFF="-L../../libstuff -lstuff_s"			\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)");				\
+	    rm -f shlib_obj/libmacho.ofileList;				\
+	    cp shlib.ofileList shlib_obj/libmacho.ofileList;		\
+	else								\
+	    (cd $(OBJROOT)/shlib_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile $(OBJS)			\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/shlib_obj				\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="-static -DSHLIB -I/LocalDeveloper/Headers/libsys" \
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff_s"		\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)");				\
+	    rm -f $(OBJROOT)/shlib_obj/libmacho.ofileList;		\
+	    cp shlib.ofileList $(OBJROOT)/shlib_obj/libmacho.ofileList;	\
+	fi
+
+profile_ofiles:	$(OBJROOT)/profile_obj $(OBJROOT)/ptmp_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    (cd ptmp_obj;						\
+		$(MAKE) -f ../Makefile libmacho_pg.a libmacho_profile.dylib \
+		INSTALL_NAME=/usr/lib/system/libmacho_profile.dylib	\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		COPTS="-dynamic $(PG)"					\
+		LIBSTUFF="-L../../libstuff -lstuff_p"			\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)");				\
+	    (cd profile_obj; rm -f $(OBJS));				\
+	    (cd ptmp_obj; cp $(OBJS) ../profile_obj); \
+	    rm -f dynamic_profile_obj;					\
+	    ln -s ./profile_obj dynamic_profile_obj;			\
+	    rm -f profile_obj/libmacho.ofileList;			\
+	    cp dylib.ofileList profile_obj/libmacho.ofileList;		\
+	else								\
+	    (cd $(OBJROOT)/ptmp_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libmacho_pg.a		\
+		libmacho_profile.dylib					\
+		INSTALL_NAME=/usr/lib/system/libmacho_profile.dylib	\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/ptmp_obj				\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff_p"		\
+		COPTS="-dynamic $(PG)"					\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)");				\
+	    (cd $(OBJROOT)/profile_obj; rm -f $(OBJS));			\
+	    (cd $(OBJROOT)/ptmp_obj; 					\
+		cp $(OBJS) $(OBJROOT)/profile_obj); \
+	    rm -f $(OBJROOT)/dynamic_profile_obj;			\
+	    ln -s ./profile_obj $(OBJROOT)/dynamic_profile_obj;		\
+	    rm -f $(OBJROOT)/profile_obj/libmacho.ofileList;		\
+	    cp dylib.ofileList $(OBJROOT)/profile_obj/libmacho.ofileList; \
+	fi
+
+optimized_ofiles: $(OBJROOT)/optimized_obj $(OBJROOT)/otmp_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    (cd otmp_obj;						\
+		$(MAKE) -f ../Makefile libmacho_static.a		\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		COPTS="-static"						\
+		LIBSTUFF="-L../../libstuff -lstuff"			\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)");				\
+	    (cd optimized_obj; rm -f $(OBJS));				\
+	    (cd otmp_obj; cp $(OBJS) ../optimized_obj); 		\
+	    rm -f static_obj;						\
+	    ln -s ./optimized_obj static_obj;				\
+	    rm -f optimized_obj/libmacho.ofileList;			\
+	    cp dylib.ofileList optimized_obj/libmacho.ofileList;	\
+	else								\
+	    (cd $(OBJROOT)/otmp_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libmacho_static.a	\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/otmp_obj				\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="-static"						\
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)");				\
+	    (cd $(OBJROOT)/optimized_obj; rm -f $(OBJS));		\
+	    (cd $(OBJROOT)/otmp_obj; 					\
+		cp $(OBJS) $(OBJROOT)/optimized_obj); 			\
+	    rm -f $(OBJROOT)/static_obj;				\
+	    ln -s ./optimized_obj $(OBJROOT)/static_obj;		\
+	    rm -f $(OBJROOT)/optimized_obj/libmacho.ofileList;		\
+	    cp dylib.ofileList $(OBJROOT)/optimized_obj/libmacho.ofileList; \
+	fi
+
+kld_ofiles: $(OBJROOT)/kld_obj $(OBJROOT)/ktmp_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    (cd ktmp_obj;						\
+		$(MAKE) -f ../Makefile libmacho_kld.a			\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		COPTS="-static -DRLD -DSA_RLD $(KERN)"			\
+		LIBSTUFF="-L../../libstuff -lstuff_kld"			\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)");				\
+	    (cd kld_obj; rm -f $(OBJS));				\
+	    (cd ktmp_obj; cp $(OBJS) ../kld_obj); 			\
+	else								\
+	    (cd $(OBJROOT)/ktmp_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libmacho_kld.a		\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/ktmp_obj				\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="-static -DRLD -DSA_RLD $(KERN)"			\
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff_kld"		\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)");				\
+	    (cd $(OBJROOT)/kld_obj; rm -f $(OBJS));			\
+	    (cd $(OBJROOT)/ktmp_obj; 					\
+		cp $(OBJS) $(OBJROOT)/kld_obj); 			\
+	fi
+
+dynamic_ofiles: $(OBJROOT)/dynamic_obj $(OBJROOT)/dtmp_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    (cd dtmp_obj;						\
+		$(MAKE) -f ../Makefile libmacho.a libmacho.dylib	\
+		INSTALL_NAME=/usr/lib/system/libmacho.dylib		\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		COPTS="-dynamic"					\
+		LIBSTUFF="-L../../libstuff -lstuff"			\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)");				\
+	    (cd dtmp_obj;						\
+		$(MAKE) -f ../Makefile libmacho_debug.dylib		\
+		INSTALL_NAME=/usr/lib/system/libmacho_debug.dylib	\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		COPTS="-dynamic"					\
+		LIBSTUFF="-L../../libstuff -lstuff"			\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)");				\
+	    (cd dynamic_obj; rm -f $(OBJS));				\
+	    (cd dtmp_obj; cp $(OBJS) ../dynamic_obj); 			\
+	    rm -f dynamic_obj/libmacho.ofileList;			\
+	    cp dylib.ofileList dynamic_obj/libmacho.ofileList;		\
+	else								\
+	    (cd $(OBJROOT)/dtmp_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libmacho.a libmacho.dylib \
+		INSTALL_NAME=/usr/lib/system/libmacho.dylib		\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/dtmp_obj				\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
+		COPTS="-dynamic"					\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)");				\
+	    (cd $(OBJROOT)/dtmp_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libmacho_debug.dylib	\
+		INSTALL_NAME=/usr/lib/system/libmacho_debug.dylib	\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/dtmp_obj				\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		LIBSTUFF="-L$(SYMROOT)/../libstuff -lstuff"		\
+		COPTS="-dynamic"					\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)");				\
+	    (cd $(OBJROOT)/dynamic_obj; rm -f $(OBJS));			\
+	    (cd $(OBJROOT)/dtmp_obj;					\
+		cp $(OBJS) $(OBJROOT)/dynamic_obj); 			\
+	    rm -f $(OBJROOT)/dynamic_obj/libmacho.ofileList;		\
+	    cp dylib.ofileList $(OBJROOT)/dynamic_obj/libmacho.ofileList; \
+	fi
+
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c -o $(OFILE_DIR)/$*.o $<
+else
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
+		-MD -dependency-file $(OFILE_DIR)/$*.d \
+		-o $(OFILE_DIR)/$*.o $<
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+vers.c:
+	vers_string -l $(VERS_STRING_FLAGS) libmacho > $(OFILE_DIR)/$@
+	echo "const char *libmacho_version= SGS_VERS;" >> $(OFILE_DIR)/$@
+
+clean:
+	-rm -r -f $(OFILE_DIRS) $(OBJROOT)/static_obj
+
+shlib_clean:
+	-rm -r -f $(OBJROOT)/ptmp_obj $(OBJROOT)/otmp_obj $(OBJROOT)/dtmp_obj
+
+libmacho.a libmacho_pg.a libmacho_static.a libmacho_kld.a: $(OBJS)
+	libtool -static -o $(SYMROOT)/$@ $(OBJS)
+
+libmacho.dylib libmacho_profile.dylib libmacho_debug.dylib: $(OBJS)
+	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -dynamiclib  \
+		-o $(SYMROOT)/$@ $(OBJS) \
+		-install_name $(INSTALL_NAME) \
+		-compatibility_version 1 \
+		-current_version $(RC_ProjectSourceVersion) \
+		-lSystem
+
+install: $(RC_OS)_install
+
+macos_install:
+
+teflon_install nextstep_install: all
+
+
+lib_ofiles_install: $(RC_OS)_lib_ofiles_install
+
+macos_lib_ofiles_install: all
+	$(MKDIRS) $(DSTROOT)$(ARCHIVEDIR) $(DSTROOT)$(DYLIBDIR)
+	if [ $(SRCROOT) = . ];						\
+	then								\
+	    install -c -m 444 dtmp_obj/libmacho.a			\
+		     $(DSTROOT)$(ARCHIVEDIR)/libmacho.a;		\
+	    ranlib $(DSTROOT)$(ARCHIVEDIR)/libmacho.a;			\
+	    (cd $(DSTROOT)$(ARCHIVEDIR) ;				\
+	    rm -f libmacho_debug.a ; ln -s libmacho.a libmacho_debug.a); \
+	    install -c -m 444 ptmp_obj/libmacho_pg.a			 \
+		     $(DSTROOT)$(ARCHIVEDIR)/libmacho_profile.a;	\
+	    ranlib $(DSTROOT)$(ARCHIVEDIR)/libmacho_profile.a;		\
+	    install -c -m 444 otmp_obj/libmacho_static.a		\
+		     $(DSTROOT)$(ARCHIVEDIR)/libmacho_static.a;		\
+	    ranlib $(DSTROOT)$(ARCHIVEDIR)/libmacho_static.a;		\
+	    install -c -m 555 dtmp_obj/libmacho.dylib			\
+		     $(DSTROOT)$(DYLIBDIR)/libmacho.dylib;		\
+	    strip -S $(DSTROOT)$(DYLIBDIR)/libmacho.dylib;		\
+	    install -c -m 555 dtmp_obj/libmacho_profile.dylib		\
+		     $(DSTROOT)$(DYLIBDIR)/libmacho_profile.dylib;	\
+	    strip -S $(DSTROOT)$(DYLIBDIR)/libmacho_profile.dylib;	\
+	    install -c -m 555 dtmp_obj/libmacho_debug.dylib		\
+		     $(DSTROOT)$(DYLIBDIR)/libmacho_debug.dylib;	\
+	    strip -S $(DSTROOT)$(DYLIBDIR)/libmacho_debug.dylib;	\
+	else								\
+	    install -c -m 444 $(SYMROOT)/libmacho.a			\
+		     $(DSTROOT)$(ARCHIVEDIR)/libmacho.a;		\
+	    ranlib $(DSTROOT)$(ARCHIVEDIR)/libmacho.a;			\
+	    (cd $(DSTROOT)$(ARCHIVEDIR) ;				\
+	    rm -f libmacho_debug.a ; ln -s libmacho.a libmacho_debug.a); \
+	    install -c -m 444 $(SYMROOT)/libmacho_pg.a			 \
+		     $(DSTROOT)$(ARCHIVEDIR)/libmacho_profile.a;	\
+	    ranlib $(DSTROOT)$(ARCHIVEDIR)/libmacho_profile.a;		\
+	    install -c -m 444 $(SYMROOT)/libmacho_static.a		\
+		     $(DSTROOT)$(ARCHIVEDIR)/libmacho_static.a;		\
+	    ranlib $(DSTROOT)$(ARCHIVEDIR)/libmacho_static.a;		\
+	    install -c -m 555 $(SYMROOT)/libmacho.dylib			\
+		     $(DSTROOT)$(DYLIBDIR)/libmacho.dylib;		\
+	    strip -S $(DSTROOT)$(DYLIBDIR)/libmacho.dylib;		\
+	    install -c -m 555 $(SYMROOT)/libmacho_profile.dylib		\
+		     $(DSTROOT)$(DYLIBDIR)/libmacho_profile.dylib;	\
+	    strip -S $(DSTROOT)$(DYLIBDIR)/libmacho_profile.dylib;	\
+	    install -c -m 555 $(SYMROOT)/libmacho_debug.dylib	\
+		     $(DSTROOT)$(DYLIBDIR)/libmacho_debug.dylib;	\
+	    strip -S $(DSTROOT)$(DYLIBDIR)/libmacho_debug.dylib;	\
+	fi
+
+teflon_lib_ofiles_install nextstep_lib_ofiles_install:
+
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+$(OFILE_DIRS) $(SYMROOT):
+	$(MKDIRS) $@
+
+-include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/libmacho/Makefile.in cctools-806/libmacho/Makefile.in
--- cctools-806-old/libmacho/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/libmacho/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,69 @@
+builddir = @builddir@
+top_builddir = @top_builddir@
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+
+VPATH = @srcdir@
+
+prefix          = @prefix@
+exec_prefix     = @exec_prefix@
+libdir          = @libdir@
+
+CC		= @CC@
+AR		= @HOST_AR@
+RANLIB		= @HOST_RANLIB@
+CFLAGS		= @CFLAGS@
+WARNINGS	= @WARNINGS@
+CPPFLAGS	= @CPPFLAGS@
+DEFS		= @DEFS@ @ENDIAN_FLAG@
+LDFLAGS		= @LDFLAGS@
+HAVE_PRIVEXT	= @HAVE_PRIVEXT@
+HAVE_FOREIGN_HEADERS	= @HAVE_FOREIGN_HEADERS@
+
+INSTALL         = @INSTALL@
+INSTALL_DATA    = @INSTALL_DATA@
+
+ifeq ($(HAVE_PRIVEXT),NO)
+INCPRIVEXT	= -include $(top_srcdir)/include/extern.h
+endif
+
+ifeq ($(HAVE_FOREIGN_HEADERS),YES)
+FORHDRS		= -I$(top_srcdir)/include/foreign
+endif
+
+MYINCLUDES	= -I$(top_builddir)/include -I$(top_srcdir)/include \
+			$(INCPRIVEXT) $(FORHDRS)
+MYWARNINGS	= 
+MYDEFS		= 
+
+MYCOMPILEFLAGS	= $(WARNINGS) $(MYWARNINGS) $(DEFS) $(MYDEFS) \
+	$(CPPFLAGS) $(MYINCLUDES) $(CFLAGS)
+
+CFILES = arch.c
+ECFILES = @EMULATED_OBJ@
+
+OBJS = $(CFILES:.c=.o)
+EOBJS = $(ECFILES:.c=.o)
+
+.PHONY: default install clean distclean
+
+default: libmacho.a
+
+libmacho.a: $(OBJS) $(EOBJS)
+	$(AR) cru $@ $^
+	$(RANLIB) $@
+
+$(OBJS): %.o: %.c
+	$(CC) $(MYCOMPILEFLAGS) -c -o $@ $<
+
+emulated.o: $(top_srcdir)/libstuff/emulated.c
+	$(CC) $(MYCOMPILEFLAGS) -c -o $@ $<
+
+clean:
+	rm -r -f *.o
+	rm -f libmacho.a
+
+install: libmacho.a
+	mkdir -p $(DESTDIR)$(libdir)
+	$(INSTALL_DATA) $< $(DESTDIR)$(libdir)/$<
+	$(RANLIB) $(DESTDIR)$(libdir)/$<
diff -urN cctools-806-old/libstuff/apple_version.c cctools-806/libstuff/apple_version.c
--- cctools-806-old/libstuff/apple_version.c	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/libstuff/apple_version.c	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,7 @@
+#if HAVE_CONFIG_H
+#include <config.h>
+#endif
+
+const char apple_version[]= PACKAGE_NAME "-" PACKAGE_VERSION;
+const double ld64VersionNumber = 59.2;
+const char ld64VersionString[]= "@(#)PROGRAM:ld64  PROJECT:" PACKAGE_NAME "-" PACKAGE_VERSION "\n";
diff -urN cctools-806-old/libstuff/emulated.c cctools-806/libstuff/emulated.c
--- cctools-806-old/libstuff/emulated.c	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/libstuff/emulated.c	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,143 @@
+#include <config.h>
+#include <mach/mach.h>
+#include <mach/mach_error.h>
+#include <mach-o/dyld.h>
+#include <stdlib.h>
+#if defined(__CYGWIN__)
+#undef __uint32_t
+#endif
+#include <stdio.h>
+#include <unistd.h>
+#include <sys/types.h>
+#include <sys/mman.h>
+#include <sys/attr.h>
+#include <errno.h>
+
+
+
+char            *mach_error_string(mach_error_t error_value)
+{
+  return "Unknown mach error";
+}
+
+mach_port_t mach_host_self(void)
+{
+  return 0;
+}
+
+kern_return_t host_info
+(
+ host_t host,
+ host_flavor_t flavor,
+ host_info_t host_info_out,
+ mach_msg_type_number_t *host_info_outCnt
+ )
+{
+  if(flavor == HOST_BASIC_INFO) {
+    host_basic_info_t      basic_info;
+
+    basic_info = (host_basic_info_t) host_info_out;
+    memset(basic_info, 0x00, sizeof(*basic_info));
+    basic_info->cpu_type = EMULATED_HOST_CPU_TYPE;
+    basic_info->cpu_subtype = EMULATED_HOST_CPU_SUBTYPE;
+  }
+
+  return 0;
+}
+
+mach_port_t     mach_task_self_ = 0;
+
+kern_return_t mach_port_deallocate
+(
+ ipc_space_t task,
+ mach_port_name_t name
+ )
+{
+  return 0;
+}
+
+kern_return_t vm_allocate
+(
+ vm_map_t target_task,
+ vm_address_t *address,
+ vm_size_t size,
+        int flags
+ )
+{
+
+  vm_address_t addr = 0;
+
+  addr = (vm_address_t)calloc(size, sizeof(char));
+  if(addr == 0)
+    return 1;
+
+  *address = addr;
+
+  return 0;
+}
+
+kern_return_t vm_deallocate
+(
+ vm_map_t target_task,
+ vm_address_t address,
+        vm_size_t size
+ )
+{
+  //  free((void *)address); leak it here
+
+  return 0;
+}
+
+kern_return_t map_fd(
+                     int fd,
+                     vm_offset_t offset,
+                     vm_offset_t *va,
+                     boolean_t findspace,
+                     vm_size_t size)
+{
+
+  void *addr = NULL;
+
+  addr = mmap(0, size, PROT_READ|PROT_WRITE,
+	      MAP_PRIVATE|MAP_FILE, fd, offset);
+
+  if(addr == (void *)-1) {
+    return 1;
+  }
+
+  *va = (vm_offset_t)addr;
+
+  return 0;
+}
+
+#ifndef HAVE_STRMODE
+void strmode(mode_t mode, char *bp)
+{
+  sprintf(bp, "xxxxxxxxxx");
+}
+#endif
+
+#ifndef HAVE_QSORT_R
+void *_qsort_thunk = NULL;
+int (*_qsort_saved_func)(void *, const void *, const void *) = NULL;
+
+static int _qsort_comparator(const void *a, const void *b);
+
+static int _qsort_comparator(const void *a, const void *b)
+{
+  return _qsort_saved_func(_qsort_thunk, a, b);
+}
+
+void
+qsort_r(void *base, size_t nmemb, size_t size, void *thunk,
+	int (*compar)(void *, const void *, const void *))
+{
+  _qsort_thunk = thunk;
+  _qsort_saved_func = compar;
+
+  qsort(base, nmemb, size, _qsort_comparator);
+}
+
+#endif
+
+vm_size_t       vm_page_size = 4096; // hardcoded to match expectations of darwin
diff -urN cctools-806-old/libstuff/execute.c cctools-806/libstuff/execute.c
--- cctools-806-old/libstuff/execute.c	2009-04-27 19:08:52.000000000 -0500
+++ cctools-806/libstuff/execute.c	2011-09-07 01:45:04.000000000 -0500
@@ -21,6 +21,7 @@
  * @APPLE_LICENSE_HEADER_END@
  */
 #ifndef RLD
+#include "config.h"
 #include <libc.h> /* first to get rid of pre-comp warning */
 #include <mach/mach.h> /* first to get rid of pre-comp warning */
 #include "stdio.h"
@@ -137,6 +138,25 @@
 	add_execute_list(cmd_with_prefix(str));
 }
 
+#ifndef HAVE__NSGETEXECUTABLEPATH
+/**
+ * Based on MonetDB's get_bin_path
+ * http://dev.monetdb.org/hg/MonetDB/file/54ad354daff8/common/utils/mutils.c#l340
+ */
+int _NSGetExecutablePath(char *buf, unsigned long *bufsize) {
+#if defined(_MSC_VER)
+	if (GetModuleFileName(NULL, buf, (DWORD)*bufsize) != 0) {
+		return strlen;
+	}
+	return -1;
+#elif defined(HAVE_READLINK) /* Linux */
+	return readlink("/proc/self/exe", buf, *bufsize);
+#else
+	return -1; /* Fail on all other systems for now */
+#endif /* _MSC_VER */
+}
+#endif/* HAVE__NSGETEXECUTABLEPATH */
+
 /*
  * This routine is passed a string of a command name and a string is returned
  * prefixed with the path of the executable and that command name.
@@ -150,12 +170,14 @@
 	char *p;
 	char *prefix, buf[MAXPATHLEN], resolved_name[PATH_MAX];
 	unsigned long bufsize;
-
+	
 	/*
 	 * Construct the prefix to the program running.
 	 */
 	bufsize = MAXPATHLEN;
 	p = buf;
+	memset(p, 0, MAXPATHLEN);
+	memset(resolved_name, 0, PATH_MAX);
 	i = _NSGetExecutablePath(p, &bufsize);
 	if(i == -1){
 	    p = allocate(bufsize);
@@ -166,7 +188,11 @@
 	if(p != NULL)
 	    p[1] = '\0';
 
+#if defined(__APPLE__)
 	return(makestr(prefix, str, NULL));
+#else
+	return makestr(prefix, CROSS_BIN_PREFIX, "-", str, NULL);
+#endif
 }
 
 /*
diff -urN cctools-806-old/libstuff/Makefile cctools-806/libstuff/Makefile
--- cctools-806-old/libstuff/Makefile	2009-12-16 13:36:55.000000000 -0600
+++ cctools-806/libstuff/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,305 +0,0 @@
-RC_OS = macos
-OFLAG = -Os
-LTO = -DLTO_SUPPORT
-LEGACY = -D_MACH_I386_THREAD_STATUS_FPSTATE_LEGACY_FIELD_NAMES_ \
-	 -D_ARCHITECTURE_I386_FPU_FPSTATE_LEGACY_FIELD_NAMES_
-
-ifneq "$(RC_MAJOR_RELEASE_TRAIN)" "Tiger"
-KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
-       -msoft-float -nostdinc \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/PrivateHeaders \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers/libsa \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers/bsd \
-       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers \
-       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
-else
-KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
-       -msoft-float -nostdinc \
--I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
--I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/libsa \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/bsd \
-       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers \
-       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
-endif
-
-X_CFLAGS =
-
-USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
-				  [ "$(RC_XBS)" != "YES" ]; then \
-	     echo YES ; else echo NO ; \
-	     fi; )
-	
-ifneq "" "$(SDKROOT)"
-  SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
-endif
-
-G = -g
-ifeq "clang" "$(notdir $(CC))"
-  CFLAGS = $(OFLAG) $(LTO) $(G) -I$(SRCROOT)/../include -Wall \
-	   $(LEGACY) $(SDK)
-  PG =
-else
-  CFLAGS = $(OFLAG) $(LTO) $(G) -I$(SRCROOT)/../include -Wall \
-	   $(X_CFLAGS) $(LEGACY) $(SDK)
-  PG = -pg
-endif
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-SRCROOT = .
-SYMROOT = .
-OBJROOT = .
-OFILE_DIRS = $(OBJROOT)/static_obj $(OBJROOT)/dynamic_obj \
-	     $(OBJROOT)/profile_obj $(OBJROOT)/shlib_obj \
-	     $(OBJROOT)/static_kld_obj
-OFILE_DIR = $(OBJROOT)
-VPATH = $(OFILE_DIR)
-
-ifeq "$(EFITOOLS)" "efitools"
-	COFF_BYTESEX = coff_bytesex.c
-else
-	COFF_BYTESEX =
-endif
-CFILES = allocate.c errors.c arch.c execute.c bytesex.c rnd.c hppa.c \
-	  swap_headers.c reloc.c version_number.c get_toc_byte_sex.c \
-	  best_arch.c fatals.c arch_usage.c ofile.c ofile_error.c print.c \
-	  set_arch_flag_name.c seg_addr_table.c dylib_table.c \
-	  breakout.c writeout.c checkout.c fatal_arch.c ofile_get_word.c \
-	  vm_flush_cache.c hash_string.c dylib_roots.c guess_short_name.c \
-	  SymLoc.c get_arch_from_host.c crc32.c macosx_deployment_target.c \
-	  symbol_list.c unix_standard_mode.c lto.c $(COFF_BYTESEX)
-OBJS = $(CFILES:.c=.o)
-INSTALL_FILES = $(CFILES) Makefile notes
-
-ifeq "$(OLD_LIBKLD)" "YES"
-	STATIC_KLD = static_kld
-else
-	STATIC_KLD = 
-endif
-
-#all: $(OFILE_DIRS) $(SYMROOT) static dynamic profile $(STATIC_KLD) $(RC_OS)
-all: $(OFILE_DIRS) $(SYMROOT) dynamic profile $(STATIC_KLD) $(RC_OS)
-
-lib_ofiles: $(OFILE_DIRS) $(SYMROOT) dynamic
-
-lib_ofiles_install: lib_ofiles
-
-teflon macos:
-
-nextstep: shlib
-
-static: $(OBJROOT)/static_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd static_obj;						\
-		$(MAKE) -f ../Makefile libstuff.a			\
-		PRODUCT=libstuff.a					\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		SYMROOT=..						\
-		COPTS="-static"						\
-		OFLAG="$(OFLAG)"					\
-		CFILES="$(CFILES)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	else								\
-	    cd $(OBJROOT)/static_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libstuff.a		\
-		PRODUCT=libstuff.a					\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/static_obj				\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="-static"						\
-		OFLAG="$(OFLAG)"					\
-		CFILES="$(CFILES)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	fi
-
-static_kld: $(OBJROOT)/static_kld_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd static_kld_obj;						\
-		$(MAKE) -f ../Makefile libstuff_kld.a			\
-		PRODUCT=libstuff_kld.a					\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		SYMROOT=..						\
-		COPTS="-static -DRLD -DSA_RLD $(KERN)"			\
-		OFLAG="$(OFLAG)"					\
-		CFILES="$(CFILES)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	else								\
-	    cd $(OBJROOT)/static_kld_obj;				\
-		$(MAKE) -f $(SRCROOT)/Makefile libstuff_kld.a		\
-		PRODUCT=libstuff_kld.a					\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/static_kld_obj			\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="-static -DRLD -DSA_RLD $(KERN)"			\
-		OFLAG="$(OFLAG)"					\
-		CFILES="$(CFILES)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	fi
-
-dynamic: $(OBJROOT)/dynamic_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd dynamic_obj;						\
-		$(MAKE) -f ../Makefile libstuff.dylib			\
-		PRODUCT=libstuff.dylib					\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		SYMROOT=..						\
-		COPTS="$(DYNAMIC)"					\
-		OFLAG="$(OFLAG)"					\
-		CFILES="$(CFILES)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	else								\
-	    cd $(OBJROOT)/dynamic_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libstuff.dylib		\
-		PRODUCT=libstuff.dylib					\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/dynamic_obj			\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="$(DYNAMIC)"					\
-		OFLAG="$(OFLAG)"					\
-		CFILES="$(CFILES)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	fi
-
-profile: $(OBJROOT)/profile_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd profile_obj;						\
-		$(MAKE) -f ../Makefile libstuff_p.a			\
-		PRODUCT=libstuff_p.a					\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		SYMROOT=..						\
-		COPTS="$(DYNAMIC) $(PG)"				\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	else								\
-	    cd $(OBJROOT)/profile_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libstuff_p.a		\
-		PRODUCT=libstuff_p.a					\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/profile_obj			\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="$(DYNAMIC) $(PG)"				\
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	fi
-
-shlib: $(OBJROOT)/shlib_obj
-	@if [ $(SRCROOT) = . ];						\
-	then								\
-	    cd shlib_obj;						\
-		$(MAKE) -f ../Makefile libstuff_s.a			\
-		PRODUCT=libstuff_s.a					\
-		VPATH=.. 						\
-		OFILE_DIR=.						\
-		SRCROOT=..						\
-		SYMROOT=..						\
-		COPTS="-static -DSHLIB -I/LocalDeveloper/Headers/libsys" \
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	else								\
-	    cd $(OBJROOT)/shlib_obj;					\
-		$(MAKE) -f $(SRCROOT)/Makefile libstuff_s.a		\
-		PRODUCT=libstuff_s.a					\
-		VPATH=$(SRCROOT)					\
-		OFILE_DIR=$(OBJROOT)/shlib_obj				\
-		SRCROOT=$(SRCROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		COPTS="-static -DSHLIB -I/LocalDeveloper/Headers/libsys" \
-		OFLAG="$(OFLAG)"					\
-		RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)";					\
-	fi
-
-$(PRODUCT):	$(OFILE_DIR) $(SYMROOT) $(OBJS)
-	libtool -static -o $(SYMROOT)/$(PRODUCT) $(OBJS)
-
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c -o $(OFILE_DIR)/$*.o $<
-
-lto.o: lto.c
-	$(CC) -std=c99 $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
-		-I/Developer/usr/local/include \
-		-o $(OFILE_DIR)/$*.o $<
-else
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
-		-MD -dependency-file $(OFILE_DIR)/$*.d \
-		-o $(OFILE_DIR)/$*.o $<
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-
-lto.o: lto.c
-	$(CC) -std=c99 $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
-		-I/Developer/usr/local/include \
-		-MD -dependency-file $(OFILE_DIR)/$*.d \
-		-o $(OFILE_DIR)/$*.o $<
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-clean shlib_clean:
-	-rm -r -f $(OFILE_DIRS)
-	-rm -f libstuff.a libstuff.dylib libstuff_p.a libstuff_s.a
-
-install: all
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-installGASsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - Makefile bytesex.c rnd.c | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-fromGASsrc: $(OBJROOT)/dynamic_obj
-	@cd dynamic_obj;						\
-	    $(MAKE) -f ../Makefile libstuff.dylib			\
-	    PRODUCT=libstuff.dylib					\
-	    VPATH=.. 							\
-	    OFILE_DIR=.							\
-	    SRCROOT=..							\
-	    SYMROOT=..							\
-	    COPTS="$(DYNAMIC)"						\
-	    OFLAG="$(OFLAG)"						\
-	    CFILES="bytesex.c rnd.c"					\
-	    RC_CFLAGS="$(RC_CFLAGS)"					\
-	    RC_ARCHS="$(RC_ARCHS)";
-
-$(OFILE_DIRS) $(SYMROOT):
-	$(MKDIRS) $@
-
--include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/libstuff/Makefile.apple cctools-806/libstuff/Makefile.apple
--- cctools-806-old/libstuff/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/libstuff/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,305 @@
+RC_OS = macos
+OFLAG = -Os
+LTO = -DLTO_SUPPORT
+LEGACY = -D_MACH_I386_THREAD_STATUS_FPSTATE_LEGACY_FIELD_NAMES_ \
+	 -D_ARCHITECTURE_I386_FPU_FPSTATE_LEGACY_FIELD_NAMES_
+
+ifneq "$(RC_MAJOR_RELEASE_TRAIN)" "Tiger"
+KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
+       -msoft-float -nostdinc \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/PrivateHeaders \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers/libsa \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers/bsd \
+       -iwithsysroot /System/Library/Frameworks/Kernel.framework/Headers \
+       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
+else
+KERN = -fno-builtin -finline -fno-keep-inline-functions -fsigned-bitfields \
+       -msoft-float -nostdinc \
+-I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders/libsa \
+-I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/PrivateHeaders \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/libsa \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers/bsd \
+       -I$(NEXT_ROOT)/System/Library/Frameworks/Kernel.framework/Headers \
+       -DKERNEL -DKERNEL_PRIVATE -DAPPLE -DNeXT -DLIBSA_PRIVATE
+endif
+
+X_CFLAGS =
+
+USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
+				  [ "$(RC_XBS)" != "YES" ]; then \
+	     echo YES ; else echo NO ; \
+	     fi; )
+	
+ifneq "" "$(SDKROOT)"
+  SDK = -isysroot $(SDKROOT)
+  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
+endif
+
+G = -g
+ifeq "clang" "$(notdir $(CC))"
+  CFLAGS = $(OFLAG) $(LTO) $(G) -I$(SRCROOT)/../include -Wall \
+	   $(LEGACY) $(SDK)
+  PG =
+else
+  CFLAGS = $(OFLAG) $(LTO) $(G) -I$(SRCROOT)/../include -Wall \
+	   $(X_CFLAGS) $(LEGACY) $(SDK)
+  PG = -pg
+endif
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+SRCROOT = .
+SYMROOT = .
+OBJROOT = .
+OFILE_DIRS = $(OBJROOT)/static_obj $(OBJROOT)/dynamic_obj \
+	     $(OBJROOT)/profile_obj $(OBJROOT)/shlib_obj \
+	     $(OBJROOT)/static_kld_obj
+OFILE_DIR = $(OBJROOT)
+VPATH = $(OFILE_DIR)
+
+ifeq "$(EFITOOLS)" "efitools"
+	COFF_BYTESEX = coff_bytesex.c
+else
+	COFF_BYTESEX =
+endif
+CFILES = allocate.c errors.c arch.c execute.c bytesex.c rnd.c hppa.c \
+	  swap_headers.c reloc.c version_number.c get_toc_byte_sex.c \
+	  best_arch.c fatals.c arch_usage.c ofile.c ofile_error.c print.c \
+	  set_arch_flag_name.c seg_addr_table.c dylib_table.c \
+	  breakout.c writeout.c checkout.c fatal_arch.c ofile_get_word.c \
+	  vm_flush_cache.c hash_string.c dylib_roots.c guess_short_name.c \
+	  SymLoc.c get_arch_from_host.c crc32.c macosx_deployment_target.c \
+	  symbol_list.c unix_standard_mode.c lto.c $(COFF_BYTESEX)
+OBJS = $(CFILES:.c=.o)
+INSTALL_FILES = $(CFILES) Makefile notes
+
+ifeq "$(OLD_LIBKLD)" "YES"
+	STATIC_KLD = static_kld
+else
+	STATIC_KLD = 
+endif
+
+#all: $(OFILE_DIRS) $(SYMROOT) static dynamic profile $(STATIC_KLD) $(RC_OS)
+all: $(OFILE_DIRS) $(SYMROOT) dynamic profile $(STATIC_KLD) $(RC_OS)
+
+lib_ofiles: $(OFILE_DIRS) $(SYMROOT) dynamic
+
+lib_ofiles_install: lib_ofiles
+
+teflon macos:
+
+nextstep: shlib
+
+static: $(OBJROOT)/static_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd static_obj;						\
+		$(MAKE) -f ../Makefile libstuff.a			\
+		PRODUCT=libstuff.a					\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		SYMROOT=..						\
+		COPTS="-static"						\
+		OFLAG="$(OFLAG)"					\
+		CFILES="$(CFILES)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	else								\
+	    cd $(OBJROOT)/static_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libstuff.a		\
+		PRODUCT=libstuff.a					\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/static_obj				\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="-static"						\
+		OFLAG="$(OFLAG)"					\
+		CFILES="$(CFILES)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	fi
+
+static_kld: $(OBJROOT)/static_kld_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd static_kld_obj;						\
+		$(MAKE) -f ../Makefile libstuff_kld.a			\
+		PRODUCT=libstuff_kld.a					\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		SYMROOT=..						\
+		COPTS="-static -DRLD -DSA_RLD $(KERN)"			\
+		OFLAG="$(OFLAG)"					\
+		CFILES="$(CFILES)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	else								\
+	    cd $(OBJROOT)/static_kld_obj;				\
+		$(MAKE) -f $(SRCROOT)/Makefile libstuff_kld.a		\
+		PRODUCT=libstuff_kld.a					\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/static_kld_obj			\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="-static -DRLD -DSA_RLD $(KERN)"			\
+		OFLAG="$(OFLAG)"					\
+		CFILES="$(CFILES)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	fi
+
+dynamic: $(OBJROOT)/dynamic_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd dynamic_obj;						\
+		$(MAKE) -f ../Makefile libstuff.dylib			\
+		PRODUCT=libstuff.dylib					\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		SYMROOT=..						\
+		COPTS="$(DYNAMIC)"					\
+		OFLAG="$(OFLAG)"					\
+		CFILES="$(CFILES)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	else								\
+	    cd $(OBJROOT)/dynamic_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libstuff.dylib		\
+		PRODUCT=libstuff.dylib					\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/dynamic_obj			\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="$(DYNAMIC)"					\
+		OFLAG="$(OFLAG)"					\
+		CFILES="$(CFILES)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	fi
+
+profile: $(OBJROOT)/profile_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd profile_obj;						\
+		$(MAKE) -f ../Makefile libstuff_p.a			\
+		PRODUCT=libstuff_p.a					\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		SYMROOT=..						\
+		COPTS="$(DYNAMIC) $(PG)"				\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	else								\
+	    cd $(OBJROOT)/profile_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libstuff_p.a		\
+		PRODUCT=libstuff_p.a					\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/profile_obj			\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="$(DYNAMIC) $(PG)"				\
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	fi
+
+shlib: $(OBJROOT)/shlib_obj
+	@if [ $(SRCROOT) = . ];						\
+	then								\
+	    cd shlib_obj;						\
+		$(MAKE) -f ../Makefile libstuff_s.a			\
+		PRODUCT=libstuff_s.a					\
+		VPATH=.. 						\
+		OFILE_DIR=.						\
+		SRCROOT=..						\
+		SYMROOT=..						\
+		COPTS="-static -DSHLIB -I/LocalDeveloper/Headers/libsys" \
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	else								\
+	    cd $(OBJROOT)/shlib_obj;					\
+		$(MAKE) -f $(SRCROOT)/Makefile libstuff_s.a		\
+		PRODUCT=libstuff_s.a					\
+		VPATH=$(SRCROOT)					\
+		OFILE_DIR=$(OBJROOT)/shlib_obj				\
+		SRCROOT=$(SRCROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		COPTS="-static -DSHLIB -I/LocalDeveloper/Headers/libsys" \
+		OFLAG="$(OFLAG)"					\
+		RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)";					\
+	fi
+
+$(PRODUCT):	$(OFILE_DIR) $(SYMROOT) $(OBJS)
+	libtool -static -o $(SYMROOT)/$(PRODUCT) $(OBJS)
+
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c -o $(OFILE_DIR)/$*.o $<
+
+lto.o: lto.c
+	$(CC) -std=c99 $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
+		-I/Developer/usr/local/include \
+		-o $(OFILE_DIR)/$*.o $<
+else
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
+		-MD -dependency-file $(OFILE_DIR)/$*.d \
+		-o $(OFILE_DIR)/$*.o $<
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+
+lto.o: lto.c
+	$(CC) -std=c99 $(CFLAGS) $(RC_CFLAGS) $(COPTS) -c \
+		-I/Developer/usr/local/include \
+		-MD -dependency-file $(OFILE_DIR)/$*.d \
+		-o $(OFILE_DIR)/$*.o $<
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+clean shlib_clean:
+	-rm -r -f $(OFILE_DIRS)
+	-rm -f libstuff.a libstuff.dylib libstuff_p.a libstuff_s.a
+
+install: all
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+installGASsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - Makefile bytesex.c rnd.c | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+fromGASsrc: $(OBJROOT)/dynamic_obj
+	@cd dynamic_obj;						\
+	    $(MAKE) -f ../Makefile libstuff.dylib			\
+	    PRODUCT=libstuff.dylib					\
+	    VPATH=.. 							\
+	    OFILE_DIR=.							\
+	    SRCROOT=..							\
+	    SYMROOT=..							\
+	    COPTS="$(DYNAMIC)"						\
+	    OFLAG="$(OFLAG)"						\
+	    CFILES="bytesex.c rnd.c"					\
+	    RC_CFLAGS="$(RC_CFLAGS)"					\
+	    RC_ARCHS="$(RC_ARCHS)";
+
+$(OFILE_DIRS) $(SYMROOT):
+	$(MKDIRS) $@
+
+-include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/libstuff/Makefile.in cctools-806/libstuff/Makefile.in
--- cctools-806-old/libstuff/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/libstuff/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,71 @@
+builddir = @builddir@
+top_builddir = @top_builddir@
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+
+VPATH = @srcdir@
+
+CC		= @CC@
+AR		= @HOST_AR@
+RANLIB		= @HOST_RANLIB@
+CFLAGS		= @CFLAGS@
+WARNINGS	= @WARNINGS@
+MDYNAMICNOPIC	= @MDYNAMICNOPIC@
+CPPFLAGS	= @CPPFLAGS@
+DEFS		= @DEFS@ @ENDIAN_FLAG@
+LDFLAGS		= @LDFLAGS@
+HAVE_PRIVEXT	= @HAVE_PRIVEXT@
+HAVE_FOREIGN_HEADERS	= @HAVE_FOREIGN_HEADERS@
+
+ifeq ($(HAVE_PRIVEXT),NO)
+INCPRIVEXT	= -include $(top_srcdir)/include/extern.h
+endif
+
+ifeq ($(HAVE_FOREIGN_HEADERS),YES)
+FORHDRS		= -I$(top_srcdir)/include/foreign
+endif
+
+MYINCLUDES	= -I$(top_builddir)/include -I$(top_srcdir)/include \
+			$(INCPRIVEXT) $(FORHDRS)
+MYWARNINGS	= 
+MYDEFS		= 
+
+MYCOMPILEFLAGS	= $(WARNINGS) $(MYWARNINGS) $(DEFS) $(MYDEFS) \
+	$(CPPFLAGS) $(MYINCLUDES) $(CFLAGS) $(MDYNAMICNOPIC) 
+
+CFILES = allocate.c errors.c arch.c execute.c bytesex.c rnd.c hppa.c		\
+	  swap_headers.c reloc.c version_number.c get_toc_byte_sex.c		\
+	  best_arch.c fatals.c arch_usage.c ofile.c ofile_error.c print.c	\
+	  set_arch_flag_name.c seg_addr_table.c dylib_table.c			\
+	  breakout.c writeout.c checkout.c fatal_arch.c ofile_get_word.c	\
+	  hash_string.c dylib_roots.c guess_short_name.c			\
+	  SymLoc.c get_arch_from_host.c crc32.c macosx_deployment_target.c	\
+	  symbol_list.c unix_standard_mode.c @EMULATED_OBJ@ apple_version.c
+
+OBJS = $(CFILES:.c=.o)
+OBJS64 = $(CFILES:.c=.64o)
+
+
+.PHONY: default install clean distclean
+
+default: libstuff.a libstuff64.a
+
+libstuff.a: $(OBJS)
+	$(AR) cru $@ $^
+	$(RANLIB) $@
+
+libstuff64.a: $(OBJS64)
+	$(AR) cru $@ $^
+	$(RANLIB) $@
+
+$(OBJS): %.o: %.c
+	$(CC) $(MYCOMPILEFLAGS) -c -o $@ $<
+
+$(OBJS64): %.64o: %.c
+	$(CC) $(MYCOMPILEFLAGS)  -DARCH64 -c -o $@ $<
+
+clean:
+	rm -r -f *.o *.64o
+	rm -f libstuff.a libstuff64.a
+
+install:
diff -urN cctools-806-old/Makefile cctools-806/Makefile
--- cctools-806-old/Makefile	2010-09-15 18:21:10.000000000 -0500
+++ cctools-806/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,452 +0,0 @@
-# Note: For Darwin developers only building for current MacOS X release is 
-# supported.  The Openstep target will NOT build outside of Apple as it requires
-# 4.3bsd licenced code.
-#
-# Building for three target OS's are currently supported:
-#
-# MacOS X (the default)
-#	RC_OS is set to macos (the top level makefile does this)
-#	RC_CFLAGS needs -D__KODIAK__ when RC_RELEASE is Kodiak (Public Beta),
-#		to get the Public Beta directory layout.
-#	RC_CFLAGS needs -D__GONZO_BUNSEN_BEAKER__ when RC_RELEASE is Gonzo,
-#		Bunsen or Beaker to get the old directory layout.
-#	The code is #ifdef'ed with __Mach30__ is picked up from <mach/mach.h>
-# Rhapsody
-#	RC_OS is set to teflon
-#	RC_CFLAGS needs the additional flag -D__HERA__
-# Openstep
-#	RC_OS is set to nextstep
-#	RC_CFLAGS needs the additional flag -D__OPENSTEP__
-#
-export USE_APPLE_PB_SUPPORT = all
-
-DSTROOT = /
-RC_OS = macos
-RC_CFLAGS =
-
-INSTALLSRC_SUBDIRS = $(COMMON_SUBDIRS) $(SUBDIRS_32) ar include efitools \
-		     libmacho
-COMMON_SUBDIRS = libstuff as gprof misc RelNotes man cbtlibs otool
-APPLE_SUBDIRS = ar
-SUBDIRS_32 = ld
-
-ifeq "macos" "$(RC_OS)"
-  OLD_LIBKLD := $(shell if [ "$(RC_MAJOR_RELEASE_TRAIN)" = "Tiger" ] || \
-			   [ "$(RC_MAJOR_RELEASE_TRAIN)" = "Leopard" ] || \
-			   [ "$(RC_RELEASE)" = "Puma"      ]  || \
-			   [ "$(RC_RELEASE)" = "Jaguar"    ]  || \
-			   [ "$(RC_RELEASE)" = "Panther"   ]  || \
-			   [ "$(RC_RELEASE)" = "MuonPrime" ]  || \
-			   [ "$(RC_RELEASE)" = "MuonSeed"  ]  || \
-			   [ "$(RC_RELEASE)" = "SUPanWheat" ] || \
-			   [ "$(RC_RELEASE)" = "Tiger" ]      || \
-			   [ "$(RC_RELEASE)" = "SUTiSoho" ]   || \
-			   [ "$(RC_RELEASE)" = "Leopard" ]    || \
-			   [ "$(RC_RELEASE)" = "Vail" ]       || \
-			   [ "$(RC_RELEASE)" = "SugarBowl" ]  || \
-			   [ "$(RC_RELEASE)" = "BigBear" ]; then \
-				echo "YES" ; \
-			    else \
-				echo "NO" ; fi; )
-else
-  OLD_LIBKLD = NO
-endif
-
-ifeq "macos" "$(RC_OS)"
-  BUILD_DYLIBS := $(shell if [ "$(RC_RELEASE)" = "Marble" ]; then \
-				echo "NO" ; \
-			    else \
-				echo "YES" ; fi; )
-else
-  BUILD_DYLIBS = NO
-endif
-
-ifeq "macos" "$(RC_OS)"
-  TRIE := $(shell if [ "$(RC_MAJOR_RELEASE_TRAIN)" = "Tiger" ] || \
-		     [ "$(RC_MAJOR_RELEASE_TRAIN)" = "Leopard" ] || \
-		     [ "$(RC_RELEASE)" = "Puma"      ]  || \
-		     [ "$(RC_RELEASE)" = "Jaguar"    ]  || \
-		     [ "$(RC_RELEASE)" = "Panther"   ]  || \
-		     [ "$(RC_RELEASE)" = "MuonPrime" ]  || \
-		     [ "$(RC_RELEASE)" = "MuonSeed"  ]  || \
-		     [ "$(RC_RELEASE)" = "SUPanWheat" ] || \
-		     [ "$(RC_RELEASE)" = "Tiger" ]      || \
-		     [ "$(RC_RELEASE)" = "SUTiSoho" ]   || \
-		     [ "$(RC_RELEASE)" = "Leopard" ]    || \
-		     [ "$(RC_RELEASE)" = "Vail" ]       || \
-		     [ "$(RC_RELEASE)" = "SugarBowl" ]  || \
-		     [ "$(RC_RELEASE)" = "BigBear" ]    || \
-		     [ "$(RC_RELEASE)" = "Homewood" ]   || \
-		     [ "$(RC_RELEASE)" = "Kirkwood" ]   || \
-		     [ "$(RC_RELEASE)" = "Northstar" ]; then \
-			    echo "" ; \
-			else \
-			    echo "-DTRIE_SUPPORT" ; fi; )
-else
-  TRIE =
-endif
-
-ifeq "macos" "$(RC_OS)"
-  LTO := $(shell if [ "$(RC_MAJOR_RELEASE_TRAIN)" = "Tiger" ] || \
-		    [ "$(RC_MAJOR_RELEASE_TRAIN)" = "Leopard" ]; then \
-			    echo "" ; \
-			else \
-			    echo "-DLTO_SUPPORT" ; fi; )
-else
-  LTO =
-endif
-
-# work around to avoid 5820763
-ifeq "$(IPHONEOS_DEPLOYMENT_TARGET)" "2.0"
-   EFITOOLS =
-else
-   EFITOOLS = efitools
-endif
-
-ifeq "nextstep" "$(RC_OS)"
-  SUBDIRS = $(COMMON_SUBDIRS)
-else
-  SUBDIRS = $(COMMON_SUBDIRS) $(APPLE_SUBDIRS) $(EFITOOLS)
-endif
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-all clean: $(DSTROOT)
-	@if [ "$(SRCROOT)" != "" ] && \
-	    [ "$(OBJROOT)" != "" ] && \
-	    [ "$(SYMROOT)" != "" ];			\
-	then								\
-	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
-	    for i in `echo $(SUBDIRS)`;					\
-	      do							\
-		    echo =========== $(MAKE) $@ for $$i =============;	\
-		    (cd $$i; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"		\
-			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
-			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
-			EFITOOLS="$(EFITOOLS)" 				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
-			SRCROOT=$(SRCROOT)/$$i				\
-			OBJROOT=$(OBJROOT)/$$i				\
-			SYMROOT=$(SYMROOT)/$$i $@) || exit 1 ;		\
-	      done;							\
-	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
- 		| sed 's/-arch x86_64//' | sed 's/-arch armv5//'	\
-		| sed 's/-arch armv6//' | sed 's/-arch armv7//'`;	\
-	    EMPTY=`echo "$$SED_RC_CFLAGS" | sed 's/ //g'		\
-		| sed 's/-pipe//'`;					\
-	    if [ "$$EMPTY"x != "x" ];					\
-	    then							\
-	      for i in `echo $(SUBDIRS_32)`;				\
-	        do							\
-		    echo =========== $(MAKE) $@ for $$i =============;	\
-		    (cd $$i; $(MAKE) "RC_CFLAGS=$$SED_RC_CFLAGS" 	\
-			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
-			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
-			EFITOOLS="$(EFITOOLS)" 				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
-			SRCROOT=$(SRCROOT)/$$i				\
-			OBJROOT=$(OBJROOT)/$$i				\
-			SYMROOT=$(SYMROOT)/$$i $@) || exit 1 ;		\
-	        done;							\
-	    fi								\
-	else								\
-	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
-	    for i in `echo $(SUBDIRS)`;					\
-	      do							\
-		    echo =========== $(MAKE) $@ for $$i =============;	\
-		    (cd $$i; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"		\
-			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
-			EFITOOLS="$(EFITOOLS)" 				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT 	\
-			$@) || exit 1 ; 				\
-	      done;							\
-	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
- 		| sed 's/-arch x86_64//' | sed 's/-arch armv5//'	\
-		| sed 's/-arch armv6//' | sed 's/-arch armv7//'`;	\
-	    EMPTY=`echo "$$SED_RC_CFLAGS" | sed 's/ //g'		\
-		| sed 's/-pipe//'`;					\
-	    if [ "$$EMPTY"x != "x" ];					\
-	    then							\
-	      for i in `echo $(SUBDIRS_32)`;				\
-	        do							\
-		    echo =========== $(MAKE) $@ for $$i =============;	\
-		    (cd $$i; $(MAKE) RC_CFLAGS="$$SED_RC_CFLAGS"	\
-			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
-			EFITOOLS="$(EFITOOLS)"				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
-			$@) || exit 1 ; 				\
-	        done;							\
-	    fi								\
-	fi
-
-install:
-	@if [ $(SRCROOT) ];						\
-	then								\
-	    projName=`basename $(SRCROOT) | 				\
-		sed 's/-[-0-9.]*//' | sed 's/\.cvs//'`;			\
-	    if [ "$$projName" = cctools ];				\
-	    then							\
-		target=install_tools;					\
-	    elif [ "$$projName" = cctools_sdk ];			\
-	    then							\
-		target=install_tools;					\
-	    elif [ "$$projName" = cctoolslib ];				\
-	    then							\
-	    	target=lib_ofiles_install;				\
-	    else							\
-	        echo "Unknown project name $$projName";			\
-		exit 1;							\
-	    fi;								\
-	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
-	    echo =========== $(MAKE) $$target =============;		\
-	    $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		EFITOOLS="$(EFITOOLS)" TRIE="$(TRIE)"			\
-		LTO="$(LTO)" DSTROOT=$$DSTROOT/$(INSTALL_LOCATION)	\
-		SRCROOT=$(SRCROOT)					\
-		OBJROOT=$(OBJROOT)					\
-		SYMROOT=$(SYMROOT) $$target;				\
-	else								\
-	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
-	    echo =========== $(MAKE) install_tools =============;	\
-	    $(MAKE) RC_CFLAGS="$(RC_CFLAGS)" RC_ARCHS="$(RC_ARCHS)" 	\
-		RC_OS="$(RC_OS)" SUBDIRS="$(SUBDIRS)" 			\
-		SUBDIRS_32="$(SUBDIRS_32)"				\
-		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
-		EFITOOLS="$(EFITOOLS)" TRIE="$(TRIE)"			\
-		LTO="$(LTO)" DSTROOT=$$DSTROOT install_tools 		\
-		lib_ofiles_install;					\
-	fi
-
-install_tools: installhdrs
-	@if [ $(SRCROOT) ];						\
-	then								\
-	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
-	    for i in `echo $(SUBDIRS)`;					\
-	      do							\
-		    echo ======== $(MAKE) install for $$i ============;	\
-		    (cd $$i; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"		\
-			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
-			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
-			EFITOOLS="$(EFITOOLS)" 				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
-			SRCROOT=$(SRCROOT)/$$i				\
-			OBJROOT=$(OBJROOT)/$$i				\
-			SYMROOT=$(SYMROOT)/$$i install) || exit 1;	\
-	      done;							\
-	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
- 		| sed 's/-arch x86_64//' | sed 's/-arch armv5//'	\
-		| sed 's/-arch armv6//' | sed 's/-arch armv7//'`;	\
-	    EMPTY=`echo "$$SED_RC_CFLAGS" | sed 's/ //g'		\
-		| sed 's/-pipe//'`;					\
-	    if [ "$$EMPTY"x != "x" ];					\
-	    then							\
-	      for i in `echo $(SUBDIRS_32)`;				\
-	        do							\
-		    echo ======== $(MAKE) install for $$i ============;	\
-		    (cd $$i; $(MAKE) RC_CFLAGS="$$SED_RC_CFLAGS"	\
-			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
-			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
-			EFITOOLS="$(EFITOOLS)"				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
-			SRCROOT=$(SRCROOT)/$$i				\
-			OBJROOT=$(OBJROOT)/$$i				\
-			SYMROOT=$(SYMROOT)/$$i install) || exit 1;	\
-	        done;							\
-	    fi								\
-	else								\
-	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
-	    for i in `echo $(SUBDIRS)`;					\
-	      do							\
-		    echo ========= $(MAKE) install for $$i ===========;	\
-		    (cd $$i; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"		\
-			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
-			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
-			EFITOOLS="$(EFITOOLS)"				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT 	\
-			install) || exit 1;				\
-	      done;							\
-	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
- 		| sed 's/-arch x86_64//' | sed 's/-arch armv5//'	\
-		| sed 's/-arch armv6//' | sed 's/-arch armv7//'`;	\
-	    EMPTY=`echo "$$SED_RC_CFLAGS" | sed 's/ //g'		\
-		| sed 's/-pipe//'`;					\
-	    if [ "$$EMPTY"x != "x" ];					\
-	    then							\
-	      for i in `echo $(SUBDIRS_32)`;				\
-	        do							\
-		    echo ========= $(MAKE) install for $$i ===========;	\
-		    (cd $$i; $(MAKE) RC_CFLAGS="$$SED_RC_CFLAGS"	\
-			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
-			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
-			EFITOOLS="$(EFITOOLS)"				\
-			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT 	\
-			install) || exit 1;				\
-	        done;							\
-	    fi								\
-	fi
-
-ofiles_install:
-	@ export RC_FORCEHDRS=YES;					\
-	$(MAKE) RC_CFLAGS="$(RC_CFLAGS)"				\
-		RC_ARCHS="$(RC_ARCHS)"					\
-		RC_OS="$(RC_OS)"					\
-		DSTROOT=$$DSTROOT/$(INSTALL_LOCATION)			\
-		SRCROOT=$(SRCROOT)					\
-		OBJROOT=$(OBJROOT)					\
-		SYMROOT=$(SYMROOT)					\
-		EFITOOLS="$(EFITOOLS)" TRIE="$(TRIE)"			\
-		LTO="$(LTO)" lib_ofiles_install
-
-lib_ofiles lib_ofiles_install: installhdrs
-	@if [ $(SRCROOT) ];						\
-	then								\
-	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
-	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
- 		| sed 's/-arch x86_64//'`;				\
-	    echo =========== $(MAKE) $@ for libstuff =============;	\
-	    (cd libstuff; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS)"		\
-		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		DSTROOT=$$DSTROOT					\
-		SRCROOT=$(SRCROOT)/libstuff				\
-		OBJROOT=$(OBJROOT)/libstuff				\
-		SYMROOT=$(SYMROOT)/libstuff $@) || exit 1;		\
-	    echo =========== $(MAKE) all for libstuff =============;	\
-	    (cd libstuff; $(MAKE) "RC_CFLAGS=$$SED_RC_CFLAGS"		\
-		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		OLD_LIBKLD="$(OLD_LIBKLD)" 				\
-		DSTROOT=$$DSTROOT					\
-		SRCROOT=$(SRCROOT)/libstuff				\
-		OBJROOT=$(OBJROOT)/libstuff				\
-		SYMROOT=$(SYMROOT)/libstuff all) || exit 1;		\
-	    if [ $(BUILD_DYLIBS) = "YES" ];				\
-	    then							\
-	        echo =========== $(MAKE) $@ for libmacho =============;	\
-	        (cd libmacho; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"		\
-		    RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
-		    OLD_LIBKLD="$(OLD_LIBKLD)"				\
-		    DSTROOT=$$DSTROOT					\
-		    SRCROOT=$(SRCROOT)/libmacho				\
-		    OBJROOT=$(OBJROOT)/libmacho				\
-		    SYMROOT=$(SYMROOT)/libmacho $@) || exit 1;		\
-	    fi;								\
-	    echo =========== $(MAKE) $@ for ld =============;		\
-	    (cd ld; $(MAKE) "RC_CFLAGS=$$SED_RC_CFLAGS"			\
-		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		OLD_LIBKLD="$(OLD_LIBKLD)"				\
-		DSTROOT=$$DSTROOT					\
-		SRCROOT=$(SRCROOT)/ld					\
-		OBJROOT=$(OBJROOT)/ld					\
-		SYMROOT=$(SYMROOT)/ld $@) || exit 1;			\
-	    echo =========== $(MAKE) $@ for misc =============;	\
-	    (cd misc; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS)"			\
-		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		TRIE="$(TRIE)" LTO="$(LTO)"				\
-		DSTROOT=$$DSTROOT					\
-		SRCROOT=$(SRCROOT)/misc					\
-		OBJROOT=$(OBJROOT)/misc					\
-		SYMROOT=$(SYMROOT)/misc $@) || exit 1;			\
-	    echo =========== $(MAKE) $@ for cbtlibs =============;	\
-	    (cd cbtlibs; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS)"		\
-		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		DSTROOT=$$DSTROOT					\
-		SRCROOT=$(SRCROOT)/cbtlibs				\
-		OBJROOT=$(OBJROOT)/cbtlibs				\
-		SYMROOT=$(SYMROOT)/cbtlibs $@) || exit 1;		\
-	else								\
-	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
-	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
- 		| sed 's/-arch x86_64//'`;				\
-	    echo =========== $(MAKE) $@ for libstuff =============;	\
-	    (cd libstuff; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS)"		\
-		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		DSTROOT=$$DSTROOT $@) || exit 1;			\
-	    echo =========== $(MAKE) all for libstuff =============;	\
-	    (cd libstuff; $(MAKE) "RC_CFLAGS=$$SED_RC_CFLAGS"		\
-		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		DSTROOT=$$DSTROOT all) || exit 1;			\
-	    if [ $(BUILD_DYLIBS) = "YES" ];				\
-	    then							\
-	        echo =========== $(MAKE) $@ for libmacho =============;	\
-	        (cd libmacho; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"		\
-		    RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
-		    DSTROOT=$$DSTROOT $@) || exit 1;			\
-	    fi;								\
-	    echo =========== $(MAKE) $@ for ld =============;		\
-	    (cd ld; $(MAKE) "RC_CFLAGS=$$SED_RC_CFLAGS"			\
-		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		OLD_LIBKLD="$(OLD_LIBKLD)"				\
-		DSTROOT=$$DSTROOT $@) || exit 1;			\
-	    echo =========== $(MAKE) $@ for misc =============;		\
-	    (cd misc; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS)"			\
-		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		TRIE="$(TRIE)" LTO="$(LTO)"				\
-		DSTROOT=$$DSTROOT $@) || exit 1;			\
-	    (cd cbtlibs; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS)"		\
-		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-		DSTROOT=$$DSTROOT $@) || exit 1;			\
-	fi
-
-installsrc: SRCROOT
-	$(MKDIRS) $(SRCROOT)
-	cp Makefile APPLE_LICENSE PB.project $(SRCROOT)
-	for i in `echo $(INSTALLSRC_SUBDIRS)`; \
-	  do \
-		echo =========== $(MAKE) $@ for $$i =============;	\
-		(cd $$i; $(MAKE) SRCROOT=$$SRCROOT/$$i 			\
-		 EFITOOLS="$(EFITOOLS)" $@) || exit 1;	\
-	  done
-
-installGASsrc: SRCROOT
-	$(MKDIRS) $(SRCROOT)
-	cp Makefile $(SRCROOT)
-	@for i in as libstuff include ; \
-	  do \
-		echo =========== $(MAKE) $@ for $$i =============;	\
-		(cd $$i; $(MAKE) SRCROOT=$$SRCROOT/$$i $@) || exit 1;	\
-	  done
-
-fromGASsrc:
-	@CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";		\
-	echo =========== $(MAKE) fromGASsrc for libstuff =============;	\
-	(cd libstuff; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"			\
-	    RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-	    DSTROOT=$$DSTROOT fromGASsrc) || exit 1;			\
-	echo =========== $(MAKE) appc_build for as =============;	\
-	(cd as; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"			\
-	    RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
-	    DSTROOT=$$DSTROOT appc_build) || exit 1;			\
-
-installhdrs: $(DSTROOT)
-	@if [ $(SRCROOT) ];						\
-	then								\
-	    projName=`basename $(SRCROOT) | sed 's/-[0-9.]*//'`;	\
-	    if [ "$$projName" = cctools -a $(RC_OS) = macos ] &&	\
-	       [ "$(RC_FORCEHDRS)" != "YES" ];				\
-	    then							\
-	    	echo === cctools does not install headers for macos ===;\
-	    else							\
-		(cd include; $(MAKE) DSTROOT=$(DSTROOT)			\
-			RC_OS="$(RC_OS)" install) || exit 1;		\
-	    fi;								\
-	else								\
-	    (cd include; $(MAKE) DSTROOT=$(DSTROOT) RC_OS=$(RC_OS) 	\
-		install) || exit 1;					\
-	fi
-
-$(DSTROOT):
-	$(MKDIRS) $@
-
-SRCROOT:
-	@if [ -n "${$@}" ]; \
-	then \
-		exit 0; \
-	else \
-		echo Must define $@; \
-		exit 1; \
-	fi
diff -urN cctools-806-old/Makefile.apple cctools-806/Makefile.apple
--- cctools-806-old/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,452 @@
+# Note: For Darwin developers only building for current MacOS X release is 
+# supported.  The Openstep target will NOT build outside of Apple as it requires
+# 4.3bsd licenced code.
+#
+# Building for three target OS's are currently supported:
+#
+# MacOS X (the default)
+#	RC_OS is set to macos (the top level makefile does this)
+#	RC_CFLAGS needs -D__KODIAK__ when RC_RELEASE is Kodiak (Public Beta),
+#		to get the Public Beta directory layout.
+#	RC_CFLAGS needs -D__GONZO_BUNSEN_BEAKER__ when RC_RELEASE is Gonzo,
+#		Bunsen or Beaker to get the old directory layout.
+#	The code is #ifdef'ed with __Mach30__ is picked up from <mach/mach.h>
+# Rhapsody
+#	RC_OS is set to teflon
+#	RC_CFLAGS needs the additional flag -D__HERA__
+# Openstep
+#	RC_OS is set to nextstep
+#	RC_CFLAGS needs the additional flag -D__OPENSTEP__
+#
+export USE_APPLE_PB_SUPPORT = all
+
+DSTROOT = /
+RC_OS = macos
+RC_CFLAGS =
+
+INSTALLSRC_SUBDIRS = $(COMMON_SUBDIRS) $(SUBDIRS_32) ar include efitools \
+		     libmacho
+COMMON_SUBDIRS = libstuff as gprof misc RelNotes man cbtlibs otool
+APPLE_SUBDIRS = ar
+SUBDIRS_32 = ld
+
+ifeq "macos" "$(RC_OS)"
+  OLD_LIBKLD := $(shell if [ "$(RC_MAJOR_RELEASE_TRAIN)" = "Tiger" ] || \
+			   [ "$(RC_MAJOR_RELEASE_TRAIN)" = "Leopard" ] || \
+			   [ "$(RC_RELEASE)" = "Puma"      ]  || \
+			   [ "$(RC_RELEASE)" = "Jaguar"    ]  || \
+			   [ "$(RC_RELEASE)" = "Panther"   ]  || \
+			   [ "$(RC_RELEASE)" = "MuonPrime" ]  || \
+			   [ "$(RC_RELEASE)" = "MuonSeed"  ]  || \
+			   [ "$(RC_RELEASE)" = "SUPanWheat" ] || \
+			   [ "$(RC_RELEASE)" = "Tiger" ]      || \
+			   [ "$(RC_RELEASE)" = "SUTiSoho" ]   || \
+			   [ "$(RC_RELEASE)" = "Leopard" ]    || \
+			   [ "$(RC_RELEASE)" = "Vail" ]       || \
+			   [ "$(RC_RELEASE)" = "SugarBowl" ]  || \
+			   [ "$(RC_RELEASE)" = "BigBear" ]; then \
+				echo "YES" ; \
+			    else \
+				echo "NO" ; fi; )
+else
+  OLD_LIBKLD = NO
+endif
+
+ifeq "macos" "$(RC_OS)"
+  BUILD_DYLIBS := $(shell if [ "$(RC_RELEASE)" = "Marble" ]; then \
+				echo "NO" ; \
+			    else \
+				echo "YES" ; fi; )
+else
+  BUILD_DYLIBS = NO
+endif
+
+ifeq "macos" "$(RC_OS)"
+  TRIE := $(shell if [ "$(RC_MAJOR_RELEASE_TRAIN)" = "Tiger" ] || \
+		     [ "$(RC_MAJOR_RELEASE_TRAIN)" = "Leopard" ] || \
+		     [ "$(RC_RELEASE)" = "Puma"      ]  || \
+		     [ "$(RC_RELEASE)" = "Jaguar"    ]  || \
+		     [ "$(RC_RELEASE)" = "Panther"   ]  || \
+		     [ "$(RC_RELEASE)" = "MuonPrime" ]  || \
+		     [ "$(RC_RELEASE)" = "MuonSeed"  ]  || \
+		     [ "$(RC_RELEASE)" = "SUPanWheat" ] || \
+		     [ "$(RC_RELEASE)" = "Tiger" ]      || \
+		     [ "$(RC_RELEASE)" = "SUTiSoho" ]   || \
+		     [ "$(RC_RELEASE)" = "Leopard" ]    || \
+		     [ "$(RC_RELEASE)" = "Vail" ]       || \
+		     [ "$(RC_RELEASE)" = "SugarBowl" ]  || \
+		     [ "$(RC_RELEASE)" = "BigBear" ]    || \
+		     [ "$(RC_RELEASE)" = "Homewood" ]   || \
+		     [ "$(RC_RELEASE)" = "Kirkwood" ]   || \
+		     [ "$(RC_RELEASE)" = "Northstar" ]; then \
+			    echo "" ; \
+			else \
+			    echo "-DTRIE_SUPPORT" ; fi; )
+else
+  TRIE =
+endif
+
+ifeq "macos" "$(RC_OS)"
+  LTO := $(shell if [ "$(RC_MAJOR_RELEASE_TRAIN)" = "Tiger" ] || \
+		    [ "$(RC_MAJOR_RELEASE_TRAIN)" = "Leopard" ]; then \
+			    echo "" ; \
+			else \
+			    echo "-DLTO_SUPPORT" ; fi; )
+else
+  LTO =
+endif
+
+# work around to avoid 5820763
+ifeq "$(IPHONEOS_DEPLOYMENT_TARGET)" "2.0"
+   EFITOOLS =
+else
+   EFITOOLS = efitools
+endif
+
+ifeq "nextstep" "$(RC_OS)"
+  SUBDIRS = $(COMMON_SUBDIRS)
+else
+  SUBDIRS = $(COMMON_SUBDIRS) $(APPLE_SUBDIRS) $(EFITOOLS)
+endif
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+all clean: $(DSTROOT)
+	@if [ "$(SRCROOT)" != "" ] && \
+	    [ "$(OBJROOT)" != "" ] && \
+	    [ "$(SYMROOT)" != "" ];			\
+	then								\
+	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
+	    for i in `echo $(SUBDIRS)`;					\
+	      do							\
+		    echo =========== $(MAKE) $@ for $$i =============;	\
+		    (cd $$i; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"		\
+			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
+			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
+			EFITOOLS="$(EFITOOLS)" 				\
+			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
+			SRCROOT=$(SRCROOT)/$$i				\
+			OBJROOT=$(OBJROOT)/$$i				\
+			SYMROOT=$(SYMROOT)/$$i $@) || exit 1 ;		\
+	      done;							\
+	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
+ 		| sed 's/-arch x86_64//' | sed 's/-arch armv5//'	\
+		| sed 's/-arch armv6//' | sed 's/-arch armv7//'`;	\
+	    EMPTY=`echo "$$SED_RC_CFLAGS" | sed 's/ //g'		\
+		| sed 's/-pipe//'`;					\
+	    if [ "$$EMPTY"x != "x" ];					\
+	    then							\
+	      for i in `echo $(SUBDIRS_32)`;				\
+	        do							\
+		    echo =========== $(MAKE) $@ for $$i =============;	\
+		    (cd $$i; $(MAKE) "RC_CFLAGS=$$SED_RC_CFLAGS" 	\
+			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
+			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
+			EFITOOLS="$(EFITOOLS)" 				\
+			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
+			SRCROOT=$(SRCROOT)/$$i				\
+			OBJROOT=$(OBJROOT)/$$i				\
+			SYMROOT=$(SYMROOT)/$$i $@) || exit 1 ;		\
+	        done;							\
+	    fi								\
+	else								\
+	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
+	    for i in `echo $(SUBDIRS)`;					\
+	      do							\
+		    echo =========== $(MAKE) $@ for $$i =============;	\
+		    (cd $$i; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"		\
+			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
+			EFITOOLS="$(EFITOOLS)" 				\
+			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT 	\
+			$@) || exit 1 ; 				\
+	      done;							\
+	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
+ 		| sed 's/-arch x86_64//' | sed 's/-arch armv5//'	\
+		| sed 's/-arch armv6//' | sed 's/-arch armv7//'`;	\
+	    EMPTY=`echo "$$SED_RC_CFLAGS" | sed 's/ //g'		\
+		| sed 's/-pipe//'`;					\
+	    if [ "$$EMPTY"x != "x" ];					\
+	    then							\
+	      for i in `echo $(SUBDIRS_32)`;				\
+	        do							\
+		    echo =========== $(MAKE) $@ for $$i =============;	\
+		    (cd $$i; $(MAKE) RC_CFLAGS="$$SED_RC_CFLAGS"	\
+			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
+			EFITOOLS="$(EFITOOLS)"				\
+			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
+			$@) || exit 1 ; 				\
+	        done;							\
+	    fi								\
+	fi
+
+install:
+	@if [ $(SRCROOT) ];						\
+	then								\
+	    projName=`basename $(SRCROOT) | 				\
+		sed 's/-[-0-9.]*//' | sed 's/\.cvs//'`;			\
+	    if [ "$$projName" = cctools ];				\
+	    then							\
+		target=install_tools;					\
+	    elif [ "$$projName" = cctools_sdk ];			\
+	    then							\
+		target=install_tools;					\
+	    elif [ "$$projName" = cctoolslib ];				\
+	    then							\
+	    	target=lib_ofiles_install;				\
+	    else							\
+	        echo "Unknown project name $$projName";			\
+		exit 1;							\
+	    fi;								\
+	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
+	    echo =========== $(MAKE) $$target =============;		\
+	    $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		EFITOOLS="$(EFITOOLS)" TRIE="$(TRIE)"			\
+		LTO="$(LTO)" DSTROOT=$$DSTROOT/$(INSTALL_LOCATION)	\
+		SRCROOT=$(SRCROOT)					\
+		OBJROOT=$(OBJROOT)					\
+		SYMROOT=$(SYMROOT) $$target;				\
+	else								\
+	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
+	    echo =========== $(MAKE) install_tools =============;	\
+	    $(MAKE) RC_CFLAGS="$(RC_CFLAGS)" RC_ARCHS="$(RC_ARCHS)" 	\
+		RC_OS="$(RC_OS)" SUBDIRS="$(SUBDIRS)" 			\
+		SUBDIRS_32="$(SUBDIRS_32)"				\
+		VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"		\
+		EFITOOLS="$(EFITOOLS)" TRIE="$(TRIE)"			\
+		LTO="$(LTO)" DSTROOT=$$DSTROOT install_tools 		\
+		lib_ofiles_install;					\
+	fi
+
+install_tools: installhdrs
+	@if [ $(SRCROOT) ];						\
+	then								\
+	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
+	    for i in `echo $(SUBDIRS)`;					\
+	      do							\
+		    echo ======== $(MAKE) install for $$i ============;	\
+		    (cd $$i; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"		\
+			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
+			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
+			EFITOOLS="$(EFITOOLS)" 				\
+			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
+			SRCROOT=$(SRCROOT)/$$i				\
+			OBJROOT=$(OBJROOT)/$$i				\
+			SYMROOT=$(SYMROOT)/$$i install) || exit 1;	\
+	      done;							\
+	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
+ 		| sed 's/-arch x86_64//' | sed 's/-arch armv5//'	\
+		| sed 's/-arch armv6//' | sed 's/-arch armv7//'`;	\
+	    EMPTY=`echo "$$SED_RC_CFLAGS" | sed 's/ //g'		\
+		| sed 's/-pipe//'`;					\
+	    if [ "$$EMPTY"x != "x" ];					\
+	    then							\
+	      for i in `echo $(SUBDIRS_32)`;				\
+	        do							\
+		    echo ======== $(MAKE) install for $$i ============;	\
+		    (cd $$i; $(MAKE) RC_CFLAGS="$$SED_RC_CFLAGS"	\
+			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
+			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
+			EFITOOLS="$(EFITOOLS)"				\
+			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT	\
+			SRCROOT=$(SRCROOT)/$$i				\
+			OBJROOT=$(OBJROOT)/$$i				\
+			SYMROOT=$(SYMROOT)/$$i install) || exit 1;	\
+	        done;							\
+	    fi								\
+	else								\
+	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
+	    for i in `echo $(SUBDIRS)`;					\
+	      do							\
+		    echo ========= $(MAKE) install for $$i ===========;	\
+		    (cd $$i; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"		\
+			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
+			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
+			EFITOOLS="$(EFITOOLS)"				\
+			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT 	\
+			install) || exit 1;				\
+	      done;							\
+	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
+ 		| sed 's/-arch x86_64//' | sed 's/-arch armv5//'	\
+		| sed 's/-arch armv6//' | sed 's/-arch armv7//'`;	\
+	    EMPTY=`echo "$$SED_RC_CFLAGS" | sed 's/ //g'		\
+		| sed 's/-pipe//'`;					\
+	    if [ "$$EMPTY"x != "x" ];					\
+	    then							\
+	      for i in `echo $(SUBDIRS_32)`;				\
+	        do							\
+		    echo ========= $(MAKE) install for $$i ===========;	\
+		    (cd $$i; $(MAKE) RC_CFLAGS="$$SED_RC_CFLAGS"	\
+			RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
+			VERS_STRING_FLAGS="$(VERS_STRING_FLAGS)"	\
+			EFITOOLS="$(EFITOOLS)"				\
+			TRIE="$(TRIE)" LTO="$(LTO)" DSTROOT=$$DSTROOT 	\
+			install) || exit 1;				\
+	        done;							\
+	    fi								\
+	fi
+
+ofiles_install:
+	@ export RC_FORCEHDRS=YES;					\
+	$(MAKE) RC_CFLAGS="$(RC_CFLAGS)"				\
+		RC_ARCHS="$(RC_ARCHS)"					\
+		RC_OS="$(RC_OS)"					\
+		DSTROOT=$$DSTROOT/$(INSTALL_LOCATION)			\
+		SRCROOT=$(SRCROOT)					\
+		OBJROOT=$(OBJROOT)					\
+		SYMROOT=$(SYMROOT)					\
+		EFITOOLS="$(EFITOOLS)" TRIE="$(TRIE)"			\
+		LTO="$(LTO)" lib_ofiles_install
+
+lib_ofiles lib_ofiles_install: installhdrs
+	@if [ $(SRCROOT) ];						\
+	then								\
+	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
+	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
+ 		| sed 's/-arch x86_64//'`;				\
+	    echo =========== $(MAKE) $@ for libstuff =============;	\
+	    (cd libstuff; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS)"		\
+		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+		DSTROOT=$$DSTROOT					\
+		SRCROOT=$(SRCROOT)/libstuff				\
+		OBJROOT=$(OBJROOT)/libstuff				\
+		SYMROOT=$(SYMROOT)/libstuff $@) || exit 1;		\
+	    echo =========== $(MAKE) all for libstuff =============;	\
+	    (cd libstuff; $(MAKE) "RC_CFLAGS=$$SED_RC_CFLAGS"		\
+		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+		OLD_LIBKLD="$(OLD_LIBKLD)" 				\
+		DSTROOT=$$DSTROOT					\
+		SRCROOT=$(SRCROOT)/libstuff				\
+		OBJROOT=$(OBJROOT)/libstuff				\
+		SYMROOT=$(SYMROOT)/libstuff all) || exit 1;		\
+	    if [ $(BUILD_DYLIBS) = "YES" ];				\
+	    then							\
+	        echo =========== $(MAKE) $@ for libmacho =============;	\
+	        (cd libmacho; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"		\
+		    RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
+		    OLD_LIBKLD="$(OLD_LIBKLD)"				\
+		    DSTROOT=$$DSTROOT					\
+		    SRCROOT=$(SRCROOT)/libmacho				\
+		    OBJROOT=$(OBJROOT)/libmacho				\
+		    SYMROOT=$(SYMROOT)/libmacho $@) || exit 1;		\
+	    fi;								\
+	    echo =========== $(MAKE) $@ for ld =============;		\
+	    (cd ld; $(MAKE) "RC_CFLAGS=$$SED_RC_CFLAGS"			\
+		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+		OLD_LIBKLD="$(OLD_LIBKLD)"				\
+		DSTROOT=$$DSTROOT					\
+		SRCROOT=$(SRCROOT)/ld					\
+		OBJROOT=$(OBJROOT)/ld					\
+		SYMROOT=$(SYMROOT)/ld $@) || exit 1;			\
+	    echo =========== $(MAKE) $@ for misc =============;	\
+	    (cd misc; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS)"			\
+		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+		TRIE="$(TRIE)" LTO="$(LTO)"				\
+		DSTROOT=$$DSTROOT					\
+		SRCROOT=$(SRCROOT)/misc					\
+		OBJROOT=$(OBJROOT)/misc					\
+		SYMROOT=$(SYMROOT)/misc $@) || exit 1;			\
+	    echo =========== $(MAKE) $@ for cbtlibs =============;	\
+	    (cd cbtlibs; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS)"		\
+		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+		DSTROOT=$$DSTROOT					\
+		SRCROOT=$(SRCROOT)/cbtlibs				\
+		OBJROOT=$(OBJROOT)/cbtlibs				\
+		SYMROOT=$(SYMROOT)/cbtlibs $@) || exit 1;		\
+	else								\
+	    CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";	\
+	    SED_RC_CFLAGS=`echo "$(RC_CFLAGS)" | sed 's/-arch ppc64//'  \
+ 		| sed 's/-arch x86_64//'`;				\
+	    echo =========== $(MAKE) $@ for libstuff =============;	\
+	    (cd libstuff; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS)"		\
+		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+		DSTROOT=$$DSTROOT $@) || exit 1;			\
+	    echo =========== $(MAKE) all for libstuff =============;	\
+	    (cd libstuff; $(MAKE) "RC_CFLAGS=$$SED_RC_CFLAGS"		\
+		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+		DSTROOT=$$DSTROOT all) || exit 1;			\
+	    if [ $(BUILD_DYLIBS) = "YES" ];				\
+	    then							\
+	        echo =========== $(MAKE) $@ for libmacho =============;	\
+	        (cd libmacho; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"		\
+		    RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"		\
+		    DSTROOT=$$DSTROOT $@) || exit 1;			\
+	    fi;								\
+	    echo =========== $(MAKE) $@ for ld =============;		\
+	    (cd ld; $(MAKE) "RC_CFLAGS=$$SED_RC_CFLAGS"			\
+		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+		OLD_LIBKLD="$(OLD_LIBKLD)"				\
+		DSTROOT=$$DSTROOT $@) || exit 1;			\
+	    echo =========== $(MAKE) $@ for misc =============;		\
+	    (cd misc; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS)"			\
+		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+		TRIE="$(TRIE)" LTO="$(LTO)"				\
+		DSTROOT=$$DSTROOT $@) || exit 1;			\
+	    (cd cbtlibs; $(MAKE) "RC_CFLAGS=$(RC_CFLAGS)"		\
+		RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+		DSTROOT=$$DSTROOT $@) || exit 1;			\
+	fi
+
+installsrc: SRCROOT
+	$(MKDIRS) $(SRCROOT)
+	cp Makefile APPLE_LICENSE PB.project $(SRCROOT)
+	for i in `echo $(INSTALLSRC_SUBDIRS)`; \
+	  do \
+		echo =========== $(MAKE) $@ for $$i =============;	\
+		(cd $$i; $(MAKE) SRCROOT=$$SRCROOT/$$i 			\
+		 EFITOOLS="$(EFITOOLS)" $@) || exit 1;	\
+	  done
+
+installGASsrc: SRCROOT
+	$(MKDIRS) $(SRCROOT)
+	cp Makefile $(SRCROOT)
+	@for i in as libstuff include ; \
+	  do \
+		echo =========== $(MAKE) $@ for $$i =============;	\
+		(cd $$i; $(MAKE) SRCROOT=$$SRCROOT/$$i $@) || exit 1;	\
+	  done
+
+fromGASsrc:
+	@CWD=`pwd`; cd "$(DSTROOT)"; DSTROOT=`pwd`; cd "$$CWD";		\
+	echo =========== $(MAKE) fromGASsrc for libstuff =============;	\
+	(cd libstuff; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"			\
+	    RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+	    DSTROOT=$$DSTROOT fromGASsrc) || exit 1;			\
+	echo =========== $(MAKE) appc_build for as =============;	\
+	(cd as; $(MAKE) RC_CFLAGS="$(RC_CFLAGS)"			\
+	    RC_ARCHS="$(RC_ARCHS)" RC_OS="$(RC_OS)"			\
+	    DSTROOT=$$DSTROOT appc_build) || exit 1;			\
+
+installhdrs: $(DSTROOT)
+	@if [ $(SRCROOT) ];						\
+	then								\
+	    projName=`basename $(SRCROOT) | sed 's/-[0-9.]*//'`;	\
+	    if [ "$$projName" = cctools -a $(RC_OS) = macos ] &&	\
+	       [ "$(RC_FORCEHDRS)" != "YES" ];				\
+	    then							\
+	    	echo === cctools does not install headers for macos ===;\
+	    else							\
+		(cd include; $(MAKE) DSTROOT=$(DSTROOT)			\
+			RC_OS="$(RC_OS)" install) || exit 1;		\
+	    fi;								\
+	else								\
+	    (cd include; $(MAKE) DSTROOT=$(DSTROOT) RC_OS=$(RC_OS) 	\
+		install) || exit 1;					\
+	fi
+
+$(DSTROOT):
+	$(MKDIRS) $@
+
+SRCROOT:
+	@if [ -n "${$@}" ]; \
+	then \
+		exit 0; \
+	else \
+		echo Must define $@; \
+		exit 1; \
+	fi
diff -urN cctools-806-old/Makefile.in cctools-806/Makefile.in
--- cctools-806-old/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,50 @@
+CFLAGS = @CFLAGS@
+CPPFLAGS = @CPPFLAGS@
+DEFS = @DEFS@
+LDFLAGS = @LDFLAGS@
+
+builddir = @builddir@
+abs_builddir = @abs_builddir@
+top_builddir = @top_builddir@
+abs_top_builddir = @abs_top_builddir@
+srcdir = @srcdir@
+abs_srcdir = @abs_srcdir@
+top_srcdir = @top_srcdir@
+abs_top_srcdir = @abs_top_srcdir@
+
+VPATH = @srcdir@
+
+COMPONENTS = @COMPONENTS@
+
+.PHONY: default install clean distclean $(COMPONENTS)
+
+default: $(COMPONENTS)
+
+$(COMPONENTS):
+	cd $@ && $(MAKE)
+
+as ar ld ld64 misc otool: libstuff
+
+clean distclean install:
+	for c in $(COMPONENTS); do              	\
+		(cd $$c && $(MAKE) $@) || exit 1;	\
+	done
+
+$(srcdir)/configure: configure.ac
+	cd $(srcdir) && autoconf
+
+$(srcdir)/include/config.h.in: include/stamp-h.in
+$(srcdir)/include/stamp-h.in: configure.ac
+	cd $(srcdir) && autoheader
+	echo timestamp > $(srcdir)/include/stamp-h.in
+
+include/config.h: include/stamp-h
+include/stamp-h: include/config.h.in config.status
+	./config.status
+
+Makefile: Makefile.in config.status
+	./config.status
+
+config.status: configure
+	./config.status --recheck
+
diff -urN cctools-806-old/man/Makefile cctools-806/man/Makefile
--- cctools-806-old/man/Makefile	2010-03-02 20:20:26.000000000 -0600
+++ cctools-806/man/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,73 +0,0 @@
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-DYLD_MAN1 = dyld.1
-COMMON_MAN1 = as.1 gprof.1 ld_classic.1 nm.1 otool.1 ranlib.1 segedit.1 size.1 \
-	      strings.1 strip.1 lipo.1 libtool.1 cmpdylib.1 pagestuff.1 \
-	      redo_prebinding.1 nmedit.1 install_name_tool.1 \
-	      codesign_allocate.1 ctf_insert.1
-
-DYLD_MAN3 = dyld.3 NSModule.3 NSObjectFileImage.3 dyld_debug.3
-MAN3 = kld.3 arch.3 get_end.3 end.3 getsectbyname.3 \
-       getsectbynamefromheader.3 getsectdata.3 getsectdatafromheader.3 \
-       getsegbyname.3
-
-MAN5 = Mach-O.5 a.out.5 ranlib.5 stab.5
-
-MANL = indr.1 checksyms.1 seg_addr_table.1 check_dylib.1
-
-EFI1 = mtoc.1
-
-DYLD_MANL3 = NSObjectFileImage_priv.3
-MANL3 = libsyminfo.3 redo_prebinding.3
-
-INSTALL_FILES = Makefile $(COMMON_MAN1) $(MAN3) $(MAN5) $(MANL) \
-		$(MANL3) $(DYLD_MAN1) $(DYLD_MAN3) $(DYLD_MANL3) $(EFI1) notes
-
-MANDIR = /usr/share/man
-LOCMANDIR = /usr/local/man
-EFIMANDIR = /usr/local/efi/share/man
-DSTDIRS = $(DSTROOT)$(MANDIR)/man1 $(DSTROOT)$(MANDIR)/man3 \
-	  $(DSTROOT)$(MANDIR)/man5 $(DSTROOT)$(LOCMANDIR)/man1 \
-	  $(DSTROOT)$(LOCMANDIR)/man3 $(DSTROOT)$(EFIMANDIR)/man1
-
-install: $(DSTDIRS) $(COMMON_MAN1) $(MAN3) $(MAN5) $(MANL) \
-	 $(RC_OS) $(MANL3)
-	install -c -m 444 $(COMMON_MAN1) $(DSTROOT)$(MANDIR)/man1
-	if [ $(OLD_DYLD_STUFF) ];					\
-	then								\
-	    install -c -m 444 $(DYLD_MAN1) $(DSTROOT)$(MANDIR)/man1 ;	\
-	fi
-	install -c -m 444 $(MAN3) $(DSTROOT)$(MANDIR)/man3
-	if [ $(OLD_DYLD_STUFF) ];					\
-	then								\
-	    install -c -m 444 $(DYLD_MAN3) $(DSTROOT)$(MANDIR)/man3 ;	\
-	fi
-	install -c -m 444 $(MAN5) $(DSTROOT)$(MANDIR)/man5
-	install -c -m 444 $(MANL) $(DSTROOT)$(LOCMANDIR)/man1
-	install -c -m 444 $(MANL3) $(DSTROOT)$(LOCMANDIR)/man3
-	install -c -m 444 $(EFI1) $(DSTROOT)$(EFIMANDIR)/man1
-	if [ $(OLD_DYLD_STUFF) ];					\
-	then								\
-	    install -c -m 444 $(DYLD_MANL3) $(DSTROOT)$(LOCMANDIR)/man3;\
-	fi
-
-teflon macos:
-
-nextstep:
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-$(DSTDIRS):
-	$(MKDIRS) $@
-
-clean shlib_clean:
-
-all:
diff -urN cctools-806-old/man/Makefile.apple cctools-806/man/Makefile.apple
--- cctools-806-old/man/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/man/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,73 @@
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+DYLD_MAN1 = dyld.1
+COMMON_MAN1 = as.1 gprof.1 ld_classic.1 nm.1 otool.1 ranlib.1 segedit.1 size.1 \
+	      strings.1 strip.1 lipo.1 libtool.1 cmpdylib.1 pagestuff.1 \
+	      redo_prebinding.1 nmedit.1 install_name_tool.1 \
+	      codesign_allocate.1 ctf_insert.1
+
+DYLD_MAN3 = dyld.3 NSModule.3 NSObjectFileImage.3 dyld_debug.3
+MAN3 = kld.3 arch.3 get_end.3 end.3 getsectbyname.3 \
+       getsectbynamefromheader.3 getsectdata.3 getsectdatafromheader.3 \
+       getsegbyname.3
+
+MAN5 = Mach-O.5 a.out.5 ranlib.5 stab.5
+
+MANL = indr.1 checksyms.1 seg_addr_table.1 check_dylib.1
+
+EFI1 = mtoc.1
+
+DYLD_MANL3 = NSObjectFileImage_priv.3
+MANL3 = libsyminfo.3 redo_prebinding.3
+
+INSTALL_FILES = Makefile $(COMMON_MAN1) $(MAN3) $(MAN5) $(MANL) \
+		$(MANL3) $(DYLD_MAN1) $(DYLD_MAN3) $(DYLD_MANL3) $(EFI1) notes
+
+MANDIR = /usr/share/man
+LOCMANDIR = /usr/local/man
+EFIMANDIR = /usr/local/efi/share/man
+DSTDIRS = $(DSTROOT)$(MANDIR)/man1 $(DSTROOT)$(MANDIR)/man3 \
+	  $(DSTROOT)$(MANDIR)/man5 $(DSTROOT)$(LOCMANDIR)/man1 \
+	  $(DSTROOT)$(LOCMANDIR)/man3 $(DSTROOT)$(EFIMANDIR)/man1
+
+install: $(DSTDIRS) $(COMMON_MAN1) $(MAN3) $(MAN5) $(MANL) \
+	 $(RC_OS) $(MANL3)
+	install -c -m 444 $(COMMON_MAN1) $(DSTROOT)$(MANDIR)/man1
+	if [ $(OLD_DYLD_STUFF) ];					\
+	then								\
+	    install -c -m 444 $(DYLD_MAN1) $(DSTROOT)$(MANDIR)/man1 ;	\
+	fi
+	install -c -m 444 $(MAN3) $(DSTROOT)$(MANDIR)/man3
+	if [ $(OLD_DYLD_STUFF) ];					\
+	then								\
+	    install -c -m 444 $(DYLD_MAN3) $(DSTROOT)$(MANDIR)/man3 ;	\
+	fi
+	install -c -m 444 $(MAN5) $(DSTROOT)$(MANDIR)/man5
+	install -c -m 444 $(MANL) $(DSTROOT)$(LOCMANDIR)/man1
+	install -c -m 444 $(MANL3) $(DSTROOT)$(LOCMANDIR)/man3
+	install -c -m 444 $(EFI1) $(DSTROOT)$(EFIMANDIR)/man1
+	if [ $(OLD_DYLD_STUFF) ];					\
+	then								\
+	    install -c -m 444 $(DYLD_MANL3) $(DSTROOT)$(LOCMANDIR)/man3;\
+	fi
+
+teflon macos:
+
+nextstep:
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+$(DSTDIRS):
+	$(MKDIRS) $@
+
+clean shlib_clean:
+
+all:
diff -urN cctools-806-old/man/Makefile.in cctools-806/man/Makefile.in
--- cctools-806-old/man/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/man/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,51 @@
+builddir = @builddir@
+top_builddir = @top_builddir@
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+datarootdir = @datarootdir@
+prefix	= @prefix@
+exec_prefix	= @exec_prefix@
+mandir		= @mandir@
+includedir	= @includedir@
+
+VPATH = @srcdir@
+
+INSTALL		= @INSTALL@
+INSTALL_PROGRAM = @INSTALL_PROGRAM@
+INSTALL_DATA	= @INSTALL_DATA@
+transform	= @program_transform_name@
+
+MANPAGES1	= as.1 gprof.1 ld.1 nm.1 otool.1 ranlib.1 \
+		segedit.1 size.1 strings.1 strip.1 lipo.1 \
+		libtool.1 pagestuff.1 redo_prebinding.1 \
+		nmedit.1 install_name_tool.1 checksyms.1 \
+		seg_addr_table.1 ld64.1 codesign_allocate.1
+
+MANPAGES3	= arch.3
+
+MANPAGES5	= Mach-O.5 a.out.5 ranlib.5 stab.5
+
+.PHONY: default install clean distclean
+
+default:
+
+install: 
+	mkdir -p $(DESTDIR)$(mandir)
+	mkdir -p $(DESTDIR)$(mandir)/man1
+	mkdir -p $(DESTDIR)$(mandir)/man3
+	mkdir -p $(DESTDIR)$(mandir)/man5
+	for m in $(MANPAGES1); do				\
+		$(INSTALL_DATA) $(srcdir)/$$m			\
+			$(DESTDIR)$(mandir)/man1/`echo "$$m" | sed -e '$(transform)'`;		\
+	done
+	for m in $(MANPAGES3); do				\
+		$(INSTALL_DATA) $(srcdir)/$$m			\
+			$(DESTDIR)$(mandir)/man3/`echo "$$m" | sed -e '$(transform)'`;		\
+	done
+	for m in $(MANPAGES5); do				\
+		$(INSTALL_DATA) $(srcdir)/$$m			\
+			$(DESTDIR)$(mandir)/man5/`echo "$$m" | sed -e '$(transform)'`;		\
+	done
+
+
+clean:
diff -urN cctools-806-old/misc/libtool.c cctools-806/misc/libtool.c
--- cctools-806-old/misc/libtool.c	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/misc/libtool.c	2011-09-07 01:45:04.000000000 -0500
@@ -2554,7 +2554,7 @@
 		}
 		memcpy(p, arch->members[j].object_addr,
 		       arch->members[j].object_size);
-#ifdef VM_SYNC_DEACTIVATE
+#if defined(VM_SYNC_DEACTIVATE) && !defined(_POSIX_C_SOURCE) && !defined(__CYGWIN__)
 		vm_msync(mach_task_self(),
 			 (vm_address_t)arch->members[j].object_addr,
 			 (vm_size_t)arch->members[j].object_size,
diff -urN cctools-806-old/misc/Makefile cctools-806/misc/Makefile
--- cctools-806-old/misc/Makefile	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/misc/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,406 +0,0 @@
-export USE_APPLE_PB_SUPPORT = all
-OFLAG = -Os
-LTO = -DLTO_SUPPORT
-TRIE = -DTRIE_SUPPORT
-RC_OS = macos
-X_CFLAGS =
-
-ifneq "" "$(SDKROOT)"
-  SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
-  CXX = $(shell xcrun -find -sdk $(SDKROOT) g++)
-endif
-ifeq "clang" "$(notdir $(CC))"
-  CFLAGS = $(OFLAG) $(LTO) $(TRIE) -g -Wall -Wno-format-nonliteral \
-	 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
-else
-  CFLAGS = $(OFLAG) $(LTO) $(TRIE) -g -Wall $(X_CFLAGS) \
-	 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
-endif
-
-USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
-				  [ "$(RC_XBS)" != "YES" ]; then \
-	     echo YES ; else echo NO ; \
-	     fi; )
-
-LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
-
-ifeq "" "$(TRIE)"
-  LIB_PRUNETRIE =
-  else
-  LIB_PRUNETRIE = /usr/local/lib/libprunetrie.a
-endif
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-SRCROOT = .
-OBJROOT = .
-OFILE_DIR = $(OBJROOT)
-VPATH = $(OFILE_DIR)
-SYMROOT = .
-
-BINDIR = /bin
-USRBINDIR = /usr/bin
-LOCBINDIR = /usr/local/bin
-LOCLIBDIR = /usr/local/lib
-
-CFILES1 = libtool.c
-CFILES2 = lipo.c size.c strings.c nm.c checksyms.c inout.c \
-	 indr.c strip.c segedit.c cmpdylib.c \
-	 pagestuff.c redo_prebinding.c seg_addr_table.c \
-	 check_dylib.c seg_hack.c install_name_tool.c \
-	 codesign_allocate.c ctf_insert.c
-INSTALL_FILES = $(CFILES1) $(CFILES2) Makefile notes Info.plist
-
-PROGS = lipo.NEW size.NEW strings.NEW nm.NEW libtool.NEW checksyms.NEW \
-	indr.NEW strip.NEW nmedit.NEW segedit.NEW cmpdylib.NEW \
-	pagestuff.NEW redo_prebinding.NEW seg_addr_table.NEW check_dylib.NEW \
-	seg_hack.NEW install_name_tool.NEW codesign_allocate.NEW ctf_insert.NEW
-
-teflon_all macos_all: $(PROGS)
-
-nextstep_all: $(PROGS)
-
-all:	$(OFILE_DIR) $(SYMROOT) $(RC_OS)_all lib_ofiles
-
-lib_ofiles: $(OFILE_DIR) $(SYMROOT) libredo_prebinding.a
-
-vers.c:
-	vers_string -c $(VERS_STRING_FLAGS) cctools_misc > $(OFILE_DIR)/$@
-	echo "const char apple_version[]= " \"`vers_string $(VERS_STRING_FLAGS) -f cctools`\" ";" >> \
-	$(OFILE_DIR)/$@
-
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o $<
-else
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file \
-		$(OFILE_DIR)/$*.d -o $(OFILE_DIR)/$*.o $<
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-libredo_prebinding.o: redo_prebinding.c
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c \
-		-o $(OFILE_DIR)/$*.o $(SRCROOT)/redo_prebinding.c -DLIBRARY_API
-else
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file $(OFILE_DIR)/$*.d \
-		-o $(OFILE_DIR)/$*.o $(SRCROOT)/redo_prebinding.c -DLIBRARY_API
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-checksyms.NEW: checksyms.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/checksyms.private.o \
-		$(OFILE_DIR)/checksyms.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/checksyms.NEW \
-		$(OFILE_DIR)/checksyms.private.o
-
-cmpdylib.NEW: cmpdylib.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/cmpdylib.private.o \
-		$(OFILE_DIR)/cmpdylib.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/cmpdylib.NEW \
-		$(OFILE_DIR)/cmpdylib.private.o
-
-lipo.NEW: lipo.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/lipo.private.o \
-		$(OFILE_DIR)/lipo.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/lipo.NEW \
-		$(OFILE_DIR)/lipo.private.o
-
-size.NEW: size.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/size.private.o \
-		$(OFILE_DIR)/size.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/size.NEW \
-		$(OFILE_DIR)/size.private.o
-
-strings.NEW: strings.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/strings.private.o \
-		$(OFILE_DIR)/strings.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/strings.NEW \
-		$(OFILE_DIR)/strings.private.o
-
-nm.NEW: nm.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/nm.private.o \
-		$(OFILE_DIR)/nm.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/nm.NEW \
-		$(OFILE_DIR)/nm.private.o
-
-libtool.NEW: libtool.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/libtool.private.o \
-		$(OFILE_DIR)/libtool.o $(OFILE_DIR)/vers.o \
-		$(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/libtool.NEW \
-		$(OFILE_DIR)/libtool.private.o
-
-redo_prebinding.NEW: redo_prebinding.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/redo_prebinding.private.o \
-		$(OFILE_DIR)/redo_prebinding.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/redo_prebinding.NEW \
-		$(OFILE_DIR)/redo_prebinding.private.o
-
-libredo_prebinding.a: libredo_prebinding.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r -o $(OBJROOT)/libredo.o \
-		libredo_prebinding.o $(LIBSTUFF)
-	libtool -static -o $(SYMROOT)/libredo_prebinding.a $(OBJROOT)/libredo.o
-
-seg_addr_table.NEW: seg_addr_table.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/seg_addr_table.private.o \
-		$(OFILE_DIR)/seg_addr_table.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/seg_addr_table.NEW \
-		$(OFILE_DIR)/seg_addr_table.private.o
-
-check_dylib.NEW: check_dylib.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/check_dylib.private.o \
-		$(OFILE_DIR)/check_dylib.o $(OFILE_DIR)/vers.o \
-		$(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/check_dylib.NEW \
-		$(OFILE_DIR)/check_dylib.private.o
-
-inout.NEW: inout.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/inout.private.o \
-		$(OFILE_DIR)/inout.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/inout.NEW \
-		$(OFILE_DIR)/inout.private.o
-
-codesign_allocate.NEW: codesign_allocate.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/codesign_allocate.private.o \
-		$(OFILE_DIR)/codesign_allocate.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/codesign_allocate.NEW \
-		-sectcreate __TEXT __info_plist Info.plist \
-		$(OFILE_DIR)/codesign_allocate.private.o
-
-ctf_insert.NEW: ctf_insert.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/ctf_insert.private.o \
-		$(OFILE_DIR)/ctf_insert.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/ctf_insert.NEW \
-		$(OFILE_DIR)/ctf_insert.private.o
-
-seg_hack.NEW: seg_hack.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/seg_hack.private.o \
-		$(OFILE_DIR)/seg_hack.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/seg_hack.NEW \
-		$(OFILE_DIR)/seg_hack.private.o
-
-install_name_tool.NEW: install_name_tool.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/install_name_tool.private.o \
-		$(OFILE_DIR)/install_name_tool.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/install_name_tool.NEW \
-		$(OFILE_DIR)/install_name_tool.private.o
-
-indr.NEW: indr.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/indr.private.o \
-		$(OFILE_DIR)/indr.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/indr.NEW \
-		$(OFILE_DIR)/indr.private.o
-
-strip.NEW: strip.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/strip.private.o \
-		$(OFILE_DIR)/strip.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CXX) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/strip.NEW \
-		$(OFILE_DIR)/strip.private.o $(LIB_PRUNETRIE)
-
-nmedit.NEW: nmedit.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/nmedit.private.o \
-		$(OFILE_DIR)/nmedit.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/nmedit.NEW \
-		$(OFILE_DIR)/nmedit.private.o
-
-nmedit.o: strip.c
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c \
-		-o $(OFILE_DIR)/nmedit.o $(SRCROOT)/strip.c -DNMEDIT
-else
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file $(OFILE_DIR)/$*.d \
-		-o $(OFILE_DIR)/nmedit.o $(SRCROOT)/strip.c -DNMEDIT
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-segedit.NEW: segedit.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/segedit.private.o \
-		$(OFILE_DIR)/segedit.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/segedit.NEW \
-		$(OFILE_DIR)/segedit.private.o
-
-pagestuff.NEW: pagestuff.o vers.o
-	$(CC) $(RC_CFLAGS) -nostdlib -r \
-		-o $(OBJROOT)/pagestuff.private.o \
-		$(OFILE_DIR)/pagestuff.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/pagestuff.NEW \
-		$(OFILE_DIR)/pagestuff.private.o
-
-
-clean: shlib_clean
-	-rm -f \
-	$(SYMROOT)/lipo.NEW \
-	$(SYMROOT)/size.NEW \
-	$(SYMROOT)/strings.NEW \
-	$(SYMROOT)/nm.NEW \
-	$(SYMROOT)/libtool.NEW \
-	$(SYMROOT)/checksyms.NEW \
-	$(SYMROOT)/seg_addr_table.NEW \
-	$(SYMROOT)/check_dylib.NEW \
-	$(SYMROOT)/inout.NEW \
-	$(SYMROOT)/codesign_allocate.NEW \
-	$(SYMROOT)/ctf_insert.NEW \
-	$(SYMROOT)/seg_hack.NEW \
-	$(SYMROOT)/install_name_tool.NEW \
-	$(SYMROOT)/codesign_allocate.NEW \
-	$(SYMROOT)/indr.NEW \
-	$(SYMROOT)/strip.NEW \
-	$(SYMROOT)/nmedit.NEW \
-	$(SYMROOT)/segedit.NEW \
-	$(SYMROOT)/pagestuff.NEW \
-	$(SYMROOT)/redo_prebinding.NEW \
-	$(SYMROOT)/libredo_prebinding.a \
-	$(SYMROOT)/cmpdylib.NEW
-
-shlib_clean:
-	-rm -f \
-	$(OFILE_DIR)/vers.c \
-	$(OFILE_DIR)/vers.o \
-	$(OFILE_DIR)/lipo.o \
-	$(OFILE_DIR)/size.o \
-	$(OFILE_DIR)/strings.o \
-	$(OFILE_DIR)/nm.o \
-	$(OFILE_DIR)/libtool.o \
-	$(OFILE_DIR)/make.h \
-	$(OFILE_DIR)/checksyms.o \
-	$(OFILE_DIR)/inout.o \
-	$(OFILE_DIR)/codesign_allocate.o \
-	$(OFILE_DIR)/ctf_insert.o \
-	$(OFILE_DIR)/seg_hack.o \
-	$(OFILE_DIR)/install_name_tool.o \
-	$(OFILE_DIR)/indr.o \
-	$(OFILE_DIR)/segedit.o \
-	$(OFILE_DIR)/pagestuff.o \
-	$(OFILE_DIR)/redo_prebinding.o \
-	$(OFILE_DIR)/libredo_prebinding.o \
-	$(OFILE_DIR)/libredo.o \
-	$(OFILE_DIR)/seg_addr_table.o \
-	$(OFILE_DIR)/check_dylib.o \
-	$(OFILE_DIR)/cmpdylib.o \
-	$(OFILE_DIR)/nmedit.o \
-	$(OFILE_DIR)/strip.o \
-	$(OFILE_DIR)/lipo.private.o \
-	$(OFILE_DIR)/size.private.o \
-	$(OFILE_DIR)/strings.private.o \
-	$(OFILE_DIR)/nm.private.o \
-	$(OFILE_DIR)/libtool.private.o \
-	$(OFILE_DIR)/checksyms.private.o \
-	$(OFILE_DIR)/inout.private.o \
-	$(OFILE_DIR)/codesign_allocate.private.o \
-	$(OFILE_DIR)/ctf_insert.private.o \
-	$(OFILE_DIR)/seg_hack.private.o \
-	$(OFILE_DIR)/install_name_tool.private.o \
-	$(OFILE_DIR)/indr.private.o \
-	$(OFILE_DIR)/segedit.private.o \
-	$(OFILE_DIR)/pagestuff.private.o \
-	$(OFILE_DIR)/redo_prebinding.private.o \
-	$(OFILE_DIR)/seg_addr_table.private.o \
-	$(OFILE_DIR)/check_dylib.private.o \
-	$(OFILE_DIR)/cmpdylib.private.o \
-	$(OFILE_DIR)/nmedit.private.o \
-	$(OFILE_DIR)/strip.private.o \
-	-rm -f $(OFILE_DIR)/Makedep make.out
-
-install: all $(RC_OS)_install
-
-teflon_install macos_install: common_install
-	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
-	install -c -s -m 555 $(SYMROOT)/strip.NEW $(DSTROOT)$(USRBINDIR)/strip
-	install -c -s -m 555 $(SYMROOT)/strings.NEW \
-		$(DSTROOT)$(USRBINDIR)/strings
-	install -c -s -m 555 $(SYMROOT)/size.NEW $(DSTROOT)$(USRBINDIR)/size
-	install -c -s -m 555 $(SYMROOT)/nm.NEW $(DSTROOT)$(USRBINDIR)/nm
-	install -c -s -m 555 $(SYMROOT)/libtool.NEW \
-		$(DSTROOT)$(USRBINDIR)/libtool
-	(cd $(DSTROOT)$(USRBINDIR); rm -f ranlib; ln -s libtool ranlib)
-	install -c -s -m 555 $(SYMROOT)/lipo.NEW $(DSTROOT)$(USRBINDIR)/lipo
-	install -c -s -m 555 $(SYMROOT)/segedit.NEW \
-		$(DSTROOT)$(USRBINDIR)/segedit
-	install -c -s -m 555 $(SYMROOT)/cmpdylib.NEW \
-			  $(DSTROOT)$(USRBINDIR)/cmpdylib
-	install -c -s -m 555 $(SYMROOT)/pagestuff.NEW \
-			  $(DSTROOT)$(USRBINDIR)/pagestuff
-	install -c -s -m 555 $(SYMROOT)/redo_prebinding.NEW \
-			  $(DSTROOT)$(USRBINDIR)/redo_prebinding
-	install -c -s -m 555 $(SYMROOT)/nmedit.NEW $(DSTROOT)$(USRBINDIR)/nmedit
-	(cd $(DSTROOT)$(LOCBINDIR); rm -f nmedit; \
-	 ln -s $(USRBINDIR)/nmedit nmedit)
-	install -c -s -m 555 $(SYMROOT)/install_name_tool.NEW \
-			  $(DSTROOT)$(USRBINDIR)/install_name_tool
-	install -c -s -m 555 $(SYMROOT)/codesign_allocate.NEW \
-			  $(DSTROOT)$(USRBINDIR)/codesign_allocate
-	install -c -s -m 555 $(SYMROOT)/ctf_insert.NEW \
-			  $(DSTROOT)$(USRBINDIR)/ctf_insert
-
-nextstep_install: common_install
-	$(MKDIRS) $(DSTROOT)$(BINDIR)
-	$(MKDIRS) $(DSTROOT)$(LOCBINDIR)
-	install -c -s -m 555 $(SYMROOT)/strip.NEW $(DSTROOT)$(BINDIR)/strip
-	install -c -s -m 555 $(SYMROOT)/strings.NEW $(DSTROOT)$(BINDIR)/strings
-	install -c -s -m 555 $(SYMROOT)/size.NEW $(DSTROOT)$(BINDIR)/size
-	install -c -s -m 555 $(SYMROOT)/nm.NEW $(DSTROOT)$(BINDIR)/nm
-	install -c -s -m 555 $(SYMROOT)/libtool.NEW $(DSTROOT)$(BINDIR)/libtool
-	(cd $(DSTROOT)$(BINDIR); rm -f ranlib; ln -s libtool ranlib)
-	install -c -s -m 555 $(SYMROOT)/lipo.NEW $(DSTROOT)$(BINDIR)/lipo
-	install -c -s -m 555 $(SYMROOT)/segedit.NEW $(DSTROOT)$(BINDIR)/segedit
-	install -c -s -m 555 $(SYMROOT)/cmpdylib.NEW \
-		$(DSTROOT)$(BINDIR)/cmpdylib
-	install -c -s -m 555 $(SYMROOT)/pagestuff.NEW \
-		$(DSTROOT)$(BINDIR)/pagestuff
-	install -c -s -m 555 $(SYMROOT)/redo_prebinding.NEW \
-			  $(DSTROOT)$(BINDIR)/redo_prebinding
-	install -c -s -m 555 $(SYMROOT)/nmedit.NEW $(DSTROOT)$(LOCBINDIR)/nmedit
-
-common_install:
-	$(MKDIRS) $(DSTROOT)$(LOCBINDIR)
-	install -c -s -m 555 $(SYMROOT)/checksyms.NEW \
-			  $(DSTROOT)$(LOCBINDIR)/checksyms
-	install -c -s -m 555 $(SYMROOT)/seg_addr_table.NEW \
-			  $(DSTROOT)$(LOCBINDIR)/seg_addr_table
-	install -c -s -m 555 $(SYMROOT)/check_dylib.NEW \
-			  $(DSTROOT)$(LOCBINDIR)/check_dylib
-	install -c -s -m 555 $(SYMROOT)/indr.NEW $(DSTROOT)$(LOCBINDIR)/indr
-	install -c -s -m 555 $(SYMROOT)/seg_hack.NEW \
-			  $(DSTROOT)$(LOCBINDIR)/seg_hack
-
-lib_ofiles_install: lib_ofiles
-	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)
-	install -p -c -m 444 $(SYMROOT)/libredo_prebinding.a \
-		 $(DSTROOT)$(LOCLIBDIR)/libredo_prebinding.a
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-$(OFILE_DIR) $(SYMROOT):
-	$(MKDIRS) $@
-
--include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/misc/Makefile.apple cctools-806/misc/Makefile.apple
--- cctools-806-old/misc/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/misc/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,406 @@
+export USE_APPLE_PB_SUPPORT = all
+OFLAG = -Os
+LTO = -DLTO_SUPPORT
+TRIE = -DTRIE_SUPPORT
+RC_OS = macos
+X_CFLAGS =
+
+ifneq "" "$(SDKROOT)"
+  SDK = -isysroot $(SDKROOT)
+  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
+  CXX = $(shell xcrun -find -sdk $(SDKROOT) g++)
+endif
+ifeq "clang" "$(notdir $(CC))"
+  CFLAGS = $(OFLAG) $(LTO) $(TRIE) -g -Wall -Wno-format-nonliteral \
+	 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
+else
+  CFLAGS = $(OFLAG) $(LTO) $(TRIE) -g -Wall $(X_CFLAGS) \
+	 -I$(SRCROOT) -I$(SRCROOT)/../include -I$(OFILE_DIR) $(SDK)
+endif
+
+USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
+				  [ "$(RC_XBS)" != "YES" ]; then \
+	     echo YES ; else echo NO ; \
+	     fi; )
+
+LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
+
+ifeq "" "$(TRIE)"
+  LIB_PRUNETRIE =
+  else
+  LIB_PRUNETRIE = /usr/local/lib/libprunetrie.a
+endif
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+SRCROOT = .
+OBJROOT = .
+OFILE_DIR = $(OBJROOT)
+VPATH = $(OFILE_DIR)
+SYMROOT = .
+
+BINDIR = /bin
+USRBINDIR = /usr/bin
+LOCBINDIR = /usr/local/bin
+LOCLIBDIR = /usr/local/lib
+
+CFILES1 = libtool.c
+CFILES2 = lipo.c size.c strings.c nm.c checksyms.c inout.c \
+	 indr.c strip.c segedit.c cmpdylib.c \
+	 pagestuff.c redo_prebinding.c seg_addr_table.c \
+	 check_dylib.c seg_hack.c install_name_tool.c \
+	 codesign_allocate.c ctf_insert.c
+INSTALL_FILES = $(CFILES1) $(CFILES2) Makefile notes Info.plist
+
+PROGS = lipo.NEW size.NEW strings.NEW nm.NEW libtool.NEW checksyms.NEW \
+	indr.NEW strip.NEW nmedit.NEW segedit.NEW cmpdylib.NEW \
+	pagestuff.NEW redo_prebinding.NEW seg_addr_table.NEW check_dylib.NEW \
+	seg_hack.NEW install_name_tool.NEW codesign_allocate.NEW ctf_insert.NEW
+
+teflon_all macos_all: $(PROGS)
+
+nextstep_all: $(PROGS)
+
+all:	$(OFILE_DIR) $(SYMROOT) $(RC_OS)_all lib_ofiles
+
+lib_ofiles: $(OFILE_DIR) $(SYMROOT) libredo_prebinding.a
+
+vers.c:
+	vers_string -c $(VERS_STRING_FLAGS) cctools_misc > $(OFILE_DIR)/$@
+	echo "const char apple_version[]= " \"`vers_string $(VERS_STRING_FLAGS) -f cctools`\" ";" >> \
+	$(OFILE_DIR)/$@
+
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o $<
+else
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file \
+		$(OFILE_DIR)/$*.d -o $(OFILE_DIR)/$*.o $<
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+libredo_prebinding.o: redo_prebinding.c
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c \
+		-o $(OFILE_DIR)/$*.o $(SRCROOT)/redo_prebinding.c -DLIBRARY_API
+else
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file $(OFILE_DIR)/$*.d \
+		-o $(OFILE_DIR)/$*.o $(SRCROOT)/redo_prebinding.c -DLIBRARY_API
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+checksyms.NEW: checksyms.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/checksyms.private.o \
+		$(OFILE_DIR)/checksyms.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/checksyms.NEW \
+		$(OFILE_DIR)/checksyms.private.o
+
+cmpdylib.NEW: cmpdylib.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/cmpdylib.private.o \
+		$(OFILE_DIR)/cmpdylib.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/cmpdylib.NEW \
+		$(OFILE_DIR)/cmpdylib.private.o
+
+lipo.NEW: lipo.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/lipo.private.o \
+		$(OFILE_DIR)/lipo.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/lipo.NEW \
+		$(OFILE_DIR)/lipo.private.o
+
+size.NEW: size.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/size.private.o \
+		$(OFILE_DIR)/size.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/size.NEW \
+		$(OFILE_DIR)/size.private.o
+
+strings.NEW: strings.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/strings.private.o \
+		$(OFILE_DIR)/strings.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/strings.NEW \
+		$(OFILE_DIR)/strings.private.o
+
+nm.NEW: nm.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/nm.private.o \
+		$(OFILE_DIR)/nm.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/nm.NEW \
+		$(OFILE_DIR)/nm.private.o
+
+libtool.NEW: libtool.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/libtool.private.o \
+		$(OFILE_DIR)/libtool.o $(OFILE_DIR)/vers.o \
+		$(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/libtool.NEW \
+		$(OFILE_DIR)/libtool.private.o
+
+redo_prebinding.NEW: redo_prebinding.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/redo_prebinding.private.o \
+		$(OFILE_DIR)/redo_prebinding.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/redo_prebinding.NEW \
+		$(OFILE_DIR)/redo_prebinding.private.o
+
+libredo_prebinding.a: libredo_prebinding.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r -o $(OBJROOT)/libredo.o \
+		libredo_prebinding.o $(LIBSTUFF)
+	libtool -static -o $(SYMROOT)/libredo_prebinding.a $(OBJROOT)/libredo.o
+
+seg_addr_table.NEW: seg_addr_table.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/seg_addr_table.private.o \
+		$(OFILE_DIR)/seg_addr_table.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/seg_addr_table.NEW \
+		$(OFILE_DIR)/seg_addr_table.private.o
+
+check_dylib.NEW: check_dylib.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/check_dylib.private.o \
+		$(OFILE_DIR)/check_dylib.o $(OFILE_DIR)/vers.o \
+		$(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/check_dylib.NEW \
+		$(OFILE_DIR)/check_dylib.private.o
+
+inout.NEW: inout.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/inout.private.o \
+		$(OFILE_DIR)/inout.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/inout.NEW \
+		$(OFILE_DIR)/inout.private.o
+
+codesign_allocate.NEW: codesign_allocate.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/codesign_allocate.private.o \
+		$(OFILE_DIR)/codesign_allocate.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/codesign_allocate.NEW \
+		-sectcreate __TEXT __info_plist Info.plist \
+		$(OFILE_DIR)/codesign_allocate.private.o
+
+ctf_insert.NEW: ctf_insert.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/ctf_insert.private.o \
+		$(OFILE_DIR)/ctf_insert.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/ctf_insert.NEW \
+		$(OFILE_DIR)/ctf_insert.private.o
+
+seg_hack.NEW: seg_hack.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/seg_hack.private.o \
+		$(OFILE_DIR)/seg_hack.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/seg_hack.NEW \
+		$(OFILE_DIR)/seg_hack.private.o
+
+install_name_tool.NEW: install_name_tool.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/install_name_tool.private.o \
+		$(OFILE_DIR)/install_name_tool.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/install_name_tool.NEW \
+		$(OFILE_DIR)/install_name_tool.private.o
+
+indr.NEW: indr.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/indr.private.o \
+		$(OFILE_DIR)/indr.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/indr.NEW \
+		$(OFILE_DIR)/indr.private.o
+
+strip.NEW: strip.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/strip.private.o \
+		$(OFILE_DIR)/strip.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CXX) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/strip.NEW \
+		$(OFILE_DIR)/strip.private.o $(LIB_PRUNETRIE)
+
+nmedit.NEW: nmedit.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/nmedit.private.o \
+		$(OFILE_DIR)/nmedit.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/nmedit.NEW \
+		$(OFILE_DIR)/nmedit.private.o
+
+nmedit.o: strip.c
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c \
+		-o $(OFILE_DIR)/nmedit.o $(SRCROOT)/strip.c -DNMEDIT
+else
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file $(OFILE_DIR)/$*.d \
+		-o $(OFILE_DIR)/nmedit.o $(SRCROOT)/strip.c -DNMEDIT
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+segedit.NEW: segedit.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/segedit.private.o \
+		$(OFILE_DIR)/segedit.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/segedit.NEW \
+		$(OFILE_DIR)/segedit.private.o
+
+pagestuff.NEW: pagestuff.o vers.o
+	$(CC) $(RC_CFLAGS) -nostdlib -r \
+		-o $(OBJROOT)/pagestuff.private.o \
+		$(OFILE_DIR)/pagestuff.o $(OFILE_DIR)/vers.o $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/pagestuff.NEW \
+		$(OFILE_DIR)/pagestuff.private.o
+
+
+clean: shlib_clean
+	-rm -f \
+	$(SYMROOT)/lipo.NEW \
+	$(SYMROOT)/size.NEW \
+	$(SYMROOT)/strings.NEW \
+	$(SYMROOT)/nm.NEW \
+	$(SYMROOT)/libtool.NEW \
+	$(SYMROOT)/checksyms.NEW \
+	$(SYMROOT)/seg_addr_table.NEW \
+	$(SYMROOT)/check_dylib.NEW \
+	$(SYMROOT)/inout.NEW \
+	$(SYMROOT)/codesign_allocate.NEW \
+	$(SYMROOT)/ctf_insert.NEW \
+	$(SYMROOT)/seg_hack.NEW \
+	$(SYMROOT)/install_name_tool.NEW \
+	$(SYMROOT)/codesign_allocate.NEW \
+	$(SYMROOT)/indr.NEW \
+	$(SYMROOT)/strip.NEW \
+	$(SYMROOT)/nmedit.NEW \
+	$(SYMROOT)/segedit.NEW \
+	$(SYMROOT)/pagestuff.NEW \
+	$(SYMROOT)/redo_prebinding.NEW \
+	$(SYMROOT)/libredo_prebinding.a \
+	$(SYMROOT)/cmpdylib.NEW
+
+shlib_clean:
+	-rm -f \
+	$(OFILE_DIR)/vers.c \
+	$(OFILE_DIR)/vers.o \
+	$(OFILE_DIR)/lipo.o \
+	$(OFILE_DIR)/size.o \
+	$(OFILE_DIR)/strings.o \
+	$(OFILE_DIR)/nm.o \
+	$(OFILE_DIR)/libtool.o \
+	$(OFILE_DIR)/make.h \
+	$(OFILE_DIR)/checksyms.o \
+	$(OFILE_DIR)/inout.o \
+	$(OFILE_DIR)/codesign_allocate.o \
+	$(OFILE_DIR)/ctf_insert.o \
+	$(OFILE_DIR)/seg_hack.o \
+	$(OFILE_DIR)/install_name_tool.o \
+	$(OFILE_DIR)/indr.o \
+	$(OFILE_DIR)/segedit.o \
+	$(OFILE_DIR)/pagestuff.o \
+	$(OFILE_DIR)/redo_prebinding.o \
+	$(OFILE_DIR)/libredo_prebinding.o \
+	$(OFILE_DIR)/libredo.o \
+	$(OFILE_DIR)/seg_addr_table.o \
+	$(OFILE_DIR)/check_dylib.o \
+	$(OFILE_DIR)/cmpdylib.o \
+	$(OFILE_DIR)/nmedit.o \
+	$(OFILE_DIR)/strip.o \
+	$(OFILE_DIR)/lipo.private.o \
+	$(OFILE_DIR)/size.private.o \
+	$(OFILE_DIR)/strings.private.o \
+	$(OFILE_DIR)/nm.private.o \
+	$(OFILE_DIR)/libtool.private.o \
+	$(OFILE_DIR)/checksyms.private.o \
+	$(OFILE_DIR)/inout.private.o \
+	$(OFILE_DIR)/codesign_allocate.private.o \
+	$(OFILE_DIR)/ctf_insert.private.o \
+	$(OFILE_DIR)/seg_hack.private.o \
+	$(OFILE_DIR)/install_name_tool.private.o \
+	$(OFILE_DIR)/indr.private.o \
+	$(OFILE_DIR)/segedit.private.o \
+	$(OFILE_DIR)/pagestuff.private.o \
+	$(OFILE_DIR)/redo_prebinding.private.o \
+	$(OFILE_DIR)/seg_addr_table.private.o \
+	$(OFILE_DIR)/check_dylib.private.o \
+	$(OFILE_DIR)/cmpdylib.private.o \
+	$(OFILE_DIR)/nmedit.private.o \
+	$(OFILE_DIR)/strip.private.o \
+	-rm -f $(OFILE_DIR)/Makedep make.out
+
+install: all $(RC_OS)_install
+
+teflon_install macos_install: common_install
+	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
+	install -c -s -m 555 $(SYMROOT)/strip.NEW $(DSTROOT)$(USRBINDIR)/strip
+	install -c -s -m 555 $(SYMROOT)/strings.NEW \
+		$(DSTROOT)$(USRBINDIR)/strings
+	install -c -s -m 555 $(SYMROOT)/size.NEW $(DSTROOT)$(USRBINDIR)/size
+	install -c -s -m 555 $(SYMROOT)/nm.NEW $(DSTROOT)$(USRBINDIR)/nm
+	install -c -s -m 555 $(SYMROOT)/libtool.NEW \
+		$(DSTROOT)$(USRBINDIR)/libtool
+	(cd $(DSTROOT)$(USRBINDIR); rm -f ranlib; ln -s libtool ranlib)
+	install -c -s -m 555 $(SYMROOT)/lipo.NEW $(DSTROOT)$(USRBINDIR)/lipo
+	install -c -s -m 555 $(SYMROOT)/segedit.NEW \
+		$(DSTROOT)$(USRBINDIR)/segedit
+	install -c -s -m 555 $(SYMROOT)/cmpdylib.NEW \
+			  $(DSTROOT)$(USRBINDIR)/cmpdylib
+	install -c -s -m 555 $(SYMROOT)/pagestuff.NEW \
+			  $(DSTROOT)$(USRBINDIR)/pagestuff
+	install -c -s -m 555 $(SYMROOT)/redo_prebinding.NEW \
+			  $(DSTROOT)$(USRBINDIR)/redo_prebinding
+	install -c -s -m 555 $(SYMROOT)/nmedit.NEW $(DSTROOT)$(USRBINDIR)/nmedit
+	(cd $(DSTROOT)$(LOCBINDIR); rm -f nmedit; \
+	 ln -s $(USRBINDIR)/nmedit nmedit)
+	install -c -s -m 555 $(SYMROOT)/install_name_tool.NEW \
+			  $(DSTROOT)$(USRBINDIR)/install_name_tool
+	install -c -s -m 555 $(SYMROOT)/codesign_allocate.NEW \
+			  $(DSTROOT)$(USRBINDIR)/codesign_allocate
+	install -c -s -m 555 $(SYMROOT)/ctf_insert.NEW \
+			  $(DSTROOT)$(USRBINDIR)/ctf_insert
+
+nextstep_install: common_install
+	$(MKDIRS) $(DSTROOT)$(BINDIR)
+	$(MKDIRS) $(DSTROOT)$(LOCBINDIR)
+	install -c -s -m 555 $(SYMROOT)/strip.NEW $(DSTROOT)$(BINDIR)/strip
+	install -c -s -m 555 $(SYMROOT)/strings.NEW $(DSTROOT)$(BINDIR)/strings
+	install -c -s -m 555 $(SYMROOT)/size.NEW $(DSTROOT)$(BINDIR)/size
+	install -c -s -m 555 $(SYMROOT)/nm.NEW $(DSTROOT)$(BINDIR)/nm
+	install -c -s -m 555 $(SYMROOT)/libtool.NEW $(DSTROOT)$(BINDIR)/libtool
+	(cd $(DSTROOT)$(BINDIR); rm -f ranlib; ln -s libtool ranlib)
+	install -c -s -m 555 $(SYMROOT)/lipo.NEW $(DSTROOT)$(BINDIR)/lipo
+	install -c -s -m 555 $(SYMROOT)/segedit.NEW $(DSTROOT)$(BINDIR)/segedit
+	install -c -s -m 555 $(SYMROOT)/cmpdylib.NEW \
+		$(DSTROOT)$(BINDIR)/cmpdylib
+	install -c -s -m 555 $(SYMROOT)/pagestuff.NEW \
+		$(DSTROOT)$(BINDIR)/pagestuff
+	install -c -s -m 555 $(SYMROOT)/redo_prebinding.NEW \
+			  $(DSTROOT)$(BINDIR)/redo_prebinding
+	install -c -s -m 555 $(SYMROOT)/nmedit.NEW $(DSTROOT)$(LOCBINDIR)/nmedit
+
+common_install:
+	$(MKDIRS) $(DSTROOT)$(LOCBINDIR)
+	install -c -s -m 555 $(SYMROOT)/checksyms.NEW \
+			  $(DSTROOT)$(LOCBINDIR)/checksyms
+	install -c -s -m 555 $(SYMROOT)/seg_addr_table.NEW \
+			  $(DSTROOT)$(LOCBINDIR)/seg_addr_table
+	install -c -s -m 555 $(SYMROOT)/check_dylib.NEW \
+			  $(DSTROOT)$(LOCBINDIR)/check_dylib
+	install -c -s -m 555 $(SYMROOT)/indr.NEW $(DSTROOT)$(LOCBINDIR)/indr
+	install -c -s -m 555 $(SYMROOT)/seg_hack.NEW \
+			  $(DSTROOT)$(LOCBINDIR)/seg_hack
+
+lib_ofiles_install: lib_ofiles
+	$(MKDIRS) $(DSTROOT)$(LOCLIBDIR)
+	install -p -c -m 444 $(SYMROOT)/libredo_prebinding.a \
+		 $(DSTROOT)$(LOCLIBDIR)/libredo_prebinding.a
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+$(OFILE_DIR) $(SYMROOT):
+	$(MKDIRS) $@
+
+-include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/misc/Makefile.in cctools-806/misc/Makefile.in
--- cctools-806-old/misc/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/misc/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,161 @@
+builddir = @builddir@
+top_builddir = @top_builddir@
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+
+prefix		= @prefix@
+exec_prefix	= @exec_prefix@
+bindir		= @bindir@
+
+VPATH = @srcdir@
+
+CC              = @CC@
+CFLAGS          = @CFLAGS@
+WARNINGS	= @WARNINGS@
+MDYNAMICNOPIC   = @MDYNAMICNOPIC@
+CPPFLAGS        = @CPPFLAGS@
+DEFS            = @DEFS@ @ENDIAN_FLAG@
+LDFLAGS         = @LDFLAGS@
+HAVE_PRIVEXT    = @HAVE_PRIVEXT@
+HAVE_FOREIGN_HEADERS    = @HAVE_FOREIGN_HEADERS@
+
+ifeq ($(HAVE_PRIVEXT),NO)
+INCPRIVEXT      = -include $(top_srcdir)/include/extern.h
+endif
+
+ifeq ($(HAVE_FOREIGN_HEADERS),YES)
+FORHDRS         = -I$(top_srcdir)/include/foreign
+endif
+
+INSTALL		= @INSTALL@
+INSTALL_PROGRAM	= @INSTALL_PROGRAM@
+transform       = @program_transform_name@
+LDPROG		= $(shell echo ld | sed '$(transform)')
+LD64PROG	= $(shell echo ld64 | sed '$(transform)')
+LIPO            = $(shell echo lipo | sed '$(transform)')
+
+MYINCLUDES      = -I$(builddir) -I$(srcdir) -I$(top_builddir)/include \
+			-I$(top_srcdir)/include $(INCPRIVEXT) $(FORHDRS)
+MYWARNINGS      = 
+MYDEFS          = -DBINDIR="\"$(bindir)\"" -DLDPROG="\"$(LDPROG)\"" \
+			-DLD64PROG="\"$(LD64PROG)\"" -DLIPO="\"$(LIPO)\""
+MYLDFLAGS	= -L$(top_builddir)/libstuff
+MYLIBS		= -lstuff
+
+MYCOMPILEFLAGS	= $(WARNINGS) $(MYWARNINGS) $(DEFS) $(MYDEFS) \
+	$(CPPFLAGS) $(MYINCLUDES) $(CFLAGS) $(MDYNAMICNOPIC) 
+
+MYLINKFLAGS	= $(LDFLAGS) $(MYLDFLAGS) $(MYLIBS)
+
+PROGRAMS = checksyms lipo size strings nm libtool redo_prebinding seg_addr_table \
+		seg_hack install_name_tool indr strip nmedit segedit pagestuff \
+		ranlib codesign_allocate
+
+CFILES_checksyms	= checksyms.c
+OBJS_checksyms	= $(CFILES_checksyms:.c=.o)
+
+CFILES_lipo	= lipo.c
+OBJS_lipo	= $(CFILES_lipo:.c=.o)
+
+CFILES_size	= size.c
+OBJS_size	= $(CFILES_size:.c=.o)
+
+CFILES_strings	= strings.c
+OBJS_strings	= $(CFILES_strings:.c=.o)
+
+CFILES_nm	= nm.c
+OBJS_nm		= $(CFILES_nm:.c=.o)
+
+CFILES_libtool	= libtool.c
+OBJS_libtool	= $(CFILES_libtool:.c=.o)
+
+CFILES_ranlib	= ranlib.c
+OBJS_ranlib	= $(CFILES_ranlib:.c=.o)
+
+CFILES_redo_prebinding	= redo_prebinding.o
+OBJS_redo_prebinding	= $(CFILES_redo_prebinding:.c=.o)
+
+CFILES_seg_addr_table	= seg_addr_table.c
+OBJS_seg_addr_table	= $(CFILES_seg_addr_table:.c=.o)
+
+CFILES_seg_hack	= seg_hack.c
+OBJS_seg_hack	= $(CFILES_seg_hack:.c=.o)
+
+CFILES_codesign_allocate	= codesign_allocate.c
+OBJS_codesign_allocate		= $(CFILES_codesign_allocate:.c=.o)
+
+CFILES_install_name_tool	= install_name_tool.c
+OBJS_install_name_tool		= $(CFILES_install_name_tool:.c=.o)
+
+CFILES_indr	= indr.c
+OBJS_indr	= $(CFILES_indr:.c=.o)
+
+CFILES_strip	= strip.c
+OBJS_strip	= $(CFILES_strip:.c=.o)
+
+CFILES_nmedit	= strip.c
+OBJS_nmedit	= nmedit.o
+
+CFILES_segedit	= segedit.c
+OBJS_segedit	= $(CFILES_segedit:.c=.o)
+
+CFILES_pagestuff	= pagestuff.c
+OBJS_pagestuff	= $(CFILES_pagestuff:.c=.o)
+
+.c.o:
+	$(CC) $(MYCOMPILEFLAGS) -c -o $@ $<
+
+.PHONY: default clean distclean install
+
+default: $(PROGRAMS)
+
+ranlib.o: ranlib.c
+	$(CC) -DRANLIB $(MYCOMPILEFLAGS) -c -o $@ $<
+
+nmedit.o: strip.c
+	$(CC) -DNMEDIT $(MYCOMPILEFLAGS) -c -o $@ $<
+
+checksyms: $(OBJS_checksyms)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+lipo: $(OBJS_lipo)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+size: $(OBJS_size)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+strings: $(OBJS_strings)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+nm: $(OBJS_nm)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+libtool: $(OBJS_libtool)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+redo_prebinding: $(OBJS_redo_prebinding)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+seg_addr_table: $(OBJS_seg_addr_table)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+seg_hack: $(OBJS_seg_hack)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+codesign_allocate: $(OBJS_codesign_allocate)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+install_name_tool: $(OBJS_install_name_tool)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+indr: $(OBJS_indr)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+strip: $(OBJS_strip)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+nmedit: $(OBJS_nmedit)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+segedit: $(OBJS_segedit)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+pagestuff: $(OBJS_pagestuff)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+ranlib: $(OBJS_ranlib)
+	$(CC) -o $@ $^ $(MYLINKFLAGS)
+
+install: $(PROGRAMS)
+	mkdir -p $(DESTDIR)$(bindir)
+	for p in $(PROGRAMS); do					\
+		$(INSTALL_PROGRAM) $$p 					\
+			$(DESTDIR)$(bindir)/`echo $$p | sed '$(transform)'`;	\
+	done
+clean:
+	rm -r -f *.o
+	rm -f $(PROGRAMS)
diff -urN cctools-806-old/misc/ranlib.c cctools-806/misc/ranlib.c
--- cctools-806-old/misc/ranlib.c	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/misc/ranlib.c	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,4000 @@
+/*
+ * Copyright (c) 1999-2003 Apple Computer, Inc.  All Rights Reserved.
+ *
+ * @APPLE_LICENSE_HEADER_START@
+ *
+ * This file contains Original Code and/or Modifications of Original Code
+ * as defined in and that are subject to the Apple Public Source License
+ * Version 2.0 (the 'License'). You may not use this file except in
+ * compliance with the License. Please obtain a copy of the License at
+ * http://www.opensource.apple.com/apsl/ and read it before using this
+ * file.
+ *
+ * The Original Code and all software distributed under the License are
+ * distributed on an 'AS IS' basis, WITHOUT WARRANTY OF ANY KIND, EITHER
+ * EXPRESS OR IMPLIED, AND APPLE HEREBY DISCLAIMS ALL SUCH WARRANTIES,
+ * INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE, QUIET ENJOYMENT OR NON-INFRINGEMENT.
+ * Please see the License for the specific language governing rights and
+ * limitations under the License.
+ *
+ * @APPLE_LICENSE_HEADER_END@
+ */
+/*
+ * The NeXT Computer, Inc. libtool(1) program that handles fat files, archives
+ * and Mach-O objects files (no 4.3bsd a.out files).  This is also the ranlib(1)
+ * program.
+ */
+
+/*
+ * NOTE: This is identical to libtool.c except that it is forced into ranlib mode.
+ */
+
+#include <mach/mach.h>
+#include "stuff/openstep_mach.h"
+#include <libc.h>
+#ifndef __OPENSTEP__
+#include <utime.h>
+#endif
+#include <stdio.h>
+#include <stdlib.h>
+#include <string.h>
+#include <signal.h>
+#include <ar.h>
+#include <mach-o/ranlib.h>
+#include <sys/types.h>
+#include <sys/stat.h>
+#include <sys/mman.h>
+#include "stuff/bool.h"
+#include "stuff/ofile.h"
+#include "stuff/rnd.h"
+#include "stuff/errors.h"
+#include "stuff/allocate.h"
+#include "stuff/execute.h"
+#include "stuff/version_number.h"
+#include "stuff/unix_standard_mode.h"
+#ifdef LTO_SUPPORT
+#include "stuff/lto.h"
+#endif /* LTO_SUPPORT */
+
+#include <mach/mach_init.h>
+#if defined(__OPENSTEP__) || defined(__GONZO_BUNSEN_BEAKER__)
+#include <servers/netname.h>
+#else
+#include <servers/bootstrap.h>
+#endif
+
+/*
+ * This is used internally to build the table of contents.
+ */
+struct toc {
+    char *name;		/* symbol defined by */
+    int32_t index1;	/* library member at this index plus 1 */
+};
+
+/* used by error routines as the name of the program */
+char *progname = NULL;
+
+/* the bytesex of the host this program is running on */
+static enum byte_sex host_byte_sex = UNKNOWN_BYTE_SEX;
+
+/*
+ * The time the table of contents' are set to and the time to base the
+ * modification time of the output file to be set to.
+ */
+static time_t toc_time = 0;
+
+/*
+ * The environment variable ZERO_AR_DATE is used here and other places that
+ * write archives to allow testing and comparing things for exact binary
+ * equality.
+ */
+static enum bool zero_ar_date = FALSE;
+
+/*
+ * The mode of the table of contents member (S_IFREG | (0666 & ~umask))
+ */
+static u_short toc_mode = 0;
+
+/* flags set from the command line arguments */
+struct cmd_flags {
+    char **files;	/* array of file name arguments */
+    uint32_t
+	nfiles;		/* number of file name arguments */
+    char **filelist;	/* filelist argument the file name argument came from */
+    enum bool
+	no_files_ok;	/* ok to see no files */
+    enum bool ranlib;	/* set if this is run as ranlib not libtool */
+    enum bool s;	/* sort the table of contents */
+    enum bool a;	/* don't sort the table of contents (original form) */
+    enum bool c;	/* include commmon symbols in the table of contents */
+    enum bool t;	/* just "touch" the archives to get the date right */
+    enum bool f;	/* warn if the output archive is fat,used by ar(1) -s */
+    enum bool q;	/* only write archive if NOT fat, used by ar(1) */
+    char *output;	/* the output file specified by -o */
+    enum bool final_output_specified; /* if -final_output is specified */
+    enum bool dynamic;	/* create a dynamic shared library, static by default */
+    char *compatibility;/* compatibility version if specified, NULL otherwise */
+    char *current;	/* current version if specified, NULL otherwise */
+    char *install_name; /* install name if specified, NULL otherwise */
+    char *seg1addr;	/* seg1addr if specified, NULL otherwise */
+    char *segs_read_only_addr;	/* segs_read_only_addr if specified, or NULL */
+    char *segs_read_write_addr;	/* segs_read_write_addr if specified, or NULL */
+    char *seg_addr_table;	/* seg_addr_table if specified, or NULL */
+    char *seg_addr_table_filename;
+			/* seg_addr_table_filename if specified, or NULL */
+    char **Ldirs;	/* array of -Ldir arguments */
+    uint32_t
+	nLdirs;		/* number of -Ldir arguments */
+    char **ldflags;	/* other ld(1) flags to pass */
+    uint32_t
+	nldflags;	/* number of ld(1) flags for above */
+    enum bool verbose;	/* print exec(2) commands run */
+    struct arch_flag
+	arch_only_flag;	/* the -arch_only flag if specified */
+    enum bool		/* set if either -prebind or -noprebind is seen */
+	prebinding_flag_specified;
+    enum bool		/* set if -prebind is seen or the LD_PREBIND */
+	prebinding;	/*  environment variable is set (and -noprebind isn't)*/
+    enum bool		/* set if either -all_load or -noall_load is seen */
+	all_load_flag_specified;
+    enum bool		/* set if -all_load is seen (and -noall_load isn't) */
+	all_load;
+    enum bool		/* set with -L (the default) off with -T, for -static */
+	use_long_names; /* use 4.4bsd extended format 1 for long names */
+    enum bool L_or_T_specified;
+    enum bool		/* set if the environ var LD_TRACE_ARCHIVES is set */
+	ld_trace_archives;
+	const char *	/* LD_TRACE_FILE if set and LD_TRACE_ARCHIVES is set, or NULL */
+	trace_file_path;
+    enum bool		/* set if -search_paths_first is specified */
+	search_paths_first;
+    enum bool noflush;	/* don't use the output_flush routine to flush the
+			   static library output file by pages */
+    uint32_t debug;	/* debug value to debug output_flush() routine */
+};
+static struct cmd_flags cmd_flags = { 0 };
+
+/* The value of the environment variable NEXT_ROOT */
+static char *next_root = NULL;
+
+/* the standard directories to search for -lx names */
+char *standard_dirs[] = {
+    "/lib/",
+    "/usr/lib/",
+    "/usr/local/lib/",
+    NULL
+};
+
+/*
+ * The input files are broken down in to their object files and then placed in
+ * these structures.  They are sorted by architecture type and then each object
+ * has a member struct created for it in one of the arch structs.  All of these
+ * structs hang off of 'archs'.
+ */
+static struct arch *archs = NULL;
+static uint32_t narchs = 0;
+
+struct arch {
+    struct arch_flag arch_flag;	/* the identifing info of this architecture */
+    uint32_t size;		/* current working size and final size */
+
+    /* the table of contents (toc) stuff for this architecture in the library */
+    uint32_t  toc_size;	/* total size of the toc including ar_hdr */
+    struct ar_hdr  toc_ar_hdr;	/* the archive header for this member */
+    enum bool toc_long_name;    /* use the long name in the output */
+    char *toc_name;		/* name of toc member */
+    uint32_t toc_name_size;/* size of name of toc member */
+    struct toc    *tocs;	/* internal table of contents */
+    struct ranlib *toc_ranlibs;	/* ranlib structs for output */
+    uint32_t       toc_nranlibs;/* number of ranlib structs */
+    char	  *toc_strings;	/* strings of symbol names for ranlib structs */
+    uint32_t       toc_strsize;	/* number of bytes for the strings above */
+
+    /* the members of this architecture in the library */
+    struct member *members;	/* the members of the library for this arch */
+    uint32_t nmembers;	/* the number of the above members */
+};
+
+struct member {
+    uint32_t offset;	    	    /* current working offset and final offset*/
+    struct ar_hdr ar_hdr;	    /* the archive header for this member */
+    char null_byte;		    /* space to write '\0' for ar_hdr */
+    char *object_addr;		    /* the address of the object file */
+    uint32_t object_size;	    /* the size of the object file */
+    enum byte_sex object_byte_sex;  /* the byte sex of the object file */
+    struct mach_header *mh;	    /* the mach_header of 32-bit object files */
+    struct mach_header_64 *mh64;    /* the mach_header of 64-bit object files */
+    struct load_command		    /* the start of the load commands */
+	*load_commands;
+    struct symtab_command *st;	    /* the symbol table command */
+    struct section **sections;	    /* array of section structs for 32-bit */
+    struct section_64 **sections64; /* array of section structs for 64-bit */
+#ifdef LTO_SUPPORT
+    void *lto;			    /* lto module */
+#endif /* LTO_SUPPORT */
+
+    /* the name of the member in the output */
+    char         *member_name;	    /* the member name */
+    uint32_t member_name_size;	    /* the size of the member name */
+    enum bool output_long_name;	    /* use the extended format #1 for the
+				       member name in the output */
+
+    /* info recorded from the input file this member came from */
+    char	  *input_file_name;	/* the input file name */
+    char	  *input_base_name;     /* the base name in the input file */
+    uint32_t  input_base_name_size;	/* the size of the base name */
+    struct ar_hdr *input_ar_hdr;
+    uint32_t      input_member_offset;  /* if from a thin archive */
+};
+
+static void usage(
+    void);
+static void process(
+    void);
+static char *file_name_from_l_flag(
+    char *l_flag);
+static char *search_for_file(
+    char *base_name);
+static char * search_paths_for_lname(
+    const char *lname_argument);
+static char * search_path_for_lname(
+    const char *dir,
+    const char *lname_argument);
+static void add_member(
+    struct ofile *ofile);
+static void free_archs(
+    void);
+static void create_library(
+    char *output,
+    struct ofile *ofile);
+static enum byte_sex get_target_byte_sex(
+    struct arch *arch,
+    enum byte_sex host_byte_sex);
+static char *put_toc_member(
+    char *p,
+    struct arch *arch,
+    enum byte_sex host_byte_sex,
+    enum byte_sex target_byte_sex);
+static void create_dynamic_shared_library(
+    char *output);
+static void create_dynamic_shared_library_cleanup(
+    int sig);
+static void make_table_of_contents(
+    struct arch *arch,
+    char *output);
+static int toc_name_qsort(
+    const struct toc *toc1,
+    const struct toc *toc2);
+static int toc_index1_qsort(
+    const struct toc *toc1,
+    const struct toc *toc2);
+static enum bool toc_symbol(
+    struct nlist *symbol,
+    struct section **sections);
+static enum bool toc_symbol_64(
+    struct nlist_64 *symbol64,
+    struct section_64 **sections64);
+static enum bool toc(
+    uint32_t n_strx,
+    uint8_t n_type,
+    uint64_t n_value,
+    enum bool attr_no_toc);
+static enum bool check_sort_tocs(
+    struct arch *arch,
+    char *output,
+    enum bool library_warnings);
+static void warn_duplicate_member_names(
+    void);
+static int member_name_qsort(
+    const struct member *member1,
+    const struct member *member2);
+static int member_offset_qsort(
+    const struct member *member1,
+    const struct member *member2);
+static void warn_member(
+    struct arch *arch,
+    struct member *member,
+    const char *format, ...) __attribute__ ((format (printf, 3, 4)));
+static void ld_trace(
+    const char *format, ...) __attribute__ ((format (printf, 1, 2)));
+
+/*
+ * This structure is used to describe blocks of the output file that are flushed
+ * to the disk file with output_flush.  It is kept in an ordered list starting
+ * with output_blocks.
+ */
+static struct block {
+    uint32_t offset;	/* starting offset of this block */
+    uint32_t size;		/* size of this block */
+    uint32_t written_offset;/* first page offset after starting offset */
+    uint32_t written_size;	/* size of written area from written_offset */
+    struct block *next; /* next block in the list */
+} *output_blocks;
+
+static void output_flush(
+    char *library,
+    uint32_t library_size,
+    int fd,
+    uint32_t offset,
+    uint32_t size);
+static void final_output_flush(
+    char *library,
+    int fd);
+#ifdef DEBUG
+static void print_block_list(void);
+#endif /* DEBUG */
+static struct block *get_block(void);
+static void remove_block(
+    struct block *block);
+static uint32_t trnc(
+    uint32_t v,
+    uint32_t r);
+
+/* apple_version is in vers.c which is created by the Makefile */
+extern char apple_version[];
+
+int
+main(
+int argc,
+char **argv,
+char **envp)
+{
+    char *p, *endp, *filelist, *dirname, *addr;
+    int fd, i;
+    struct stat stat_buf;
+    uint32_t j, nfiles, maxfiles;
+    uint32_t temp;
+    int oumask, numask;
+    enum bool lflags_seen, bad_flag_seen, Vflag;
+
+	lflags_seen = FALSE;
+	Vflag = FALSE;
+	progname = argv[0];
+
+	host_byte_sex = get_host_byte_sex();
+
+	/*
+	 * The environment variable ZERO_AR_DATE is used here and other
+	 * places that write archives to allow testing and comparing
+	 * things for exact binary equality.
+	 */
+	if(getenv("ZERO_AR_DATE") == NULL)
+	    zero_ar_date = FALSE;
+	else
+	    zero_ar_date = TRUE;
+	if(zero_ar_date == FALSE)
+	    toc_time = time(0);
+	else
+	    toc_time = 0;
+
+	numask = 0;
+	oumask = umask(numask);
+	toc_mode = S_IFREG | (0666 & ~oumask);
+	(void)umask(oumask);
+
+	/* see if this is being run as ranlib */
+	p = strrchr(argv[0], '/');
+	if(p != NULL)
+	    p++;
+	else
+	    p = argv[0];
+
+	cmd_flags.ranlib = TRUE;
+
+	/* The default is to used long names */
+	cmd_flags.use_long_names = TRUE;
+
+	/* process the command line arguments and collect the files */
+	maxfiles = argc;
+        cmd_flags.files = allocate(sizeof(char *) * maxfiles);
+        cmd_flags.filelist = allocate(sizeof(char *) * maxfiles);
+        memset(cmd_flags.filelist, '\0', sizeof(char *) * maxfiles);
+	for(i = 1; i < argc; i++){
+	    if(argv[i][0] == '-'){
+		if(argv[i][1] == '\0'){
+		    for(i += 1 ; i < argc; i++)
+			cmd_flags.files[cmd_flags.nfiles++] = argv[i];
+		    break;
+		}
+		if(strcmp(argv[i], "-o") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 == argc){
+			error("missing argument to: %s option", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.output != NULL){
+			error("more than one: %s option specified", argv[i]);
+			usage();
+		    }
+		    cmd_flags.output = argv[i+1];
+		    i++;
+		}
+		else if(strcmp(argv[i], "-arch_only") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 == argc){
+			error("missing argument to %s option", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.arch_only_flag.name != NULL){
+			error("more than one: %s option specified", argv[i]);
+			usage();
+		    }
+		    else{
+			if(get_arch_from_flag(argv[i+1],
+					      &cmd_flags.arch_only_flag) == 0){
+			    error("unknown architecture specification flag: "
+				  "%s %s", argv[i], argv[i+1]);
+			    arch_usage();
+			    usage();
+			}
+		    }
+		    i++;
+		}
+		else if(strcmp(argv[i], "-dynamic") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    cmd_flags.dynamic = TRUE;
+		}
+		else if(strcmp(argv[i], "-static") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    cmd_flags.dynamic = FALSE;
+		}
+		else if(strcmp(argv[i], "-filelist") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 == argc){
+			error("missing argument to: %s option", argv[i]);
+			usage();
+		    }
+		    filelist = argv[i + 1];
+		    dirname = strrchr(filelist, ',');
+		    if(dirname != NULL){
+			*dirname = '\0';
+			dirname++;
+		    }
+		    else
+			dirname = "";
+		    if((fd = open(filelist, O_RDONLY, 0)) == -1)
+			system_fatal("can't open file list file: %s", filelist);
+		    if(fstat(fd, &stat_buf) == -1)
+			system_fatal("can't stat file list file: %s", filelist);
+		    /*
+		     * For some reason mapping files with zero size fails
+		     * so it has to be handled specially.
+		     */
+		    addr = NULL;
+		    if(stat_buf.st_size != 0){
+			addr = mmap(0, stat_buf.st_size, PROT_READ|PROT_WRITE,
+				    MAP_FILE|MAP_PRIVATE, fd, 0);
+			if((intptr_t)addr == -1)
+			    system_error("can't map file list file: %s",
+				         filelist);
+		    }
+		    else{
+			fatal("file list file: %s is empty", filelist);
+		    }
+		    if(*dirname != '\0')
+			dirname[-1] = ',';
+		    close(fd);
+		    nfiles = 0;
+		    for(j = 0; j < stat_buf.st_size; j++){
+			if(addr[j] == '\n')
+			    nfiles++;
+		    }
+		    if(addr[stat_buf.st_size - 1] != '\n')
+			nfiles++;
+		    p = allocate((strlen(dirname) + 1) * nfiles +
+				 stat_buf.st_size);
+		    cmd_flags.files = reallocate(cmd_flags.files,
+					sizeof(char *) * (maxfiles + nfiles));
+        	    cmd_flags.filelist = reallocate(cmd_flags.filelist,
+					sizeof(char *) * (maxfiles + nfiles));
+        	    memset(cmd_flags.filelist + maxfiles, '\0',
+			   sizeof(char *) * nfiles);
+		    maxfiles += nfiles;
+
+		    cmd_flags.files[cmd_flags.nfiles] = p;
+		    cmd_flags.filelist[cmd_flags.nfiles] = filelist;
+		    cmd_flags.nfiles++;
+		    if(*dirname != '\0'){
+			strcpy(p, dirname);
+			p += strlen(dirname);
+			*p++ = '/';
+		    }
+		    for(j = 0; j < stat_buf.st_size; j++){
+			if(addr[j] != '\n')
+			    *p++ = addr[j];
+			else{
+			    *p++ = '\0';
+			    if(j != stat_buf.st_size - 1){
+				cmd_flags.files[cmd_flags.nfiles] = p;
+				cmd_flags.filelist[cmd_flags.nfiles] =argv[i+1];
+				cmd_flags.nfiles++;
+				if(*dirname != '\0'){
+				    strcpy(p, dirname);
+				    p += strlen(dirname);
+				    *p++ = '/';
+				}
+			    }
+			}
+		    }
+		    if(addr[stat_buf.st_size - 1] != '\n')
+			*p = '\0';
+		    i++;
+		}
+		else if(strcmp(argv[i], "-compatibility_version") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 == argc){
+			error("missing argument to: %s option", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.compatibility != NULL){
+			error("more than one: %s option specified", argv[i]);
+			usage();
+		    }
+		    if(get_version_number(argv[i], argv[i+1], &temp) == FALSE){
+			usage();
+		    }
+		    cmd_flags.compatibility = argv[i+1];
+		    i++;
+		}
+		else if(strcmp(argv[i], "-current_version") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 == argc){
+			error("missing argument to: %s option", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.current != NULL){
+			error("more than one: %s option specified", argv[i]);
+			usage();
+		    }
+		    if(get_version_number(argv[i], argv[i+1], &temp) == FALSE){
+			usage();
+		    }
+		    cmd_flags.current = argv[i+1];
+		    i++;
+		}
+		else if(strcmp(argv[i], "-install_name") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 == argc){
+			error("missing argument to: %s option", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.install_name != NULL){
+			error("more than one: %s option specified", argv[i]);
+			usage();
+		    }
+		    cmd_flags.install_name = argv[i+1];
+		    i++;
+		}
+		else if(strcmp(argv[i], "-seg1addr") == 0 ||
+			strcmp(argv[i], "-image_base") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 == argc){
+			error("missing argument to: %s option", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.seg1addr != NULL){
+			error("more than one: %s option specified", argv[i]);
+			usage();
+		    }
+		    temp = strtoul(argv[i + 1], &endp, 16);
+		    if(*endp != '\0'){
+			error("address for -seg1addr %s not a proper "
+			      "hexadecimal number", argv[i+1]);
+			usage();
+		    }
+		    cmd_flags.seg1addr = argv[i+1];
+		    i++;
+		}
+		else if(strcmp(argv[i], "-segs_read_only_addr") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 == argc){
+			error("missing argument to: %s option", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.segs_read_only_addr != NULL){
+			error("more than one: %s option specified", argv[i]);
+			usage();
+		    }
+		    temp = strtoul(argv[i + 1], &endp, 16);
+		    if(*endp != '\0'){
+			error("address for -segs_read_only_addr %s not a "
+			      "proper hexadecimal number", argv[i+1]);
+			usage();
+		    }
+		    cmd_flags.segs_read_only_addr = argv[i+1];
+		    i++;
+		}
+		else if(strcmp(argv[i], "-segs_read_write_addr") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 == argc){
+			error("missing argument to: %s option", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.segs_read_write_addr != NULL){
+			error("more than one: %s option specified", argv[i]);
+			usage();
+		    }
+		    temp = strtoul(argv[i + 1], &endp, 16);
+		    if(*endp != '\0'){
+			error("address for -segs_read_write_addr %s not a "
+			      "proper hexadecimal number", argv[i+1]);
+			usage();
+		    }
+		    cmd_flags.segs_read_write_addr = argv[i+1];
+		    i++;
+		}
+		else if(strcmp(argv[i], "-seg_addr_table") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 == argc){
+			error("missing argument to: %s option", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.seg_addr_table != NULL){
+			error("more than one: %s option specified", argv[i]);
+			usage();
+		    }
+		    cmd_flags.seg_addr_table = argv[i+1];
+		    i++;
+		}
+		else if(strcmp(argv[i], "-seg_addr_table_filename") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 == argc){
+			error("missing argument to: %s option", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.seg_addr_table_filename != NULL){
+			error("more than one: %s option specified", argv[i]);
+			usage();
+		    }
+		    cmd_flags.seg_addr_table_filename = argv[i+1];
+		    i++;
+		}
+		else if(strcmp(argv[i], "-syslibroot") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 == argc){
+			error("missing argument to: %s option", argv[i]);
+			usage();
+		    }
+		    if(next_root != NULL && strcmp(next_root, argv[i+1]) != 0){
+			error("more than one: %s option specified", argv[i]);
+			usage();
+		    }
+		    next_root = argv[i+1];
+		    cmd_flags.ldflags = reallocate(cmd_flags.ldflags,
+				sizeof(char *) * (cmd_flags.nldflags + 2));
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i];
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i+1];
+		    i++;
+		}
+		else if(strcmp(argv[i], "-sectcreate") == 0 ||
+		        strcmp(argv[i], "-segcreate") == 0 ||
+		        strcmp(argv[i], "-sectorder") == 0 ||
+		        strcmp(argv[i], "-sectalign") == 0 ||
+		        strcmp(argv[i], "-segprot") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 3 >= argc){
+			error("not enough arguments follow %s", argv[i]);
+			usage();
+		    }
+		    cmd_flags.ldflags = reallocate(cmd_flags.ldflags,
+				sizeof(char *) * (cmd_flags.nldflags + 4));
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i];
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i+1];
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i+2];
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i+3];
+		    if(strcmp(argv[i], "-sectcreate") == 0 ||
+		       strcmp(argv[i], "-segcreate") == 0)
+			cmd_flags.no_files_ok = TRUE;
+		    i += 3;
+		}
+		else if(strcmp(argv[i], "-segalign") == 0 ||
+		        strcmp(argv[i], "-undefined") == 0 ||
+		        strcmp(argv[i], "-macosx_version_min") == 0 ||
+		        strcmp(argv[i], "-multiply_defined") == 0 ||
+		        strcmp(argv[i], "-multiply_defined_unused") == 0 ||
+		        strcmp(argv[i], "-umbrella") == 0 ||
+			strcmp(argv[i], "-sub_umbrella") == 0 ||
+			strcmp(argv[i], "-sub_library") == 0 ||
+			strcmp(argv[i], "-allowable_client") == 0 ||
+		        strcmp(argv[i], "-read_only_relocs") == 0 ||
+		        strcmp(argv[i], "-init") == 0 ||
+		        strcmp(argv[i], "-U") == 0 ||
+		        strcmp(argv[i], "-Y") == 0 ||
+		        strcmp(argv[i], "-dylib_file") == 0 ||
+		        strcmp(argv[i], "-final_output") == 0 ||
+		        strcmp(argv[i], "-headerpad") == 0 ||
+		        strcmp(argv[i], "-weak_reference_mismatches") == 0 ||
+		        strcmp(argv[i], "-u") == 0 ||
+		        strcmp(argv[i], "-exported_symbols_list") == 0 ||
+		        strcmp(argv[i], "-unexported_symbols_list") == 0 ||
+		        strcmp(argv[i], "-executable_path") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 >= argc){
+			error("not enough arguments follow %s", argv[i]);
+			usage();
+		    }
+		    cmd_flags.ldflags = reallocate(cmd_flags.ldflags,
+				sizeof(char *) * (cmd_flags.nldflags + 2));
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i];
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i+1];
+		    if(strcmp(argv[i], "-final_output") == 0)
+			cmd_flags.final_output_specified = TRUE;
+		    i += 1;
+		}
+		else if(strcmp(argv[i], "-sectorder_detail") == 0 ||
+		        strcmp(argv[i], "-Sn") == 0 ||
+		        strcmp(argv[i], "-Si") == 0 ||
+		        strcmp(argv[i], "-Sp") == 0 ||
+		        strcmp(argv[i], "-S") == 0 ||
+		        strcmp(argv[i], "-X") == 0 ||
+		        strcmp(argv[i], "-x") == 0 ||
+		        strcmp(argv[i], "-whatsloaded") == 0 ||
+			strcmp(argv[i], "-whyload") == 0 ||
+			strcmp(argv[i], "-arch_errors_fatal") == 0 ||
+			strcmp(argv[i], "-run_init_lazily") == 0 ||
+			strcmp(argv[i], "-twolevel_namespace") == 0 ||
+			strcmp(argv[i], "-twolevel_namespace_hints") == 0 ||
+			strcmp(argv[i], "-flat_namespace") == 0 ||
+			strcmp(argv[i], "-nomultidefs") == 0 ||
+			strcmp(argv[i], "-headerpad_max_install_names") == 0 ||
+			strcmp(argv[i], "-prebind_all_twolevel_modules") == 0 ||
+			strcmp(argv[i], "-prebind_allow_overlap") == 0 ||
+			strcmp(argv[i], "-ObjC") == 0 ||
+			strcmp(argv[i], "-M") == 0 ||
+			strcmp(argv[i], "-t") == 0 ||
+			strcmp(argv[i], "-single_module") == 0 ||
+			strcmp(argv[i], "-multi_module") == 0 ||
+			strcmp(argv[i], "-m") == 0 ||
+			strcmp(argv[i], "-dead_strip") == 0 ||
+			strcmp(argv[i], "-no_uuid") == 0 ||
+			strcmp(argv[i], "-no_dead_strip_inits_and_terms") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    cmd_flags.ldflags = reallocate(cmd_flags.ldflags,
+				sizeof(char *) * (cmd_flags.nldflags + 1));
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i];
+		}
+		else if(strcmp(argv[i], "-no_arch_warnings") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    /* ignore this flag */
+		}
+		else if(strcmp(argv[i], "-prebind") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.prebinding_flag_specified == TRUE &&
+		       cmd_flags.prebinding == FALSE){
+			error("both -prebind and -noprebind can't be "
+			      "specified");
+			usage();
+		    }
+		    cmd_flags.prebinding_flag_specified = TRUE;
+		    cmd_flags.prebinding = TRUE;
+		    cmd_flags.ldflags = reallocate(cmd_flags.ldflags,
+				sizeof(char *) * (cmd_flags.nldflags + 1));
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i];
+		}
+		else if(strcmp(argv[i], "-noprebind") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.prebinding_flag_specified == TRUE &&
+		       cmd_flags.prebinding == TRUE){
+			error("both -prebind and -noprebind can't be "
+			      "specified");
+			usage();
+		    }
+		    cmd_flags.prebinding_flag_specified = TRUE;
+		    cmd_flags.prebinding = FALSE;
+		    cmd_flags.ldflags = reallocate(cmd_flags.ldflags,
+				sizeof(char *) * (cmd_flags.nldflags + 1));
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i];
+		}
+		else if(strcmp(argv[i], "-all_load") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.all_load_flag_specified == TRUE &&
+		       cmd_flags.all_load == FALSE){
+			error("both -all_load and -noall_load can't be "
+			      "specified");
+			usage();
+		    }
+		    cmd_flags.all_load_flag_specified = TRUE;
+		    cmd_flags.all_load = TRUE;
+		}
+		else if(strcmp(argv[i], "-noall_load") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(cmd_flags.all_load_flag_specified == TRUE &&
+		       cmd_flags.all_load == TRUE){
+			error("both -all_load and -noall_load can't be "
+			      "specified");
+			usage();
+		    }
+		    cmd_flags.all_load_flag_specified = TRUE;
+		    cmd_flags.all_load = FALSE;
+		}
+		else if(strncmp(argv[i], "-y", 2) == 0 ||
+		        strncmp(argv[i], "-i", 2) == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(strncmp(argv[i], "-i", 2) == 0)
+			cmd_flags.no_files_ok = TRUE;
+		    cmd_flags.ldflags = reallocate(cmd_flags.ldflags,
+				sizeof(char *) * (cmd_flags.nldflags + 1));
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i];
+		}
+		else if(argv[i][1] == 'l'){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(argv[i][2] == '\0'){
+			error("-l: name missing");
+			usage();
+		    }
+		    cmd_flags.files[cmd_flags.nfiles++] = argv[i];
+		    lflags_seen = TRUE;
+		}
+		else if(strncmp(argv[i], "-weak-l", 7) == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(argv[i][7] == '\0'){
+			error("-weak-l: name missing");
+			usage();
+		    }
+		    cmd_flags.files[cmd_flags.nfiles++] = argv[i];
+		    lflags_seen = TRUE;
+		}
+		else if(strcmp(argv[i], "-framework") == 0 ||
+		        strcmp(argv[i], "-weak_framework") == 0 ||
+		        strcmp(argv[i], "-weak_library") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    if(i + 1 >= argc){
+			error("not enough arguments follow %s", argv[i]);
+			usage();
+		    }
+		    cmd_flags.files[cmd_flags.nfiles++] = argv[i];
+		    cmd_flags.files[cmd_flags.nfiles++] = argv[i+1];
+		    lflags_seen = TRUE;
+		    i += 1;
+		}
+		else if(strcmp(argv[i], "-T") == 0){
+		    if(cmd_flags.L_or_T_specified == TRUE){
+			error("both -T and -L can't be specified");
+			usage();
+		    }
+		    cmd_flags.L_or_T_specified = TRUE;
+		    cmd_flags.use_long_names = FALSE;
+		}
+		else if(argv[i][1] == 'L' || argv[i][1] == 'F'){
+		    if(argv[i][1] == 'L' && argv[i][2] == '\0'){
+			if(cmd_flags.L_or_T_specified == TRUE){
+			    error("both -T and -L can't be specified");
+			    usage();
+			}
+			cmd_flags.L_or_T_specified = TRUE;
+			cmd_flags.use_long_names = TRUE;
+		    }
+		    else{
+			if(cmd_flags.ranlib == TRUE){
+			    error("unknown option: %s", argv[i]);
+			    usage();
+			}
+			cmd_flags.Ldirs = realloc(cmd_flags.Ldirs,
+				    sizeof(char *) * (cmd_flags.nLdirs + 1));
+			cmd_flags.Ldirs[cmd_flags.nLdirs++] = argv[i];
+		    }
+		}
+		else if(argv[i][1] == 'g'){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    /* We need to ignore -g[gdb,codeview,stab][number] flags */
+			;
+		}
+		else if(strcmp(argv[i], "-pg") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    /* We need to ignore -pg */
+			;
+		}
+		else if(strcmp(argv[i], "-search_paths_first") == 0){
+		    if(cmd_flags.ranlib == TRUE){
+			error("unknown option: %s", argv[i]);
+			usage();
+		    }
+		    cmd_flags.search_paths_first = TRUE;
+		    cmd_flags.ldflags = reallocate(cmd_flags.ldflags,
+				sizeof(char *) * (cmd_flags.nldflags + 1));
+		    cmd_flags.ldflags[cmd_flags.nldflags++] = argv[i];
+		}
+		else if(strcmp(argv[i], "-noflush") == 0){
+		    cmd_flags.noflush = TRUE;
+		}
+#ifdef DEBUG
+		else if(strcmp(argv[i], "-debug") == 0){
+		    if(i + 1 >= argc){
+			error("not enough arguments follow %s", argv[i]);
+			usage();
+		    }
+		    i++;
+		    cmd_flags.debug |= 1 << strtoul(argv[i], &endp, 10);
+		    if(*endp != '\0' || strtoul(argv[i], &endp, 10) > 32)
+			fatal("argument for -debug %s not a proper "
+			      "decimal number less than 32", argv[i]);
+		}
+#endif /* DEBUG */
+		else{
+		    for(j = 1; argv[i][j] != '\0'; j++){
+			switch(argv[i][j]){
+			case 's':
+			    cmd_flags.s = TRUE;
+			    break;
+			case 'a':
+			    cmd_flags.a = TRUE;
+			    break;
+			case 'c':
+			    cmd_flags.c = TRUE;
+			    break;
+			case 'v':
+			    if(cmd_flags.ranlib == TRUE){
+				error("unknown option character `%c' in: %s",
+				      argv[i][j], argv[i]);
+				usage();
+			    }
+			    cmd_flags.verbose= TRUE;
+			    break;
+			case 'V':
+			    printf("Apple Computer, Inc. version %s\n",
+				   apple_version);
+			    Vflag = TRUE;
+			    break;
+			case 't':
+			    if(cmd_flags.ranlib == TRUE){
+				warning("touch option (`%c' in: %s) ignored "
+					"(table of contents rebuilt anyway)",
+					argv[i][j], argv[i]);
+				cmd_flags.t = TRUE;
+				break;
+			    }
+			    else {
+				error("unknown option character `%c' in: %s",
+				      argv[i][j], argv[i]);
+				usage();
+			    }
+			case 'f':
+			    if(cmd_flags.ranlib == TRUE){
+				cmd_flags.f = TRUE;
+				break;
+			    }
+			    else {
+				error("unknown option character `%c' in: %s",
+				      argv[i][j], argv[i]);
+				usage();
+			    }
+			case 'q':
+			    if(cmd_flags.ranlib == TRUE){
+				cmd_flags.q = TRUE;
+				break;
+			    }
+			    else {
+				error("unknown option character `%c' in: %s",
+				      argv[i][j], argv[i]);
+				usage();
+			    }
+			default:
+			    error("unknown option character `%c' in: %s",
+				  argv[i][j], argv[i]);
+			    usage();
+			}
+		    }
+		}
+	    }
+	    else
+		cmd_flags.files[cmd_flags.nfiles++] = argv[i];
+	}
+	/*
+         * Test to see if the environment variable LD_TRACE_ARCHIVES is set.
+         */
+        if((getenv("RC_TRACE_ARCHIVES") != NULL) ||
+	   (getenv("LD_TRACE_ARCHIVES") != NULL)) {
+	     cmd_flags.ld_trace_archives = TRUE;
+	     cmd_flags.trace_file_path = getenv("LD_TRACE_FILE");
+	   }
+
+	/*
+	 * If either -syslibroot or the environment variable NEXT_ROOT is set
+	 * prepend it to the standard paths for library searches.  This was
+	 * added to ease cross build environments.
+	 */
+	if(next_root != NULL){
+	    if(getenv("NEXT_ROOT") != NULL)
+		warning("NEXT_ROOT environment variable ignored because "
+			"-syslibroot specified");
+	}
+	else{
+	    next_root = getenv("NEXT_ROOT");
+	}
+	if(next_root != NULL){
+	    for(i = 0; standard_dirs[i] != NULL; i++){
+		p = allocate(strlen(next_root) +
+			     strlen(standard_dirs[i]) + 1);
+		strcpy(p, next_root);
+		strcat(p, standard_dirs[i]);
+		standard_dirs[i] = p;
+	    }
+	    for(i = 0; i < cmd_flags.nLdirs ; i++){
+		if(cmd_flags.Ldirs[i][1] != 'L')
+		    continue;
+		if(cmd_flags.Ldirs[i][2] == '/'){
+		    p = makestr(next_root, cmd_flags.Ldirs[i] + 2, NULL);
+		    if(access(p, F_OK) != -1){
+			free(p);
+			p = makestr("-L", next_root, cmd_flags.Ldirs[i] + 2,
+				    NULL);
+			cmd_flags.Ldirs[i] = p;
+		    }
+		    else{
+			free(p);
+		    }
+		}
+	    }
+	}
+
+	/* check the command line arguments for correctness */
+	if(cmd_flags.ranlib == FALSE && cmd_flags.dynamic == TRUE){
+	    if(cmd_flags.s == TRUE){
+		warning("-static not specified, -s invalid");
+	    }
+	    if(cmd_flags.a == TRUE){
+		warning("-static not specified, -a invalid");
+	    }
+	    if(cmd_flags.c == TRUE){
+		warning("-static not specified, -c invalid");
+	    }
+	    if(cmd_flags.L_or_T_specified == TRUE){
+		if(cmd_flags.use_long_names == TRUE)
+		    warning("-static not specified, -L invalid");
+		else
+		    warning("-static not specified, -T invalid");
+	    }
+	}
+	if(cmd_flags.s == TRUE && cmd_flags.a == TRUE){
+	    error("only one of -s or -a can be specified");
+	    usage();
+	}
+	if(cmd_flags.ranlib == FALSE && cmd_flags.output == NULL){
+	    if(Vflag == TRUE)
+		exit(EXIT_SUCCESS);
+	    error("no output file specified (specify with -o output)");
+	    usage();
+	}
+	if(cmd_flags.dynamic == FALSE){
+	    if(cmd_flags.compatibility != NULL){
+		warning("-dynamic not specified, -compatibility_version %s "
+		      "invalid", cmd_flags.compatibility);
+	    }
+	    if(cmd_flags.current != NULL){
+		warning("-dynamic not specified, -current_version %s invalid",
+		      cmd_flags.current);
+	    }
+	    if(cmd_flags.install_name != NULL){
+		warning("-dynamic not specified, -install_name %s invalid",
+		      cmd_flags.install_name);
+	    }
+	    if(cmd_flags.seg1addr != NULL){
+		warning("-dynamic not specified, -seg1addr %s invalid",
+		      cmd_flags.seg1addr);
+	    }
+	    if(cmd_flags.segs_read_only_addr != NULL){
+		warning("-dynamic not specified, -segs_read_only_addr %s "
+			"invalid", cmd_flags.segs_read_only_addr);
+	    }
+	    if(cmd_flags.segs_read_write_addr != NULL){
+		warning("-dynamic not specified, -segs_read_write_addr %s "
+			"invalid", cmd_flags.segs_read_write_addr);
+	    }
+	    if(cmd_flags.seg_addr_table != NULL){
+		warning("-dynamic not specified, -seg_addr_table %s "
+			"invalid", cmd_flags.seg_addr_table);
+	    }
+	    if(cmd_flags.seg_addr_table_filename != NULL){
+		warning("-dynamic not specified, -seg_addr_table_filename %s "
+			"invalid", cmd_flags.seg_addr_table_filename);
+	    }
+	    if(cmd_flags.all_load_flag_specified == TRUE){
+		if(cmd_flags.all_load == TRUE)
+		    warning("-dynamic not specified, -all_load invalid");
+		else
+		    warning("-dynamic not specified, -noall_load invalid");
+	    }
+	    if(cmd_flags.nldflags != 0){
+		bad_flag_seen = FALSE;
+		for(j = 0; j < cmd_flags.nldflags; j++){
+		    if(strcmp(cmd_flags.ldflags[j], "-syslibroot") == 0){
+			j++;
+			continue;
+		    }
+		    if(bad_flag_seen == FALSE){
+			fprintf(stderr, "%s: -dynamic not specified the "
+				"following flags are invalid: ", progname);
+			bad_flag_seen = TRUE;
+		    }
+		    fprintf(stderr, "%s ", cmd_flags.ldflags[j]);
+		}
+		if(bad_flag_seen == TRUE)
+		    fprintf(stderr, "\n");
+	    }
+	    if(cmd_flags.nLdirs != 0){
+		/* Note: both -L and -F flags are in cmd_flags.Ldirs to keep the
+		   search order right. */
+		bad_flag_seen = FALSE;
+		for(j = 0; j < cmd_flags.nLdirs; j++){
+		    if(strncmp(cmd_flags.Ldirs[j], "-L", 2) == 0)
+			continue;
+		    if(bad_flag_seen == FALSE){
+			fprintf(stderr, "%s: -dynamic not specified the "
+				"following flags are invalid: ", progname);
+			bad_flag_seen = TRUE;
+		    }
+		    fprintf(stderr, "%s ", cmd_flags.Ldirs[j]);
+		}
+		if(bad_flag_seen == TRUE)
+		    fprintf(stderr, "\n");
+	    }
+	}
+	else{
+	    /*
+	     * The -prebind flag can also be specified with the LD_PREBIND
+	     * environment variable.
+	     */
+	    if(getenv("LD_PREBIND") != NULL){
+		if(cmd_flags.prebinding_flag_specified == TRUE &&
+		   cmd_flags.prebinding == FALSE){
+		    warning("LD_PREBIND environment variable ignored because "
+			    "-noprebind specified");
+		}
+		else{
+		    cmd_flags.prebinding_flag_specified = TRUE;
+		    cmd_flags.prebinding = TRUE;
+		}
+	    }
+	}
+	if(cmd_flags.nfiles == 0){
+	    if(cmd_flags.ranlib == TRUE){
+		error("no archives specified");
+		usage();
+	    }
+	    else{
+		if(cmd_flags.dynamic == TRUE && cmd_flags.no_files_ok == TRUE)
+		    warning("warning no files specified");
+		else{
+		    error("no files specified");
+		    usage();
+		}
+	    }
+	}
+
+	/* set the defaults if not specified */
+	if(cmd_flags.a == FALSE)
+	    cmd_flags.s = TRUE; /* sort table of contents by default */
+
+	process();
+
+	if(errors == 0)
+	    return(EXIT_SUCCESS);
+	else
+	    return(EXIT_FAILURE);
+}
+
+/*
+ * usage() prints the current usage message and exits indicating failure.
+ */
+static
+void
+usage(
+void)
+{
+	if(cmd_flags.ranlib)
+	    fprintf(stderr, "Usage: %s [-sactfqLT] [-] archive [...]\n",
+		    progname);
+	else{
+	    fprintf(stderr, "Usage: %s -static [-] file [...] "
+		    "[-filelist listfile[,dirname]] [-arch_only arch] "
+		    "[-sacLT]\n", progname);
+	    fprintf(stderr, "Usage: %s -dynamic [-] file [...] "
+		    "[-filelist listfile[,dirname]] [-arch_only arch] "
+		    "[-o output] [-install_name name] "
+		    "[-compatibility_version #] [-current_version #] "
+		    "[-seg1addr 0x#] [-segs_read_only_addr 0x#] "
+		    "[-segs_read_write_addr 0x#] [-seg_addr_table <filename>] "
+		    "[-seg_addr_table_filename <file_system_path>] "
+		    "[-all_load] [-noall_load]\n",
+		    progname);
+	}
+	exit(EXIT_FAILURE);
+}
+
+/*
+ * process() the input files into libraries based on the command flags.
+ */
+static
+void
+process(
+void)
+{
+    uint32_t i, j, k, previous_errors;
+    struct ofile *ofiles;
+    char *file_name;
+    enum bool flag, ld_trace_archive_printed;
+
+	/*
+	 * For libtool processing put all input files in the specified output
+	 * file.  For ranlib processing all input files should be archives or
+	 * fat files with archives in them and each is processed by itself and
+	 * not combined with anything else.  The format of fat object files in
+	 * a thin archive is supported here also.
+	 */
+	ofiles = allocate(sizeof(struct ofile) * cmd_flags.nfiles);
+	for(i = 0; i < cmd_flags.nfiles; i++){
+	    if(strncmp(cmd_flags.files[i], "-l", 2) == 0 ||
+	       strncmp(cmd_flags.files[i], "-weak-l", 7) == 0){
+		file_name = file_name_from_l_flag(cmd_flags.files[i]);
+		if(file_name != NULL)
+		    if(ofile_map(file_name, NULL, NULL, ofiles + i, TRUE) ==
+		       FALSE)
+			continue;
+	    }
+	    else if(strcmp(cmd_flags.files[i], "-framework") == 0 ||
+		    strcmp(cmd_flags.files[i], "-weak_framework") == 0 ||
+		    strcmp(cmd_flags.files[i], "-weak_library") == 0){
+		i++;
+		continue;
+	    }
+	    else{
+		if(ofile_map(cmd_flags.files[i], NULL, NULL, ofiles + i,
+			     TRUE) == FALSE)
+		    continue;
+	    }
+
+	    previous_errors = errors;
+	    errors = 0;
+	    ld_trace_archive_printed = FALSE;
+
+	    if(ofiles[i].file_type == OFILE_FAT){
+		(void)ofile_first_arch(ofiles + i);
+		do{
+		    if(ofiles[i].arch_type == OFILE_ARCHIVE){
+			if(cmd_flags.ld_trace_archives == TRUE &&
+			   cmd_flags.dynamic == FALSE &&
+			   ld_trace_archive_printed == FALSE){
+			    char resolvedname[MAXPATHLEN];
+                	    if(realpath(ofiles[i].file_name, resolvedname) !=
+			       NULL)
+				ld_trace("[Logging for XBS] Used static "
+					 "archive: %s\n", resolvedname);
+			    else
+				ld_trace("[Logging for XBS] Used static "
+					 "archive: %s\n", ofiles[i].file_name);
+			    ld_trace_archive_printed = TRUE;
+			}
+			/* loop through archive */
+			if((flag = ofile_first_member(ofiles + i)) == TRUE){
+			    if(ofiles[i].member_ar_hdr != NULL &&
+			       strncmp(ofiles[i].member_name, SYMDEF,
+				       sizeof(SYMDEF) - 1) == 0)
+				flag = ofile_next_member(ofiles + i);
+			    while(flag == TRUE){
+				/* No fat members in a fat file */
+				if(ofiles[i].mh != NULL ||
+				   ofiles[i].mh64 != NULL ||
+				   ofiles[i].lto != NULL ||
+				   cmd_flags.ranlib == TRUE)
+				    add_member(ofiles + i);
+				else{
+				    error("for architecture: %s file: %s(%.*s) "
+					  "is not an object file (not allowed "
+					  "in a library)",
+					  ofiles[i].arch_flag.name,
+					  cmd_flags.files[i],
+					  (int)ofiles[i].member_name_size,
+					  ofiles[i].member_name);
+				}
+				flag = ofile_next_member(ofiles + i);
+			    }
+			}
+		    }
+		    else if(ofiles[i].arch_type == OFILE_Mach_O){
+			if(cmd_flags.ranlib == TRUE){
+			    error("for architecture: %s file: %s is not an "
+				  "archive (no processing done on this file)",
+				  ofiles[i].arch_flag.name, cmd_flags.files[i]);
+			    goto ranlib_fat_error;
+			}
+			else
+			    add_member(ofiles + i);
+		    }
+		    else if(ofiles[i].arch_type == OFILE_UNKNOWN){
+			if(cmd_flags.ranlib == TRUE){
+			    error("for architecture: %s file: %s is not an "
+				  "archive (no processing done on this file)",
+				  ofiles[i].arch_flag.name, cmd_flags.files[i]);
+			    goto ranlib_fat_error;
+			}
+			else{
+			    error("for architecture: %s file: %s is not an "
+				  "object file (not allowed in a library)",
+				  ofiles[i].arch_flag.name, cmd_flags.files[i]);
+			}
+		    }
+		}while(ofile_next_arch(ofiles + i) == TRUE);
+	    }
+	    else if(ofiles[i].file_type == OFILE_ARCHIVE){
+		if(cmd_flags.ld_trace_archives == TRUE &&
+		   cmd_flags.dynamic == FALSE &&
+		   ld_trace_archive_printed == FALSE){
+		    char resolvedname[MAXPATHLEN];
+		    if(realpath(ofiles[i].file_name, resolvedname) != NULL)
+			ld_trace("[Logging for XBS] Used static archive: "
+				 "%s\n", resolvedname);
+		    else
+			ld_trace("[Logging for XBS] Used static archive: "
+				 "%s\n", ofiles[i].file_name);
+		    ld_trace_archive_printed = TRUE;
+		}
+		/* loop through archive */
+		if((flag = ofile_first_member(ofiles + i)) == TRUE){
+		    if(ofiles[i].member_ar_hdr != NULL &&
+		       strncmp(ofiles[i].member_name, SYMDEF,
+			       sizeof(SYMDEF) - 1) == 0){
+			flag = ofile_next_member(ofiles + i);
+		    }
+		    while(flag == TRUE){
+			/* incorrect form: archive with fat object members */
+			if(ofiles[i].member_type == OFILE_FAT){
+			    (void)ofile_first_arch(ofiles + i);
+			    do{
+				if(ofiles[i].mh != NULL ||
+				   ofiles[i].mh64 != NULL ||
+				   ofiles[i].lto != NULL ||
+				   cmd_flags.ranlib == TRUE){
+				    add_member(ofiles + i);
+				}
+				else{
+				    /*
+				     * Can't really get here because ofile_*()
+				     * routines will refuse to process this
+				     * type of file (but I'll leave it here).
+				     */
+				    error("file: %s(%.*s) for architecture: %s "
+					"is not an object file (not allowed in "
+					"a library)", cmd_flags.files[i],
+					(int)ofiles[i].member_name_size,
+					ofiles[i].member_name,
+					ofiles[i].arch_flag.name);
+				}
+
+			    }while(ofile_next_arch(ofiles + i) == TRUE);
+			}
+			else if(ofiles[i].mh != NULL ||
+			        ofiles[i].mh64 != NULL ||
+#ifdef LTO_SUPPORT
+			        ofiles[i].lto != NULL ||
+#endif /* LTO_SUPPORT */
+				cmd_flags.ranlib == TRUE){
+			    add_member(ofiles + i);
+			}
+			else{
+			    error("file: %s(%.*s) is not an object file (not "
+				  "allowed in a library)", cmd_flags.files[i],
+				  (int)ofiles[i].member_name_size,
+				  ofiles[i].member_name);
+			}
+			flag = ofile_next_member(ofiles + i);
+		    }
+		}
+	    }
+	    else if(ofiles[i].file_type == OFILE_Mach_O){
+		if(cmd_flags.ranlib == TRUE){
+		    error("file: %s is not an archive", cmd_flags.files[i]);
+		    continue;
+		}
+		add_member(ofiles + i);
+	    }
+#ifdef LTO_SUPPORT
+	    else if(ofiles[i].file_type == OFILE_LLVM_BITCODE){
+		if(cmd_flags.ranlib == TRUE){
+		    error("file: %s is not an archive", cmd_flags.files[i]);
+		    continue;
+		}
+		add_member(ofiles + i);
+	    }
+#endif /* LTO_SUPPORT */
+	    else{ /* ofiles[i].file_type == OFILE_UNKNOWN */
+		if(cmd_flags.ranlib == TRUE){
+		    error("file: %s is not an archive", cmd_flags.files[i]);
+		    continue;
+		}
+		else{
+		    error("file: %s is not an object file (not allowed in a "
+			  "library)", cmd_flags.files[i]);
+		}
+	    }
+
+	    if(cmd_flags.ranlib == TRUE){
+		/*
+		 * In the case where ranlib is being used on an archive that
+		 * contains fat object files with multiple members and non-
+		 * object members this has to be treated as an error because
+		 * it is not known which architecture(s) the non-object file
+		 * belong to.
+		 */
+		if(narchs > 1){
+		    for(j = 0; j < narchs; j++){
+			for(k = 0; k < archs[j].nmembers; k++){
+			    if(archs[j].members[k].mh == NULL &&
+#ifdef LTO_SUPPORT
+			       archs[j].members[k].lto == NULL &&
+#endif /* LTO_SUPPORT */
+			       archs[j].members[k].mh64 == NULL){
+				error("library member: %s(%.*s) is not an "
+				      "object file (not allowed in a library "
+				      "with multiple architectures)",
+				      cmd_flags.files[i],
+				      (int)archs[j].members[k].
+					input_base_name_size,
+				      archs[j].members[k].input_base_name);
+			    }
+			}
+		    }
+		}
+		if(errors == 0)
+		    create_library(cmd_flags.files[i], ofiles + i);
+		if(cmd_flags.nfiles > 1){
+ranlib_fat_error:
+		    free_archs();
+		    ofile_unmap(ofiles + i);
+		}
+	    }
+	    errors += previous_errors;
+	}
+	if(cmd_flags.ranlib == FALSE && errors == 0)
+	    create_library(cmd_flags.output, NULL);
+
+	/*
+	 * Clean-up of ofiles[] and archs could be done here but since this
+	 * program is now done it is faster to just exit.
+	 */
+}
+
+/*
+ * file_name_from_l_flag() is passed a "-lx" or "-weak-lx" flag and returns a
+ * name of a file for this flag.  The flag "-lx" and "-weak-lx" are the same
+ * flags as used in the link editor to refer to file names.  If it can't find a
+ * file name for the flag it prints an error and returns NULL.
+ */
+static
+char *
+file_name_from_l_flag(
+char *l_flag)
+{
+    char *file_name, *p, *start;
+
+	if(strncmp(l_flag, "-weak-l", 7) == 0)
+	    start = &l_flag[7];
+	else
+	    start = &l_flag[2];
+	p = strrchr(start, '.');
+	if(p != NULL && strcmp(p, ".o") == 0){
+	    p = start;
+	    file_name = search_for_file(p);
+	}
+	else{
+	    file_name = NULL;
+	    if(cmd_flags.dynamic == TRUE){
+		if(cmd_flags.search_paths_first == TRUE){
+		    file_name = search_paths_for_lname(start);
+		}
+		else{
+		    p = makestr("lib", start, ".dylib", NULL);
+		    file_name = search_for_file(p);
+		    free(p);
+		    if(file_name == NULL){
+			p = makestr("lib", start, ".a", NULL);
+			file_name = search_for_file(p);
+			free(p);
+		    }
+		}
+	    }
+	    else{
+		p = makestr("lib", start, ".a", NULL);
+		file_name = search_for_file(p);
+		free(p);
+	    }
+	}
+	if(file_name == NULL)
+	    error("can't locate file for: %s", l_flag);
+	return(file_name);
+}
+
+/*
+ * search_for_file() takes base_name and trys to find a file with that base name
+ * is the -L search directories and in the standard directories.  If it is
+ * sucessful it returns a pointer to the file name else it returns NULL.
+ */
+static
+char *
+search_for_file(
+char *base_name)
+{
+    uint32_t i;
+    char *file_name;
+
+	for(i = 0; i < cmd_flags.nLdirs ; i++){
+	    if(cmd_flags.Ldirs[i][1] != 'L')
+		continue;
+	    file_name = makestr(cmd_flags.Ldirs[i] + 2, "/", base_name, NULL);
+	    if(access(file_name, R_OK) != -1)
+		return(file_name);
+	    free(file_name);
+	}
+	for(i = 0; standard_dirs[i] != NULL ; i++){
+	    file_name = makestr(standard_dirs[i], base_name, NULL);
+	    if(access(file_name, R_OK) != -1)
+		return(file_name);
+	    free(file_name);
+	}
+	return(NULL);
+}
+
+/*
+ * search_paths_for_lname() takes the argument to a -lx option and and trys to
+ * find a file with the name libx.dylib or libx.a.  This routine is only used
+ * when the -search_paths_first option is specified and -dynamic is in effect.
+ * And looks for a file name ending in .dylib then .a in each directory before
+ * looking in the next directory.  The list of the -L search directories and in
+ * the standard directories are searched in that order.  If this is sucessful
+ * it returns a pointer to the file name else NULL.
+ */
+static
+char *
+search_paths_for_lname(
+const char *lname_argument)
+{
+    uint32_t i;
+    char *file_name, *dir;
+
+	for(i = 0; i < cmd_flags.nLdirs ; i++){
+	    if(cmd_flags.Ldirs[i][1] != 'L')
+		continue;
+	    dir = makestr(cmd_flags.Ldirs[i] + 2, "/", NULL);
+	    file_name = search_path_for_lname(dir, lname_argument);
+	    free(dir);
+	    if(file_name != NULL)
+		return(file_name);
+	}
+	for(i = 0; standard_dirs[i] != NULL ; i++){
+	    file_name = search_path_for_lname(standard_dirs[i], lname_argument);
+	    if(file_name != NULL)
+		return(file_name);
+	}
+	return(NULL);
+}
+
+/*
+ * search_path_for_lname() takes the argument to a -lx option and and trys to
+ * find a file with the name libx.dylib then libx.a in the specified directory
+ * name.  This routine is only used when the -search_paths_first option is
+ * specified and -dynamic is in effect.  If this is sucessful it returns a
+ * pointer to the file name else NULL.
+ */
+static
+char *
+search_path_for_lname(
+const char *dir,
+const char *lname_argument)
+{
+    char *file_name;
+
+	file_name = makestr(dir, "/", "lib", lname_argument, ".dylib", NULL);
+	if(access(file_name, R_OK) != -1)
+	    return(file_name);
+	free(file_name);
+
+	file_name = makestr(dir, "/", "lib", lname_argument, ".a", NULL);
+	if(access(file_name, R_OK) != -1)
+	    return(file_name);
+	free(file_name);
+
+	return(NULL);
+}
+
+/*
+ * add_member() add the specified ofile as a member to the library.  The
+ * specified ofile must be either an object file (libtool or ranlib) or an
+ * archive member with an unknown file type (ranlib only).
+ */
+static
+void
+add_member(
+struct ofile *ofile)
+{
+    uint32_t i, j, size, ar_name_size;
+    struct arch *arch;
+    struct member *member;
+    struct stat stat_buf;
+    char *p, c, ar_name_buf[sizeof(ofile->member_ar_hdr->ar_name) + 1];
+    char ar_size_buf[sizeof(ofile->member_ar_hdr->ar_size) + 1];
+    const struct arch_flag *family_arch_flag;
+
+	/*
+	 * If this did not come from an archive get the stat info which is
+	 * needed to fill in the archive header for this member.
+	 */
+	if(ofile->member_ar_hdr == NULL){
+	    if(stat(ofile->file_name, &stat_buf) == -1){
+		system_error("can't stat file: %s", ofile->file_name);
+		return;
+	    }
+	}
+
+	/*
+	 * Determine the size this member will have in the library which
+	 * includes the padding as a result of rounding the size of the
+	 * member.  To get all members on an 8 byte boundary (so that mapping
+	 * in object files can be used directly) the size of the member is
+	 * CHANGED to reflect this padding.  In the UNIX definition of archives
+	 * the size of the member is never changed but the offset to the next
+	 * member is defined to be the offset of the previous member plus
+	 * the size of the previous member rounded to 2.  So to get 8 byte
+	 * boundaries without breaking the UNIX definition of archives the
+	 * size is changed here.  As with the UNIX ar(1) program the padded
+	 * bytes are set to the character '\n'.
+	 */
+	if(ofile->mh != NULL || ofile->mh64 != NULL)
+	    size = rnd(ofile->object_size, 8);
+#ifdef LTO_SUPPORT
+	else if(ofile->lto != NULL && ofile->file_type == OFILE_LLVM_BITCODE)
+	    size = rnd(ofile->file_size, 8);
+#endif /* LTO_SUPPORT */
+	else
+	    size = rnd(ofile->member_size, 8);
+
+	/* select or create an arch type to put this in */
+	i = 0;
+	if(ofile->mh != NULL ||
+	   ofile->mh64 != NULL){
+	    if(ofile->mh_cputype == 0){
+		if(ofile->member_ar_hdr != NULL){
+		    error("file: %s(%.*s) cputype is zero (a reserved value)",
+			  ofile->file_name, (int)ofile->member_name_size,
+			  ofile->member_name);
+		}
+		else
+		    error("file: %s cputype is zero (a reserved value)",
+			  ofile->file_name);
+		return;
+	    }
+	    /*
+	     * If we are building a dynamic library then don't add dynamic
+	     * shared libraries to the archs.  This is so that a dependent
+	     * dynamic shared library that happens to be fat will not cause the
+	     * library to be created fat unless there are object going into
+	     * the library that are fat.
+	     */
+	    if(ofile->mh_filetype == MH_DYLIB ||
+	       ofile->mh_filetype == MH_DYLIB_STUB){
+		/*
+		 * If we are building a static library we should not put a
+		 * dynamic library Mach-O file into the static library.  This
+		 * can happen if a libx.a file is really a dynamic library and
+		 * someone is using -lx when creating a static library.
+		 */
+		if(cmd_flags.dynamic != TRUE){
+		    if(ofile->member_ar_hdr != NULL){
+			warning("file: %s(%.*s) is a dynamic library, not "
+				"added to the static library",
+			        ofile->file_name, (int)ofile->member_name_size,
+			        ofile->member_name);
+		    }
+		    else
+			warning("file: %s is a dynamic library, not added to "
+				"the static library", ofile->file_name);
+		}
+		return;
+	    }
+	    /*
+	     * If -arch_only is specified then only add this file if it matches
+	     * the architecture specified.
+	     */
+	    if(cmd_flags.arch_only_flag.name != NULL){
+		if(cmd_flags.arch_only_flag.cputype != ofile->mh_cputype)
+		    return;
+		if(cmd_flags.arch_only_flag.cputype == CPU_TYPE_ARM){
+		    if(cmd_flags.arch_only_flag.cpusubtype !=
+							ofile->mh_cpusubtype)
+			return;
+		}
+	    }
+
+	    for( ; i < narchs; i++){
+		if(archs[i].arch_flag.cputype == ofile->mh_cputype){
+		    if(archs[i].arch_flag.cputype == CPU_TYPE_ARM &&
+		       archs[i].arch_flag.cpusubtype != ofile->mh_cpusubtype)
+			continue;
+		    break;
+		}
+	    }
+	}
+#ifdef LTO_SUPPORT
+	else if(ofile->lto != NULL){
+	    /*
+	     * If -arch_only is specified then only add this file if it matches
+	     * the architecture specified.
+	     */
+	    if(cmd_flags.arch_only_flag.name != NULL &&
+	       cmd_flags.arch_only_flag.cputype != ofile->lto_cputype)
+		return;
+
+	    for( ; i < narchs; i++){
+		if(archs[i].arch_flag.cputype == ofile->lto_cputype){
+		    if(archs[i].arch_flag.cputype == CPU_TYPE_ARM &&
+		       archs[i].arch_flag.cpusubtype != ofile->lto_cpusubtype)
+			continue;
+		    break;
+		}
+	    }
+	}
+#endif /* LTO_SUPPORT */
+	if(narchs == 1 && archs[0].arch_flag.cputype == 0){
+	    i = 0;
+	}
+	else if(i == narchs){
+	    archs = reallocate(archs, sizeof(struct arch) * (narchs+1));
+	    memset(archs + narchs, '\0', sizeof(struct arch));
+	    if(ofile->mh != NULL ||
+	       ofile->mh64 != NULL){
+		if(ofile->mh_cputype == CPU_TYPE_ARM){
+		    archs[narchs].arch_flag.name = (char *)
+			get_arch_name_from_types(
+				ofile->mh_cputype, ofile->mh_cpusubtype);
+		    archs[narchs].arch_flag.cputype = ofile->mh_cputype;
+		    archs[narchs].arch_flag.cpusubtype = ofile->mh_cpusubtype;
+		}
+		else{
+		    family_arch_flag =
+			    get_arch_family_from_cputype(ofile->mh_cputype);
+		    if(family_arch_flag != NULL)
+			archs[narchs].arch_flag = *family_arch_flag;
+		}
+	}
+#ifdef LTO_SUPPORT
+	    else if(ofile->lto != NULL){
+		if(ofile->lto_cputype == CPU_TYPE_ARM){
+		    archs[narchs].arch_flag.name = (char *)
+			get_arch_name_from_types(
+				ofile->lto_cputype, ofile->lto_cpusubtype);
+		    archs[narchs].arch_flag.cputype = ofile->lto_cputype;
+		    archs[narchs].arch_flag.cpusubtype = ofile->lto_cpusubtype;
+		}
+		else{
+		    family_arch_flag =
+			    get_arch_family_from_cputype(ofile->lto_cputype);
+		    if(family_arch_flag != NULL)
+			archs[narchs].arch_flag = *family_arch_flag;
+		}
+	    }
+#endif /* LTO_SUPPORT */
+	    else
+		archs[narchs].arch_flag.name = "unknown";
+	    narchs++;
+	}
+	arch = archs + i;
+
+	/*
+	 * If the cputype of this arch is not yet known then see if this new
+	 * member can determine it.
+	 */
+	if(arch->arch_flag.cputype == 0 &&
+	   (ofile->mh != NULL || ofile->mh64 != NULL)){
+	    family_arch_flag = get_arch_family_from_cputype(ofile->mh_cputype);
+	    if(family_arch_flag != NULL){
+		arch->arch_flag = *family_arch_flag;
+	    }
+            else{
+                arch->arch_flag.name =
+                    savestr("cputype 1234567890 cpusubtype 1234567890");
+                if(arch->arch_flag.name != NULL)
+                    sprintf(arch->arch_flag.name, "cputype %u cpusubtype %u",
+                            ofile->mh_cputype, ofile->mh_cpusubtype &
+			    ~CPU_SUBTYPE_MASK);
+                    arch->arch_flag.cputype = ofile->mh_cputype;
+                    arch->arch_flag.cpusubtype = ofile->mh_cpusubtype;
+	    }
+	}
+#ifdef LTO_SUPPORT
+	if(arch->arch_flag.cputype == 0 &&
+	   (ofile->lto != NULL)){
+	    family_arch_flag = get_arch_family_from_cputype(ofile->lto_cputype);
+	    if(family_arch_flag != NULL){
+		arch->arch_flag = *family_arch_flag;
+	    }
+            else{
+                arch->arch_flag.name =
+                    savestr("cputype 1234567890 cpusubtype 1234567890");
+                if(arch->arch_flag.name != NULL)
+                    sprintf(arch->arch_flag.name, "cputype %u cpusubtype %u",
+                            ofile->lto_cputype, ofile->lto_cpusubtype &
+			    ~CPU_SUBTYPE_MASK);
+                    arch->arch_flag.cputype = ofile->lto_cputype;
+                    arch->arch_flag.cpusubtype = ofile->lto_cpusubtype;
+	    }
+	}
+#endif /* LTO_SUPPORT */
+
+	/* create a member in this arch type for this member */
+	arch->members = reallocate(arch->members, sizeof(struct member) *
+				   (arch->nmembers + 1));
+	member = arch->members + arch->nmembers;
+	memset(member, '\0', sizeof(struct member));
+	arch->nmembers++;
+
+	/* fill in the member for this ofile */
+	member->input_file_name = ofile->file_name;
+
+	if(ofile->member_ar_hdr == NULL){
+	    /*
+	     * We are creating an archive member in the output file from a
+	     * file (that is not archive member in an input file).  First get
+	     * the base name the file_name for the member name.
+	     */
+	    p = strrchr(ofile->file_name, '/');
+	    if(p != NULL)
+		p++;
+	    else
+		p = ofile->file_name;
+	    member->input_base_name = p;
+	    member->input_base_name_size = strlen(p);
+	    member->member_name = member->input_base_name;
+	    /*
+	     * If we can use long names then force using them to allow 64-bit
+	     * objects to be aligned on an 8 byte boundary.  This is needed
+	     * since the struct ar_hdr is not a multiple of 8.  This is normally
+	     * done if the name does not fit in the archive header or contains
+	     * a space character then we use the extened format #1.  The size
+	     * of the name is rounded up so the object file after the name will
+	     * be on an 8 byte boundary (including rounding the size of the
+	     * struct ar_hdr).  The name will be padded with '\0's when it is
+	     * written out.
+	     */
+	    if(cmd_flags.use_long_names == TRUE){
+		member->output_long_name = TRUE;
+		member->member_name_size = member->input_base_name_size;
+		ar_name_size = rnd(member->input_base_name_size, 8) +
+			       (rnd(sizeof(struct ar_hdr), 8) -
+				sizeof(struct ar_hdr));
+		sprintf(ar_name_buf, "%s%-*lu", AR_EFMT1,
+			(int)(sizeof(member->ar_hdr.ar_name) -
+			      (sizeof(AR_EFMT1) - 1)),
+			(long unsigned int)ar_name_size);
+		memcpy(member->ar_hdr.ar_name, ar_name_buf,
+		      sizeof(member->ar_hdr.ar_name));
+	    }
+	    else{
+		ar_name_size = 0;
+		member->output_long_name = FALSE;
+		/*
+		 * Truncate the file_name if needed and place in archive header.
+		 */
+		c = '\0';
+		if(strlen(p) > sizeof(member->ar_hdr.ar_name)){
+		    c = p[sizeof(member->ar_hdr.ar_name)];
+		    p[sizeof(member->ar_hdr.ar_name)] = '\0';
+		}
+		sprintf((char *)(&member->ar_hdr), "%-*s",
+			(int)sizeof(member->ar_hdr.ar_name), p);
+		if(c != '\0')
+		    p[sizeof(member->ar_hdr.ar_name)] = c;
+		member->member_name_size = size_ar_name(&member->ar_hdr);
+	    }
+	    if(zero_ar_date == TRUE)
+		stat_buf.st_mtime = 0;
+	    /*
+	     * Create the rest of the archive header after the name.
+	     */
+	    sprintf((char *)(&member->ar_hdr) + sizeof(member->ar_hdr.ar_name),
+	       "%-*ld%-*u%-*u%-*o%-*ld%-*s",
+	       (int)sizeof(member->ar_hdr.ar_date),
+		   (long int)stat_buf.st_mtime,
+	       (int)sizeof(member->ar_hdr.ar_uid),
+		   (unsigned short)stat_buf.st_uid,
+	       (int)sizeof(member->ar_hdr.ar_gid),
+		   (unsigned short)stat_buf.st_gid,
+	       (int)sizeof(member->ar_hdr.ar_mode),
+		   (unsigned int)stat_buf.st_mode,
+	       (int)sizeof(member->ar_hdr.ar_size),
+		   (long)size + ar_name_size,
+	       (int)sizeof(member->ar_hdr.ar_fmag),
+		   ARFMAG);
+	}
+	else{
+	    /*
+	     * We are creating an archive member in the output file from an
+	     * archive member in an input file.  There can be some changes to
+	     * the contents.  First the size might be changed and the contents
+	     * padded with '\n's to round it to a multiple of 8
+	     * Second we may take a member using extended format #1
+	     * for it's name and truncate it then place the name in the archive
+	     * header.  Or we may round the name size to a multiple of 8.
+	     */
+	    member->input_ar_hdr = ofile->member_ar_hdr;
+	    member->input_base_name = ofile->member_name;
+	    member->input_base_name_size = ofile->member_name_size;
+	    member->input_member_offset = ofile->member_offset -
+					  sizeof(struct ar_hdr);
+	    if(strncmp(ofile->member_ar_hdr->ar_name, AR_EFMT1,
+	       sizeof(AR_EFMT1) - 1) == 0)
+		member->input_member_offset -= ofile->member_name_size;
+
+	    member->ar_hdr = *(ofile->member_ar_hdr);
+	    member->member_name = ofile->member_name;
+
+	    if(cmd_flags.use_long_names == TRUE){
+		/*
+		 * We can use long names.  So if the input ofile is using the
+		 * extended format #1 we need make sure the size of the name and
+		 * the size of struct ar_hdr are rounded to 8 bytes. And write
+		 * that size into the ar_name with the AR_EFMT1 string.  To
+		 * avoid growing the size of names first trim the long name size
+		 * before rounding up.
+		 */
+		if(ofile->member_name != ofile->member_ar_hdr->ar_name){
+		    member->output_long_name = TRUE;
+		    member->member_name_size = ofile->member_name_size;
+		    for(ar_name_size = member->member_name_size;
+			ar_name_size > 1 ;
+			ar_name_size--){
+			if(ofile->member_name[ar_name_size - 1] != '\0')
+			   break;
+		    }
+		    member->member_name_size = ar_name_size;
+		    ar_name_size = rnd(ar_name_size, 8) +
+				   (rnd(sizeof(struct ar_hdr), 8) -
+				    sizeof(struct ar_hdr));
+		    sprintf(ar_name_buf, "%s%-*lu", AR_EFMT1,
+			    (int)(sizeof(member->ar_hdr.ar_name) -
+				  (sizeof(AR_EFMT1) - 1)),
+			    (long unsigned int)ar_name_size);
+		    memcpy(member->ar_hdr.ar_name, ar_name_buf,
+			  sizeof(member->ar_hdr.ar_name));
+		}
+		else{
+		    /*
+		     * Since we can use long names force this to use extended
+		     * format #1. And round the name size to 8 plus the size of
+		     * struct ar_hdr rounded to 8 bytes.
+		     */
+		    member->member_name_size = size_ar_name(&member->ar_hdr);
+		    ar_name_size = rnd(ofile->member_name_size, 8) +
+				   (rnd(sizeof(struct ar_hdr), 8) -
+				    sizeof(struct ar_hdr));
+		    member->output_long_name = TRUE;
+		    sprintf(ar_name_buf, "%s%-*lu", AR_EFMT1,
+			    (int)(sizeof(member->ar_hdr.ar_name) -
+				  (sizeof(AR_EFMT1) - 1)),
+			    (long unsigned int)ar_name_size);
+		    memcpy(member->ar_hdr.ar_name, ar_name_buf,
+			  sizeof(member->ar_hdr.ar_name));
+		}
+	    }
+	    else{
+		/*
+		 * We can't use long names.  So if the input ofile is using the
+		 * extended format #1 we need to truncate the name and write it
+		 * into the ar_name field.  Note the extended format is also
+		 * used it the name has a space in it so it may be shorter than
+		 * sizeof(ar_hdr.ar_name) .
+		 */
+		ar_name_size = 0;
+		member->output_long_name = FALSE;
+		if(ofile->member_name != ofile->member_ar_hdr->ar_name){
+		    for(j = 0; j < sizeof(member->ar_hdr.ar_name) &&
+			       j < ofile->member_name_size &&
+			       ofile->member_name[j] != '\0'; j++)
+			member->ar_hdr.ar_name[j] = ofile->member_name[j];
+		    for( ; j < sizeof(member->ar_hdr.ar_name); j++)
+			member->ar_hdr.ar_name[j] = ' ';
+		}
+		member->member_name_size = size_ar_name(&member->ar_hdr);
+	    }
+	    /*
+	     * Since sprintf() writes a '\0' at the end of the string the
+	     * memcpy is needed to preserve the ARFMAG string that follows.
+	     */
+	    sprintf(ar_size_buf, "%-*ld",
+		    (int)sizeof(member->ar_hdr.ar_size),
+		    (long)size + ar_name_size);
+	    memcpy(member->ar_hdr.ar_size, ar_size_buf,
+		   sizeof(member->ar_hdr.ar_size));
+	}
+
+	member->offset = arch->size;
+	arch->size += sizeof(struct ar_hdr) + size + ar_name_size;
+
+	if(ofile->mh != NULL ||
+	   ofile->mh64 != NULL){
+	    member->object_addr = ofile->object_addr;
+	    member->object_size = ofile->object_size;
+	    member->object_byte_sex = ofile->object_byte_sex;
+	    member->mh = ofile->mh;
+	    member->mh64 = ofile->mh64;
+	    member->load_commands = ofile->load_commands;
+	}
+#ifdef LTO_SUPPORT
+	else if(ofile->file_type == OFILE_LLVM_BITCODE){
+	    member->object_addr = ofile->file_addr;
+	    member->object_size = ofile->file_size;
+	    member->lto = ofile->lto;
+	    member->object_byte_sex = get_byte_sex_from_flag(&arch->arch_flag);
+	}
+#endif /* LTO_SUPPORT */
+	else{
+	    member->object_addr = ofile->member_addr;
+	    member->object_size = ofile->member_size;
+#ifdef LTO_SUPPORT
+	    if(ofile->lto != NULL){
+		member->lto = ofile->lto;
+		member->object_byte_sex = get_byte_sex_from_flag(
+							&arch->arch_flag);
+	    }
+#endif /* LTO_SUPPORT */
+	}
+}
+
+/*
+ * free_archs() frees the memory allocated that is pointed to by archs.
+ */
+static
+void
+free_archs(
+void)
+{
+    uint32_t i;
+
+	for(i = 0 ; i < narchs; i++){
+	    /*
+	     * Just leak memory on the arch_flag.name in some cases
+	     * (unknown archiectures only where the space is malloced and
+	     * a sprintf() is done into the memory)
+	     */
+	    if(archs[i].tocs != NULL)
+		free(archs[i].tocs);
+	    if(archs[i].toc_ranlibs != NULL)
+		free(archs[i].toc_ranlibs);
+	    if(archs[i].toc_strings != NULL)
+		free(archs[i].toc_strings);
+	    if(archs[i].members != NULL)
+		free(archs[i].members);
+	}
+	if(archs != NULL)
+	    free(archs);
+	archs = NULL;
+	narchs = 0;
+}
+
+/*
+ * create_library() creates a library from the data structure pointed to by
+ * archs into the specified output file.  Only when more than one architecture
+ * is in archs will a fat file be created.
+ *
+ * In the case of cmd_flags.ranlib == TRUE the ofile may not be NULL if it
+ * from a thin archive.  If so and the toc_* fields are set and we may update
+ * the table of contents in place if the new one fits where the old table of
+ * contents was.
+ */
+static
+void
+create_library(
+char *output,
+struct ofile *ofile)
+{
+    uint32_t i, j, k, library_size, offset, pad, *time_offsets;
+    enum byte_sex target_byte_sex;
+    char *library, *p, *flush_start;
+    kern_return_t r;
+    struct arch *arch;
+    struct fat_header *fat_header;
+    struct fat_arch *fat_arch;
+    int fd;
+#ifndef __OPENSTEP__
+    struct utimbuf timep;
+#else
+    time_t timep[2];
+#endif
+    struct stat stat_buf;
+    struct ar_hdr toc_ar_hdr;
+    enum bool some_tocs, same_toc, different_offsets;
+
+	if(narchs == 0){
+	    if(cmd_flags.ranlib == TRUE){
+		if(cmd_flags.q == FALSE)
+		    warning("empty library: %s (no table of contents added)",
+			    output);
+		return;
+	    }
+	    else{
+		if(cmd_flags.dynamic == FALSE ||
+		   cmd_flags.no_files_ok == FALSE){
+		    if(cmd_flags.arch_only_flag.name != NULL)
+			error("no library created (no object files in input "
+			      "files matching -arch_only %s)",
+			      cmd_flags.arch_only_flag.name);
+		    else
+			error("no library created (no object files in input "
+			      "files)");
+		    return;
+		}
+	    }
+	}
+
+	if(cmd_flags.dynamic == TRUE){
+	    create_dynamic_shared_library(output);
+	    return;
+	}
+
+	/* if this is libtool warn about duplicate member names */
+	if(cmd_flags.ranlib == FALSE)
+	    warn_duplicate_member_names();
+
+	/*
+	 * Calculate the total size of the library and the final size of each
+	 * architecture.
+	 */
+	if(narchs > 1){
+	    library_size = sizeof(struct fat_header) +
+			   sizeof(struct fat_arch) * narchs;
+	    /*
+	     * The ar(1) program uses the -q flag to ranlib(1) to add a table
+	     * of contents only of the output is not a fat file.  This is done
+	     * by default for UNIX standards conformance when the files are
+	     * thin .o files.
+	     */
+	    if(cmd_flags.q == TRUE)
+		exit(EXIT_SUCCESS);
+	    /*
+	     * The ar(1) program uses the -f to ranlib(1) when it see the 's'
+	     * option.  And if we are creating a fat file issue a warning that
+	     * ar(1) will not be able to use it.
+	     */
+	    if(cmd_flags.f == TRUE)
+		warning("archive library: %s will be fat and ar(1) will not "
+			"be able to operate on it", output);
+	}
+	else
+	    library_size = 0;
+	some_tocs = FALSE;
+	for(i = 0; i < narchs; i++){
+	    make_table_of_contents(archs + i, output);
+	    if(errors != 0)
+		return;
+	    if(archs[i].toc_nranlibs != 0)
+		some_tocs = TRUE;
+	    archs[i].size += SARMAG + archs[i].toc_size;
+	    library_size += archs[i].size;
+	}
+	/*
+	 * The ar(1) program uses the -q flag to ranlib(1) to add a table of
+	 * contents only of the output contains some object files.  This is
+	 * done for UNIX standards conformance.
+	 */
+	if(cmd_flags.q == TRUE && some_tocs == FALSE)
+	    exit(EXIT_SUCCESS);
+	
+ 	/* 
+	 * If this is ranlib(1) and we are running in UNIX standard mode and
+	 * the file is not writeable just print and error message and return.
+	 */
+	if(cmd_flags.ranlib == TRUE &&
+	   get_unix_standard_mode() == TRUE &&
+	   access(output, W_OK) == -1){
+	    system_error("file: %s is not writable", output);
+	    return;
+	}
+
+	/*
+	 * If this is ranlib(1) and we have a thin archive that has an existing
+	 * table of contents see if we have enough room to update it in place.
+	 * Actually we check to see that we have the exact same number of
+	 * ranlib structs and string size, as this is the most common case that
+	 * the defined global symbols have not changed when rebuilding and it
+	 * will just be the offset to archive members that will have changed.
+	 */
+	if(cmd_flags.ranlib == TRUE && narchs == 1 &&
+	   ofile != NULL && ofile->toc_addr != NULL &&
+	   ofile->toc_bad == FALSE &&
+	   archs[0].toc_nranlibs == ofile->toc_nranlibs &&
+	   archs[0].toc_strsize == ofile->toc_strsize){
+
+	    /*
+	     * The existing thin archive may not be laid out the same way as
+	     * libtool(1) would do it.  As ar(1) does not know to pad things
+	     * so object files are on their natural alignment.  So check to
+	     * see if the offsets are not the same and if the alignment is OK.
+	     */
+	    different_offsets = FALSE;
+	    for(i = 0; i < archs[0].nmembers; i++){
+		if(archs[0].members[i].input_member_offset !=
+		   archs[0].members[i].offset){
+		    different_offsets = TRUE;
+		    /*
+		     * For now we will allow alignments of 4 bytes offsets even
+		     * though we would produce 8 byte alignments.
+		     */
+		    if(archs[0].members[i].input_member_offset % 4 != 0){
+		        goto fail_to_update_toc_in_place;
+		    }
+		}
+	    }
+
+	    /*
+	     * The time_offsets array records the offsets to the table of
+	     * contents archive header's ar_date fields.  In this case we just
+	     * have one since this is a thin file (non-fat) file.
+	     */
+	    time_offsets = allocate(1 * sizeof(uint32_t));
+	    /*
+	     * Calculate the offset to the archive header's time field for the
+	     * table of contents.
+	     */
+	    time_offsets[0] = SARMAG +
+			 ((char *)&toc_ar_hdr.ar_date - (char *)&toc_ar_hdr);
+
+	    /*
+	     * If we had different member offsets in the input thin archive
+	     * we adjust the ranlib structs ran_off to use them.
+	     */
+	    if(different_offsets == TRUE){
+		same_toc = FALSE;
+		for(i = 0; i < archs[0].toc_nranlibs; i++){
+		    for(j = 0; j < archs[0].nmembers; j++){
+			if(archs[0].members[j].offset == 
+			   archs[0].toc_ranlibs[i].ran_off){
+			    archs[0].toc_ranlibs[i].ran_off = 
+				archs[0].members[i].input_member_offset;
+			    break;
+			}
+		    }
+		}
+	    }
+	    else{
+		/*
+		 * If the new table of contents and the new string table are the
+		 * same as the old then the archive only needs to be "touched"
+		 * and the time field of the toc needs to be updated.
+		 */
+		same_toc = TRUE;
+		for(i = 0; i < archs[0].toc_nranlibs; i++){
+		    if(archs[0].toc_ranlibs[i].ran_un.ran_strx != 
+		       ofile->toc_ranlibs[i].ran_un.ran_strx ||
+		       archs[0].toc_ranlibs[i].ran_off !=
+		       ofile->toc_ranlibs[i].ran_off){
+			same_toc = FALSE;
+			break;
+		    }
+		}
+		if(same_toc == TRUE){
+		    for(i = 0; i < archs[0].toc_strsize; i++){
+			if(archs[0].toc_strings[i] != ofile->toc_strings[i]){
+			    same_toc = FALSE;
+			    break;
+			}
+		    }
+		}
+	    }
+
+	    library_size = SARMAG;
+	    if(same_toc == FALSE)
+		library_size += archs[0].toc_size;
+	    if((r = vm_allocate(mach_task_self(), (vm_address_t *)&library,
+				library_size, TRUE)) != KERN_SUCCESS)
+		mach_fatal(r, "can't vm_allocate() buffer for output file: %s "
+			   "of size %u", output, library_size);
+
+
+	    /* put in the archive magic string in the buffer */
+	    p = library;
+	    memcpy(p, ARMAG, SARMAG);
+	    p += SARMAG;
+
+	    /* put the table of contents in the buffer if needed */
+	    target_byte_sex = get_target_byte_sex(archs + 0, host_byte_sex);
+	    if(same_toc == FALSE)
+		p = put_toc_member(p, archs+0, host_byte_sex, target_byte_sex);
+
+	    if((fd = open(output, O_WRONLY, 0)) == -1){
+		system_error("can't open output file: %s", output);
+		return;
+	    }
+	    if(write(fd, library, library_size) != (int)library_size){
+		system_error("can't write output file: %s", output);
+		return;
+	    }
+	    if(close(fd) == -1){
+		system_fatal("can't close output file: %s", output);
+		return;
+	    }
+	    goto update_toc_ar_dates;
+	}
+fail_to_update_toc_in_place:
+
+	/*
+	 * This buffer is vm_allocate'ed to make sure all holes are filled with
+	 * zero bytes.
+	 */
+	if((r = vm_allocate(mach_task_self(), (vm_address_t *)&library,
+			    library_size, TRUE)) != KERN_SUCCESS)
+	    mach_fatal(r, "can't vm_allocate() buffer for output file: %s of "
+		       "size %u", output, library_size);
+
+	/*
+	 * Create the output file.  The unlink() is done to handle the problem
+	 * when the outputfile is not writable but the directory allows the
+	 * file to be removed (since the file may not be there the return code
+	 * of the unlink() is ignored).
+	 */
+	(void)unlink(output);
+	if((fd = open(output, O_WRONLY | O_CREAT | O_TRUNC, 0666)) == -1){
+	    system_error("can't create output file: %s", output);
+	    return;
+	}
+#ifdef F_NOCACHE
+        /* tell filesystem to NOT cache the file when reading or writing */
+	(void)fcntl(fd, F_NOCACHE, 1);
+#endif
+
+	/*
+	 * If there is more than one architecture then fill in the fat file
+	 * header and the fat_arch structures in the buffer.
+	 */
+	if(narchs > 1){
+	    fat_header = (struct fat_header *)library;
+	    fat_header->magic = FAT_MAGIC;
+	    fat_header->nfat_arch = narchs;
+	    offset = sizeof(struct fat_header) +
+			    sizeof(struct fat_arch) * narchs;
+	    fat_arch = (struct fat_arch *)(library + sizeof(struct fat_header));
+	    for(i = 0; i < narchs; i++){
+		fat_arch[i].cputype = archs[i].arch_flag.cputype;
+		fat_arch[i].cpusubtype = archs[i].arch_flag.cpusubtype;
+		fat_arch[i].offset = offset;
+		fat_arch[i].size = archs[i].size;
+		fat_arch[i].align = 2;
+		offset += archs[i].size;
+	    }
+#ifdef __LITTLE_ENDIAN__
+	    swap_fat_header(fat_header, BIG_ENDIAN_BYTE_SEX);
+	    swap_fat_arch(fat_arch, narchs, BIG_ENDIAN_BYTE_SEX);
+#endif /* __LITTLE_ENDIAN__ */
+	    offset = sizeof(struct fat_header) +
+			    sizeof(struct fat_arch) * narchs;
+	}
+	else
+	    offset = 0;
+
+	/* flush out the fat headers if any */
+	output_flush(library, library_size, fd, 0, offset);
+
+	/*
+	 * The time_offsets array records the offsets to the table of conternts
+	 * archive header's ar_date fields.
+	 */
+	time_offsets = allocate(narchs * sizeof(uint32_t));
+
+	/*
+	 * Now put each arch in the buffer.
+	 */
+	for(i = 0; i < narchs; i++){
+	    p = library + offset;
+	    flush_start = p;
+	    arch = archs + i;
+
+	    /*
+	     * If the input files only contains non-object files then the
+	     * byte sex of the output can't be determined which is needed for
+	     * the two binary long's of the table of contents.  But since these
+	     * will be zero (the same in both byte sexes) because there are no
+	     * symbols in the table of contents if there are no object files.
+	     */
+
+	    /* put in the archive magic string */
+	    memcpy(p, ARMAG, SARMAG);
+	    p += SARMAG;
+
+	    /*
+	     * Warn for what really is a bad library that has an empty table of
+	     * contents but this is allowed in the original ranlib.
+	     */
+	    if(arch->toc_nranlibs == 0 && cmd_flags.q == FALSE){
+		if(narchs > 1)
+		    warning("warning for library: %s for architecture: %s the "
+			    "table of contents is empty (no object file members"
+			    " in the library define global symbols)", output,
+			    arch->arch_flag.name);
+		else
+		    warning("warning for library: %s the table of contents is "
+			    "empty (no object file members in the library "
+			    "define global symbols)", output);
+	    }
+
+	    /*
+	     * Pick the byte sex to write the table of contents in.
+	     */
+	    target_byte_sex = get_target_byte_sex(arch, host_byte_sex);
+
+	    /*
+	     * Remember the offset to the archive header's time field for this
+	     * arch's table of contents member.
+	     */
+	    time_offsets[i] =
+			 (p - library) +
+			 ((char *)&toc_ar_hdr.ar_date - (char *)&toc_ar_hdr);
+
+	    /*
+	     * Put in the table of contents member in the output buffer.
+	     */
+	    p = put_toc_member(p, arch, host_byte_sex, target_byte_sex);
+
+	    output_flush(library, library_size, fd, flush_start - library,
+			 p - flush_start);
+
+	    /*
+	     * Put in the archive header and member contents for each member.
+	     */
+	    for(j = 0; j < arch->nmembers; j++){
+		flush_start = p;
+		memcpy(p, (char *)&(arch->members[j].ar_hdr),
+		       sizeof(struct ar_hdr));
+		p += sizeof(struct ar_hdr);
+
+		/*
+		 * If we are using extended format #1 for long names write out
+		 * the name.  Note the name is padded with '\0' and the
+		 * member_name_size is the unrounded size.
+		 */
+		if(arch->members[j].output_long_name == TRUE){
+		    strncpy(p, arch->members[j].member_name,
+			    arch->members[j].member_name_size);
+		    p += rnd(arch->members[j].member_name_size, 8) +
+			       (rnd(sizeof(struct ar_hdr), 8) -
+				sizeof(struct ar_hdr));
+		}
+
+		/*
+		 * ofile_map swaps the headers to the host_byte_sex if the
+		 * object's byte sex is not the same as the host byte sex so
+		 * if this is the case swap them back before writing them out.
+		 */
+		if(arch->members[j].mh != NULL &&
+		   arch->members[j].object_byte_sex != host_byte_sex){
+		    if(swap_object_headers(arch->members[j].mh,
+		       arch->members[j].load_commands) == FALSE)
+			fatal("internal error: swap_object_headers() failed");
+		}
+		else if(arch->members[j].mh64 != NULL &&
+		   arch->members[j].object_byte_sex != host_byte_sex){
+		    if(swap_object_headers(arch->members[j].mh64,
+		       arch->members[j].load_commands) == FALSE)
+			fatal("internal error: swap_object_headers() failed");
+		}
+		memcpy(p, arch->members[j].object_addr,
+		       arch->members[j].object_size);
+#if defined(VM_SYNC_DEACTIVATE) && !defined(_POSIX_C_SOURCE) && !defined(__CYGWIN__)
+		vm_msync(mach_task_self(),
+			 (vm_address_t)arch->members[j].object_addr,
+			 (vm_size_t)arch->members[j].object_size,
+			 VM_SYNC_DEACTIVATE);
+#endif /* VM_SYNC_DEACTIVATE */
+		p += arch->members[j].object_size;
+		pad = rnd(arch->members[j].object_size, 8) -
+		      arch->members[j].object_size;
+		/* as with the UNIX ar(1) program pad with '\n' characters */
+		for(k = 0; k < pad; k++)
+		    *p++ = '\n';
+
+		output_flush(library, library_size, fd, flush_start - library,
+			     p - flush_start);
+	    }
+	    offset += arch->size;
+	}
+
+	/*
+	 * Write the library to the file or flush the remaining buffer to the
+	 * file.
+	 */
+	if(cmd_flags.noflush == TRUE){
+	    if(write(fd, library, library_size) != (int)library_size){
+		system_error("can't write output file: %s", output);
+		return;
+	    }
+	}
+	else{
+	    final_output_flush(library, fd);
+	}
+	if(close(fd) == -1){
+	    system_fatal("can't close output file: %s", output);
+	    return;
+	}
+
+update_toc_ar_dates:
+	/*
+	 * Now that the library is created on the file system it is written
+	 * to get the time for the file on that file system.
+	 */
+	if(stat(output, &stat_buf) == -1){
+	    system_fatal("can't stat file output file: %s", output);
+	    return;
+	}
+	if((fd = open(output, O_WRONLY, 0)) == -1){
+	    system_error("can't open output file: %s", output);
+	    return;
+	}
+	if(zero_ar_date == TRUE)
+	    stat_buf.st_mtime = 0;
+	/*
+         * With the time from the file system the library is on set the ar_date
+	 * using the modification time returned by stat.  Then write this into
+	 * all the ar_date's in the file.
+	 */
+	sprintf((char *)(&toc_ar_hdr), "%-*s%-*ld",
+	   (int)sizeof(toc_ar_hdr.ar_name),
+	       SYMDEF,
+	   (int)sizeof(toc_ar_hdr.ar_date),
+	       (long int)stat_buf.st_mtime + 5);
+	for(i = 0; i < narchs; i++){
+	    if(lseek(fd, time_offsets[i], L_SET) == -1){
+		system_error("can't lseek in output file: %s", output);
+		return;
+	    }
+	    if(write(fd, &toc_ar_hdr.ar_date, sizeof(toc_ar_hdr.ar_date)) !=
+		     sizeof(toc_ar_hdr.ar_date)){
+		system_error("can't write to output file: %s", output);
+		return;
+	    }
+	}
+	if(close(fd) == -1){
+	    system_fatal("can't close output file: %s", output);
+	    return;
+	}
+	/*
+	 * Now set the modtime of the created library back to it's stat time
+	 * when we first closed it.
+	 */
+#ifndef __OPENSTEP__
+	timep.actime = stat_buf.st_mtime;
+	timep.modtime = stat_buf.st_mtime;
+	if(utime(output, &timep) == -1)
+#else
+	timep[0] = stat_buf.st_mtime;
+	timep[1] = stat_buf.st_mtime;
+	if(utime(output, timep) == -1)
+#endif
+	{
+	    system_fatal("can't set the modifiy times in output file: %s",
+			 output);
+	    return;
+	}
+	if((r = vm_deallocate(mach_task_self(), (vm_address_t)library,
+			      library_size)) != KERN_SUCCESS){
+	    my_mach_error(r, "can't vm_deallocate() buffer for output file");
+	    return;
+	}
+}
+
+/*
+ * get_target_byte_sex() pick the byte sex to write the table of contents in
+ * for the arch.
+ */
+static
+enum byte_sex
+get_target_byte_sex(
+struct arch *arch,
+enum byte_sex host_byte_sex)
+{
+    uint32_t i;
+    enum byte_sex target_byte_sex;
+
+	target_byte_sex = UNKNOWN_BYTE_SEX;
+	for(i = 0;
+	    i < arch->nmembers && target_byte_sex == UNKNOWN_BYTE_SEX;
+	    i++){
+	    target_byte_sex = arch->members[i].object_byte_sex;
+	}
+	if(target_byte_sex == UNKNOWN_BYTE_SEX)
+	    target_byte_sex = host_byte_sex;
+	return(target_byte_sex);
+}
+
+/*
+ * put_toc_member() put the contents member for arch into the buffer p and 
+ * returns the pointer to the buffer after the table of contents.
+ * The table of contents member is:
+ *	the archive header
+ *  the archive member name (if using a long name)
+ *	a uint32_t for the number of bytes of the ranlib structs
+ *	the ranlib structs
+ *	a uint32_t for the number of bytes of the strings for the
+ *    ranlibs
+ *	the strings for the ranlib structs
+ */
+static
+char *
+put_toc_member(
+char *p,
+struct arch *arch,
+enum byte_sex host_byte_sex,
+enum byte_sex target_byte_sex)
+{
+    uint32_t l;
+
+	memcpy(p, (char *)&arch->toc_ar_hdr, sizeof(struct ar_hdr));
+	p += sizeof(struct ar_hdr);
+
+	if(arch->toc_long_name == TRUE){
+	    memcpy(p, arch->toc_name, arch->toc_name_size);
+	    p += arch->toc_name_size +
+		 (rnd(sizeof(struct ar_hdr), 8) -
+		  sizeof(struct ar_hdr));
+	}
+
+	l = arch->toc_nranlibs * sizeof(struct ranlib);
+	if(target_byte_sex != host_byte_sex)
+	    l = SWAP_INT(l);
+	memcpy(p, (char *)&l, sizeof(uint32_t));
+	p += sizeof(uint32_t);
+
+	if(target_byte_sex != host_byte_sex)
+	    swap_ranlib(arch->toc_ranlibs, arch->toc_nranlibs,
+			target_byte_sex);
+	memcpy(p, (char *)arch->toc_ranlibs,
+	       arch->toc_nranlibs * sizeof(struct ranlib));
+	p += arch->toc_nranlibs * sizeof(struct ranlib);
+
+	l = arch->toc_strsize;
+	if(target_byte_sex != host_byte_sex)
+	    l = SWAP_INT(l);
+	memcpy(p, (char *)&l, sizeof(uint32_t));
+	p += sizeof(uint32_t);
+
+	memcpy(p, (char *)arch->toc_strings, arch->toc_strsize);
+	p += arch->toc_strsize;
+
+	return(p);
+}
+
+/*
+ * output_flush() takes an offset and a size of part of the output library,
+ * known in the comments as the new area, and causes any fully flushed pages to
+ * be written to the library file the new area in combination with previous
+ * areas created.  The data structure output_blocks has ordered blocks of areas
+ * that have been flushed which are maintained by this routine.  Any area can
+ * only be flushed once and an error will result is the new area overlaps with a
+ * previously flushed area.
+ */
+static
+void
+output_flush(
+char *library,
+uint32_t library_size,
+int fd,
+uint32_t offset,
+uint32_t size)
+{ 
+    uint32_t write_offset, write_size, host_pagesize;
+    struct block **p, *block, *before, *after;
+    kern_return_t r;
+
+	host_pagesize = 0x2000;
+
+	if(cmd_flags.noflush == TRUE)
+	    return;
+
+	if(offset + size > library_size)
+	    fatal("internal error: output_flush(offset = %u, size = %u) out "
+		  "of range for library_size = %u", offset, size, library_size);
+
+#ifdef DEBUG
+	if(cmd_flags.debug & (1 << 2))
+	    print_block_list();
+	if(cmd_flags.debug & (1 << 1))
+	    printf("output_flush(offset = %lu, size %lu)", offset, size);
+#endif /* DEBUG */
+
+	if(size == 0){
+#ifdef DEBUG
+	if(cmd_flags.debug & (1 << 1))
+	    printf("\n");
+#endif /* DEBUG */
+	    return;
+	}
+
+	/*
+	 * Search through the ordered output blocks to find the block before the
+	 * new area and after the new area if any exist.
+	 */
+	before = NULL;
+	after = NULL;
+	p = &(output_blocks);
+	while(*p){
+	    block = *p;
+	    if(offset < block->offset){
+		after = block;
+		break;
+	    }
+	    else{
+		before = block;
+	    }
+	    p = &(block->next);
+	}
+
+	/*
+	 * Check for overlap of the new area with the block before and after the
+	 * new area if there are such blocks.
+	 */
+	if(before != NULL){
+	    if(before->offset + before->size > offset){
+		warning("internal error: output_flush(offset = %u, size = %u)"
+		      " overlaps with flushed block(offset = %u, size = %u)",
+		      offset, size, before->offset, before->size);
+		printf("calling abort()\n");	
+		abort();
+	    }
+	}
+	if(after != NULL){
+	    if(offset + size > after->offset){
+		warning("internal error: output_flush(offset = %u, size = %u)"
+		      " overlaps with flushed block(offset = %u, size = %u)",
+		      offset, size, after->offset, after->size);
+		printf("calling abort()\n");	
+		abort();
+	    }
+	}
+
+	/*
+	 * Now see how the new area fits in with the blocks before and after it
+	 * (that is does it touch both, one or the other or neither blocks).
+	 * For each case first the offset and size to write (write_offset and
+	 * write_size) are set for the area of full pages that can now be
+	 * written from the block.  Then the area written in the block
+	 * (->written_offset and ->written_size) are set to reflect the total
+	 * area in the block now written.  Then offset and size the block
+	 * refers to (->offset and ->size) are set to total area of the block.
+	 * Finally the links to others blocks in the list are adjusted if a
+	 * block is added or removed.
+	 *
+	 * See if there is a block before the new area and the new area
+	 * starts at the end of that block.
+	 */
+	if(before != NULL && before->offset + before->size == offset){
+	    /*
+	     * See if there is also a block after the new area and the new area
+	     * ends at the start of that block.
+	     */
+	    if(after != NULL && offset + size == after->offset){
+		/*
+		 * This is the case where the new area exactly fill the area
+		 * between two existing blocks.  The total area is folded into
+		 * the block before the new area and the block after the new
+		 * area is removed from the list.
+		 */
+		if(before->offset == 0 && before->written_size == 0){
+		    write_offset = 0;
+		    before->written_offset = 0;
+		}
+		else
+		    write_offset =before->written_offset + before->written_size;
+		if(after->written_size == 0)
+		    write_size = trnc(after->offset + after->size -
+				       write_offset, host_pagesize);
+		else
+		    write_size = trnc(after->written_offset - write_offset,
+				       host_pagesize);
+		if(write_size != 0){
+		    before->written_size += write_size;
+		}
+		if(after->written_size != 0)
+		    before->written_size += after->written_size;
+		before->size += size + after->size;
+
+		/* remove the block after the new area */
+		before->next = after->next;
+		remove_block(after);
+	    }
+	    else{
+		/*
+		 * This is the case where the new area starts at the end of the
+		 * block just before it but does not end where the block after
+		 * it (if any) starts.  The new area is folded into the block
+		 * before the new area.
+		 */
+		write_offset = before->written_offset + before->written_size;
+		write_size = trnc(offset + size - write_offset, host_pagesize);
+		if(write_size != 0)
+		    before->written_size += write_size;
+		before->size += size;
+	    }
+	}
+	/*
+	 * See if the new area and the new area ends at the start of the block
+	 * after it (if any).
+	 */
+	else if(after != NULL && offset + size == after->offset){
+	    /*
+	     * This is the case where the new area ends at the begining of the
+	     * block just after it but does not start where the block before it.
+	     * (if any) ends.  The new area is folded into this block after the
+	     * new area.
+	     */
+	    write_offset = rnd(offset, host_pagesize);
+	    if(after->written_size == 0)
+		write_size = trnc(after->offset + after->size - write_offset,
+				   host_pagesize);
+	    else
+		write_size = trnc(after->written_offset - write_offset,
+				   host_pagesize);
+	    if(write_size != 0){
+		after->written_offset = write_offset;
+		after->written_size += write_size;
+	    }
+	    else if(write_offset != after->written_offset){
+		after->written_offset = write_offset;
+	    }
+	    after->offset = offset;
+	    after->size += size;
+	}
+	else{
+	    /*
+	     * This is the case where the new area neither starts at the end of
+	     * the block just before it (if any) or ends where the block after
+	     * it (if any) starts.  A new block is created and the new area is
+	     * is placed in it.
+	     */
+	    write_offset = rnd(offset, host_pagesize);
+	    write_size = trnc(offset + size - write_offset, host_pagesize);
+	    block = get_block();
+	    block->offset = offset;
+	    block->size = size;
+	    block->written_offset = write_offset;
+	    block->written_size = write_size;
+	    /*
+	     * Insert this block in the ordered list in the correct place.
+	     */
+	    if(before != NULL){
+		block->next = before->next;
+		before->next = block;
+	    }
+	    else{
+		block->next = output_blocks;
+		output_blocks = block;
+	    }
+	}
+
+	/*
+	 * Now if there are full pages to write write them to the output file.
+	 */
+	if(write_size != 0){
+#ifdef DEBUG
+	if((cmd_flags.debug & (1 << 1)) || (cmd_flags.debug & (1 << 0)))
+	    printf(" writing (write_offset = %lu write_size = %lu)\n",
+		   write_offset, write_size);
+#endif /* DEBUG */
+	    lseek(fd, write_offset, L_SET);
+	    if(write(fd, library + write_offset, write_size) !=
+	       (int)write_size)
+		system_fatal("can't write to output file");
+	    if((r = vm_deallocate(mach_task_self(), (vm_address_t)(library +
+				  write_offset), write_size)) != KERN_SUCCESS)
+		mach_fatal(r, "can't vm_deallocate() buffer for output file");
+	}
+#ifdef DEBUG
+	else{
+	    if(cmd_flags.debug & (1 << 1))
+		printf(" no write\n");
+	}
+#endif /* DEBUG */
+}
+
+/*
+ * final_output_flush() flushes the last part of the last page of the object
+ * file if it does not round out to exactly a page.
+ */
+static
+void
+final_output_flush(
+char *library,
+int fd)
+{ 
+    struct block *block;
+    uint32_t write_offset, write_size;
+    kern_return_t r;
+
+#ifdef DEBUG
+	/* The compiler "warning: `write_offset' may be used uninitialized in */
+	/* this function" can safely be ignored */
+	write_offset = 0;
+	if((cmd_flags.debug & (1 << 1)) || (cmd_flags.debug & (1 << 0))){
+	    printf("final_output_flush block_list:\n");
+	    print_block_list();
+	}
+#endif /* DEBUG */
+
+	write_size = 0;
+	block = output_blocks;
+	if(block != NULL){
+	    if(block->offset != 0)
+		fatal("internal error: first block not at offset 0");
+	    if(block->written_size != 0){
+		if(block->written_offset != 0)
+		    fatal("internal error: first block written_offset not 0");
+		write_offset = block->written_size;
+		write_size = block->size - block->written_size;
+	    }
+	    else{
+		write_offset = block->offset;
+		write_size = block->size;
+	    }
+	    if(block->next != NULL)
+		fatal("internal error: more than one block in final list");
+	}
+	if(write_size != 0){
+#ifdef DEBUG
+	    if((cmd_flags.debug & (1 << 1)) || (cmd_flags.debug & (1 << 1)))
+		printf(" writing (write_offset = %lu write_size = %lu)\n",
+		       write_offset, write_size);
+#endif /* DEBUG */
+	    lseek(fd, write_offset, L_SET);
+	    if(write(fd, library + write_offset, write_size) !=
+	       (int)write_size)
+		system_fatal("can't write to output file");
+	    if((r = vm_deallocate(mach_task_self(), (vm_address_t)(library +
+				  write_offset), write_size)) != KERN_SUCCESS)
+		mach_fatal(r, "can't vm_deallocate() buffer for output file");
+	}
+	output_blocks = NULL;
+}
+
+#ifdef DEBUG
+/*
+ * print_block_list() prints the list of blocks.  Used for debugging.
+ */
+static
+void
+print_block_list(void)
+{
+    struct block **p, *block;
+
+	p = &(output_blocks);
+	if(*p == NULL)
+	    printf("Empty block list\n");
+	while(*p){
+	    block = *p;
+	    printf("block 0x%x\n", (unsigned int)block);
+	    printf("    offset %lu\n", block->offset);
+	    printf("    size %lu\n", block->size);
+	    printf("    written_offset %lu\n", block->written_offset);
+	    printf("    written_size %lu\n", block->written_size);
+	    printf("    next 0x%x\n", (unsigned int)(block->next));
+	    p = &(block->next);
+	}
+}
+#endif /* DEBUG */
+
+/*
+ * get_block() returns a pointer to a new block.  This could be done by
+ * allocating block of these placing them on a free list and and handing them
+ * out.  For the initial release of this code this number is typicly low and not
+ * a big win so each block just allocated and free'ed.
+ */
+static
+struct block *
+get_block(void)
+{
+    struct block *block;
+
+	block = allocate(sizeof(struct block));
+	return(block);
+}
+
+/*
+ * remove_block() throws away the block specified.  See comments in get_block().
+ */
+static
+void
+remove_block(
+struct block *block)
+{
+	free(block);
+}
+
+/*
+ * trnc() truncates the value 'v' to the power of two value 'r'.  If v is
+ * less than zero it returns zero.
+ */
+static
+uint32_t
+trnc(
+uint32_t v,
+uint32_t r)
+{
+	if(((int32_t)v) < 0)
+	    return(0);
+	return(v & ~(r - 1));
+}
+
+/*
+ * create_dynamic_shared_library() creates a dynamic shared library from the
+ * data structure pointed to by archs into the specified output file.  Only
+ * when more than one architecture is in archs will a fat file be created.
+ */
+static
+void
+create_dynamic_shared_library(
+char *output)
+{
+    uint32_t i, j;
+    char *p, *filelist;
+    struct stat stat_buf;
+    enum bool use_force_cpusubtype_ALL;
+    const struct arch_flag *family_arch_flag;
+
+	/*
+	 * If there is more than one architecture setup a signal handler to
+	 * clean up the temporary files in case we get a signal.
+	 */
+	if(narchs > 1)
+	    signal(SIGINT, create_dynamic_shared_library_cleanup);
+
+	/*
+	 * If -arch_only is specified with a specific cpusubtype other than the
+	 * family cpusubtype do not use -force_cpusubtype_ALL as the user wants
+	 * the output to be tagged with that cpusubtype.
+	 */
+	use_force_cpusubtype_ALL = TRUE;
+	if(cmd_flags.arch_only_flag.name != NULL){
+	    family_arch_flag = get_arch_family_from_cputype(
+				    cmd_flags.arch_only_flag.cputype);
+	    if(family_arch_flag != NULL){
+		if((family_arch_flag->cpusubtype & ~CPU_SUBTYPE_MASK) !=
+		   (cmd_flags.arch_only_flag.cpusubtype & ~CPU_SUBTYPE_MASK))
+		    use_force_cpusubtype_ALL = FALSE;
+	    }
+	}
+
+	/*
+	 * For each architecture run ld(1) -dylib to create the dynamic shared
+	 * library.
+	 */
+	for(i = 0; i < narchs || (i == 0 && narchs == 0); i++){
+	    reset_execute_list();
+	    add_execute_list_with_prefix("ld");
+	    if(narchs != 0 && cmd_flags.arch_only_flag.name == NULL)
+		add_execute_list("-arch_multiple");
+	    if(archs != NULL){
+		add_execute_list("-arch");
+		if(use_force_cpusubtype_ALL == TRUE)
+		    add_execute_list(archs[i].arch_flag.name);
+		else
+		    add_execute_list(cmd_flags.arch_only_flag.name);
+	    }
+	    add_execute_list("-dylib");
+	    add_execute_list("-dynamic");
+	    if(cmd_flags.all_load_flag_specified == FALSE ||
+	       cmd_flags.all_load == TRUE)
+		add_execute_list("-all_load");
+	    if(use_force_cpusubtype_ALL == TRUE)
+		add_execute_list("-force_cpusubtype_ALL");
+	    add_execute_list("-no_arch_warnings");
+	    if(cmd_flags.seg1addr != NULL){
+		add_execute_list("-seg1addr");
+		add_execute_list(cmd_flags.seg1addr);
+	    }
+	    if(cmd_flags.segs_read_only_addr != NULL){
+		add_execute_list("-segs_read_only_addr");
+		add_execute_list(cmd_flags.segs_read_only_addr);
+	    }
+	    if(cmd_flags.segs_read_write_addr != NULL){
+		add_execute_list("-segs_read_write_addr");
+		add_execute_list(cmd_flags.segs_read_write_addr);
+	    }
+	    if(cmd_flags.seg_addr_table != NULL){
+		add_execute_list("-seg_addr_table");
+		add_execute_list(cmd_flags.seg_addr_table);
+	    }
+	    if(cmd_flags.seg_addr_table_filename != NULL){
+		add_execute_list("-seg_addr_table_filename");
+		add_execute_list(cmd_flags.seg_addr_table_filename);
+	    }
+	    if(cmd_flags.compatibility != NULL){
+		add_execute_list("-dylib_compatibility_version");
+		add_execute_list(cmd_flags.compatibility);
+	    }
+	    if(cmd_flags.current != NULL){
+		add_execute_list("-dylib_current_version");
+		add_execute_list(cmd_flags.current);
+	    }
+	    if(cmd_flags.install_name != NULL){
+		add_execute_list("-dylib_install_name");
+		add_execute_list(cmd_flags.install_name);
+	    }
+	    else{
+		if(narchs > 1){
+		    add_execute_list("-dylib_install_name");
+		    add_execute_list(cmd_flags.output);
+		}
+	    }
+	    for(j = 0; j < cmd_flags.nldflags; j++)
+		add_execute_list(cmd_flags.ldflags[j]);
+	    for(j = 0; j < cmd_flags.nLdirs; j++)
+		add_execute_list(cmd_flags.Ldirs[j]);
+	    add_execute_list("-ldylib1.o");
+	    filelist = NULL;
+	    for(j = 0; j < cmd_flags.nfiles; j++){
+		if(cmd_flags.filelist[j] == NULL){
+		    add_execute_list(cmd_flags.files[j]);
+		}
+		else{
+		    if(cmd_flags.filelist[j] != filelist){
+			add_execute_list("-filelist");
+			add_execute_list(cmd_flags.filelist[j]);
+			filelist = cmd_flags.filelist[j];
+		    }
+		}
+	    }
+	    if(narchs <= 1){
+		add_execute_list("-o");
+		add_execute_list(cmd_flags.output);
+	    }
+	    else{
+		add_execute_list("-o");
+		add_execute_list(makestr(cmd_flags.output, ".libtool.",
+					 archs[i].arch_flag.name, NULL));
+		if(cmd_flags.final_output_specified == FALSE){
+		    add_execute_list("-final_output");
+		    add_execute_list(cmd_flags.output);
+		}
+	    }
+	    if(execute_list(cmd_flags.verbose) == 0)
+		fatal("internal link edit command failed");
+	}
+	/*
+	 * If there is more than one architecture then run lipo to put them
+	 * in a fat file.
+	 */
+	if(narchs > 1){
+	    reset_execute_list();
+	    add_execute_list_with_prefix("lipo");
+	    add_execute_list("-create");
+	    add_execute_list("-output");
+	    add_execute_list(cmd_flags.output);
+	    for(i = 0; i < narchs; i++){
+		add_execute_list(makestr(cmd_flags.output, ".libtool.",
+					 archs[i].arch_flag.name, NULL));
+	    }
+	    if(execute_list(cmd_flags.verbose) == 0)
+		fatal("internal lipo command failed");
+	    for(i = 0; i < narchs; i++){
+		p = makestr(cmd_flags.output, ".libtool.",
+			    archs[i].arch_flag.name, NULL);
+		if(unlink(p) == -1){
+		    error("can't remove temporary file: %s", p);
+		}
+	    }
+	}
+	/*
+	 * If we are doing prebinding then run objcunique on the
+	 * output.
+	 */
+	if(cmd_flags.prebinding == TRUE){
+	    if(stat("/usr/bin/objcunique", &stat_buf) != -1){
+		reset_execute_list();
+		add_execute_list_with_prefix("objcunique");
+		add_execute_list(cmd_flags.output);
+		add_execute_list("-prebind");
+		for(j = 0; j < cmd_flags.nLdirs; j++)
+		    add_execute_list(cmd_flags.Ldirs[j]);
+		if(execute_list(cmd_flags.verbose) == 0)
+		    fatal("internal objcunique command failed");
+	    }
+	}
+}
+
+/*
+ * create_dynamic_shared_library_cleanup() is the signal handler to remove the
+ * temporary files if more than one arch is being used.
+ */
+static
+void
+create_dynamic_shared_library_cleanup(
+int sig)
+{
+    uint32_t i;
+
+	for(i = 0; i < narchs; i++){
+	    (void)unlink(makestr(cmd_flags.output, ".libtool.",
+				 archs[i].arch_flag.name, NULL));
+	}
+	exit(EXIT_FAILURE);
+}
+
+/*
+ * make_table_of_contents() make the table of contents for the specified arch
+ * and fills in the toc_* fields in the arch.  Output is the name of the output
+ * file for error messages.
+ */
+static
+void
+make_table_of_contents(
+struct arch *arch,
+char *output)
+{
+    uint32_t i, j, k, r, s, nsects, ncmds, n_strx;
+    struct member *member;
+    struct load_command *lc;
+    struct segment_command *sg;
+    struct segment_command_64 *sg64;
+    struct nlist *symbols;
+    struct nlist_64 *symbols64;
+    char *strings;
+    enum bool sorted, is_toc_symbol;
+    char *ar_name;
+    struct section *section;
+    struct section_64 *section64;
+    uint8_t n_type, n_sect;
+#ifdef LTO_SUPPORT
+    uint32_t nsyms;
+#endif /* LTO_SUPPORT */
+
+	symbols = NULL;
+	symbols64 = NULL;
+	/*
+	 * First pass over the members to count how many ranlib structs are
+	 * needed and the size of the strings in the toc that are needed.
+	 */
+	for(i = 0; i < arch->nmembers; i++){
+	    member = arch->members + i;
+	    if(member->mh != NULL || member->mh64 != NULL){
+		nsects = 0;
+		lc = member->load_commands;
+		if(member->mh != NULL)
+		    ncmds = member->mh->ncmds;
+		else
+		    ncmds = member->mh64->ncmds;
+		for(j = 0; j < ncmds; j++){
+		    if(lc->cmd == LC_SYMTAB){
+			if(member->st == NULL)
+			    member->st = (struct symtab_command *)lc;
+		    }
+		    else if(lc->cmd == LC_SEGMENT){
+			sg = (struct segment_command *)lc;
+			nsects += sg->nsects;
+		    }
+		    else if(lc->cmd == LC_SEGMENT_64){
+			sg64 = (struct segment_command_64 *)lc;
+			nsects += sg64->nsects;
+		    }
+		    lc = (struct load_command *)((char *)lc + lc->cmdsize);
+		}
+		if(member->mh != NULL)
+		    member->sections = allocate(nsects *
+						sizeof(struct section *));
+		else
+		    member->sections64 = allocate(nsects *
+						  sizeof(struct section_64 *));
+		nsects = 0;
+		lc = member->load_commands;
+		for(j = 0; j < ncmds; j++){
+		    if(lc->cmd == LC_SEGMENT){
+			sg = (struct segment_command *)lc;
+			section = (struct section *)
+				  ((char *)sg + sizeof(struct segment_command));
+			for(k = 0; k < sg->nsects; k++){
+			    member->sections[nsects++] = section++;
+			}
+		    }
+		    else if(lc->cmd == LC_SEGMENT_64){
+			sg64 = (struct segment_command_64 *)lc;
+			section64 = (struct section_64 *)
+			    ((char *)sg64 + sizeof(struct segment_command_64));
+			for(k = 0; k < sg64->nsects; k++){
+			    member->sections64[nsects++] = section64++;
+			}
+		    }
+		    lc = (struct load_command *)((char *)lc + lc->cmdsize);
+		}
+		if(member->st != NULL && member->st->nsyms != 0){
+		    if(member->mh != NULL){
+			symbols = (struct nlist *)(member->object_addr +
+					           member->st->symoff);
+			if(member->object_byte_sex != get_host_byte_sex())
+			    swap_nlist(symbols, member->st->nsyms,
+				       get_host_byte_sex());
+		    }
+		    else{
+			symbols64 = (struct nlist_64 *)(member->object_addr +
+					                member->st->symoff);
+			if(member->object_byte_sex != get_host_byte_sex())
+			    swap_nlist_64(symbols64, member->st->nsyms,
+				          get_host_byte_sex());
+		    }
+		    strings = member->object_addr + member->st->stroff;
+		    for(j = 0; j < member->st->nsyms; j++){
+			if(member->mh != NULL){
+			    n_strx = symbols[j].n_un.n_strx;
+			    n_type = symbols[j].n_type;
+			    n_sect = symbols[j].n_sect;
+			}
+			else{
+			    n_strx = symbols64[j].n_un.n_strx;
+			    n_type = symbols64[j].n_type;
+			    n_sect = symbols64[j].n_sect;
+			}
+			if(n_strx > member->st->strsize){
+			    warn_member(arch, member, "malformed object "
+				"(symbol %u n_strx field extends past the "
+				"end of the string table)", j);
+			    errors++;
+			    continue;
+			}
+			if((n_type & N_TYPE) == N_SECT){
+			    if(n_sect == NO_SECT){
+				warn_member(arch, member, "malformed object "
+				    "(symbol %u must not have NO_SECT for its "
+				    "n_sect field given its type (N_SECT))", j);
+				errors++;
+				continue;
+			    }
+			    if(n_sect > nsects){
+				warn_member(arch, member, "malformed object "
+				    "(symbol %u n_sect field greater than the "
+				    "number of sections in the file)", j);
+				errors++;
+				continue;
+			    }
+			}
+			if(member->mh != NULL)
+			    is_toc_symbol = toc_symbol(symbols + j,
+						       member->sections);
+			else
+			    is_toc_symbol = toc_symbol_64(symbols64 + j,
+						          member->sections64);
+			if(is_toc_symbol == TRUE){
+			    arch->toc_nranlibs++;
+			    arch->toc_strsize += strlen(strings + n_strx) + 1;
+			}
+		    }
+		}
+		else
+		    warn_member(arch, member, "has no symbols");
+	    }
+#ifdef LTO_SUPPORT
+	    else if(member->lto != NULL){
+		nsyms = lto_get_nsyms(member->lto);
+		for(j = 0; j < nsyms; j++){
+		    if(lto_toc_symbol(member->lto, j, cmd_flags.c) == TRUE){
+			arch->toc_nranlibs++;
+			arch->toc_strsize +=
+			    strlen(lto_symbol_name(member->lto, j)) + 1;
+		    }
+		}
+	    }
+#endif /* LTO_SUPPORT */
+	    else{
+		if(cmd_flags.ranlib == FALSE){
+		    warn_member(arch, member, "is not an object file");
+		    errors++;
+		}
+	    }
+	}
+	if(errors != 0)
+	    return;
+
+	/*
+	 * Allocate the space for the ranlib structs and strings for the
+	 * table of contents.
+	 */
+	arch->toc_ranlibs = allocate(sizeof(struct ranlib) *arch->toc_nranlibs);
+	arch->tocs = allocate(sizeof(struct toc) * arch->toc_nranlibs);
+	arch->toc_strsize = rnd(arch->toc_strsize, 8);
+	arch->toc_strings = allocate(arch->toc_strsize);
+
+	/*
+	 * Second pass over the members to fill in the ranlib structs and
+	 * the strings for the table of contents.  The ran_name field is
+	 * filled in with a pointer to a string contained in arch->toc_strings
+	 * for easy sorting and conversion to an index.  The ran_off field is
+	 * filled in with the member index plus one to allow marking with it's
+	 * negative value by check_sort_tocs() and easy conversion to the
+	 * real offset.
+	 */
+	r = 0;
+	s = 0;
+	for(i = 0; i < arch->nmembers; i++){
+	    member = arch->members + i;
+	    if(member->mh != NULL || member->mh64 != NULL){
+		if(member->st != NULL && member->st->nsyms != 0){
+		    if(member->mh != NULL)
+			symbols = (struct nlist *)(member->object_addr +
+					           member->st->symoff);
+		    else
+			symbols64 = (struct nlist_64 *)(member->object_addr +
+					                member->st->symoff);
+		    strings = member->object_addr + member->st->stroff;
+		    for(j = 0; j < member->st->nsyms; j++){
+			if(member->mh != NULL)
+			    n_strx = symbols[j].n_un.n_strx;
+			else
+			    n_strx = symbols64[j].n_un.n_strx;
+			if(n_strx > member->st->strsize)
+			    continue;
+			if(member->mh != NULL)
+			    is_toc_symbol = toc_symbol(symbols + j,
+						       member->sections);
+			else
+			    is_toc_symbol = toc_symbol_64(symbols64 + j,
+						          member->sections64);
+			if(is_toc_symbol == TRUE){
+			    strcpy(arch->toc_strings + s,
+				   strings + n_strx);
+			    arch->tocs[r].name = arch->toc_strings + s;
+			    arch->tocs[r].index1 = i + 1;
+			    r++;
+			    s += strlen(strings + n_strx) + 1;
+			}
+		    }
+		    if(member->object_byte_sex != get_host_byte_sex()){
+			if(member->mh != NULL)
+			    swap_nlist(symbols, member->st->nsyms,
+				       member->object_byte_sex);
+			else
+			    swap_nlist_64(symbols64, member->st->nsyms,
+				          member->object_byte_sex);
+		    }
+		}
+	    }
+#ifdef LTO_SUPPORT
+	    else if(member->lto != NULL){
+		nsyms = lto_get_nsyms(member->lto);
+		for(j = 0; j < nsyms; j++){
+		    if(lto_toc_symbol(member->lto, j, cmd_flags.c) == TRUE){
+			strcpy(arch->toc_strings + s,
+			       lto_symbol_name(member->lto, j));
+			arch->tocs[r].name = arch->toc_strings + s;
+			arch->tocs[r].index1 = i + 1;
+			r++;
+			s += strlen(lto_symbol_name(member->lto, j)) + 1;
+		    }
+		}
+	    }
+#endif /* LTO_SUPPORT */
+	}
+
+	/*
+	 * If the table of contents is to be sorted by symbol name then try to
+	 * sort it and leave it sorted if no duplicates.
+	 */
+	if(cmd_flags.s == TRUE){
+	    qsort(arch->tocs, arch->toc_nranlibs, sizeof(struct toc),
+		  (int (*)(const void *, const void *))toc_name_qsort);
+	    sorted = check_sort_tocs(arch, output, FALSE);
+	    if(sorted == FALSE){
+		qsort(arch->tocs, arch->toc_nranlibs, sizeof(struct toc),
+		      (int (*)(const void *, const void *))toc_index1_qsort);
+		arch->toc_name = SYMDEF;
+		arch->toc_name_size = sizeof(SYMDEF) - 1;
+		if(cmd_flags.use_long_names == TRUE){
+		    arch->toc_long_name = TRUE;
+		    /*
+		     * This  assumes that "__.SYMDEF\0\0\0\0\0\0\0" is 16 bytes
+		     * and
+		     * (rnd(sizeof(struct ar_hdr), 8) - sizeof(struct ar_hdr)
+		     * is 4 bytes.
+		     */
+		    ar_name = AR_EFMT1 "20";
+		    arch->toc_name_size = 16;
+		    arch->toc_name = SYMDEF "\0\0\0\0\0\0\0";
+		}
+		else{
+		    arch->toc_long_name = FALSE;
+		    ar_name = arch->toc_name;
+		}
+	    }
+	    else{
+		/*
+		 * Since the SYMDEF_SORTED is "__.SYMDEF SORTED" which contains
+		 * a space, it should use extended format #1 if we can use long
+		 * names.
+		 */
+		arch->toc_name = SYMDEF_SORTED;
+		arch->toc_name_size = sizeof(SYMDEF_SORTED) - 1;
+		if(cmd_flags.use_long_names == TRUE){
+		    arch->toc_long_name = TRUE;
+		    /*
+		     * This assumes that "__.SYMDEF SORTED" is 16 bytes and
+		     * (rnd(sizeof(struct ar_hdr), 8) - sizeof(struct ar_hdr)
+		     * is 4 bytes.
+		     */
+		    ar_name = AR_EFMT1 "20";
+		}
+		else{
+		    arch->toc_long_name = FALSE;
+		    ar_name = arch->toc_name;
+		}
+	    }
+	}
+	else{
+	    sorted = FALSE;
+	    arch->toc_name = SYMDEF;
+	    arch->toc_name_size = sizeof(SYMDEF) - 1;
+	    if(cmd_flags.use_long_names == TRUE){
+		arch->toc_long_name = TRUE;
+		/*
+		 * This  assumes that "__.SYMDEF\0\0\0\0\0\0\0" is 16 bytes and
+		 * (rnd(sizeof(struct ar_hdr), 8) - sizeof(struct ar_hdr)
+		 * is 4 bytes.
+		 */
+		ar_name = AR_EFMT1 "20";
+		arch->toc_name_size = 16;
+		arch->toc_name = SYMDEF "\0\0\0\0\0\0\0";
+	    }
+	    else{
+		arch->toc_long_name = FALSE;
+		ar_name = arch->toc_name;
+	    }
+	}
+
+	/*
+	 * Now set the ran_off and ran_un.ran_strx fields of the ranlib structs.
+	 * To do this the size of the toc member must be know because it comes
+	 * first in the library.  The size of the toc member is made up of the
+	 * sizeof an archive header struct (the size of the name if a long name
+	 * is used) then the toc which is (as defined in ranlib.h):
+	 *	a uint32_t for the number of bytes of the ranlib structs
+	 *	the ranlib structures
+	 *	a uint32_t for the number of bytes of the strings
+	 *	the strings
+	 */
+	arch->toc_size = sizeof(struct ar_hdr) +
+			 sizeof(uint32_t) +
+			 arch->toc_nranlibs * sizeof(struct ranlib) +
+			 sizeof(uint32_t) +
+			 arch->toc_strsize;
+	/* add the size of the name is a long name is used */
+	if(arch->toc_long_name == TRUE)
+	    arch->toc_size += arch->toc_name_size +
+			      (rnd(sizeof(struct ar_hdr), 8) -
+			       sizeof(struct ar_hdr));
+	for(i = 0; i < arch->nmembers; i++)
+	    arch->members[i].offset += SARMAG + arch->toc_size;
+	for(i = 0; i < arch->toc_nranlibs; i++){
+	    arch->toc_ranlibs[i].ran_un.ran_strx =
+		arch->tocs[i].name - arch->toc_strings;
+	    arch->toc_ranlibs[i].ran_off =
+		arch->members[arch->tocs[i].index1 - 1].offset;
+	}
+
+	sprintf((char *)(&arch->toc_ar_hdr), "%-*s%-*ld%-*u%-*u%-*o%-*ld",
+	   (int)sizeof(arch->toc_ar_hdr.ar_name),
+	       ar_name,
+	   (int)sizeof(arch->toc_ar_hdr.ar_date),
+	       toc_time,
+	   (int)sizeof(arch->toc_ar_hdr.ar_uid),
+	       (unsigned short)getuid(),
+	   (int)sizeof(arch->toc_ar_hdr.ar_gid),
+	       (unsigned short)getgid(),
+	   (int)sizeof(arch->toc_ar_hdr.ar_mode),
+	       (unsigned int)toc_mode,
+	   (int)sizeof(arch->toc_ar_hdr.ar_size),
+	       (long)(arch->toc_size - sizeof(struct ar_hdr)));
+	/*
+	 * This has to be done by hand because sprintf puts a null
+	 * at the end of the buffer.
+	 */
+	memcpy(arch->toc_ar_hdr.ar_fmag, ARFMAG,
+	       (int)sizeof(arch->toc_ar_hdr.ar_fmag));
+}
+
+/*
+ * Function for qsort() for comparing toc structures by name.
+ */
+static
+int
+toc_name_qsort(
+const struct toc *toc1,
+const struct toc *toc2)
+{
+	return(strcmp(toc1->name, toc2->name));
+}
+
+/*
+ * Function for qsort() for comparing toc structures by index1.
+ */
+static
+int
+toc_index1_qsort(
+const struct toc *toc1,
+const struct toc *toc2)
+{
+	if(toc1->index1 < toc2->index1)
+	    return(-1);
+	if(toc1->index1 > toc2->index1)
+	    return(1);
+	/* toc1->index1 == toc2->index1 */
+	    return(0);
+}
+
+/*
+ * toc_symbol() returns TRUE if the symbol is to be included in the table of
+ * contents otherwise it returns FALSE.
+ */
+static
+enum bool
+toc_symbol(
+struct nlist *symbol,
+struct section **sections)
+{
+	return(toc(symbol->n_un.n_strx,
+		   symbol->n_type,
+		   symbol->n_value,
+		   (symbol->n_type & N_TYPE) == N_SECT &&
+		       sections[symbol->n_sect - 1]->flags & S_ATTR_NO_TOC));
+}
+
+static
+enum bool
+toc_symbol_64(
+struct nlist_64 *symbol64,
+struct section_64 **sections64)
+{
+	return(toc(symbol64->n_un.n_strx,
+		   symbol64->n_type,
+		   symbol64->n_value,
+		   (symbol64->n_type & N_TYPE) == N_SECT &&
+		       sections64[symbol64->n_sect-1]->flags & S_ATTR_NO_TOC));
+}
+
+static
+enum bool
+toc(
+uint32_t n_strx,
+uint8_t n_type,
+uint64_t n_value,
+enum bool attr_no_toc)
+{
+	/* if the name is NULL then it won't be in the table of contents */
+	if(n_strx == 0)
+	    return(FALSE);
+	/* if symbol is not external then it won't be in the toc */
+	if((n_type & N_EXT) == 0)
+	    return(FALSE);
+	/* if symbol is undefined then it won't be in the toc */
+	if((n_type & N_TYPE) == N_UNDF && n_value == 0)
+	    return(FALSE);
+	/* if symbol is common and the -c flag is not specified then ... */
+	if((n_type & N_TYPE) == N_UNDF && n_value != 0 &&
+	   cmd_flags.c == FALSE)
+	    return(FALSE);
+	/* if the symbols is in a section marked NO_TOC then ... */
+	if(attr_no_toc != 0)
+	    return(FALSE);
+
+	return(TRUE);
+}
+
+/*
+ * check_sort_tocs() checks the table of contents for the specified arch
+ * which is sorted by name for more then one object defining the same symbol.
+ * It this is the case it prints each symbol that is defined in more than one
+ * object along with the object it is defined in.  It returns TRUE if there are
+ * no multiple definitions and FALSE otherwise.
+ */
+static
+enum bool
+check_sort_tocs(
+struct arch *arch,
+char *output,
+enum bool library_warnings)
+{
+    uint32_t i;
+    enum bool multiple_defs;
+    struct member *member;
+
+	if(arch->toc_nranlibs == 0)
+	    return(TRUE);
+	/*
+	 * Since the symbol table is sorted by name look to any two adjcent
+	 * entries with the same name.  If such entries are found print them
+	 * only once (marked by changing the sign of their ran_off).
+	 */
+	multiple_defs = FALSE;
+	for(i = 0; i < arch->toc_nranlibs - 1; i++){
+	    if(strcmp(arch->tocs[i].name, arch->tocs[i+1].name) == 0){
+		if(multiple_defs == FALSE){
+		    if(library_warnings == FALSE)
+			return(FALSE);
+		    fprintf(stderr, "%s: same symbol defined in more than one "
+			    "member ", progname);
+		    if(narchs > 1)
+			fprintf(stderr, "for architecture: %s ",
+				arch->arch_flag.name);
+		    fprintf(stderr, "in: %s (table of contents will not be "
+			    "sorted)\n", output);
+		    multiple_defs = TRUE;
+		}
+		if((int)(arch->tocs[i].index1) > 0){
+		    member = arch->members + arch->tocs[i].index1 - 1;
+		    warn_member(arch, member, "defines symbol: %s",
+				arch->tocs[i].name);
+		    arch->tocs[i].index1 =
+				-(arch->tocs[i].index1);
+		}
+		if((int)(arch->tocs[i+1].index1) > 0){
+		    member = arch->members + arch->tocs[i+1].index1 - 1;
+		    warn_member(arch, member, "defines symbol: %s",
+				arch->tocs[i+1].name);
+		    arch->tocs[i+1].index1 =
+				-(arch->tocs[i+1].index1);
+		}
+	    }
+	}
+
+	if(multiple_defs == FALSE)
+	    return(TRUE);
+	else{
+	    for(i = 0; i < arch->toc_nranlibs; i++)
+		if(((int)arch->tocs[i].index1) < 0)
+		    arch->tocs[i].index1 =
+			-(arch->tocs[i].index1);
+	    return(FALSE);
+	}
+}
+
+/*
+ * warn_duplicate_member_names() generates a warning if two members end up with
+ * the same ar_name.  This is only a warning because ld(1) and this program
+ * has no problems with it.  Only if ar(1) were used to extract the files
+ * would this be a problem (even the 4.4bsd ar(1) using long names can
+ * get hosed by base names,  the 4.3bsd ar(1) can't handle full 16 character
+ * ar_names).
+ */
+static
+void
+warn_duplicate_member_names(
+void)
+{
+    uint32_t i, j, len, len1, len2;
+
+	for(i = 0; i < narchs; i++){
+	    /* sort in order of ar_names */
+	    qsort(archs[i].members, archs[i].nmembers, sizeof(struct member),
+		  (int (*)(const void *, const void *))member_name_qsort);
+
+	    /* check for duplicate names */
+	    for(j = 0; j < archs[i].nmembers - 1; j++){
+		len1 = archs[i].members[j].member_name_size;
+		len2 = archs[i].members[j+1].member_name_size;
+		len = len1 > len2 ? len1 : len2;
+		if(strncmp(archs[i].members[j].member_name,
+			   archs[i].members[j+1].member_name,
+			   len) == 0){
+		    fprintf(stderr, "%s: warning ", progname);
+		    if(narchs > 1)
+			fprintf(stderr, "for architecture: %s ",
+				archs[i].arch_flag.name);
+		    fprintf(stderr, "same member name (%.*s) in output file "
+			    "used for input files: ", (int)len1,
+			    archs[i].members[j].member_name);
+
+		    if(archs[i].members[j].input_ar_hdr != NULL){
+			len = archs[i].members[j].input_base_name_size;
+			fprintf(stderr, "%s(%.*s) and: ",
+				archs[i].members[j].input_file_name, (int)len,
+				archs[i].members[j].input_base_name);
+		    }
+		    else
+			fprintf(stderr, "%s and: ",
+				archs[i].members[j].input_file_name);
+
+		    if(archs[i].members[j+1].input_ar_hdr != NULL){
+			len = archs[i].members[j+1].input_base_name_size;
+			fprintf(stderr, "%s(%.*s) due to use of basename, "
+				"truncation and blank padding\n",
+				archs[i].members[j+1].input_file_name, (int)len,
+				archs[i].members[j+1].input_base_name);
+		    }
+		    else
+			fprintf(stderr, "%s (due to use of basename, truncation"
+				", blank padding or duplicate input files)\n",
+				archs[i].members[j+1].input_file_name);
+		}
+	    }
+
+	    /* sort back in order of offset */
+	    qsort(archs[i].members, archs[i].nmembers, sizeof(struct member),
+		  (int (*)(const void *, const void *))member_offset_qsort);
+	}
+}
+
+/*
+ * Function for qsort() for comparing member structures by ar_hdr.ar_name.
+ */
+static
+int
+member_name_qsort(
+const struct member *member1,
+const struct member *member2)
+{
+    uint32_t len, len1, len2;
+
+	len1 = member1->member_name_size;
+	len2 = member2->member_name_size;
+	len = len1 > len2 ? len1 : len2;
+	return(strncmp(member1->member_name, member2->member_name, len));
+}
+
+/*
+ * Function for qsort() for comparing member structures by offset.
+ */
+static
+int
+member_offset_qsort(
+const struct member *member1,
+const struct member *member2)
+{
+	if(member1->offset < member2->offset)
+	    return(-1);
+	if(member1->offset > member2->offset)
+	    return(1);
+	/* member1->offset == member2->offset */
+	    return(0);
+}
+
+/*
+ * warn_member() is like the error routines it prints the program name the
+ * member name specified and message specified.
+ */
+static
+void
+warn_member(
+struct arch *arch,
+struct member *member,
+const char *format, ...)
+{
+    va_list ap;
+
+	fprintf(stderr, "%s: ", progname);
+	if(narchs > 1)
+	    fprintf(stderr, "for architecture: %s ", arch->arch_flag.name);
+
+	if(member->input_ar_hdr != NULL){
+	    fprintf(stderr, "file: %s(%.*s) ", member->input_file_name,
+		    (int)member->input_base_name_size, member->input_base_name);
+	}
+	else
+	    fprintf(stderr, "file: %s ", member->input_file_name);
+
+	va_start(ap, format);
+	vfprintf(stderr, format, ap);
+        fprintf(stderr, "\n");
+	va_end(ap);
+}
+
+/*
+ * Prints the message to cmd_flags.trace_file_path, or stderr if that
+ * isn't set.
+ */
+static
+void
+ld_trace(
+const char *format, ...)
+{
+	static int trace_file = -1;
+	char trace_buffer[MAXPATHLEN * 2];
+	char *buffer_ptr;
+	int length;
+	ssize_t amount_written;
+
+	if(trace_file == -1){
+		if(cmd_flags.trace_file_path != NULL){
+			trace_file = open(cmd_flags.trace_file_path, O_WRONLY | O_APPEND | O_CREAT, 0666);
+			if(trace_file == -1)
+				error("Could not open or create trace file: %s\n", cmd_flags.trace_file_path);
+		}
+		else{
+			trace_file = fileno(stderr);
+		}
+	}
+    va_list ap;
+
+	va_start(ap, format);
+	length = vsnprintf(trace_buffer, sizeof(trace_buffer), format, ap);
+	va_end(ap);
+	buffer_ptr = trace_buffer;
+	while(length > 0){
+		amount_written = write(trace_file, buffer_ptr, length);
+		if(amount_written == -1)
+			/* Failure to write shouldn't fail the build. */
+			return;
+		buffer_ptr += amount_written;
+		length -= amount_written;
+	}
+}
diff -urN cctools-806-old/misc/redo_prebinding.c cctools-806/misc/redo_prebinding.c
--- cctools-806-old/misc/redo_prebinding.c	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/misc/redo_prebinding.c	2011-09-07 01:45:04.000000000 -0500
@@ -9849,6 +9849,7 @@
 has_resource_fork(
 char *filename)
 {
+#ifdef HAVE_GETATTRLIST
     int err;
     struct attrlist alist;
     struct fileinfobuf finfo;
@@ -9900,6 +9901,7 @@
 	 */
 	if((finfo.finderinfo[0] != 0) || (finfo.finderinfo[1] != 0))
 	    return(TRUE);
+#endif /* HAVE_GETATTRLIST */
 
 	return(FALSE);
 }
diff -urN cctools-806-old/missing cctools-806/missing
--- cctools-806-old/missing	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/missing	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,353 @@
+#! /bin/sh
+# Common stub for a few missing GNU programs while installing.
+
+scriptversion=2004-09-07.08
+
+# Copyright (C) 1996, 1997, 1999, 2000, 2002, 2003, 2004
+#   Free Software Foundation, Inc.
+# Originally by Fran,cois Pinard <pinard@iro.umontreal.ca>, 1996.
+
+# This program is free software; you can redistribute it and/or modify
+# it under the terms of the GNU General Public License as published by
+# the Free Software Foundation; either version 2, or (at your option)
+# any later version.
+
+# This program is distributed in the hope that it will be useful,
+# but WITHOUT ANY WARRANTY; without even the implied warranty of
+# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+# GNU General Public License for more details.
+
+# You should have received a copy of the GNU General Public License
+# along with this program; if not, write to the Free Software
+# Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
+# 02111-1307, USA.
+
+# As a special exception to the GNU General Public License, if you
+# distribute this file as part of a program that contains a
+# configuration script generated by Autoconf, you may include it under
+# the same distribution terms that you use for the rest of that program.
+
+if test $# -eq 0; then
+  echo 1>&2 "Try \`$0 --help' for more information"
+  exit 1
+fi
+
+run=:
+
+# In the cases where this matters, `missing' is being run in the
+# srcdir already.
+if test -f configure.ac; then
+  configure_ac=configure.ac
+else
+  configure_ac=configure.in
+fi
+
+msg="missing on your system"
+
+case "$1" in
+--run)
+  # Try to run requested program, and just exit if it succeeds.
+  run=
+  shift
+  "$@" && exit 0
+  # Exit code 63 means version mismatch.  This often happens
+  # when the user try to use an ancient version of a tool on
+  # a file that requires a minimum version.  In this case we
+  # we should proceed has if the program had been absent, or
+  # if --run hadn't been passed.
+  if test $? = 63; then
+    run=:
+    msg="probably too old"
+  fi
+  ;;
+
+  -h|--h|--he|--hel|--help)
+    echo "\
+$0 [OPTION]... PROGRAM [ARGUMENT]...
+
+Handle \`PROGRAM [ARGUMENT]...' for when PROGRAM is missing, or return an
+error status if there is no known handling for PROGRAM.
+
+Options:
+  -h, --help      display this help and exit
+  -v, --version   output version information and exit
+  --run           try to run the given command, and emulate it if it fails
+
+Supported PROGRAM values:
+  aclocal      touch file \`aclocal.m4'
+  autoconf     touch file \`configure'
+  autoheader   touch file \`config.h.in'
+  automake     touch all \`Makefile.in' files
+  bison        create \`y.tab.[ch]', if possible, from existing .[ch]
+  flex         create \`lex.yy.c', if possible, from existing .c
+  help2man     touch the output file
+  lex          create \`lex.yy.c', if possible, from existing .c
+  makeinfo     touch the output file
+  tar          try tar, gnutar, gtar, then tar without non-portable flags
+  yacc         create \`y.tab.[ch]', if possible, from existing .[ch]
+
+Send bug reports to <bug-automake@gnu.org>."
+    exit 0
+    ;;
+
+  -v|--v|--ve|--ver|--vers|--versi|--versio|--version)
+    echo "missing $scriptversion (GNU Automake)"
+    exit 0
+    ;;
+
+  -*)
+    echo 1>&2 "$0: Unknown \`$1' option"
+    echo 1>&2 "Try \`$0 --help' for more information"
+    exit 1
+    ;;
+
+esac
+
+# Now exit if we have it, but it failed.  Also exit now if we
+# don't have it and --version was passed (most likely to detect
+# the program).
+case "$1" in
+  lex|yacc)
+    # Not GNU programs, they don't have --version.
+    ;;
+
+  tar)
+    if test -n "$run"; then
+       echo 1>&2 "ERROR: \`tar' requires --run"
+       exit 1
+    elif test "x$2" = "x--version" || test "x$2" = "x--help"; then
+       exit 1
+    fi
+    ;;
+
+  *)
+    if test -z "$run" && ($1 --version) > /dev/null 2>&1; then
+       # We have it, but it failed.
+       exit 1
+    elif test "x$2" = "x--version" || test "x$2" = "x--help"; then
+       # Could not run --version or --help.  This is probably someone
+       # running `$TOOL --version' or `$TOOL --help' to check whether
+       # $TOOL exists and not knowing $TOOL uses missing.
+       exit 1
+    fi
+    ;;
+esac
+
+# If it does not exist, or fails to run (possibly an outdated version),
+# try to emulate it.
+case "$1" in
+  aclocal*)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`acinclude.m4' or \`${configure_ac}'.  You might want
+         to install the \`Automake' and \`Perl' packages.  Grab them from
+         any GNU archive site."
+    touch aclocal.m4
+    ;;
+
+  autoconf)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`${configure_ac}'.  You might want to install the
+         \`Autoconf' and \`GNU m4' packages.  Grab them from any GNU
+         archive site."
+    touch configure
+    ;;
+
+  autoheader)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`acconfig.h' or \`${configure_ac}'.  You might want
+         to install the \`Autoconf' and \`GNU m4' packages.  Grab them
+         from any GNU archive site."
+    files=`sed -n 's/^[ ]*A[CM]_CONFIG_HEADER(\([^)]*\)).*/\1/p' ${configure_ac}`
+    test -z "$files" && files="config.h"
+    touch_files=
+    for f in $files; do
+      case "$f" in
+      *:*) touch_files="$touch_files "`echo "$f" |
+				       sed -e 's/^[^:]*://' -e 's/:.*//'`;;
+      *) touch_files="$touch_files $f.in";;
+      esac
+    done
+    touch $touch_files
+    ;;
+
+  automake*)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified \`Makefile.am', \`acinclude.m4' or \`${configure_ac}'.
+         You might want to install the \`Automake' and \`Perl' packages.
+         Grab them from any GNU archive site."
+    find . -type f -name Makefile.am -print |
+	   sed 's/\.am$/.in/' |
+	   while read f; do touch "$f"; done
+    ;;
+
+  autom4te)
+    echo 1>&2 "\
+WARNING: \`$1' is needed, but is $msg.
+         You might have modified some files without having the
+         proper tools for further handling them.
+         You can get \`$1' as part of \`Autoconf' from any GNU
+         archive site."
+
+    file=`echo "$*" | sed -n 's/.*--output[ =]*\([^ ]*\).*/\1/p'`
+    test -z "$file" && file=`echo "$*" | sed -n 's/.*-o[ ]*\([^ ]*\).*/\1/p'`
+    if test -f "$file"; then
+	touch $file
+    else
+	test -z "$file" || exec >$file
+	echo "#! /bin/sh"
+	echo "# Created by GNU Automake missing as a replacement of"
+	echo "#  $ $@"
+	echo "exit 0"
+	chmod +x $file
+	exit 1
+    fi
+    ;;
+
+  bison|yacc)
+    echo 1>&2 "\
+WARNING: \`$1' $msg.  You should only need it if
+         you modified a \`.y' file.  You may need the \`Bison' package
+         in order for those modifications to take effect.  You can get
+         \`Bison' from any GNU archive site."
+    rm -f y.tab.c y.tab.h
+    if [ $# -ne 1 ]; then
+        eval LASTARG="\${$#}"
+	case "$LASTARG" in
+	*.y)
+	    SRCFILE=`echo "$LASTARG" | sed 's/y$/c/'`
+	    if [ -f "$SRCFILE" ]; then
+	         cp "$SRCFILE" y.tab.c
+	    fi
+	    SRCFILE=`echo "$LASTARG" | sed 's/y$/h/'`
+	    if [ -f "$SRCFILE" ]; then
+	         cp "$SRCFILE" y.tab.h
+	    fi
+	  ;;
+	esac
+    fi
+    if [ ! -f y.tab.h ]; then
+	echo >y.tab.h
+    fi
+    if [ ! -f y.tab.c ]; then
+	echo 'main() { return 0; }' >y.tab.c
+    fi
+    ;;
+
+  lex|flex)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified a \`.l' file.  You may need the \`Flex' package
+         in order for those modifications to take effect.  You can get
+         \`Flex' from any GNU archive site."
+    rm -f lex.yy.c
+    if [ $# -ne 1 ]; then
+        eval LASTARG="\${$#}"
+	case "$LASTARG" in
+	*.l)
+	    SRCFILE=`echo "$LASTARG" | sed 's/l$/c/'`
+	    if [ -f "$SRCFILE" ]; then
+	         cp "$SRCFILE" lex.yy.c
+	    fi
+	  ;;
+	esac
+    fi
+    if [ ! -f lex.yy.c ]; then
+	echo 'main() { return 0; }' >lex.yy.c
+    fi
+    ;;
+
+  help2man)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+	 you modified a dependency of a manual page.  You may need the
+	 \`Help2man' package in order for those modifications to take
+	 effect.  You can get \`Help2man' from any GNU archive site."
+
+    file=`echo "$*" | sed -n 's/.*-o \([^ ]*\).*/\1/p'`
+    if test -z "$file"; then
+	file=`echo "$*" | sed -n 's/.*--output=\([^ ]*\).*/\1/p'`
+    fi
+    if [ -f "$file" ]; then
+	touch $file
+    else
+	test -z "$file" || exec >$file
+	echo ".ab help2man is required to generate this page"
+	exit 1
+    fi
+    ;;
+
+  makeinfo)
+    echo 1>&2 "\
+WARNING: \`$1' is $msg.  You should only need it if
+         you modified a \`.texi' or \`.texinfo' file, or any other file
+         indirectly affecting the aspect of the manual.  The spurious
+         call might also be the consequence of using a buggy \`make' (AIX,
+         DU, IRIX).  You might want to install the \`Texinfo' package or
+         the \`GNU make' package.  Grab either from any GNU archive site."
+    file=`echo "$*" | sed -n 's/.*-o \([^ ]*\).*/\1/p'`
+    if test -z "$file"; then
+      file=`echo "$*" | sed 's/.* \([^ ]*\) *$/\1/'`
+      file=`sed -n '/^@setfilename/ { s/.* \([^ ]*\) *$/\1/; p; q; }' $file`
+    fi
+    touch $file
+    ;;
+
+  tar)
+    shift
+
+    # We have already tried tar in the generic part.
+    # Look for gnutar/gtar before invocation to avoid ugly error
+    # messages.
+    if (gnutar --version > /dev/null 2>&1); then
+       gnutar "$@" && exit 0
+    fi
+    if (gtar --version > /dev/null 2>&1); then
+       gtar "$@" && exit 0
+    fi
+    firstarg="$1"
+    if shift; then
+	case "$firstarg" in
+	*o*)
+	    firstarg=`echo "$firstarg" | sed s/o//`
+	    tar "$firstarg" "$@" && exit 0
+	    ;;
+	esac
+	case "$firstarg" in
+	*h*)
+	    firstarg=`echo "$firstarg" | sed s/h//`
+	    tar "$firstarg" "$@" && exit 0
+	    ;;
+	esac
+    fi
+
+    echo 1>&2 "\
+WARNING: I can't seem to be able to run \`tar' with the given arguments.
+         You may want to install GNU tar or Free paxutils, or check the
+         command line arguments."
+    exit 1
+    ;;
+
+  *)
+    echo 1>&2 "\
+WARNING: \`$1' is needed, and is $msg.
+         You might have modified some files without having the
+         proper tools for further handling them.  Check the \`README' file,
+         it often tells you about the needed prerequisites for installing
+         this package.  You may also peek at any GNU archive site, in case
+         some other package would contain this missing \`$1' program."
+    exit 1
+    ;;
+esac
+
+exit 0
+
+# Local variables:
+# eval: (add-hook 'write-file-hooks 'time-stamp)
+# time-stamp-start: "scriptversion="
+# time-stamp-format: "%:y-%02m-%02d.%02H"
+# time-stamp-end: "$"
+# End:
diff -urN cctools-806-old/otool/Makefile cctools-806/otool/Makefile
--- cctools-806-old/otool/Makefile	2009-12-16 13:37:48.000000000 -0600
+++ cctools-806/otool/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,172 +0,0 @@
-RC_OS = macos
-export USE_APPLE_PB_SUPPORT = all
-OFLAG = -Os
-LEGACY = -D_MACH_I386_THREAD_STATUS_FPSTATE_LEGACY_FIELD_NAMES_ \
-	 -D_ARCHITECTURE_I386_FPU_FPSTATE_LEGACY_FIELD_NAMES_
-X_CFLAGS =
-
-ifeq "macos" "$(RC_OS)"
-  STATIC := $(shell if [ "$(RC_RELEASE)" = "Beaker"    ] || \
-		     [ "$(RC_RELEASE)" = "Bunsen"    ] || \
-		     [ "$(RC_RELEASE)" = "Gonzo"     ] || \
-		     [ "$(RC_RELEASE)" = "Kodiak"    ] || \
-		     [ "$(RC_RELEASE)" = "Cheetah"   ] || \
-		     [ "$(RC_RELEASE)" = "Puma"      ] || \
-		     [ "$(RC_RELEASE)" = "Jaguar"    ] || \
-		     [ "$(RC_RELEASE)" = "Panther"   ] || \
-		     [ "$(RC_RELEASE)" = "MuonPrime" ] || \
-		     [ "$(RC_RELEASE)" = "MuonSeed"  ] || \
-		     [ "$(RC_RELEASE)" = "SUPanWheat" ]; then \
-		    echo "-static" ; \
-	    else if [ "$(RC_RELEASE)" = "Tiger" ]; then \
-		    echo "-static" ; \
-	    else \
-		    echo "" ; \
-	  fi; fi; )
-else
-  STATIC = -static
-endif
-
-ifeq "$(EFITOOLS)" "efitools"
-	EFI_SUPPORT = -DEFI_SUPPORT
-endif
-
-ifneq "" "$(SDKROOT)"
-  SDK = -isysroot $(SDKROOT)
-  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
-endif
-
-ifeq "clang" "$(notdir $(CC))"
-  CFLAGS = $(STATIC) $(OFLAG) -g -Wall -I$(SRCROOT)/../include \
-	   -I$(SRCROOT) $(LEGACY) $(EFI_SUPPORT) $(SDK)
-else
-  CFLAGS = $(STATIC) $(OFLAG) -g -Wall -I$(SRCROOT)/../include \
-	   -I$(SRCROOT) $(X_CFLAGS) $(LEGACY) $(EFI_SUPPORT) $(SDK)
-endif
-
-USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
-				  [ "$(RC_XBS)" != "YES" ]; then \
-	     echo YES ; else echo NO ; \
-	     fi; )
-
-LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
-
-ifeq "macos" "$(RC_OS)"
-  SYSTEMDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] || \
-			  [ "$(RC_RELEASE)" = "Bunsen" ] || \
-			  [ "$(RC_RELEASE)" = "Gonzo" ]; then \
-	 echo /Local/Developer/System; else echo /usr/local/lib/system; fi; )
-else
-  SYSTEMDIR = /Local/Developer/System
-endif
-ifeq "macos" "$(RC_OS)"
-  LIBS := $(shell if [ "$(RC_RELEASE)" = "Beaker"    ] || \
-		     [ "$(RC_RELEASE)" = "Bunsen"    ] || \
-		     [ "$(RC_RELEASE)" = "Gonzo"     ] || \
-		     [ "$(RC_RELEASE)" = "Kodiak"    ] || \
-		     [ "$(RC_RELEASE)" = "Cheetah"   ] || \
-		     [ "$(RC_RELEASE)" = "Puma"      ] || \
-		     [ "$(RC_RELEASE)" = "Jaguar"    ] || \
-		     [ "$(RC_RELEASE)" = "Panther"   ] || \
-		     [ "$(RC_RELEASE)" = "MuonPrime" ] || \
-		     [ "$(RC_RELEASE)" = "MuonSeed"  ] || \
-		     [ "$(RC_RELEASE)" = "SUPanWheat" ]; then \
-		    echo "-L$(NEXT_ROOT)$(SYSTEMDIR) -lc_static" ; \
-	    else if [ "$(RC_RELEASE)" = "Tiger" ]; then \
-		    echo "-L$(NEXT_ROOT)$(SYSTEMDIR) -lc_static -lm_static" ; \
-	    else \
-		    echo "" ; \
-	  fi; fi; )
-else
-  LIBS = -lc_static
-endif
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-SRCROOT = .
-SYMROOT = .
-OBJROOT = .
-OFILE_DIR = $(OBJROOT)
-VPATH = $(OFILE_DIR)
-
-BINDIR = /bin
-USRBINDIR = /usr/bin
-
-CFILES = main.c ofile_print.c m68k_disasm.c i860_disasm.c \
-	 m88k_disasm.c i386_disasm.c ppc_disasm.c hppa_disasm.c \
-	 sparc_disasm.c print_objc.c notify.c arm_disasm.c \
-	 print_objc2_64bit.c print_objc2_32bit.c
-ifeq "$(EFITOOLS)" "efitools"
-	CFILES += coff_print.c
-endif
-HFILES = otool.h ofile_print.h m68k_disasm.h i860_disasm.h \
-	 sparc_disasm.h m88k_disasm.h i386_disasm.h ppc_disasm.h hppa_disasm.h \
-	 notify.h arm_disasm.h
-OBJS = $(CFILES:.c=.o) ofile.o vers.o
-INSTALL_FILES = $(CFILES) $(HFILES) Makefile notes
-
-PRODUCT = otool
-all: $(OFILE_DIR) $(SYMROOT) $(PRODUCT).NEW
-
-$(PRODUCT).NEW:	$(OFILE_DIR) $(SYMROOT) $(OBJS)
-	$(CC) $(RC_CFLAGS) -nostdlib -r -o $(OBJROOT)/private.o \
-		$(OBJS) $(LIBSTUFF)
-	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/$@ $(OBJROOT)/private.o \
-		$(LIBSTUFF) $(LIBS)
-
-vers.c:
-	vers_string -c $(VERS_STRING_FLAGS) $(PRODUCT) > $(OFILE_DIR)/$@
-
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o $<
-else
-.c.o:
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file $(OFILE_DIR)/$*.d \
-		-o $(OFILE_DIR)/$*.o $<
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-ofile.o: $(SRCROOT)/../libstuff/ofile.c
-ifeq "NO" "$(USE_DEPENDENCY_FILE)"
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o \
-		$(SRCROOT)/../libstuff/ofile.c -DOTOOL
-else
-	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file $(OFILE_DIR)/$*.d \
-		-o $(OFILE_DIR)/$*.o $(SRCROOT)/../libstuff/ofile.c -DOTOOL
-	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
-endif
-
-clean: shlib_clean
-	-rm -f $(SYMROOT)/$(PRODUCT).NEW $(OFILE_DIR)/vers.c
-
-shlib_clean:
-	-cd $(OFILE_DIR); rm -f $(OBJS) private.o
-	-rm -f $(OFILE_DIR)/Makedep make.out
-
-install: all $(RC_OS)_install
-
-teflon_install macos_install:
-	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
-	install -c -s -m 555 $(SYMROOT)/$(PRODUCT).NEW \
-		$(DSTROOT)$(USRBINDIR)/$(PRODUCT)
-
-nextstep_install:
-	$(MKDIRS) $(DSTROOT)$(BINDIR)
-	install -c -s -m 555 $(SYMROOT)/$(PRODUCT).NEW \
-		$(DSTROOT)$(BINDIR)/$(PRODUCT)
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-$(OFILE_DIR) $(SYMROOT):
-	$(MKDIRS) $@
-
--include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/otool/Makefile.apple cctools-806/otool/Makefile.apple
--- cctools-806-old/otool/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/otool/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,172 @@
+RC_OS = macos
+export USE_APPLE_PB_SUPPORT = all
+OFLAG = -Os
+LEGACY = -D_MACH_I386_THREAD_STATUS_FPSTATE_LEGACY_FIELD_NAMES_ \
+	 -D_ARCHITECTURE_I386_FPU_FPSTATE_LEGACY_FIELD_NAMES_
+X_CFLAGS =
+
+ifeq "macos" "$(RC_OS)"
+  STATIC := $(shell if [ "$(RC_RELEASE)" = "Beaker"    ] || \
+		     [ "$(RC_RELEASE)" = "Bunsen"    ] || \
+		     [ "$(RC_RELEASE)" = "Gonzo"     ] || \
+		     [ "$(RC_RELEASE)" = "Kodiak"    ] || \
+		     [ "$(RC_RELEASE)" = "Cheetah"   ] || \
+		     [ "$(RC_RELEASE)" = "Puma"      ] || \
+		     [ "$(RC_RELEASE)" = "Jaguar"    ] || \
+		     [ "$(RC_RELEASE)" = "Panther"   ] || \
+		     [ "$(RC_RELEASE)" = "MuonPrime" ] || \
+		     [ "$(RC_RELEASE)" = "MuonSeed"  ] || \
+		     [ "$(RC_RELEASE)" = "SUPanWheat" ]; then \
+		    echo "-static" ; \
+	    else if [ "$(RC_RELEASE)" = "Tiger" ]; then \
+		    echo "-static" ; \
+	    else \
+		    echo "" ; \
+	  fi; fi; )
+else
+  STATIC = -static
+endif
+
+ifeq "$(EFITOOLS)" "efitools"
+	EFI_SUPPORT = -DEFI_SUPPORT
+endif
+
+ifneq "" "$(SDKROOT)"
+  SDK = -isysroot $(SDKROOT)
+  CC = $(shell xcrun -find -sdk $(SDKROOT) cc)
+endif
+
+ifeq "clang" "$(notdir $(CC))"
+  CFLAGS = $(STATIC) $(OFLAG) -g -Wall -I$(SRCROOT)/../include \
+	   -I$(SRCROOT) $(LEGACY) $(EFI_SUPPORT) $(SDK)
+else
+  CFLAGS = $(STATIC) $(OFLAG) -g -Wall -I$(SRCROOT)/../include \
+	   -I$(SRCROOT) $(X_CFLAGS) $(LEGACY) $(EFI_SUPPORT) $(SDK)
+endif
+
+USE_DEPENDENCY_FILE := $(shell if [ "$(notdir $(CC))" != "mwccppc" ] && \
+				  [ "$(RC_XBS)" != "YES" ]; then \
+	     echo YES ; else echo NO ; \
+	     fi; )
+
+LIBSTUFF = -L$(SYMROOT)/../libstuff -lstuff
+
+ifeq "macos" "$(RC_OS)"
+  SYSTEMDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] || \
+			  [ "$(RC_RELEASE)" = "Bunsen" ] || \
+			  [ "$(RC_RELEASE)" = "Gonzo" ]; then \
+	 echo /Local/Developer/System; else echo /usr/local/lib/system; fi; )
+else
+  SYSTEMDIR = /Local/Developer/System
+endif
+ifeq "macos" "$(RC_OS)"
+  LIBS := $(shell if [ "$(RC_RELEASE)" = "Beaker"    ] || \
+		     [ "$(RC_RELEASE)" = "Bunsen"    ] || \
+		     [ "$(RC_RELEASE)" = "Gonzo"     ] || \
+		     [ "$(RC_RELEASE)" = "Kodiak"    ] || \
+		     [ "$(RC_RELEASE)" = "Cheetah"   ] || \
+		     [ "$(RC_RELEASE)" = "Puma"      ] || \
+		     [ "$(RC_RELEASE)" = "Jaguar"    ] || \
+		     [ "$(RC_RELEASE)" = "Panther"   ] || \
+		     [ "$(RC_RELEASE)" = "MuonPrime" ] || \
+		     [ "$(RC_RELEASE)" = "MuonSeed"  ] || \
+		     [ "$(RC_RELEASE)" = "SUPanWheat" ]; then \
+		    echo "-L$(NEXT_ROOT)$(SYSTEMDIR) -lc_static" ; \
+	    else if [ "$(RC_RELEASE)" = "Tiger" ]; then \
+		    echo "-L$(NEXT_ROOT)$(SYSTEMDIR) -lc_static -lm_static" ; \
+	    else \
+		    echo "" ; \
+	  fi; fi; )
+else
+  LIBS = -lc_static
+endif
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+SRCROOT = .
+SYMROOT = .
+OBJROOT = .
+OFILE_DIR = $(OBJROOT)
+VPATH = $(OFILE_DIR)
+
+BINDIR = /bin
+USRBINDIR = /usr/bin
+
+CFILES = main.c ofile_print.c m68k_disasm.c i860_disasm.c \
+	 m88k_disasm.c i386_disasm.c ppc_disasm.c hppa_disasm.c \
+	 sparc_disasm.c print_objc.c notify.c arm_disasm.c \
+	 print_objc2_64bit.c print_objc2_32bit.c
+ifeq "$(EFITOOLS)" "efitools"
+	CFILES += coff_print.c
+endif
+HFILES = otool.h ofile_print.h m68k_disasm.h i860_disasm.h \
+	 sparc_disasm.h m88k_disasm.h i386_disasm.h ppc_disasm.h hppa_disasm.h \
+	 notify.h arm_disasm.h
+OBJS = $(CFILES:.c=.o) ofile.o vers.o
+INSTALL_FILES = $(CFILES) $(HFILES) Makefile notes
+
+PRODUCT = otool
+all: $(OFILE_DIR) $(SYMROOT) $(PRODUCT).NEW
+
+$(PRODUCT).NEW:	$(OFILE_DIR) $(SYMROOT) $(OBJS)
+	$(CC) $(RC_CFLAGS) -nostdlib -r -o $(OBJROOT)/private.o \
+		$(OBJS) $(LIBSTUFF)
+	$(CC) $(RC_CFLAGS) $(SDK) -o $(SYMROOT)/$@ $(OBJROOT)/private.o \
+		$(LIBSTUFF) $(LIBS)
+
+vers.c:
+	vers_string -c $(VERS_STRING_FLAGS) $(PRODUCT) > $(OFILE_DIR)/$@
+
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o $<
+else
+.c.o:
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file $(OFILE_DIR)/$*.d \
+		-o $(OFILE_DIR)/$*.o $<
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+ofile.o: $(SRCROOT)/../libstuff/ofile.c
+ifeq "NO" "$(USE_DEPENDENCY_FILE)"
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -o $(OFILE_DIR)/$*.o \
+		$(SRCROOT)/../libstuff/ofile.c -DOTOOL
+else
+	$(CC) $(CFLAGS) $(RC_CFLAGS) -c -MD -dependency-file $(OFILE_DIR)/$*.d \
+		-o $(OFILE_DIR)/$*.o $(SRCROOT)/../libstuff/ofile.c -DOTOOL
+	md -d -u $(OFILE_DIR)/Makedep $(OFILE_DIR)/$*.d
+endif
+
+clean: shlib_clean
+	-rm -f $(SYMROOT)/$(PRODUCT).NEW $(OFILE_DIR)/vers.c
+
+shlib_clean:
+	-cd $(OFILE_DIR); rm -f $(OBJS) private.o
+	-rm -f $(OFILE_DIR)/Makedep make.out
+
+install: all $(RC_OS)_install
+
+teflon_install macos_install:
+	$(MKDIRS) $(DSTROOT)$(USRBINDIR)
+	install -c -s -m 555 $(SYMROOT)/$(PRODUCT).NEW \
+		$(DSTROOT)$(USRBINDIR)/$(PRODUCT)
+
+nextstep_install:
+	$(MKDIRS) $(DSTROOT)$(BINDIR)
+	install -c -s -m 555 $(SYMROOT)/$(PRODUCT).NEW \
+		$(DSTROOT)$(BINDIR)/$(PRODUCT)
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+$(OFILE_DIR) $(SYMROOT):
+	$(MKDIRS) $@
+
+-include $(OFILE_DIR)/Makedep
diff -urN cctools-806-old/otool/Makefile.in cctools-806/otool/Makefile.in
--- cctools-806-old/otool/Makefile.in	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/otool/Makefile.in	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,93 @@
+builddir = @builddir@
+top_builddir = @top_builddir@
+srcdir = @srcdir@
+top_srcdir = @top_srcdir@
+
+prefix		= @prefix@
+exec_prefix	= @exec_prefix@
+bindir		= @bindir@
+
+VPATH = @srcdir@
+
+CC              = @CC@
+CFLAGS          = @CFLAGS@
+WARNINGS	= @WARNINGS@
+MDYNAMICNOPIC   = @MDYNAMICNOPIC@
+CPPFLAGS        = @CPPFLAGS@
+DEFS            = @DEFS@ @ENDIAN_FLAG@
+LDFLAGS         = @LDFLAGS@
+OBJC		= @OBJC@
+HAVE_PRIVEXT    = @HAVE_PRIVEXT@
+HAVE_FOREIGN_HEADERS    = @HAVE_FOREIGN_HEADERS@
+
+ifeq ($(HAVE_PRIVEXT),NO)
+INCPRIVEXT      = -include $(top_srcdir)/include/extern.h
+endif
+
+ifeq ($(HAVE_FOREIGN_HEADERS),YES)
+FORHDRS         = -I$(top_srcdir)/include/foreign
+endif
+
+INSTALL		= @INSTALL@
+INSTALL_PROGRAM	= @INSTALL_PROGRAM@
+transform       = @program_transform_name@
+
+MYINCLUDES      = -I$(builddir) -I$(srcdir) -I$(top_builddir)/include \
+			-I$(top_srcdir)/include $(INCPRIVEXT) $(FORHDRS)
+MYWARNINGS      = 
+MYDEFS          = 
+MYLDFLAGS	= -L$(top_builddir)/libstuff
+MYLIBS		=
+
+MYCOMPILEFLAGS	= $(WARNINGS) $(MYWARNINGS) $(DEFS) $(MYDEFS) \
+	$(CPPFLAGS) $(MYINCLUDES) $(CFLAGS) $(MDYNAMICNOPIC) 
+
+MYLINKFLAGS	= $(LDFLAGS) $(MYLDFLAGS) $(MYLIBS)
+
+CFILES = main.c ofile_print.c m68k_disasm.c i860_disasm.c \
+         m88k_disasm.c i386_disasm.c ppc_disasm.c hppa_disasm.c \
+         sparc_disasm.c arm_disasm.c
+MFILES = print_objc.c print_objc2_32bit.c print_objc2_64bit.c
+
+OBJS = $(CFILES:.c=.o)
+OBJS64 = $(CFILES:.c=.64o)
+
+MOBJS = $(MFILES:.c=.o)
+MOBJS64 = $(MFILES:.c=.64o)
+
+.PHONY: default clean distclean install
+
+default: otool otool64
+
+$(OBJS): %.o: %.c
+	$(CC) $(MYCOMPILEFLAGS) -c -o $@ $<
+
+$(OBJS64): %.64o: %.c
+	$(CC) $(MYCOMPILEFLAGS) -DARCH64 -c -o $@ $<
+
+otool: $(OBJS) ofile.o $(MOBJS)
+	$(CC) -o $@ $^ $(MYLINKFLAGS) -lstuff
+
+otool64: $(OBJS64) ofile.64o $(MOBJS64)
+	$(CC) -o $@ $^ $(MYLINKFLAGS) -lstuff64
+
+ofile.o: $(top_srcdir)/libstuff/ofile.c
+	$(CC) -DOTOOL $(MYCOMPILEFLAGS) -c -o $@ $<
+ofile.64o: $(top_srcdir)/libstuff/ofile.c
+	$(CC) -DOTOOL $(MYCOMPILEFLAGS) -DARCH64 -c -o $@ $<
+
+$(MOBJS): %.o: %.c
+	$(CC) $(OBJC) $(MYCOMPILEFLAGS) -c -o $@ $<
+$(MOBJS64): %.64o: %.c
+	$(CC) $(OBJC) $(MYCOMPILEFLAGS) -DARCH64 -c -o $@ $<
+
+install: otool otool64
+	mkdir -p $(DESTDIR)$(bindir)
+	$(INSTALL_PROGRAM) otool \
+		$(DESTDIR)$(bindir)/`echo otool | sed '$(transform)'`
+	$(INSTALL_PROGRAM) otool64 \
+		$(DESTDIR)$(bindir)/`echo otool64 | sed '$(transform)'`
+
+clean:
+	rm -r -f *.o *.64o
+	rm -f otool otool64
diff -urN cctools-806-old/otool/print_objc.c cctools-806/otool/print_objc.c
--- cctools-806-old/otool/print_objc.c	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/otool/print_objc.c	2011-09-07 01:45:04.000000000 -0500
@@ -144,7 +144,9 @@
     uint32_t characters;	/* char * (32-bit pointer) */
     uint32_t _length;
 };
+#ifdef __APPLE__
 typedef struct objc_string_object_t NXConstantString;
+#endif
 
 #define SIZEHASHTABLE 821
 struct _hashEntry_t {
diff -urN cctools-806-old/RelNotes/Makefile cctools-806/RelNotes/Makefile
--- cctools-806-old/RelNotes/Makefile	2009-06-29 16:32:19.000000000 -0500
+++ cctools-806/RelNotes/Makefile	1969-12-31 18:00:00.000000000 -0600
@@ -1,66 +0,0 @@
-RC_OS = macos
-OTHER_SRCS = Makefile
-PRIVATE_NOTES = Private_CompilerTools.html FatFiles.rtf
-COMPILERTOOLS_NOTES = CompilerTools.html
-PREBINDING_NOTES = CompilerTools.html
-INSTALL_FILES = $(OTHER_SRCS) $(COMPILERTOOLS_NOTES) $(PREBINDING_NOTES) \
-		$(PRIVATE_NOTES)
-
-ifneq "" "$(wildcard /bin/mkdirs)"
-  MKDIRS = /bin/mkdirs
-else
-  MKDIRS = /bin/mkdir -p
-endif
-
-ifeq "macos" "$(RC_OS)"
-  NOTESDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] || \
-			 [ "$(RC_RELEASE)" = "Bunsen" ] || \
-			 [ "$(RC_RELEASE)" = "Gonzo" ]; then \
-	echo /System/Documentation/Developer/ReleaseNotes ; else \
-		      if [ "$(RC_RELEASE)" = "Kodiak"    ] || \
-		         [ "$(RC_RELEASE)" = "Cheetah"   ] || \
-		         [ "$(RC_RELEASE)" = "Puma"      ] || \
-		         [ "$(RC_RELEASE)" = "Jaguar"    ] || \
-		         [ "$(RC_RELEASE)" = "Panther" ]; then \
-	echo /Developer/Documentation/ReleaseNotes; else \
-	echo /Developer/Documentation/DocSets/com.apple.ADC_Reference_Library.DeveloperTools.docset/Contents/Resources/Documents/documentation/DeveloperTools ; \
-    fi; \
-  fi;)
-else
-  NOTESDIR = /System/Documentation/Developer/ReleaseNotes
-endif
-PRIVATE_NOTESDIR = /usr/local/RelNotes
-
-install: ${COMPILERTOOLS_NOTES} ${PREBINDING_NOTES} ${PRIVATE_NOTES}
-	$(MKDIRS) '${DSTROOT}${NOTESDIR}'
-	$(MKDIRS) ${DSTROOT}${PRIVATE_NOTESDIR}
-	install -c -m 444 ${IFLAGS} ${COMPILERTOOLS_NOTES} \
-		'${DSTROOT}${NOTESDIR}'
-	install -c -m 444 ${IFLAGS} ${PREBINDING_NOTES} \
-		'${DSTROOT}${NOTESDIR}'
-	install -c -m 444 ${IFLAGS} ${PRIVATE_NOTES} \
-		${DSTROOT}${PRIVATE_NOTESDIR}
-
-installsrc:
-	$(MKDIRS) $(SRCROOT)
-	chmod 755 $(SRCROOT)
-	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
-	chmod 444 $(SRCROOT)/*
-
-depend:
-
-clean:
-shlib_clean:
-
-all:
-
-ifeq "macos" "$(RC_OS)"
-  WEBDIR = /Library/WebServer/Documents
-else
-  WEBDIR = /Local/Library/WebServer/Documents
-endif
-
-local_install:
-	cp Private_CompilerTools.html $(WEBDIR)
-	cp CompilerTools.html $(WEBDIR)
-	cp Prebinding.html $(WEBDIR)
diff -urN cctools-806-old/RelNotes/Makefile.apple cctools-806/RelNotes/Makefile.apple
--- cctools-806-old/RelNotes/Makefile.apple	1969-12-31 18:00:00.000000000 -0600
+++ cctools-806/RelNotes/Makefile.apple	2011-09-07 01:45:04.000000000 -0500
@@ -0,0 +1,66 @@
+RC_OS = macos
+OTHER_SRCS = Makefile
+PRIVATE_NOTES = Private_CompilerTools.html FatFiles.rtf
+COMPILERTOOLS_NOTES = CompilerTools.html
+PREBINDING_NOTES = CompilerTools.html
+INSTALL_FILES = $(OTHER_SRCS) $(COMPILERTOOLS_NOTES) $(PREBINDING_NOTES) \
+		$(PRIVATE_NOTES)
+
+ifneq "" "$(wildcard /bin/mkdirs)"
+  MKDIRS = /bin/mkdirs
+else
+  MKDIRS = /bin/mkdir -p
+endif
+
+ifeq "macos" "$(RC_OS)"
+  NOTESDIR := $(shell if [ "$(RC_RELEASE)" = "Beaker" ] || \
+			 [ "$(RC_RELEASE)" = "Bunsen" ] || \
+			 [ "$(RC_RELEASE)" = "Gonzo" ]; then \
+	echo /System/Documentation/Developer/ReleaseNotes ; else \
+		      if [ "$(RC_RELEASE)" = "Kodiak"    ] || \
+		         [ "$(RC_RELEASE)" = "Cheetah"   ] || \
+		         [ "$(RC_RELEASE)" = "Puma"      ] || \
+		         [ "$(RC_RELEASE)" = "Jaguar"    ] || \
+		         [ "$(RC_RELEASE)" = "Panther" ]; then \
+	echo /Developer/Documentation/ReleaseNotes; else \
+	echo /Developer/Documentation/DocSets/com.apple.ADC_Reference_Library.DeveloperTools.docset/Contents/Resources/Documents/documentation/DeveloperTools ; \
+    fi; \
+  fi;)
+else
+  NOTESDIR = /System/Documentation/Developer/ReleaseNotes
+endif
+PRIVATE_NOTESDIR = /usr/local/RelNotes
+
+install: ${COMPILERTOOLS_NOTES} ${PREBINDING_NOTES} ${PRIVATE_NOTES}
+	$(MKDIRS) '${DSTROOT}${NOTESDIR}'
+	$(MKDIRS) ${DSTROOT}${PRIVATE_NOTESDIR}
+	install -c -m 444 ${IFLAGS} ${COMPILERTOOLS_NOTES} \
+		'${DSTROOT}${NOTESDIR}'
+	install -c -m 444 ${IFLAGS} ${PREBINDING_NOTES} \
+		'${DSTROOT}${NOTESDIR}'
+	install -c -m 444 ${IFLAGS} ${PRIVATE_NOTES} \
+		${DSTROOT}${PRIVATE_NOTESDIR}
+
+installsrc:
+	$(MKDIRS) $(SRCROOT)
+	chmod 755 $(SRCROOT)
+	gnutar cf - $(INSTALL_FILES) | (cd $(SRCROOT); gnutar xf -)
+	chmod 444 $(SRCROOT)/*
+
+depend:
+
+clean:
+shlib_clean:
+
+all:
+
+ifeq "macos" "$(RC_OS)"
+  WEBDIR = /Library/WebServer/Documents
+else
+  WEBDIR = /Local/Library/WebServer/Documents
+endif
+
+local_install:
+	cp Private_CompilerTools.html $(WEBDIR)
+	cp CompilerTools.html $(WEBDIR)
+	cp Prebinding.html $(WEBDIR)
